<!DOCTYPE html>
<html amp lang="en" i-amphtml-layout="" i-amphtml-no-boilerplate="" transformed="self;v=1">
<head><meta charset="utf-8"><style amp-runtime="" i-amphtml-version="012109102127000">html{overflow-x:hidden!important}html.i-amphtml-fie{height:100%!important;width:100%!important}html:not([amp4ads]),html:not([amp4ads]) body{height:auto!important}html:not([amp4ads]) body{margin:0!important}body{-webkit-text-size-adjust:100%;-moz-text-size-adjust:100%;-ms-text-size-adjust:100%;text-size-adjust:100%}html.i-amphtml-singledoc.i-amphtml-embedded{-ms-touch-action:pan-y pinch-zoom;touch-action:pan-y pinch-zoom}html.i-amphtml-fie>body,html.i-amphtml-singledoc>body{overflow:visible!important}html.i-amphtml-fie:not(.i-amphtml-inabox)>body,html.i-amphtml-singledoc:not(.i-amphtml-inabox)>body{position:relative!important}html.i-amphtml-ios-embed-legacy>body{overflow-x:hidden!important;overflow-y:auto!important;position:absolute!important}html.i-amphtml-ios-embed{overflow-y:auto!important;position:static}#i-amphtml-wrapper{overflow-x:hidden!important;overflow-y:auto!important;position:absolute!important;top:0!important;left:0!important;right:0!important;bottom:0!important;margin:0!important;display:block!important}html.i-amphtml-ios-embed.i-amphtml-ios-overscroll,html.i-amphtml-ios-embed.i-amphtml-ios-overscroll>#i-amphtml-wrapper{-webkit-overflow-scrolling:touch!important}#i-amphtml-wrapper>body{position:relative!important;border-top:1px solid transparent!important}#i-amphtml-wrapper+body{visibility:visible}#i-amphtml-wrapper+body .i-amphtml-lightbox-element,#i-amphtml-wrapper+body[i-amphtml-lightbox]{visibility:hidden}#i-amphtml-wrapper+body[i-amphtml-lightbox] .i-amphtml-lightbox-element{visibility:visible}#i-amphtml-wrapper.i-amphtml-scroll-disabled,.i-amphtml-scroll-disabled{overflow-x:hidden!important;overflow-y:hidden!important}amp-instagram{padding:54px 0px 0px!important;background-color:#fff}amp-iframe iframe{box-sizing:border-box!important}[amp-access][amp-access-hide]{display:none}[subscriptions-dialog],body:not(.i-amphtml-subs-ready) [subscriptions-action],body:not(.i-amphtml-subs-ready) [subscriptions-section]{display:none!important}amp-experiment,amp-live-list>[update]{display:none}amp-list[resizable-children]>.i-amphtml-loading-container.amp-hidden{display:none!important}amp-list [fetch-error],amp-list[load-more] [load-more-button],amp-list[load-more] [load-more-end],amp-list[load-more] [load-more-failed],amp-list[load-more] [load-more-loading]{display:none}amp-list[diffable] div[role=list]{display:block}amp-story-page,amp-story[standalone]{min-height:1px!important;display:block!important;height:100%!important;margin:0!important;padding:0!important;overflow:hidden!important;width:100%!important}amp-story[standalone]{background-color:#000!important;position:relative!important}amp-story-page{background-color:#757575}amp-story .amp-active>div,amp-story .i-amphtml-loader-background{display:none!important}amp-story-page:not(:first-of-type):not([distance]):not([active]){transform:translateY(1000vh)!important}amp-autocomplete{position:relative!important;display:inline-block!important}amp-autocomplete>input,amp-autocomplete>textarea{padding:0.5rem;border:1px solid rgba(0,0,0,0.33)}.i-amphtml-autocomplete-results,amp-autocomplete>input,amp-autocomplete>textarea{font-size:1rem;line-height:1.5rem}[amp-fx^=fly-in]{visibility:hidden}amp-script[nodom],amp-script[sandboxed]{position:fixed!important;top:0!important;width:1px!important;height:1px!important;overflow:hidden!important;visibility:hidden}
/*# sourceURL=/css/ampdoc.css*/[hidden]{display:none!important}.i-amphtml-element{display:inline-block}.i-amphtml-blurry-placeholder{transition:opacity 0.3s cubic-bezier(0.0,0.0,0.2,1)!important;pointer-events:none}[layout=nodisplay]:not(.i-amphtml-element){display:none!important}.i-amphtml-layout-fixed,[layout=fixed][width][height]:not(.i-amphtml-layout-fixed){display:inline-block;position:relative}.i-amphtml-layout-responsive,[layout=responsive][width][height]:not(.i-amphtml-layout-responsive),[width][height][heights]:not([layout]):not(.i-amphtml-layout-responsive),[width][height][sizes]:not(img):not([layout]):not(.i-amphtml-layout-responsive){display:block;position:relative}.i-amphtml-layout-intrinsic,[layout=intrinsic][width][height]:not(.i-amphtml-layout-intrinsic){display:inline-block;position:relative;max-width:100%}.i-amphtml-layout-intrinsic .i-amphtml-sizer{max-width:100%}.i-amphtml-intrinsic-sizer{max-width:100%;display:block!important}.i-amphtml-layout-container,.i-amphtml-layout-fixed-height,[layout=container],[layout=fixed-height][height]:not(.i-amphtml-layout-fixed-height){display:block;position:relative}.i-amphtml-layout-fill,.i-amphtml-layout-fill.i-amphtml-notbuilt,[layout=fill]:not(.i-amphtml-layout-fill),body noscript>*{display:block;overflow:hidden!important;position:absolute;top:0;left:0;bottom:0;right:0}body noscript>*{position:absolute!important;width:100%;height:100%;z-index:2}body noscript{display:inline!important}.i-amphtml-layout-flex-item,[layout=flex-item]:not(.i-amphtml-layout-flex-item){display:block;position:relative;-ms-flex:1 1 auto;flex:1 1 auto}.i-amphtml-layout-fluid{position:relative}.i-amphtml-layout-size-defined{overflow:hidden!important}.i-amphtml-layout-awaiting-size{position:absolute!important;top:auto!important;bottom:auto!important}i-amphtml-sizer{display:block!important}@supports (aspect-ratio:1/1){i-amphtml-sizer.i-amphtml-disable-ar{display:none!important}}.i-amphtml-blurry-placeholder,.i-amphtml-fill-content{display:block;height:0;max-height:100%;max-width:100%;min-height:100%;min-width:100%;width:0;margin:auto}.i-amphtml-layout-size-defined .i-amphtml-fill-content{position:absolute;top:0;left:0;bottom:0;right:0}.i-amphtml-replaced-content,.i-amphtml-screen-reader{padding:0!important;border:none!important}.i-amphtml-screen-reader{position:fixed!important;top:0px!important;left:0px!important;width:4px!important;height:4px!important;opacity:0!important;overflow:hidden!important;margin:0!important;display:block!important;visibility:visible!important}.i-amphtml-screen-reader~.i-amphtml-screen-reader{left:8px!important}.i-amphtml-screen-reader~.i-amphtml-screen-reader~.i-amphtml-screen-reader{left:12px!important}.i-amphtml-screen-reader~.i-amphtml-screen-reader~.i-amphtml-screen-reader~.i-amphtml-screen-reader{left:16px!important}.i-amphtml-unresolved{position:relative;overflow:hidden!important}.i-amphtml-select-disabled{-webkit-user-select:none!important;-ms-user-select:none!important;user-select:none!important}.i-amphtml-notbuilt,[layout]:not(.i-amphtml-element),[width][height][heights]:not([layout]):not(.i-amphtml-element),[width][height][sizes]:not(img):not([layout]):not(.i-amphtml-element){position:relative;overflow:hidden!important;color:transparent!important}.i-amphtml-notbuilt:not(.i-amphtml-layout-container)>*,[layout]:not([layout=container]):not(.i-amphtml-element)>*,[width][height][heights]:not([layout]):not(.i-amphtml-element)>*,[width][height][sizes]:not([layout]):not(.i-amphtml-element)>*{display:none}amp-img:not(.i-amphtml-element)[i-amphtml-ssr]>img.i-amphtml-fill-content{display:block}.i-amphtml-notbuilt:not(.i-amphtml-layout-container),[layout]:not([layout=container]):not(.i-amphtml-element),[width][height][heights]:not([layout]):not(.i-amphtml-element),[width][height][sizes]:not(img):not([layout]):not(.i-amphtml-element){color:transparent!important;line-height:0!important}.i-amphtml-ghost{visibility:hidden!important}.i-amphtml-element>[placeholder],[layout]:not(.i-amphtml-element)>[placeholder],[width][height][heights]:not([layout]):not(.i-amphtml-element)>[placeholder],[width][height][sizes]:not([layout]):not(.i-amphtml-element)>[placeholder]{display:block;line-height:normal}.i-amphtml-element>[placeholder].amp-hidden,.i-amphtml-element>[placeholder].hidden{visibility:hidden}.i-amphtml-element:not(.amp-notsupported)>[fallback],.i-amphtml-layout-container>[placeholder].amp-hidden,.i-amphtml-layout-container>[placeholder].hidden{display:none}.i-amphtml-layout-size-defined>[fallback],.i-amphtml-layout-size-defined>[placeholder]{position:absolute!important;top:0!important;left:0!important;right:0!important;bottom:0!important;z-index:1}amp-img[i-amphtml-ssr]:not(.i-amphtml-element)>[placeholder]{z-index:auto}.i-amphtml-notbuilt>[placeholder]{display:block!important}.i-amphtml-hidden-by-media-query{display:none!important}.i-amphtml-element-error{background:red!important;color:#fff!important;position:relative!important}.i-amphtml-element-error:before{content:attr(error-message)}i-amp-scroll-container,i-amphtml-scroll-container{position:absolute;top:0;left:0;right:0;bottom:0;display:block}i-amp-scroll-container.amp-active,i-amphtml-scroll-container.amp-active{overflow:auto;-webkit-overflow-scrolling:touch}.i-amphtml-loading-container{display:block!important;pointer-events:none;z-index:1}.i-amphtml-notbuilt>.i-amphtml-loading-container{display:block!important}.i-amphtml-loading-container.amp-hidden{visibility:hidden}.i-amphtml-element>[overflow]{cursor:pointer;position:relative;z-index:2;visibility:hidden;display:initial;line-height:normal}.i-amphtml-layout-size-defined>[overflow]{position:absolute}.i-amphtml-element>[overflow].amp-visible{visibility:visible}template{display:none!important}.amp-border-box,.amp-border-box *,.amp-border-box :after,.amp-border-box :before{box-sizing:border-box}amp-pixel{display:none!important}amp-analytics,amp-auto-ads,amp-story-auto-ads{position:fixed!important;top:0!important;width:1px!important;height:1px!important;overflow:hidden!important;visibility:hidden}html.i-amphtml-fie>amp-analytics{position:initial!important}[visible-when-invalid]:not(.visible),form [submit-error],form [submit-success],form [submitting]{display:none}amp-accordion{display:block!important}@media (min-width:1px){:where(amp-accordion>section)>:first-child{margin:0;background-color:#efefef;padding-right:20px;border:1px solid #dfdfdf}:where(amp-accordion>section)>:last-child{margin:0}}amp-accordion>section{float:none!important}amp-accordion>section>*{float:none!important;display:block!important;overflow:hidden!important;position:relative!important}amp-accordion,amp-accordion>section{margin:0}amp-accordion:not(.i-amphtml-built)>section>:last-child{display:none!important}amp-accordion:not(.i-amphtml-built)>section[expanded]>:last-child{display:block!important}
/*# sourceURL=/css/ampshared.css*/</style><meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1"><meta property="og:type" content="article"><meta property="og:title" content="El Niño Project (Part 4)"><meta property="og:url" content="https://johncarlosbaez.wordpress.com/2014/07/08/el-nino-project-part-4/"><meta property="og:description" content="As the first big step in our El Niño prediction project, Graham Jones replicated the paper by Ludescher et al that I explained last time. Let’s see how this works!Graham did it using R, a pro…"><meta property="article:published_time" content="2014-07-08T03:47:01+00:00"><meta property="article:modified_time" content="2014-08-13T06:55:17+00:00"><meta property="og:site_name" content="Azimuth"><meta property="og:image" content="http://math.ucr.edu/home/baez/ecological/el_nino/ludescher_el_nino_cooperativity_1a.jpg"><meta property="og:image:width" content="450"><meta property="og:locale" content="en_US"><meta name="twitter:site" content="@wordpressdotcom"><meta name="twitter:text:title" content="El Niño Project (Part 4)"><meta name="twitter:image" content="http://math.ucr.edu/home/baez/ecological/el_nino/ludescher_el_nino_cooperativity_1a.jpg?w=144"><meta name="twitter:card" content="summary"><meta property="fb:app_id" content="249643311490"><meta property="article:publisher" content="https://www.facebook.com/WordPresscom"><meta name="generator" content="AMP Plugin v2.0.5; mode=reader; theme=legacy"><meta name="generator" content="WordPress.com"><title>El Niño Project (Part 4) – Azimuth</title><link rel="preconnect" href="https://cdn.ampproject.org"><link rel="preload" as="script" href="https://cdn.ampproject.org/v0.js"><script async="" src="https://cdn.ampproject.org/v0.js"></script><script src="https://cdn.ampproject.org/v0/amp-anim-0.1.js" async="" custom-element="amp-anim"></script><style amp-custom="">.jp-related-posts-i2__row{display:flex;margin-top:1.5rem}.jp-related-posts-i2__row:first-child{margin-top:0}.jp-related-posts-i2__post{flex-grow:1;flex-basis:0;margin:0 10px;display:flex;flex-direction:column;padding-left:0}.jp-related-posts-i2__row[data-post-count="3"] .jp-related-posts-i2__post{max-width:calc(33% - 20px)}.jp-related-posts-i2__row[data-post-count="2"] .jp-related-posts-i2__post,.jp-related-posts-i2__row[data-post-count="1"] .jp-related-posts-i2__post{max-width:calc(50% - 20px)}.jp-related-posts-i2__post-date,.jp-related-posts-i2__post-context{flex-direction:row;display:block}.jp-related-posts-i2__post-link{display:block;width:100%;line-height:1.2em}.jp-relatedposts-i2[data-layout=list] .jp-related-posts-i2__row{margin-top:0;display:block}.jp-relatedposts-i2[data-layout=list] .jp-related-posts-i2__post{max-width:none;margin:0}@media only screen and (max-width:640px){.jp-related-posts-i2__row{margin-top:0;display:block}.jp-related-posts-i2__row[data-post-count] .jp-related-posts-i2__post{max-width:none;margin:0;margin-top:1rem}}h1,h2,h3{overflow-wrap:break-word}ul{overflow-wrap:break-word}p{overflow-wrap:break-word}@-webkit-keyframes a{to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes a{to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@-webkit-keyframes b{0%{background-position:0 0}to{background-position:30px 0}}@keyframes b{0%{background-position:0 0}to{background-position:30px 0}}amp-img.amp-wp-enforced-sizes[layout="intrinsic"] > img,amp-anim.amp-wp-enforced-sizes[layout="intrinsic"] > img{object-fit:contain}.amp-wp-enforced-sizes{max-width:100%;margin:0 auto}html{background:#0a89c0}body{background:#fff;color:#353535;font-family:Georgia,"Times New Roman",Times,Serif;font-weight:300;line-height:1.75em}p,ul{margin:0 0 1em;padding:0}a,a:visited{color:#0a89c0}a:hover,a:active,a:focus{color:#353535}.amp-wp-meta,.amp-wp-header div,.amp-wp-title,.amp-wp-tax-category,.amp-wp-comments-link,.amp-wp-footer p,.back-to-top{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen-Sans","Ubuntu","Cantarell","Helvetica Neue",sans-serif}.amp-wp-header{background-color:#0a89c0}.amp-wp-header div{color:#fff;font-size:1em;font-weight:400;margin:0 auto;max-width:calc(840px - 32px);padding:.875em 16px;position:relative}.amp-wp-header a{color:#fff;text-decoration:none}.amp-wp-article{color:#353535;font-weight:400;margin:1.5em auto;max-width:840px;overflow-wrap:break-word;word-wrap:break-word}.amp-wp-article-header{align-items:center;align-content:stretch;display:flex;flex-wrap:wrap;justify-content:space-between;margin:1.5em 16px 0}.amp-wp-title{color:#353535;display:block;flex:1 0 100%;font-weight:900;margin:0 0 .625em;width:100%}.amp-wp-meta{color:#696969;display:inline-block;flex:2 1 50%;font-size:.875em;line-height:1.5em;margin:0 0 1.5em;padding:0}.amp-wp-article-header .amp-wp-meta:last-of-type{text-align:right}.amp-wp-article-header .amp-wp-meta:first-of-type{text-align:left}.amp-wp-byline amp-img,.amp-wp-byline .amp-wp-author{display:inline-block;vertical-align:middle}.amp-wp-byline amp-img{border:1px solid #0a89c0;border-radius:50%;position:relative;margin-right:6px}.amp-wp-posted-on{text-align:right}.amp-wp-article-content{margin:0 16px}.amp-wp-article-content ul{margin-left:1em}.amp-wp-article-content amp-img{margin:0 auto}.amp-wp-article-footer .amp-wp-meta{display:block}.amp-wp-tax-category{color:#696969;font-size:.875em;line-height:1.5em;margin:1.5em 16px}.amp-wp-comments-link{color:#696969;font-size:.875em;line-height:1.5em;text-align:center;margin:2.25em 0 1.5em}.amp-wp-comments-link a{border-style:solid;border-color:#c2c2c2;border-width:1px 1px 2px;border-radius:4px;background-color:transparent;color:#0a89c0;cursor:pointer;display:block;font-size:14px;font-weight:600;line-height:18px;margin:0 auto;max-width:200px;padding:11px 16px;text-decoration:none;width:50%;-webkit-transition:background-color .2s ease;transition:background-color .2s ease}.amp-wp-footer{border-top:1px solid #c2c2c2;margin:calc(1.5em - 1px) 0 0}.amp-wp-footer div{margin:0 auto;max-width:calc(840px - 32px);padding:1.25em 16px 1.25em;position:relative}.amp-wp-footer h2{font-size:1em;line-height:1.375em;margin:0 0 .5em}.amp-wp-footer p{color:#696969;font-size:.8em;line-height:1.5em;margin:0 85px 0 0}.amp-wp-footer a{text-decoration:none}.back-to-top{bottom:1.275em;font-size:.8em;font-weight:600;line-height:2em;position:absolute;right:16px}@font-face{font-family:"social-logos";src:url("/wp-content/mu-plugins/social-logos/social-logos.eot?5d3b4da4f6c2460dd842dbf9e0992ea6");font-weight:normal;font-style:normal}@font-face{font-family:"social-logos";src:url("/wp-content/mu-plugins/social-logos/social-logos.eot?5d3b4da4f6c2460dd842dbf9e0992ea6");src:url("/wp-content/mu-plugins/social-logos/social-logos.eot?5d3b4da4f6c2460dd842dbf9e0992ea6#iefix") format("embedded-opentype"),url("/wp-content/mu-plugins/social-logos/social-logos.woff") format("woff"),url("/wp-content/mu-plugins/social-logos/social-logos.ttf?5d3b4da4f6c2460dd842dbf9e0992ea6") format("truetype");font-weight:normal;font-style:normal;font-display:swap}.jp-related-posts-i2__row{display:flex;margin-top:1.5rem}.jp-related-posts-i2__row:first-child{margin-top:0}.jp-related-posts-i2__post{flex-grow:1;flex-basis:0;margin:0 10px;display:flex;flex-direction:column;padding-left:0}.jp-related-posts-i2__row[data-post-count="3"] .jp-related-posts-i2__post{max-width:calc(33% - 20px)}.jp-related-posts-i2__row[data-post-count="2"] .jp-related-posts-i2__post,.jp-related-posts-i2__row[data-post-count="1"] .jp-related-posts-i2__post{max-width:calc(50% - 20px)}.jp-related-posts-i2__post-date,.jp-related-posts-i2__post-context{flex-direction:row;display:block}.jp-related-posts-i2__post-link{display:block;width:100%;line-height:1.2em}.jp-relatedposts-i2[data-layout="list"] .jp-related-posts-i2__row{margin-top:0;display:block}.jp-relatedposts-i2[data-layout="list"] .jp-related-posts-i2__post{max-width:none;margin:0}@media only screen and (max-width: 640px){.jp-related-posts-i2__row{margin-top:0;display:block}.jp-related-posts-i2__row[data-post-count] .jp-related-posts-i2__post{max-width:none;margin:0;margin-top:1rem}}

/*# sourceURL=amp-custom.css */</style><link rel="canonical" href="https://johncarlosbaez.wordpress.com/2014/07/08/el-nino-project-part-4/"><script type="application/ld+json">{"@context":"http:\/\/schema.org","publisher":{"@type":"Organization","name":"Azimuth","logo":{"@type":"ImageObject","url":"https:\/\/s2.wp.com\/wp-content\/plugins\/amp-2.0\/assets\/images\/amp-page-fallback-wordpress-publisher-logo.png"}},"@type":"BlogPosting","mainEntityOfPage":"https:\/\/johncarlosbaez.wordpress.com\/2014\/07\/08\/el-nino-project-part-4\/","headline":"El Niño Project (Part 4)","datePublished":"2014-07-08T03:47:01+00:00","dateModified":"2014-08-13T06:55:17+00:00","author":{"@type":"Person","name":"John Baez"},"image":{"@type":"ImageObject","url":"http:\/\/math.ucr.edu\/home\/baez\/ecological\/el_nino\/ludescher_el_nino_cooperativity_1a.jpg","width":450,"height":0}}</script></head>

<body class="">

<header id="top" class="amp-wp-header">
	<div>
		<a href="https://johncarlosbaez.wordpress.com/">
									<span class="amp-site-title">
				Azimuth			</span>
		</a>
	</div>
</header>

<article class="amp-wp-article">
	<header class="amp-wp-article-header">
		<h1 class="amp-wp-title">El Niño Project (Part 4)</h1>
			<div class="amp-wp-meta amp-wp-byline">
					<amp-img src="https://secure.gravatar.com/avatar/34784534843022b3541c8ddd693718cb?s=24&amp;d=identicon&amp;r=g" alt="John Baez" width="24" height="24" layout="fixed" class="i-amphtml-layout-fixed i-amphtml-layout-size-defined" style="width:24px;height:24px;" i-amphtml-layout="fixed"></amp-img>
				<span class="amp-wp-author author vcard">John Baez</span>
	</div>
<div class="amp-wp-meta amp-wp-posted-on">
	<time datetime="2014-07-08T03:47:01+00:00">
		7 years ago	</time>
</div>
	</header>

	
	<div class="amp-wp-article-content">
		<p>As the first big step in our El Niño prediction project, Graham Jones replicated the paper by Ludescher <i>et al</i> that I explained <a href="https://johncarlosbaez.wordpress.com/2014/07/01/el-nino-project-part-3/">last time</a>. Let’s see how this works!</p>
<p>Graham did it using <a href="https://en.wikipedia.org/wiki/R_%28programming_language%29">R</a>, a programming language that’s good for statistics. If you prefer another language, go ahead and write software for that… and let us know! We can add it to our repository.</p>
<p>Today I’ll explain this stuff to people who know their way around computers. But I’m not one of those people! So, next time I’ll explain the nitty-gritty details in a way that may be helpful to people more like me.</p>
<h3>Getting temperature data</h3>
<p>Say you want to predict El Niños from 1950 to 1980 using Ludescher <i>et al’</i>s method. To do this, you need daily average surface air temperatures in this grid in the Pacific Ocean:</p>
<div align="center"><a href="http://math.ucr.edu/home/baez/ecological/el_nino/ludescher_el_nino_cooperativity_1.jpg"><amp-img src="https://i2.wp.com/math.ucr.edu/home/baez/ecological/el_nino/ludescher_el_nino_cooperativity_1a.jpg" alt="" width="450" height="298.14814814815" class="amp-wp-enforced-sizes i-amphtml-layout-intrinsic i-amphtml-layout-size-defined" layout="intrinsic" i-amphtml-layout="intrinsic"><i-amphtml-sizer class="i-amphtml-sizer"><img alt="" aria-hidden="true" class="i-amphtml-intrinsic-sizer" role="presentation" src="data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9JzI5OC4xNDgxNDgxNDgxNScgd2lkdGg9JzQ1MCcgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB2ZXJzaW9uPScxLjEnLz4="></i-amphtml-sizer><noscript><img src="https://i2.wp.com/math.ucr.edu/home/baez/ecological/el_nino/ludescher_el_nino_cooperativity_1a.jpg" alt="" width="450" height="298.14814814815" class=""></noscript></amp-img></a></div>
<p>Each square here is 7.5° × 7.5°. To compute these temperatures, you have to start with temperatures on a grid with smaller squares that are 2.5° × 2.5° in size:</p>
<p>• Earth System Research Laboratory, <a href="http://www.esrl.noaa.gov/psd/cgi-bin/db_search/DBSearch.pl?Dataset=NCEP+Reanalysis+Daily+Averages+Surface+Level&amp;Variable=Air+Temperature&amp;group=0&amp;submit=Search">NCEP Reanalysis Daily Averages Surface Level</a>, or <a href="ftp://ftp.cdc.noaa.gov/Datasets/ncep.reanalysis.dailyavgs/surface/">ftp site</a>.</p>
<p>This website will give you daily average surface air temperatures in whatever rectangle and time interval you want. It delivers this data in a format called <b>NetCDF</b>, meaning <a href="http://www.unidata.ucar.edu/software/netcdf/">Network Common Data Form</a>.</p>
<p>We’ll take a different approach. We’ll download <i>all</i> the temperatures in this database, and then extract the data we need using R scripts. That way, when we play other games with temperature data later, we’ll already have it.</p>
<p>So, go ahead and download all the files from <code>air.sig995. 1948.nc</code> to <code>air.sig995.2013.nc</code>. It will take a while… but you’ll own the world.</p>
<p>There are different ways to do this. If you have R fired up, just cut-and-paste this into the console:</p>
<pre>for (year in 1950:1979) { 
  download.file(url=paste0(
  "ftp://ftp.cdc.noaa.gov/Datasets/ncep.reanalysis.dailyavgs/surface/air.sig995.", 
  year, ".nc"), 
  destfile=paste0("air.sig995.", year, ".nc"), mode="wb") 
  }
</pre>
<h3>Getting the temperatures you need</h3>
<p>Now you have files of daily average temperatures on a 2.5° by 2.5° grid from 1948 to 2013. Make sure all these files are in your working directory for R, and download this R script from GitHub:</p>
<p>• <a href="https://github.com/johncarlosbaez/el-nino/blob/master/R/netcdf-convertor-ludescher.R">netcdf-convertor-ludescher.R</a></p>
<p>You can use this to get the temperatures in any time interval and any rectangle of grid points you want. The details are explained in the script. But the defaults are set to precisely what you need now!</p>
<p>So, just run this script. You should get a file called <code>Pacific-1948-1980.txt</code>. This has daily average temperatures in the region we care about, from 1948 to 1980. It should start with a really long line listing locations in a 27 × 69 grid, starting with S024E48 and ending with S248E116. I’ll explain this coordinate scheme at the end of this post. Then come hundreds of lines listing temperatures in kelvin at those locations on successive days. The first of these lines should start with Y1948P001, meaning the first day of 1948.</p>
<p>And I know what you’re dying to ask: yes, leap days are omitted! This annoys the perfectionist in me… but leap years make data analysis more complicated, so Ludescher <i>et al</i> ignore leap days, and we will too.</p>
<h3>Getting the El Niño data</h3>
<p>You’ll use this data to predict El Niños, so you also want a file of the <b>Niño 3.4</b> index. Remember from last time, this says how much hotter the surface of this patch of seawater is than usual for this time of year:</p>
<div align="center"><a href="http://www.bom.gov.au/climate/enso/indices/about.shtml"><br> <amp-anim src="https://i0.wp.com/math.ucr.edu/home/baez/ecological/el_nino/nino_3.4_region.gif" alt="" width="450" height="115.3125" class="amp-wp-enforced-sizes i-amphtml-layout-intrinsic i-amphtml-layout-size-defined" layout="intrinsic" i-amphtml-layout="intrinsic"><i-amphtml-sizer class="i-amphtml-sizer"><img alt="" aria-hidden="true" class="i-amphtml-intrinsic-sizer" role="presentation" src="data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9JzExNS4zMTI1JyB3aWR0aD0nNDUwJyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHZlcnNpb249JzEuMScvPg=="></i-amphtml-sizer><noscript><img src="https://i0.wp.com/math.ucr.edu/home/baez/ecological/el_nino/nino_3.4_region.gif" alt="" width="450" height="115.3125" class=""></noscript></amp-anim><br> </a></div>
<p>You can download the file from here:</p>
<p>• <a href="https://github.com/johncarlosbaez/el-nino/blob/master/R/nino3.4-anoms.txt"><code>nino3.4-anoms.txt</code></a></p>
<p>This is a copy of the <a href="http://www.cpc.noaa.gov/products/analysis_monitoring/ensostuff/detrend.nino34.ascii.txt">monthly Niño 3.4 index</a> from the US National Weather Service, which I discussed last time. It has monthly Niño 3.4 data in the column called <code>ANOM</code>.</p>
<p>Put this file in your working directory.</p>
<h3>Predicting El Niños</h3>
<p>Now for the cool part. <a href="https://johncarlosbaez.wordpress.com/2014/07/01/el-nino-project-part-3/">Last time</a> I explained the `average link strength’, which Ludescher <i>et al</i> use to predict El Niños. Now you’ll compute it.</p>
<p>You’ve got <code>Pacific-1948-1980.txt</code> and <code>nino3.4-anoms.txt</code> in your working directory. Download this R script written by Graham Jones, and run it:</p>
<p>• <a href="https://github.com/johncarlosbaez/el-nino/blob/master/R/ludescher-replication.R"><code>ludescher-replication.R</code></a></p>
<p>It takes about 45 minutes on my laptop. It computes the average link strength <amp-img src="https://s0.wp.com/latex.php?latex=S&amp;bg=ffffff&amp;fg=333333&amp;s=0&amp;c=20201002" alt="S" class="latex amp-wp-enforced-sizes i-amphtml-layout-intrinsic i-amphtml-layout-size-defined" width="11" height="12" layout="intrinsic" i-amphtml-layout="intrinsic"><i-amphtml-sizer class="i-amphtml-sizer"><img alt="" aria-hidden="true" class="i-amphtml-intrinsic-sizer" role="presentation" src="data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9JzEyJyB3aWR0aD0nMTEnIHhtbG5zPSdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycgdmVyc2lvbj0nMS4xJy8+"></i-amphtml-sizer><noscript><img src="https://s0.wp.com/latex.php?latex=S&amp;bg=ffffff&amp;fg=333333&amp;s=0&amp;c=20201002" alt="S" class="latex" width="11" height="12"></noscript></amp-img> at ten-day intervals. Then it plots <amp-img src="https://s0.wp.com/latex.php?latex=S&amp;bg=ffffff&amp;fg=333333&amp;s=0&amp;c=20201002" alt="S" class="latex amp-wp-enforced-sizes i-amphtml-layout-intrinsic i-amphtml-layout-size-defined" width="11" height="12" layout="intrinsic" i-amphtml-layout="intrinsic"><i-amphtml-sizer class="i-amphtml-sizer"><img alt="" aria-hidden="true" class="i-amphtml-intrinsic-sizer" role="presentation" src="data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9JzEyJyB3aWR0aD0nMTEnIHhtbG5zPSdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycgdmVyc2lvbj0nMS4xJy8+"></i-amphtml-sizer><noscript><img src="https://s0.wp.com/latex.php?latex=S&amp;bg=ffffff&amp;fg=333333&amp;s=0&amp;c=20201002" alt="S" class="latex" width="11" height="12"></noscript></amp-img> in red and the Niño 3.4 index in blue, like this:</p>
<div align="center"><a href="http://math.ucr.edu/home/baez/ecological/el_nino/ludescher_replication.jpg"><br> <amp-img src="https://i2.wp.com/math.ucr.edu/home/baez/ecological/el_nino/ludescher_replication_small.jpg" alt="" width="450" height="213.07603686636" class="amp-wp-enforced-sizes i-amphtml-layout-intrinsic i-amphtml-layout-size-defined" layout="intrinsic" i-amphtml-layout="intrinsic"><i-amphtml-sizer class="i-amphtml-sizer"><img alt="" aria-hidden="true" class="i-amphtml-intrinsic-sizer" role="presentation" src="data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9JzIxMy4wNzYwMzY4NjYzNicgd2lkdGg9JzQ1MCcgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB2ZXJzaW9uPScxLjEnLz4="></i-amphtml-sizer><noscript><img src="https://i2.wp.com/math.ucr.edu/home/baez/ecological/el_nino/ludescher_replication_small.jpg" alt="" width="450" height="213.07603686636" class=""></noscript></amp-img></a></div>
<p>(Click to enlarge.) The shaded region is where the Niño 3.4 index is below 0.5°C. When the blue curve escapes this region and then stays above 0.5°C for at least 5 months, Ludescher <i>et al</i> say that there’s an El Niño.</p>
<p>The horizontal red line shows the threshold <amp-img src="https://s0.wp.com/latex.php?latex=%5Ctheta+%3D+2.82.&amp;bg=ffffff&amp;fg=333333&amp;s=0&amp;c=20201002" alt="\theta = 2.82." class="latex amp-wp-enforced-sizes i-amphtml-layout-intrinsic i-amphtml-layout-size-defined" width="63" height="12" layout="intrinsic" i-amphtml-layout="intrinsic"><i-amphtml-sizer class="i-amphtml-sizer"><img alt="" aria-hidden="true" class="i-amphtml-intrinsic-sizer" role="presentation" src="data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9JzEyJyB3aWR0aD0nNjMnIHhtbG5zPSdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycgdmVyc2lvbj0nMS4xJy8+"></i-amphtml-sizer><noscript><img src="https://s0.wp.com/latex.php?latex=%5Ctheta+%3D+2.82.&amp;bg=ffffff&amp;fg=333333&amp;s=0&amp;c=20201002" alt="\theta = 2.82." class="latex" width="63" height="12"></noscript></amp-img> When <amp-img src="https://s0.wp.com/latex.php?latex=S&amp;bg=ffffff&amp;fg=333333&amp;s=0&amp;c=20201002" alt="S" class="latex amp-wp-enforced-sizes i-amphtml-layout-intrinsic i-amphtml-layout-size-defined" width="11" height="12" layout="intrinsic" i-amphtml-layout="intrinsic"><i-amphtml-sizer class="i-amphtml-sizer"><img alt="" aria-hidden="true" class="i-amphtml-intrinsic-sizer" role="presentation" src="data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9JzEyJyB3aWR0aD0nMTEnIHhtbG5zPSdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycgdmVyc2lvbj0nMS4xJy8+"></i-amphtml-sizer><noscript><img src="https://s0.wp.com/latex.php?latex=S&amp;bg=ffffff&amp;fg=333333&amp;s=0&amp;c=20201002" alt="S" class="latex" width="11" height="12"></noscript></amp-img> exceeds this, and the Niño 3.4 index is not <i>already</i> over 0.5°C, Ludescher <i>et al</i> predict that there will be an El Niño in the next calendar year!</p>
<p>Our graph almost agrees with theirs:</p>
<div align="center"><a href="http://math.ucr.edu/home/baez/ecological/el_nino/ludescher_el_nino_cooperativity_2b.jpg"><br> <amp-img src="https://i0.wp.com/math.ucr.edu/home/baez/ecological/el_nino/ludescher_el_nino_cooperativity_2b.jpg" alt="" width="450" height="192.59510869565" class="amp-wp-enforced-sizes i-amphtml-layout-intrinsic i-amphtml-layout-size-defined" layout="intrinsic" i-amphtml-layout="intrinsic"><i-amphtml-sizer class="i-amphtml-sizer"><img alt="" aria-hidden="true" class="i-amphtml-intrinsic-sizer" role="presentation" src="data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9JzE5Mi41OTUxMDg2OTU2NScgd2lkdGg9JzQ1MCcgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB2ZXJzaW9uPScxLjEnLz4="></i-amphtml-sizer><noscript><img src="https://i0.wp.com/math.ucr.edu/home/baez/ecological/el_nino/ludescher_el_nino_cooperativity_2b.jpg" alt="" width="450" height="192.59510869565" class=""></noscript></amp-img></a></div>
<p>Here the green arrows show their successful predictions, dashed arrows show false alarms, and a little letter n appears next to each El Niño they failed to predict.</p>
<p>The graphs don’t match perfectly. For the blue curves, we could be using Niño 3.4 from different sources. Differences in the red curves are more interesting, since that’s where all the work is involved, and we’re starting with the same data. Besides actual bugs, which are always possible, I can think of various explanations. None of them are extremely interesting, so I’ll stick them in the last section!</p>
<p>If you want to get ahold of our output, you can do so here:</p>
<p>• <a href="https://github.com/johncarlosbaez/el-nino/blob/master/R/average-link-strength.txt"><code>average-link-strength.txt</code></a></p>
<p>This has the average link strength <amp-img src="https://s0.wp.com/latex.php?latex=S&amp;bg=ffffff&amp;fg=333333&amp;s=0&amp;c=20201002" alt="S" class="latex amp-wp-enforced-sizes i-amphtml-layout-intrinsic i-amphtml-layout-size-defined" width="11" height="12" layout="intrinsic" i-amphtml-layout="intrinsic"><i-amphtml-sizer class="i-amphtml-sizer"><img alt="" aria-hidden="true" class="i-amphtml-intrinsic-sizer" role="presentation" src="data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9JzEyJyB3aWR0aD0nMTEnIHhtbG5zPSdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycgdmVyc2lvbj0nMS4xJy8+"></i-amphtml-sizer><noscript><img src="https://s0.wp.com/latex.php?latex=S&amp;bg=ffffff&amp;fg=333333&amp;s=0&amp;c=20201002" alt="S" class="latex" width="11" height="12"></noscript></amp-img> at 10-day intervals, starting from day 730 and going until day 12040, where day 1 is the first of January 1948.</p>
<p>So, you don’t actually have to run all these programs to get our final result. However, these programs will help you tackle some programming challenges which I’ll list now!</p>
<h3>Programming challenges</h3>
<p>There are lots of variations on the Ludescher <i>et al</i> paper which we could explore. Here are a few easy ones to get you started. If you do any of these, or anything else, let me know!</p>
<p>I’ll start with a really easy one, and work on up.</p>
<p><b>Challenge 1.</b> Repeat the calculation with temperature data from 1980 to 2013. You’ll have to adjust two lines in <code>netcdf-convertor-ludescher.R</code>:</p>
<pre>firstyear &lt;- 1948
lastyear &lt;- 1980
</pre>
<p>should become</p>
<pre>firstyear &lt;- 1980
lastyear &lt;- 2013
</pre>
<p>or whatever range of years you want. You’ll also have to adjust names of years in <code>ludescher-replication.R</code>. Search the file for the string <code>19</code> and make the necessary changes. Ask me if you get stuck.</p>
<p><b>Challenge 2.</b> Repeat the calculation with temperature data on a 2.5° × 2.5° grid instead of the coarser 7.5° × 7.5° grid Ludescher <i>et al</i> use. You’ve got the data you need. Right now, the program <code>ludescher-replication.R</code> averages out the temperatures over little 3 × 3 squares. It starts with temperatures on a 27 × 69 grid and averages them out to obtain temperatures on the 9 × 23 grid shown here:</p>
<div align="center"><a href="http://math.ucr.edu/home/baez/ecological/el_nino/ludescher_el_nino_cooperativity_1.jpg"><br> <amp-img src="https://i2.wp.com/math.ucr.edu/home/baez/ecological/el_nino/ludescher_el_nino_cooperativity_1a.jpg" alt="" width="250" height="165.6378600823" class="amp-wp-enforced-sizes i-amphtml-layout-intrinsic i-amphtml-layout-size-defined" layout="intrinsic" i-amphtml-layout="intrinsic"><i-amphtml-sizer class="i-amphtml-sizer"><img alt="" aria-hidden="true" class="i-amphtml-intrinsic-sizer" role="presentation" src="data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9JzE2NS42Mzc4NjAwODIzJyB3aWR0aD0nMjUwJyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHZlcnNpb249JzEuMScvPg=="></i-amphtml-sizer><noscript><img src="https://i2.wp.com/math.ucr.edu/home/baez/ecological/el_nino/ludescher_el_nino_cooperativity_1a.jpg" alt="" width="250" height="165.6378600823" class=""></noscript></amp-img></a></div>
<p>Here’s where that happens:</p>
<pre># the data per day is reduced from e.g. 27x69 to 9x23. 

subsample.3x3 &lt;- function(vals) {
  stopifnot(dim(vals)[2] %% 3 == 0)
  stopifnot(dim(vals)[3] %% 3 == 0)
  n.sslats &lt;- dim(vals)[2]/3
  n.sslons &lt;- dim(vals)[3]/3
  ssvals &lt;- array(0, dim=c(dim(vals)[1], n.sslats, n.sslons))  
  for (d in 1:dim(vals)[1]) {
    for (slat in 1:n.sslats) {
      for (slon in 1:n.sslons) {
        ssvals[d, slat, slon] &lt;- mean(vals[d, (3*slat-2):(3*slat), (3*slon-2):(3*slon)])
      }
    }
  }
  ssvals
}
</pre>
<p>So, you need to eliminate this and change whatever else needs to be changed. What new value of the threshold <amp-img src="https://s0.wp.com/latex.php?latex=%5Ctheta&amp;bg=ffffff&amp;fg=333333&amp;s=0&amp;c=20201002" alt="\theta" class="latex amp-wp-enforced-sizes i-amphtml-layout-intrinsic i-amphtml-layout-size-defined" width="8" height="12" layout="intrinsic" i-amphtml-layout="intrinsic"><i-amphtml-sizer class="i-amphtml-sizer"><img alt="" aria-hidden="true" class="i-amphtml-intrinsic-sizer" role="presentation" src="data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9JzEyJyB3aWR0aD0nOCcgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB2ZXJzaW9uPScxLjEnLz4="></i-amphtml-sizer><noscript><img src="https://s0.wp.com/latex.php?latex=%5Ctheta&amp;bg=ffffff&amp;fg=333333&amp;s=0&amp;c=20201002" alt="\theta" class="latex" width="8" height="12"></noscript></amp-img> looks good for predicting El Niños now? Most importantly: <i>can you get better at predicting El El Niños this way?</i></p>
<p>The calculation may take a lot longer, since you’ve got 9 times as many grid points and you’re calculating correlations between pairs. So if this is too tough, you can go the other way: use a coarser grid and see how much that <i>degrades</i> your ability to predict El Niños.</p>
<p><b>Challenge 3.</b> Right now we average the link strength over all pairs <amp-img src="https://s0.wp.com/latex.php?latex=%28i%2Cj%29&amp;bg=ffffff&amp;fg=333333&amp;s=0&amp;c=20201002" alt="(i,j)" class="latex amp-wp-enforced-sizes i-amphtml-layout-intrinsic i-amphtml-layout-size-defined" width="31" height="17" layout="intrinsic" i-amphtml-layout="intrinsic"><i-amphtml-sizer class="i-amphtml-sizer"><img alt="" aria-hidden="true" class="i-amphtml-intrinsic-sizer" role="presentation" src="data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9JzE3JyB3aWR0aD0nMzEnIHhtbG5zPSdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycgdmVyc2lvbj0nMS4xJy8+"></i-amphtml-sizer><noscript><img src="https://s0.wp.com/latex.php?latex=%28i%2Cj%29&amp;bg=ffffff&amp;fg=333333&amp;s=0&amp;c=20201002" alt="(i,j)" class="latex" width="31" height="17"></noscript></amp-img> where <amp-img src="https://s0.wp.com/latex.php?latex=i&amp;bg=ffffff&amp;fg=333333&amp;s=0&amp;c=20201002" alt="i" class="latex amp-wp-enforced-sizes i-amphtml-layout-intrinsic i-amphtml-layout-size-defined" width="5" height="12" layout="intrinsic" i-amphtml-layout="intrinsic"><i-amphtml-sizer class="i-amphtml-sizer"><img alt="" aria-hidden="true" class="i-amphtml-intrinsic-sizer" role="presentation" src="data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9JzEyJyB3aWR0aD0nNScgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB2ZXJzaW9uPScxLjEnLz4="></i-amphtml-sizer><noscript><img src="https://s0.wp.com/latex.php?latex=i&amp;bg=ffffff&amp;fg=333333&amp;s=0&amp;c=20201002" alt="i" class="latex" width="5" height="12"></noscript></amp-img> is a node in the <b>El Niño basin</b> defined by Ludescher <i>et al</i> and <amp-img src="https://s0.wp.com/latex.php?latex=j&amp;bg=ffffff&amp;fg=333333&amp;s=0&amp;c=20201002" alt="j" class="latex amp-wp-enforced-sizes i-amphtml-layout-intrinsic i-amphtml-layout-size-defined" width="8" height="16" layout="intrinsic" i-amphtml-layout="intrinsic"><i-amphtml-sizer class="i-amphtml-sizer"><img alt="" aria-hidden="true" class="i-amphtml-intrinsic-sizer" role="presentation" src="data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9JzE2JyB3aWR0aD0nOCcgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB2ZXJzaW9uPScxLjEnLz4="></i-amphtml-sizer><noscript><img src="https://s0.wp.com/latex.php?latex=j&amp;bg=ffffff&amp;fg=333333&amp;s=0&amp;c=20201002" alt="j" class="latex" width="8" height="16"></noscript></amp-img> is a node outside this basin. The basin consists of the red dots here:</p>
<div align="center"><a href="http://math.ucr.edu/home/baez/ecological/el_nino/ludescher_el_nino_cooperativity_1.jpg"><br> <amp-img src="https://i2.wp.com/math.ucr.edu/home/baez/ecological/el_nino/ludescher_el_nino_cooperativity_1a.jpg" alt="" width="450" height="298.14814814815" class="amp-wp-enforced-sizes i-amphtml-layout-intrinsic i-amphtml-layout-size-defined" layout="intrinsic" i-amphtml-layout="intrinsic"><i-amphtml-sizer class="i-amphtml-sizer"><img alt="" aria-hidden="true" class="i-amphtml-intrinsic-sizer" role="presentation" src="data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9JzI5OC4xNDgxNDgxNDgxNScgd2lkdGg9JzQ1MCcgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB2ZXJzaW9uPScxLjEnLz4="></i-amphtml-sizer><noscript><img src="https://i2.wp.com/math.ucr.edu/home/baez/ecological/el_nino/ludescher_el_nino_cooperativity_1a.jpg" alt="" width="450" height="298.14814814815" class=""></noscript></amp-img></a></div>
<p>What happens if you change the definition of the El Niño basin? For example, can you drop those annoying two red dots that are south of the rest, without messing things up? <i>Can you get better results if you change the shape of the basin?</i></p>
<p>To study these questions you need to rewrite <code>ludescher-replication.R</code> a bit. Here’s where Graham defines the El Niño basin:</p>
<pre>ludescher.basin &lt;- function() {
  lats &lt;- c( 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6)
  lons &lt;- c(11,12,13,14,15,16,17,18,19,20,21,22,16,22)
  stopifnot(length(lats) == length(lons))
  list(lats=lats,lons=lons)
}
</pre>
<p>These are lists of latitude and longitude coordinates: (5,11), (5,12), (5,13), etc. A coordinate like (5,11) means the little circle that’s 5 down and 11 across in the grid on the above map. So, that’s the leftmost point in Ludescher’s El Niño basin. By changing these lists, you can change the definition of the El Niño basin. You’ll also have to change these lists if you tackle Challenge 2.</p>
<p>There’s a lot more you can do… the sky’s the limit! In the weeks to come, I’ll show you lots of things we’ve actually done.</p>
<h3>Annoying nuances</h3>
<p>Here are two reasons our average link strengths could differ from Ludescher’s.</p>
<p>Last time I mentioned that Ludescher <i>et al</i> claim to normalize their time-delayed cross-covariances in a sort of complicated way. I explained why I don’t think they could have actually used this method. In <code>ludescher-replication.R</code>, Graham used the simpler normalization described last time: namely, dividing by</p>
<p><amp-img src="https://s0.wp.com/latex.php?latex=%5Csqrt%7B%5Clangle+T_i%28t%29%5E2+%5Crangle+-+%5Clangle+T_i%28t%29+%5Crangle%5E2%7D+%5C%3B+%5Csqrt%7B%5Clangle+T_j%28t-%5Ctau%29%5E2+%5Crangle+-+%5Clangle+T_j%28t-%5Ctau%29+%5Crangle%5E2%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0&amp;c=20201002" alt="\sqrt{\langle T_i(t)^2 \rangle - \langle T_i(t) \rangle^2} \; \sqrt{\langle T_j(t-\tau)^2 \rangle - \langle T_j(t-\tau) \rangle^2}" class="latex amp-wp-enforced-sizes i-amphtml-layout-intrinsic i-amphtml-layout-size-defined" width="348" height="21" layout="intrinsic" i-amphtml-layout="intrinsic"><i-amphtml-sizer class="i-amphtml-sizer"><img alt="" aria-hidden="true" class="i-amphtml-intrinsic-sizer" role="presentation" src="data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9JzIxJyB3aWR0aD0nMzQ4JyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHZlcnNpb249JzEuMScvPg=="></i-amphtml-sizer><noscript><img src="https://s0.wp.com/latex.php?latex=%5Csqrt%7B%5Clangle+T_i%28t%29%5E2+%5Crangle+-+%5Clangle+T_i%28t%29+%5Crangle%5E2%7D+%5C%3B+%5Csqrt%7B%5Clangle+T_j%28t-%5Ctau%29%5E2+%5Crangle+-+%5Clangle+T_j%28t-%5Ctau%29+%5Crangle%5E2%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0&amp;c=20201002" alt="\sqrt{\langle T_i(t)^2 \rangle - \langle T_i(t) \rangle^2} \; \sqrt{\langle T_j(t-\tau)^2 \rangle - \langle T_j(t-\tau) \rangle^2}" class="latex" width="348" height="21"></noscript></amp-img></p>
<p>instead of</p>
<p><amp-img src="https://s0.wp.com/latex.php?latex=%5Csqrt%7B+%5Clangle+%28T_i%28t%29+-+%5Clangle+T_i%28t%29%5Crangle%29%5E2+%5Crangle%7D+%5C%3B+%5Csqrt%7B+%5Clangle+%28T_j%28t-%5Ctau%29+-+%5Clangle+T_j%28t-%5Ctau%29%5Crangle%29%5E2+%5Crangle%7D+&amp;bg=ffffff&amp;fg=333333&amp;s=0&amp;c=20201002" alt="\sqrt{ \langle (T_i(t) - \langle T_i(t)\rangle)^2 \rangle} \; \sqrt{ \langle (T_j(t-\tau) - \langle T_j(t-\tau)\rangle)^2 \rangle} " class="latex amp-wp-enforced-sizes i-amphtml-layout-intrinsic i-amphtml-layout-size-defined" width="361" height="21" layout="intrinsic" i-amphtml-layout="intrinsic"><i-amphtml-sizer class="i-amphtml-sizer"><img alt="" aria-hidden="true" class="i-amphtml-intrinsic-sizer" role="presentation" src="data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9JzIxJyB3aWR0aD0nMzYxJyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHZlcnNpb249JzEuMScvPg=="></i-amphtml-sizer><noscript><img src="https://s0.wp.com/latex.php?latex=%5Csqrt%7B+%5Clangle+%28T_i%28t%29+-+%5Clangle+T_i%28t%29%5Crangle%29%5E2+%5Crangle%7D+%5C%3B+%5Csqrt%7B+%5Clangle+%28T_j%28t-%5Ctau%29+-+%5Clangle+T_j%28t-%5Ctau%29%5Crangle%29%5E2+%5Crangle%7D+&amp;bg=ffffff&amp;fg=333333&amp;s=0&amp;c=20201002" alt="\sqrt{ \langle (T_i(t) - \langle T_i(t)\rangle)^2 \rangle} \; \sqrt{ \langle (T_j(t-\tau) - \langle T_j(t-\tau)\rangle)^2 \rangle} " class="latex" width="361" height="21"></noscript></amp-img></p>
<p>Since we don’t really know what Ludescher <i>et al</i> did, they might have done something else.</p>
<p>We might also have used a different ‘subsampling’ procedure. That’s a name for how we get from the temperature data on a 9 × 69 grid to temperatures on a 3 × 23 grid. While the original data files give temperatures named after grid points, each is really an area-averaged temperature for a 2.5° × 2.5° square. Is this square <i>centered</i> at the grid point, or is the square having that grid point as its north-west corner, or what? I don’t know.</p>
<p>This data is on a grid where the coordinates are the number of steps of 2.5 degrees, counting from 1. So, for latitude, 1 means the North Pole, 73 means the South Pole. For longitude, 1 means the prime meridian, 37 means 90° east, 73 means 180° east, 109 means 270°E or 90°W, and 144 means 2.5° west. It’s an annoying system, as far as I’m concerned.</p>
<p>In <code>ludescher-replication.R</code> we use this range of coordinates:</p>
<pre>lat.range &lt;- 24:50
lon.range &lt;- 48:116 
</pre>
<p>That’s why your file <code>Pacific-1948-1980.txt</code> has locations starting with S024E48 and ending with S248E116. Maybe Ludescher <i>et al</i> used a slightly different range or subsampling procedure!</p>
<p>There are probably lots of other nuances I haven’t noticed. Can you think of some?</p>
<div id="jp-post-flair" class="sharedaddy">
<nav class="jp-relatedposts-i2" data-layout="grid"><h3 class="jp-relatedposts-headline"><em>Related</em></h3><div class="jp-related-posts-i2__row" data-post-count="3"><ul id="related-posts-item-614fb7b7ad89b" aria-labelledby="related-posts-item-614fb7b7ad89b-label" class="jp-related-posts-i2__post" role="menuitem"><li class="jp-related-posts-i2__post-link"><a id="related-posts-item-614fb7b7ad89b-label" href="https://johncarlosbaez.wordpress.com/2014/07/01/el-nino-project-part-3/">El Niño Project (Part 3)</a></li><li class="jp-related-posts-i2__post-date">1 July, 2014</li><li class="jp-related-posts-i2__post-context">In "climate"</li></ul><ul id="related-posts-item-614fb7b7ad8be" aria-labelledby="related-posts-item-614fb7b7ad8be-label" class="jp-related-posts-i2__post" role="menuitem"><li class="jp-related-posts-i2__post-link"><a id="related-posts-item-614fb7b7ad8be-label" href="https://johncarlosbaez.wordpress.com/2014/11/29/climate-networks/">Networks in Climate Science</a></li><li class="jp-related-posts-i2__post-date">29 November, 2014</li><li class="jp-related-posts-i2__post-context">In "climate"</li></ul><ul id="related-posts-item-614fb7b7ad8d8" aria-labelledby="related-posts-item-614fb7b7ad8d8-label" class="jp-related-posts-i2__post" role="menuitem"><li class="jp-related-posts-i2__post-link"><a id="related-posts-item-614fb7b7ad8d8-label" href="https://johncarlosbaez.wordpress.com/2014/08/18/el-nino-project-part-7/">El Niño Project (Part 7)</a></li><li class="jp-related-posts-i2__post-date">18 August, 2014</li><li class="jp-related-posts-i2__post-context">In "climate"</li></ul></div></nav></div>	</div>

	<footer class="amp-wp-article-footer">
			<div class="amp-wp-meta amp-wp-tax-category">
		Categories: <a href="https://johncarlosbaez.wordpress.com/category/climate/" rel="category tag">climate</a>	</div>

		<div class="amp-wp-meta amp-wp-comments-link">
		<a href="https://johncarlosbaez.wordpress.com/2014/07/08/el-nino-project-part-4/#comments">
			Leave a Comment		</a>
	</div>
	</footer>
</article>

<footer class="amp-wp-footer">
	<div>
		<h2>Azimuth</h2>
		<a href="#top" class="back-to-top">Back to top</a>
	</div>
</footer>


	<amp-pixel src="https://pixel.wp.com/b.gif?rand=RANDOM&amp;host=johncarlosbaez.wordpress.com&amp;ref=DOCUMENT_REFERRER&amp;amp=1&amp;blog=12777403&amp;v=wpcom&amp;tz=0&amp;user_id=0&amp;post=18316&amp;subd=johncarlosbaez" class="i-amphtml-layout-fixed i-amphtml-layout-size-defined" style="width:1px;height:1px;" i-amphtml-layout="fixed"></amp-pixel>
	<amp-pixel src="https://pixel.wp.com/b.gif?rand=RANDOM&amp;v=wpcom-no-pv&amp;crypt=UE40eW5QN0p8M2Y%2FRE1TaVhzUzFMbjdWNHpwZGhTayxPSUFCMGNrd29%2BSmw0TDhnZmRTK0hlRi9QSGh6bi9GXVhBJWIlZlR5U1JMLU8%2FMkNtblkvY1d6eVImTEouL2UleTBRZmlNdkp0aWJaNFJhPS0uTVpHa1hIc25EbVJyQmw%2FSkZ%2BQ3lLcjU%2FNDBvQTY5VFcmLHB0U3J1elBvZCZiTkEzXXlsLi1PU25PbltLcyZONi1Lay1ia3RtU0ZEcmxjdDdab2FqP3lnNTdjREcvfi93LG1GJS5WSk1jVm9kc2FWLUphd2lmT115NjhLb3VQJU9t" class="i-amphtml-layout-fixed i-amphtml-layout-size-defined" style="width:1px;height:1px;" i-amphtml-layout="fixed"></amp-pixel>
	


</body></html>
