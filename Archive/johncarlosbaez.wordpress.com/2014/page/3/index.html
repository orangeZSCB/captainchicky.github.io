<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>2014 | Azimuth | Page 3</title>
<link rel="profile" href="http://gmpg.org/xfn/11" />
<link rel="pingback" href="https://johncarlosbaez.wordpress.com/xmlrpc.php" />
<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s1.wp.com' />
<link rel='dns-prefetch' href='//s2.wp.com' />
<link rel='dns-prefetch' href='//s0.wp.com' />
<link rel='dns-prefetch' href='//s.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Azimuth &raquo; Feed" href="https://johncarlosbaez.wordpress.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Azimuth &raquo; Comments Feed" href="https://johncarlosbaez.wordpress.com/comments/feed/" />
	<script type="text/javascript">
		/* <![CDATA[ */
		function addLoadEvent(func) {
			var oldonload = window.onload;
			if (typeof window.onload != 'function') {
				window.onload = func;
			} else {
				window.onload = function () {
					oldonload();
					func();
				}
			}
		}
		/* ]]> */
	</script>
			<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/s1.wp.com\/wp-includes\/js\/wp-emoji-release.min.js?m=1625065786h&ver=5.8.1"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([10084,65039,8205,55357,56613],[10084,65039,8203,55357,56613])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='all-css-0-1' href='https://s2.wp.com/_static/??-eJyNkttSAyEMhl9IlqVOdbxwfBYOEVOBZSBYeXuz1e6sVrveMDl9yU9AHrOwUyJIJGMTOTSPqUpMz5iQ+mIMttYbuVFMLxChytyMPJXFTBfcGfKNXQPFc6aAfFNq2A9KmobBSRMm+yoCmqJLl5V6gKURJhua4zGHKiM41BB46qxo5eSgOxQRwGvbh4hpG+fc2v8G/S3+pJSbAWU9S9Z9aiR8QfdD9r9bFE2YfN3A7fSF7QY18t4cVlqC4nd29WTzzjkes768+BXsiM4DMV7PtiB4v45kHiOMyQVqFXxGbFF8/pSZe4qP6u5W3T/sx3F3+ACgX/YH?cssminify=yes' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify {
	text-align:justify;
}
</style>
<style id='global-styles-inline-css'>
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--normal: 16px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--huge: 42px;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-normal-font-size{font-size: var(--wp--preset--font-size--normal) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-huge-font-size{font-size: var(--wp--preset--font-size--huge) !important;}
</style>
<link rel='stylesheet' id='all-css-2-1' href='https://s0.wp.com/_static/??-eJx9i0EKgCAQAD+ULYJRHaK3qJhY666o0fezW126zcAMGNR09LaUDq4kLFN1VCGeIuHpAxXwjgWy1TUwfURsqEP+W7MzyL6hh1a99JnWuEg1zEpNo1T7DZLtMYQ=?cssminify=yes' type='text/css' media='all' />
<link rel='stylesheet' id='print-css-3-1' href='https://s2.wp.com/wp-content/mu-plugins/global-print/global-print.css?m=1465851035h&cssminify=yes' type='text/css' media='print' />
<style id='jetpack-global-styles-frontend-style-inline-css'>
:root { --font-headings: unset; --font-base: unset; --font-headings-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif; --font-base-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif;}
</style>
<link rel='stylesheet' id='all-css-6-1' href='https://s0.wp.com/wp-content/themes/h4/global.css?m=1420737423h&cssminify=yes' type='text/css' media='all' />
<script id='wpcom-actionbar-placeholder-js-extra'>
var actionbardata = {"siteID":"12777403","siteName":"Azimuth","siteURL":"http:\/\/johncarlosbaez.wordpress.com","siteHost":"johncarlosbaez.wordpress.com","icon":"<img alt='' src='https:\/\/s2.wp.com\/i\/logo\/wpcom-gray-white.png' class='avatar avatar-50' height='50' width='50' \/>","canManageOptions":"","canCustomizeSite":"","isFollowing":"","themeSlug":"pub\/contempt","signupURL":"https:\/\/wordpress.com\/start\/","loginURL":"https:\/\/wordpress.com\/log-in?redirect_to=https%3A%2F%2Fjohncarlosbaez.wordpress.com%2F2014%2F08%2F18%2Fel-nino-project-part-7%2F&signup_flow=account","themeURL":"","xhrURL":"https:\/\/johncarlosbaez.wordpress.com\/wp-admin\/admin-ajax.php","nonce":"e6f6fdfb46","isSingular":"","isFolded":"","isLoggedIn":"","isMobile":"","subscribeNonce":"<input type=\"hidden\" id=\"_wpnonce\" name=\"_wpnonce\" value=\"ffcb185558\" \/>","referer":"https:\/\/johncarlosbaez.wordpress.com\/2014\/page\/3\/","canFollow":"1","feedID":"62242","statusMessage":"","subsEmailDefault":"instantly","customizeLink":"https:\/\/johncarlosbaez.wordpress.com\/wp-admin\/customize.php?url=https%3A%2F%2Fjohncarlosbaez.wordpress.com%2F2014%2Fpage%2F3%2F","i18n":{"view":"View site","follow":"Follow","following":"Following","edit":"Edit","login":"Log in","signup":"Sign up","customize":"Customize","report":"Report this content","themeInfo":"Get theme: Contempt","shortlink":"Copy shortlink","copied":"Copied","followedText":"New posts from this site will now appear in your <a href=\"https:\/\/wordpress.com\/read\">Reader<\/a>","foldBar":"Collapse this bar","unfoldBar":"Expand this bar","editSubs":"Manage subscriptions","viewReader":"View site in Reader","viewReadPost":"View post in Reader","subscribe":"Sign me up","enterEmail":"Enter your email address","followers":"Join 5,228 other followers","alreadyUser":"Already have a WordPress.com account? <a href=\"https:\/\/wordpress.com\/log-in?redirect_to=https%3A%2F%2Fjohncarlosbaez.wordpress.com%2F2014%2F08%2F18%2Fel-nino-project-part-7%2F&signup_flow=account\">Log in now.<\/a>","stats":"Stats","notifyNewPosts":"Notify me of new posts","notifyNewPostsDetails":"Receive web and mobile notifications for new posts from this site.","emailNewPosts":"Email me new posts","emailNewPostsDetails":"You can customize your notification settings further <a href=\"https:\/\/wordpress.com\/following\/manage?s=johncarlosbaez.wordpress.com\">here<\/a>.","emailNewComments":"Email me new comments","instantly":"Instantly","daily":"Daily","weekly":"Weekly"}};
</script>
<script crossorigin='anonymous' type='text/javascript' src='https://s2.wp.com/_static/??-eJyFykEKwkAMQNELmQ4qtboQz1LbWDJMknGSQXt7K9SFILj6i//CI8Og4igeooWs5oxm/YRNtE34vqxXSgjVsCxAHEhu+sOV5JCLPufPIxlSHdHeM94rlnlNwyR/ETBNpXdc8YXP28OuOx3brt3HF3swRvU='></script>
<script type='text/javascript'>
	window.addEventListener( 'DOMContentLoaded', function() {
		rltInitialize( {"token":null,"iframeOrigins":["https:\/\/widgets.wp.com"]} );
	} );
</script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://johncarlosbaez.wordpress.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://s1.wp.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress.com" />

<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="website" />
<meta property="og:title" content="2014 &#8211; Page 3 &#8211; Azimuth" />
<meta property="og:site_name" content="Azimuth" />
<meta property="og:image" content="https://s0.wp.com/i/blank.jpg" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:site" content="@wordpressdotcom" />
<meta property="fb:app_id" content="249643311490" />

<!-- End Jetpack Open Graph Tags -->
<link rel="shortcut icon" type="image/x-icon" href="https://s1.wp.com/i/favicon.ico" sizes="16x16 24x24 32x32 48x48" />
<link rel="icon" type="image/x-icon" href="https://s1.wp.com/i/favicon.ico" sizes="16x16 24x24 32x32 48x48" />
<link rel="apple-touch-icon" href="https://s2.wp.com/i/webclip.png" />
<link rel='openid.server' href='https://johncarlosbaez.wordpress.com/?openidserver=1' />
<link rel='openid.delegate' href='https://johncarlosbaez.wordpress.com/' />
<link rel="search" type="application/opensearchdescription+xml" href="https://johncarlosbaez.wordpress.com/osd.xml" title="Azimuth" />
<link rel="search" type="application/opensearchdescription+xml" href="https://s1.wp.com/opensearch.xml" title="WordPress.com" />
<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>		<style type="text/css">
			.recentcomments a {
				display: inline !important;
				padding: 0 !important;
				margin: 0 !important;
			}

			table.recentcommentsavatartop img.avatar, table.recentcommentsavatarend img.avatar {
				border: 0px;
				margin: 0;
			}

			table.recentcommentsavatartop a, table.recentcommentsavatarend a {
				border: 0px !important;
				background-color: transparent !important;
			}

			td.recentcommentsavatarend, td.recentcommentsavatartop {
				padding: 0px 0px 1px 0px;
				margin: 0px;
			}

			td.recentcommentstextend {
				border: none !important;
				padding: 0px 0px 2px 10px;
			}

			.rtl td.recentcommentstextend {
				padding: 0px 10px 2px 0px;
			}

			td.recentcommentstexttop {
				border: none;
				padding: 0px 0px 0px 10px;
			}

			.rtl td.recentcommentstexttop {
				padding: 0px 10px 0px 0px;
			}
		</style>
		<meta name="application-name" content="Azimuth" /><meta name="msapplication-window" content="width=device-width;height=device-height" /><meta name="msapplication-task" content="name=Subscribe;action-uri=https://johncarlosbaez.wordpress.com/feed/;icon-uri=https://s1.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=Sign up for a free blog;action-uri=http://wordpress.com/signup/;icon-uri=https://s1.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=WordPress.com Support;action-uri=http://support.wordpress.com/;icon-uri=https://s1.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=WordPress.com Forums;action-uri=http://forums.wordpress.com/;icon-uri=https://s1.wp.com/i/favicon.ico" /><meta name="description" content="10 posts published by John Baez in the year 2014" />
<style type="text/css">
#headerimg{
	background: url(https://johncarlosbaez.files.wordpress.com/2010/08/azimuth_header.jpg) no-repeat;
}
#header h1 a, .description {
	color:#E5F2E9;
}
</style>
<!-- There is no amphtml version available for this URL. -->		<link rel="stylesheet" id="custom-css-css" type="text/css" href="https://s0.wp.com/?custom-css=1&#038;csblog=RBZ9&#038;cscache=6&#038;csrev=7" />
		</head>
<body class="archive date paged paged-3 date-paged-3 customizer-styles-applied highlander-enabled highlander-light">

<div id="page">

<div id="header">
	<div id="headerimg" onclick="location.href='https://johncarlosbaez.wordpress.com';" style="cursor: pointer;">
		<h1><a href="https://johncarlosbaez.wordpress.com/">Azimuth</a></h1>
		<div class="description"></div>
	</div>
</div>

<ul id="pagebar" class="menu pagebar"><li ><a href="https://johncarlosbaez.wordpress.com/">Home</a></li><li class="page_item page-item-2"><a href="https://johncarlosbaez.wordpress.com/about/">About</a></li>
</ul>

<div id="grad" style="height: 65px; width: 100%; background: url(https://s2.wp.com/wp-content/themes/pub/contempt/images/blue_flower/topgrad.jpg);">&nbsp;</div>

	<div id="content">

	
		
			<div class="post-18465 post type-post status-publish format-standard hentry category-climate" id="post-18465">
				<h2><a href="https://johncarlosbaez.wordpress.com/2014/08/18/el-nino-project-part-7/" rel="bookmark">El Niño Project (Part&nbsp;7)</a></h2>
				<small>18 August, 2014</small><br />


				<div class="entry">
					<p>So, we&#8217;ve seen that Ludescher <i>et al</i> have a way to predict El Niños. But there&#8217;s something a bit funny: their definition of El Niño is not the standard one!</p>
<p>Precisely defining a complicated climate phenomenon like El Niño is a tricky business. Lots of different things tend to happen when an El Niño occurs. In 1997-1998, we saw these:</p>
<div align="center"><a href="http://www.shrimpnews.com/FreeReportsFolder/WeatherFolder/ElNino.html#Monster"></p>
<p></a><a href="http://www.shrimpnews.com/FreeReportsFolder/WeatherFolder/ElNino.html#Monster"><br />
<img src="https://i2.wp.com/math.ucr.edu/home/baez/ecological/el_nino/ElNinoMap1998.jpg" alt="" width="445" /></a></div>
<p>But what if just <i>some</i> of these things happen? Do we still have an El Niño or not? Is there a right answer to this question, or is it partially a matter of taste?</p>
<p>A related puzzle: is El Niño a single phenomenon, or several? Could there be several <i>kinds</i> of El Niño? Some people say there are.</p>
<p>Sometime I&#8217;ll have to talk about this. But today let&#8217;s start with the basics: the standard definition of El Niño. Let&#8217;s see how this differs from Ludescher <i>et al&#8217;</i>s definition.</p>
<h3>The standard definition</h3>
<p>The most standard definitions use the <b>Oceanic Niño Index</b> or <b>ONI</b>, which is the running 3-month mean of the Niño 3.4 index:</p>
<p>• An <b>El Niño</b> occurs when the ONI is over 0.5 °C for at least 5 months in a row.</p>
<p>• A <b>La Niña</b> occurs when the ONI is below -0.5 °C for at least 5 months in a row.</p>
<p>Of course I should also say exactly what the &#8216;Niño 3.4 index&#8217; is, and what the &#8216;running 3-month mean&#8217; is.</p>
<p>The <b>Niño 3.4 index</b> is the area-averaged, time-averaged sea surface temperature anomaly for a given month in the region 5°S-5°N and 170°-120°W:</p>
<div align="center"><a href="http://www.esrl.noaa.gov/psd/forecasts/sstlim/for1gl.html"><img src="https://i0.wp.com/math.ucr.edu/home/baez/ecological/el_nino/nino_3.4_region.gif" alt="" width="450" /></a></div>
<p>Here <b>anomaly</b> means that we take the area-averaged, time-averaged sea surface temperature for a given month &#8212; say February &#8212; and subtract off the historical average of this quantity &#8212; that is, for Februaries of other years on record.</p>
<p>If you&#8217;re clever you can already see room for subtleties and disagreements. For example, you can get sea surface temperatures in the Niño 3.4 region here:</p>
<p>• <a href="http://www.esrl.noaa.gov/psd/gcos_wgsp/Timeseries/Nino34/">Niño 3.4 data since 1870 calculated from the HadISST1</a>, NOAA. Discussed in N. A. Rayner <i>et al</i>, Global analyses of sea surface temperature, sea ice, and night marine air temperature since the late nineteenth century, <a href="http://onlinelibrary.wiley.com/doi/10.1029/2002JD002670/abstract"><i>J. Geophys. Res.</i></a> <b>108</b> (2003), 4407.</p>
<p>However, they don&#8217;t actually provide the Niño 3.4 index.</p>
<p>You can get the Niño 3.4 index here:</p>
<p>• <a href="http://www.cgd.ucar.edu/cas/catalog/climind/TNI_N34/">TNI (Trans-Niño Index) and N3.4 (Niño 3.4 Index)</a>, NCAR.</p>
<p>You can also get it from here:</p>
<p>• <a href="http://www.cpc.noaa.gov/products/analysis_monitoring/ensostuff/ONI_change.shtml">Monthly Niño 3.4 index</a>, Climate Prediction Center, National Weather Service.</p>
<p>The actual temperatures in Celsius on the two websites are quite close — but the anomalies are rather different, because the second one &#8216;subtracts off the historical average&#8217; in a way that takes global warming into account. For example, to compute the Niño 3.4 index in June 1952, instead of taking the average temperature that month and subtracting off the average temperature for <i>all</i> Junes on record, they subtract off the average for Junes in the period 1936-1965. Averages for different periods are shown here:</p>
<div align="center"><a href="http://www.cpc.ncep.noaa.gov/products/analysis_monitoring/ensostuff/ONI_change.shtml"><img src="https://i0.wp.com/math.ucr.edu/home/baez/ecological/el_nino/30yrbaseperiods_Nino34.png" alt="" width="450" /></a></div>
<p>You can see how these curves move up over time: that&#8217;s global warming! It&#8217;s interesting that they go up fastest during the cold part of the year. It&#8217;s also interesting to see how gentle the seasons are in this part of the world. In the old days, the average monthly temperatures ranged from 26.2 °C in the winter to 27.5 °C in the summer — a mere 1.3 °C fluctuation.</p>
<p>Finally, to compute the ONI in a given month, we take the average of the Niño 3.4 index in that month, the month before, and the month after. This definition of <b>running 3-month mean</b> has a funny feature: we can&#8217;t know the ONI for this month until <i>next</i> month!</p>
<p>You can get a table of the ONI here:</p>
<p>• <a href="http://www.cpc.noaa.gov/products/analysis_monitoring/ensostuff/ensoyears.shtml">Cold and warm episodes by season</a>, Climate Prediction Center, National Weather Service.</p>
<p>It&#8217;s not particularly computer-readable.</p>
<h3>Ludescher <i>et al</i></h3>
<p>Now let&#8217;s compare Ludescher <i>et al</i>. They say there&#8217;s an El Niño when the Niño 3.4 index is over 0.5°C for at least 5 months in a row. By not using the ONI — by using the Niño 3.4 index instead of its 3-month running mean — they could be counting some short &#8216;spikes&#8217; in the Niño 3.4 index as El Niños, that wouldn&#8217;t count as El Niños by the usual definition.</p>
<p>I haven&#8217;t carefully checked to see how much changing the definition would affect the success rate of their predictions. To be fair, we should also let them change the value of their parameter θ, which is tuned to be good for predicting El Niños in their setup. But we can see that there could be some &#8216;spike El Niños&#8217; in this graph of theirs, that might go away with a different definition. These are places where the red line goes over the horizontal line for more than 5 months, but no more:</p>
<div align="center"><a href="http://www.pnas.org/content/early/2013/06/26/1309353110.full.pdf+html"><br />
<img src="https://i1.wp.com/math.ucr.edu/home/baez/ecological/el_nino/ludescher_el_nino_cooperativity_2a.jpg" alt="" width="450" /><br />
</a></div>
<p>Let&#8217;s see look at the spike around 1975. See that green arrow at the beginning of 1975? That means Ludescher <i>et al</i> are claiming to successfully predict an El Niño sometime the next calendar year. We can zoom in for a better look:</p>
<div align="center"><a href="http://www.pnas.org/content/early/2013/06/26/1309353110.full.pdf+html"><br />
<img src="https://i0.wp.com/math.ucr.edu/home/baez/ecological/el_nino/ludescher_el_nino_1975-1980.jpg" alt="" width="450" /><br />
</a></div>
<p>The tiny blue bumps are where the Niño 3.4 index exceeds 0.5.</p>
<p>Let&#8217;s compare the ONI as computed by the National Weather Service, month by month, with El Niños in red and La Niñas in blue:</p>
<p>1975: <span style="color:blue;">0.5, -0.5, -0.6, -0.7, -0.8, -1.0, -1.1, -1.2, -1.4, -1.5, -1.6, -1.7</span></p>
<p>1976: <span style="color:blue;"> -1.5, -1.1, -0.7, -0.5,</span> -0.3, -0.1, 0.2, 0.4, <span style="color:red;">0.6, 0.7, 0.8, 0.8</span></p>
<p>1977: <span style="color:red;"> 0.6, 0.6,</span> 0.3, 0.3, 0.3, 0.4, 0.4, 0.4, <span style="color:red;">0.5, 0.7, 0.8, 0.8</span></p>
<p>1978: <span style="color:red;">0.7, 0.5,</span> 0.1, -0.2, -0.3, -0.3, -0.3, -0.4, -0.4, -0.3, -0.1, -0.1</p>
<p>So indeed an El Niño started in September 1976. The ONI only stayed above 0.5 for 6 months, but that&#8217;s enough. Ludescher and company luck out!</p>
<p>Just for fun, let&#8217;s look at the National Weather service Niño 3.4 index to see what that&#8217;s like:</p>
<p>1975: -0.33, -0.48, -0.72, -0.54, -0.68, -1.17, -1.07, -1.19, -1.36, -1.69 -1.45, -1.76</p>
<p>1976: -1.78, -1.10, -0.55, -0.53, -0.33, -0.10, 0.20, 0.39, 0.49, 0.88, 0.85, 0.63</p>
<p>So, this exceeded 0.5 in October 1976. That&#8217;s when Ludescher <i>et al</i> would say the El Niño starts, if they used the National Weather Service data.</p>
<p>Let&#8217;s also compare the NCAR Niño 3.4 index:</p>
<p>1975: -0.698, -0.592, -0.579, -0.801, -1.025, -1.205, -1.435, -1.620, -1.699 -1.855, -2.041, -1.960</p>
<p>1976: -1.708, -1.407, -1.026, -0.477, -0.095, 0.167, 0.465, 0.805, 1.039, 1.137, 1.290, 1.253</p>
<p>It&#8217;s pretty different! But it also gives an El Niño in 1976 according to Ludescher <i>et al&#8217;</i> definition: the Niño 3.4 index exceeds 0.5 starting in August 1976.</p>
<h3>For further study</h3>
<p>This time we didn&#8217;t get into the interesting question of <i>why</i> one definition of El Niño is better than another. For that, try:</p>
<p>• Kevin E. Trenberth, <a href="http://www.cgd.ucar.edu/staff/trenbert/trenberth.papers/defnBAMS.pdf">The definition of El Niño</a>, <i>Bulletin of the American Meteorological Society</i> <b>78</b> (1997), 2771–2777.</p>
<p>There could also be fundamentally different <i>kinds</i> of El Niño. For example, besides the usual sort where high sea surface temperatures are centered in the Niño 3.4 region, there could be another kind centered farther west near the International Date Line. This is called the <b>dateline El Niño</b> or <b>El Niño Modoki</b>. For more, try this:</p>
<p>• Nathaniel C. Johnson, <a href="http://iprc.soest.hawaii.edu/users/natj/papers/ENSO_flavors_ms_revised.pdf">How many ENSO flavors can we distinguish?</a>, <i>Journal of Climate</i> <b>26</b> (2013), 4816-4827.</p>
<p>which has lots of references to earlier work. Here, to whet your appetite, is his picture showing the 9 most common patterns of sea surface temperature anomalies in the Pacific:</p>
<div align="center"><a href="http://math.ucr.edu/home/baez/ecological/el_nino/johnson_el_nino_flavors.jpg"><img src="https://i0.wp.com/math.ucr.edu/home/baez/ecological/el_nino/johnson_el_nino_flavors.jpg" alt="" width="450" /></a></div>
<p>At the bottom of each is a percentage showing how frequently that pattern has occurred from 1950 to 2011. To get these pictures Johnson used something called a &#8216;self-organizing map analysis&#8217; &#8211; a fairly new sort of cluster analysis done using neural networks. This is the sort of thing I hope we get into as our project progresses!</p>
<h3> The series so far </h3>
<p>Just in case you want to get to old articles, here&#8217;s the story so far:</p>
<p>&bull; <a href="https://johncarlosbaez.wordpress.com/2014/06/20/el-nino-project-part-1/">El Niño project (part 1)</a>: basic introduction to El Niño and our project here.</p>
<p>&bull; <a href="https://johncarlosbaez.wordpress.com/2014/06/24/el-nino-project-part-2/">El Niño project (part 2)</a>: introduction to the physics of El Niño.</p>
<p>&bull; <a href="https://johncarlosbaez.wordpress.com/2014/07/01/el-nino-project-part-3/">El Niño project (part 3)</a>: summary of the work of Ludescher <i>et al</i>.</p>
<p>&bull; <a href="https://johncarlosbaez.wordpress.com/2014/07/08/el-nino-project-part-4/">El Niño project (part 4)</a>: how Graham Jones replicated the work by Ludescher <i>et al</i>, using software written in R.</p>
<p>&bull; <a href="https://johncarlosbaez.wordpress.com/2014/07/12/el-nino-project-part-5/">El Niño project (part 5)</a>: how to download R and use it to get files of climate data.</p>
<p>&bull; <a href="https://johncarlosbaez.wordpress.com/2014/07/23/el-nino-project-part-6/">El Niño project (part 6)</a>: Steve Wenner&#8217;s statistical analysis of the work of Ludescher <i>et al</i>.</p>
<p>&bull; <a href="https://johncarlosbaez.wordpress.com/2014/08/18/el-nino-project-part-7/">El Niño project (part 7)</a>: the definition of El Ni&ntilde;o.</p>
<p>&bull; <a href="https://johncarlosbaez.wordpress.com/2014/10/14/el-nino-project-part-8/">El Niño project (part 8)</a>: Berezin <i>et al</i> on the stability of climate networks.</p>
									</div>

				<p class="postmetadata">
				<img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/speech_bubble.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2014/08/18/el-nino-project-part-7/#comments">9 Comments</a>				| <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/documents.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/category/climate/" rel="category tag">climate</a>								 | <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/permalink.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2014/08/18/el-nino-project-part-7/" rel="bookmark" title="Permanent Link to El Niño Project (Part&nbsp;7)">Permalink</a>
<br /><img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/figure_ver1.gif" alt="" /> Posted by John Baez				</p>
			</div>
			<hr />
		
			<div class="post-18438 post type-post status-publish format-standard hentry category-climate category-mathematics category-probability" id="post-18438">
				<h2><a href="https://johncarlosbaez.wordpress.com/2014/08/01/exploring-climate-data-part-1/" rel="bookmark">Exploring Climate Data (Part&nbsp;1)</a></h2>
				<small>1 August, 2014</small><br />


				<div class="entry">
					<p><i>joint with <b>Dara O Shayda</b></i></p>
<p>Emboldened by our <a href="http://www.azimuthproject.org/azimuth/show/Experiments+in+El+Ni%C3%B1o+analysis+and+prediction+">experiments in El Ni&ntilde;o analysis and prediction</a>, people in the <a href="http://www.azimuthproject.org/azimuth/show/Azimuth+Code+Project">Azimuth Code Project</a> have been starting to analyze weather and climate data.  A lot of this work is exploratory, with no big conclusions.  But it&#8217;s still interesting!  So, let&#8217;s try some blog articles where we present this work.</p>
<p>This one will be about the air pressure on the island of Tahiti and in a city called Darwin in Australia: how they&#8217;re correlated, and how each one varies.  This article will also be a quick introduction to some basic statistics, as well as &#8216;continuous wavelet transforms&#8217;.</p>
<h3> Darwin, Tahiti and El Ni&ntilde;os </h3>
<p>The El Ni&ntilde;o Southern Oscillation is often studied using the air pressure in Darwin, Australia versus the air pressure in Tahiti.  When there&#8217;s an El Ni&ntilde;o, it gets stormy in the eastern Pacific so the air temperatures tend to be lower in Tahiti and higher in Darwin.  When there&#8217;s a La Ni&ntilde;a, it&#8217;s the other way around:</p>
<div align="center">
<a href="http://www.bom.gov.au/watl/about-weather-and-climate/australian-climate-influences.shtml?bookmark=enso"><br />
<img border="none" src="https://i1.wp.com/math.ucr.edu/home/baez/ecological/el_nino/ensoanim.gif" alt="" /><br />
</a>
</div>
<p>The <a href="http://www.azimuthproject.org/azimuth/show/ENSO#SOI">Southern Oscillation Index</a> or <b>SOI</b> is a normalized version of the monthly mean air pressure anomaly in Tahiti minus that in Darwin.   Here <b>anomaly</b> means we subtract off the mean, and <b>normalized</b> means that we divide by the standard deviation.  </p>
<p>So, the SOI tends to be negative when there&#8217;s an El Ni&ntilde;o.  On the other hand, when there&#8217;s an El Ni&ntilde;o the <a href="http://www.azimuthproject.org/azimuth/show/ENSO#Nino3.4">Ni&ntilde;o 3.4 index</a> tends to be positive&mdash;this says it&#8217;s hotter than usual in a certain patch of the Pacific.  </p>
<p>Here you can see how this works:</p>
<div align="center">
<a href="http://www.cpc.ncep.noaa.gov/products/analysis_monitoring/ensocycle/soi.shtml"><br />
<img width="450" border="none" src="http://www.cpc.ncep.noaa.gov/products/analysis_monitoring/ensocycle/soi_nino34.gif" /><br />
</a>
</div>
<p>When the Ni&ntilde;o 3.4 index is positive, the SOI tends to be negative, and vice versa!</p>
<p>It might be fun to explore precisely how well correlated they are.  You can get the data to do that by clicking on the links above.   </p>
<p>But here&#8217;s another question: how similar are the air pressure anomalies in Darwin and in Tahiti?  Do we really need to take their difference, or are they so strongly anticorrelated that either one would be enough to detect an El Ni&ntilde;o?</p>
<p>You can get the data to answer such questions here:</p>
<p>&bull; <a href="http://www.cgd.ucar.edu/cas/catalog/climind/soiAnnual.html">Southern Oscillation Index based upon annual standardization</a>, Climate Analysis Section, NCAR/UCAR.  This includes links to monthly sea level pressure anomalies in <a href="http://www.cgd.ucar.edu/cas/catalog/climind/darwin.anom.ascii">Darwin</a> and <a href="http://www.cgd.ucar.edu/cas/catalog/climind/tahiti.anom.ascii">Tahiti</a>, in either ASCII format (click the second two links) or netCDF format (click the first one and read the explanation).</p>
<p>In fact this website has some nice graphs already made, which I might as well show you!  Here&#8217;s the SOI and also the <i>sum</i> of the air pressure anomalies in Darwin and Tahiti, normalized in some way:</p>
<div align="center">
<a href="http://math.ucr.edu/home/baez/ecological/el_nino/soi_and_tahiti+darwin.gif"><br />
<img width="450" src="https://i0.wp.com/math.ucr.edu/home/baez/ecological/el_nino/soi_and_tahiti+darwin.gif" /></a>
</div>
<p>(Click to enlarge.)</p>
<p>If the sum were zero, the air pressure anomalies in Darwin and Tahiti would contain the same information and life would be simple.  But it&#8217;s not!</p>
<p>How similar in character are the air pressure anomalies in Darwin and Tahiti? There are many ways to study this question.  Dara tackled it by taking the air pressure anomaly data from 1866 to 2012 and computing some &#8216;continuous wavelet transforms&#8217; of these air pressure anomalies.  This is a good excuse for explaining how a continuous wavelet transform works.</p>
<h3> Very basic statistics </h3>
<p>It helps to start with some very basic statistics.  Suppose you have a list of numbers </p>
<p><img src="https://s0.wp.com/latex.php?latex=x+%3D+%28x_1%2C+%5Cdots%2C+x_n%29+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x = (x_1, &#92;dots, x_n) " class="latex" />  </p>
<p>You probably know how to take their <b><a href="https://en.wikipedia.org/wiki/Arithmetic_mean">mean</a></b>, or average.  People often write this with angle brackets:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Clangle+x+%5Crangle+%3D+%5Cfrac%7B1%7D%7Bn%7D+%5Csum_%7Bi+%3D+1%7D%5En+x_i+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;langle x &#92;rangle = &#92;frac{1}{n} &#92;sum_{i = 1}^n x_i } " class="latex" /></p>
<p>You can also calculate the mean of their squares:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B++%5Clangle+x%5E2+%5Crangle+%3D+%5Cfrac%7B1%7D%7Bn%7D+%5Csum_%7Bi+%3D+1%7D%5En+x_i%5E2+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{  &#92;langle x^2 &#92;rangle = &#92;frac{1}{n} &#92;sum_{i = 1}^n x_i^2 } " class="latex" /></p>
<p>If you were naive you might think <img src="https://s0.wp.com/latex.php?latex=%5Clangle+x%5E2+%5Crangle+%3D+%5Clangle+x+%5Crangle%5E2%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;langle x^2 &#92;rangle = &#92;langle x &#92;rangle^2," class="latex" /> but in fact we have:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Clangle+x%5E2+%5Crangle+%5Cge+%5Clangle+x+%5Crangle%5E2+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;langle x^2 &#92;rangle &#92;ge &#92;langle x &#92;rangle^2 " class="latex" /></p>
<p>and they&#8217;re equal only if all the <img src="https://s0.wp.com/latex.php?latex=x_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x_i" class="latex" /> are the same.  The point is that if the numbers <img src="https://s0.wp.com/latex.php?latex=x_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x_i" class="latex" /> are spread out, the squares of the big ones (positive or negative) contribute more to the average of the squares than if we had averaged them out before squaring.  The difference</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Clangle+x%5E2+%5Crangle+-+%5Clangle+x+%5Crangle%5E2+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;langle x^2 &#92;rangle - &#92;langle x &#92;rangle^2 " class="latex" /></p>
<p>is called the <b><a href="https://en.wikipedia.org/wiki/Variance">variance</a></b>; it says how spread out our numbers are.  The square root of the variance is the <b><a href="https://en.wikipedia.org/wiki/Standard_deviation">standard deviation</a></b>:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Csigma_x+%3D+%5Csqrt%7B%5Clangle+x%5E2+%5Crangle+-+%5Clangle+x+%5Crangle%5E2+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;sigma_x = &#92;sqrt{&#92;langle x^2 &#92;rangle - &#92;langle x &#92;rangle^2 } " class="latex" /></p>
<p>and this has the slight advantage that if you multiply all the numbers <img src="https://s0.wp.com/latex.php?latex=x_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x_i" class="latex" /> by some constant <img src="https://s0.wp.com/latex.php?latex=c%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="c," class="latex" /> the standard deviation gets multiplied by <img src="https://s0.wp.com/latex.php?latex=%7Cc%7C.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="|c|." class="latex" />  (The variance gets multiplied by <img src="https://s0.wp.com/latex.php?latex=c%5E2.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="c^2." class="latex" />)</p>
<p>We can generalize the variance to a situation where we have two lists of numbers: </p>
<p><img src="https://s0.wp.com/latex.php?latex=x+%3D+%28x_1%2C+%5Cdots%2C+x_n%29+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x = (x_1, &#92;dots, x_n) " class="latex" />  </p>
<p><img src="https://s0.wp.com/latex.php?latex=y+%3D+%28y_1%2C+%5Cdots%2C+y_n%29+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="y = (y_1, &#92;dots, y_n) " class="latex" />  </p>
<p>Namely, we can form the <b><a href="https://en.wikipedia.org/wiki/Covariance">covariance</a></b></p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Clangle+x+y+%5Crangle+-+%5Clangle+x+%5Crangle+%5Clangle+y+%5Crangle+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;langle x y &#92;rangle - &#92;langle x &#92;rangle &#92;langle y &#92;rangle " class="latex" /></p>
<p>This reduces to the variance when <img src="https://s0.wp.com/latex.php?latex=x+%3D+y.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x = y." class="latex" />  It measures how much <img src="https://s0.wp.com/latex.php?latex=x&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="y" class="latex" /> vary together &mdash; &#8216;hand in hand&#8217;, as it were.  A bit more precisely: if <img src="https://s0.wp.com/latex.php?latex=x_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x_i" class="latex" /> is greater than its mean value mainly for <img src="https://s0.wp.com/latex.php?latex=i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i" class="latex" /> such that <img src="https://s0.wp.com/latex.php?latex=y_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="y_i" class="latex" /> is greater than <i>its</i> mean value, the covariance is positive.  On the other hand, if <img src="https://s0.wp.com/latex.php?latex=x_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x_i" class="latex" /> tends to be greater than average when <img src="https://s0.wp.com/latex.php?latex=y_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="y_i" class="latex" /> is <i>smaller</i> than average &mdash; like with the air pressures at Darwin and Tahiti &mdash; the covariance will be negative.</p>
<p>For example, if </p>
<p><img src="https://s0.wp.com/latex.php?latex=x+%3D+%281%2C-1%29%2C+%5Cquad+y+%3D+%281%2C-1%29+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x = (1,-1), &#92;quad y = (1,-1) " class="latex" /></p>
<p>then they &#8216;vary hand in hand&#8217;, and the covariance</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Clangle+x+y+%5Crangle+-+%5Clangle+x+%5Crangle+%5Clangle+y+%5Crangle+%3D+1+-+0+%3D+1+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;langle x y &#92;rangle - &#92;langle x &#92;rangle &#92;langle y &#92;rangle = 1 - 0 = 1 " class="latex" /></p>
<p>is positive.  But if</p>
<p><img src="https://s0.wp.com/latex.php?latex=x+%3D+%281%2C-1%29%2C+%5Cquad+y+%3D+%28-1%2C1%29+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x = (1,-1), &#92;quad y = (-1,1) " class="latex" /></p>
<p>then one is positive when the other is negative, so the covariance</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Clangle+x+y+%5Crangle+-+%5Clangle+x+%5Crangle+%5Clangle+y+%5Crangle+%3D+-1+-+0+%3D+-1+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;langle x y &#92;rangle - &#92;langle x &#92;rangle &#92;langle y &#92;rangle = -1 - 0 = -1 " class="latex" /></p>
<p>is negative.  </p>
<p>Of course the covariance will get bigger if we multiply both <img src="https://s0.wp.com/latex.php?latex=x&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="y" class="latex" /> by some big number.  If we don&#8217;t want this effect, we can normalize the covariance and get the <b><a href="https://en.wikipedia.org/wiki/Correlation#Pearson.27s_product-moment_coefficient">correlation</a></b>:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7B+%5Clangle+x+y+%5Crangle+-+%5Clangle+x+%5Crangle+%5Clangle+y+%5Crangle+%7D%7B%5Csigma_x+%5Csigma_y%7D+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{ &#92;langle x y &#92;rangle - &#92;langle x &#92;rangle &#92;langle y &#92;rangle }{&#92;sigma_x &#92;sigma_y} } " class="latex" /></p>
<p>which will always be between <img src="https://s0.wp.com/latex.php?latex=-1&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="-1" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=1.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="1." class="latex" />   </p>
<p>For example, if we compute the correlation between the air pressure anomalies at Darwin and Tahiti, measured monthly from 1866 to 2012, we get<br />
-0.253727.  This indicates that when one goes up, the other tends to go down.  But since we&#8217;re not getting -1, it means they&#8217;re not completely locked into a linear relationship where one is some negative number times the other.</p>
<p>Okay, we&#8217;re almost ready for continuous wavelet transforms!   Here is the main thing we need to know.  If the mean of either <img src="https://s0.wp.com/latex.php?latex=x&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x" class="latex" /> or <img src="https://s0.wp.com/latex.php?latex=y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="y" class="latex" /> is zero, the formula for covariance simplifies a lot, to</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B++%5Clangle+x+y+%5Crangle+%3D+%5Cfrac%7B1%7D%7Bn%7D+%5Csum_%7Bi+%3D+1%7D%5En+x_i+y_i+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{  &#92;langle x y &#92;rangle = &#92;frac{1}{n} &#92;sum_{i = 1}^n x_i y_i } " class="latex" /></p>
<p>So, this quantity says how much the numbers <img src="https://s0.wp.com/latex.php?latex=x_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x_i" class="latex" /> &#8216;vary hand in hand&#8217; with the numbers <img src="https://s0.wp.com/latex.php?latex=y_i%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="y_i," class="latex" /> in the special case when one (or both) has mean zero.</p>
<p>We can do something similar if <img src="https://s0.wp.com/latex.php?latex=x%2C+y+%3A+%5Cmathbb%7BR%7D+%5Cto+%5Cmathbb%7BR%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x, y : &#92;mathbb{R} &#92;to &#92;mathbb{R}" class="latex" /> are functions of time defined for all real numbers <img src="https://s0.wp.com/latex.php?latex=t.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="t." class="latex" />  The sum becomes an integral, and we have to give up on dividing by <img src="https://s0.wp.com/latex.php?latex=n.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="n." class="latex" />  We get:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B++%5Cint_%7B-%5Cinfty%7D%5E%5Cinfty+x%28t%29+y%28t%29%5C%3B+d+t+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{  &#92;int_{-&#92;infty}^&#92;infty x(t) y(t)&#92;; d t } " class="latex" /></p>
<p>This is called the <b>inner product</b> of the functions <img src="https://s0.wp.com/latex.php?latex=x&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=y%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="y," class="latex" /> and often it&#8217;s written <img src="https://s0.wp.com/latex.php?latex=%5Clangle+x%2C+y+%5Crangle%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;langle x, y &#92;rangle," class="latex" /> but it&#8217;s a lot like the covariance.</p>
<h3> Continuous wavelet transforms </h3>
<p>What are continuous wavelet transforms, and why should we care?</p>
<p>People have lots of tricks for studying &#8216;signals&#8217;, like series of numbers <img src="https://s0.wp.com/latex.php?latex=x_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x_i" class="latex" /> or functions <img src="https://s0.wp.com/latex.php?latex=x+%3A+%5Cmathbb%7BR%7D+%5Cto+%5Cmathbb%7BR%7D.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x : &#92;mathbb{R} &#92;to &#92;mathbb{R}." class="latex" />  One method is to &#8216;transform&#8217; the signal in a way that reveals useful information.  The <a href="https://en.wikipedia.org/wiki/Fourier_transform">Fourier transform</a> decomposes a signal into sines and cosines of different frequencies.  This lets us see how much power the signal has at different frequencies, but it doesn&#8217;t reveal how the power at different frequencies <i>changes with time</i>.  For that we should use something else, like the <a href="https://johncarlosbaez.wordpress.com/2013/01/30/milankovich-vs-the-ice-ages/">Gabor transform</a> explained by Blake Pollard in a previous post.</p>
<p>Sines and cosines are great, but we might want to look for other patterns in a signal.  A &#8216;continuous wavelet transform&#8217; lets us scan a signal for appearances of a given pattern at different <i>times</i> and also at different <i>time scales</i>: a pattern could go by quickly, or in a stretched out slow way.  </p>
<p>To implement the continuous wavelet transform, we need a signal and a pattern to look for.  The signal could be a function <img src="https://s0.wp.com/latex.php?latex=x+%3A+%5Cmathbb%7BR%7D+%5Cto+%5Cmathbb%7BR%7D.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x : &#92;mathbb{R} &#92;to &#92;mathbb{R}." class="latex" />  The pattern would then be another function <img src="https://s0.wp.com/latex.php?latex=y%3A+%5Cmathbb%7BR%7D+%5Cto+%5Cmathbb%7BR%7D%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="y: &#92;mathbb{R} &#92;to &#92;mathbb{R}," class="latex" /> usually called a <b><a href="https://en.wikipedia.org/wiki/Wavelet">wavelet</a></b>.  </p>
<p>Here&#8217;s an example of a wavelet:</p>
<div align="center">
<a href="http://math.ucr.edu/home/baez/ecological/shayda/DGauss4.jpg"><br />
<img src="https://i2.wp.com/math.ucr.edu/home/baez/ecological/shayda/DGauss4.jpg" /></a>
</div>
<p>If we&#8217;re in a relaxed mood, we could call <i>any</i> function that looks like a bump with wiggles in it a wavelet.  There are lots of famous wavelets, but this particular one is the fourth derivative of a certain Gaussian.  Mathematica calls this particular wavelet <a href="http://reference.wolfram.com/language/ref/DGaussianWavelet.html">DGaussianWavelet[4]</a>, and you can look up the formula under &#8216;Details&#8217; on their webpage.  </p>
<p>However, the exact formula doesn&#8217;t matter at all now!  If we call this wavelet <img src="https://s0.wp.com/latex.php?latex=y%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="y," class="latex" /> all that matters is that it&#8217;s a bump with wiggles on it, and that its mean value is 0, or more precisely:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cint_%7B-%5Cinfty%7D%5E%5Cinfty+y%28t%29+%5C%3B+d+t+%3D+0+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;int_{-&#92;infty}^&#92;infty y(t) &#92;; d t = 0 } " class="latex" /> </p>
<p>As we saw in the last section, this fact lets us take our function <img src="https://s0.wp.com/latex.php?latex=x&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x" class="latex" /> and the wavelet <img src="https://s0.wp.com/latex.php?latex=y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="y" class="latex" /> and see how much they &#8216;vary hand it hand&#8217; simply by computing their inner product:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Clangle+x+%2C+y+%5Crangle+%3D+%5Cint_%7B-%5Cinfty%7D%5E%5Cinfty+x%28t%29+y%28t%29%5C%3B+d+t+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;langle x , y &#92;rangle = &#92;int_{-&#92;infty}^&#92;infty x(t) y(t)&#92;; d t } " class="latex" /></p>
<p>Loosely speaking, this measures the &#8216;amount of <img src="https://s0.wp.com/latex.php?latex=y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="y" class="latex" />-shaped wiggle in the function <img src="https://s0.wp.com/latex.php?latex=x&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x" class="latex" />’.  It&#8217;s amazing how hard it is to say something in plain English that perfectly captures the meaning of a simple formula like the above one&mdash;so take the quoted phrase with a huge grain of salt.  But it gives a rough intuition.</p>
<p>Our wavelet <img src="https://s0.wp.com/latex.php?latex=y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="y" class="latex" /> happens to be centered at <img src="https://s0.wp.com/latex.php?latex=t++%3D+0.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="t  = 0." class="latex" />  However, we might be interested in <img src="https://s0.wp.com/latex.php?latex=y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="y" class="latex" />-shaped wiggles that are centered not at zero but at some other number <img src="https://s0.wp.com/latex.php?latex=s.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s." class="latex" />  We could detect these by shifting the function <img src="https://s0.wp.com/latex.php?latex=y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="y" class="latex" /> before taking its inner product with <img src="https://s0.wp.com/latex.php?latex=x&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x" class="latex" />:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cint_%7B-%5Cinfty%7D%5E%5Cinfty+x%28t%29+y%28t-s%29%5C%3B+d+t+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;int_{-&#92;infty}^&#92;infty x(t) y(t-s)&#92;; d t } " class="latex" /></p>
<p>We could also be interested in measuring the amount of some stretched-out or squashed version of a <img src="https://s0.wp.com/latex.php?latex=y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="y" class="latex" />-shaped wiggle in the function <img src="https://s0.wp.com/latex.php?latex=x.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x." class="latex" />  Again we could do this by changing <img src="https://s0.wp.com/latex.php?latex=y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="y" class="latex" /> before taking its inner product with <img src="https://s0.wp.com/latex.php?latex=x&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x" class="latex" />:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cint_%7B-%5Cinfty%7D%5E%5Cinfty+x%28t%29+%5C%3B+y%5Cleft%28%5Cfrac%7Bt%7D%7BP%7D%5Cright%29+%5C%3B+d+t+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;int_{-&#92;infty}^&#92;infty x(t) &#92;; y&#92;left(&#92;frac{t}{P}&#92;right) &#92;; d t } " class="latex" /></p>
<p>When <img src="https://s0.wp.com/latex.php?latex=P&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="P" class="latex" /> is big, we get a stretched-out version of <img src="https://s0.wp.com/latex.php?latex=y.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="y." class="latex" />  People sometimes call <img src="https://s0.wp.com/latex.php?latex=P&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="P" class="latex" /> the <b>period</b>, since the period of the wiggles in <img src="https://s0.wp.com/latex.php?latex=y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="y" class="latex" /> will be proportional to this (though usually not equal to it).</p>
<p>Finally, we can combine these ideas, and compute</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cint_%7B-%5Cinfty%7D%5E%5Cinfty+x%28t%29+%5C%3B+y%5Cleft%28%5Cfrac%7Bt-+s%7D%7BP%7D%5Cright%29%5C%3B+dt+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;int_{-&#92;infty}^&#92;infty x(t) &#92;; y&#92;left(&#92;frac{t- s}{P}&#92;right)&#92;; dt } " class="latex" /></p>
<p>This is a function of the shift <img src="https://s0.wp.com/latex.php?latex=s&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s" class="latex" /> and period <img src="https://s0.wp.com/latex.php?latex=P&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="P" class="latex" /> which says how much of the <img src="https://s0.wp.com/latex.php?latex=s&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s" class="latex" />-shifted, <img src="https://s0.wp.com/latex.php?latex=P&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="P" class="latex" />-stretched wavelet <img src="https://s0.wp.com/latex.php?latex=y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="y" class="latex" /> is lurking in the function <img src="https://s0.wp.com/latex.php?latex=x.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x." class="latex" />  It&#8217;s a version of the continuous wavelet transform!</p>
<p>Mathematica implements this idea for <a href="https://en.wikipedia.org/wiki/Time_series"><b>time series</b></a>, meaning lists of numbers <img src="https://s0.wp.com/latex.php?latex=x+%3D+%28x_1%2C%5Cdots%2Cx_n%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x = (x_1,&#92;dots,x_n)" class="latex" /> instead of functions <img src="https://s0.wp.com/latex.php?latex=x+%3A+%5Cmathbb%7BR%7D+%5Cto+%5Cmathbb%7BR%7D.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x : &#92;mathbb{R} &#92;to &#92;mathbb{R}." class="latex" />  The idea is that we think of the numbers as samples of a function <img src="https://s0.wp.com/latex.php?latex=x&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x" class="latex" />:</p>
<p><img src="https://s0.wp.com/latex.php?latex=x_1+%3D+x%28%5CDelta+t%29+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x_1 = x(&#92;Delta t) " class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=x_2+%3D+x%282+%5CDelta+t%29+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x_2 = x(2 &#92;Delta t) " class="latex" /></p>
<p>and so on, where <img src="https://s0.wp.com/latex.php?latex=%5CDelta+t&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Delta t" class="latex" /> is some time step, and replace the integral above by a suitable sum.   Mathematica has a function <a href="http://reference.wolfram.com/language/ref/ContinuousWaveletTransform.html">ContinuousWaveletTransform</a> that does this, giving</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B++w%28s%2CP%29+%3D+%5Cfrac%7B1%7D%7B%5Csqrt%7BP%7D%7D+%5Csum_%7Bi+%3D+1%7D%5En+x_i+%5C%3B+y%5Cleft%28%5Cfrac%7Bi+%5CDelta+t+-+s%7D%7BP%7D%5Cright%29+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{  w(s,P) = &#92;frac{1}{&#92;sqrt{P}} &#92;sum_{i = 1}^n x_i &#92;; y&#92;left(&#92;frac{i &#92;Delta t - s}{P}&#92;right) } " class="latex" /></p>
<p>The factor of <img src="https://s0.wp.com/latex.php?latex=1%2F%5Csqrt%7BP%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="1/&#92;sqrt{P}" class="latex" /> in front is a useful extra trick: it&#8217;s the right way to compensate for the fact that when you stretch out out your wavelet <img src="https://s0.wp.com/latex.php?latex=y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="y" class="latex" /> by a factor of <img src="https://s0.wp.com/latex.php?latex=P%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="P," class="latex" /> it gets bigger.  So, when we&#8217;re doing integrals, we should define the <b>continuous wavelet transform</b> of <img src="https://s0.wp.com/latex.php?latex=y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="y" class="latex" /> by:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+w%28s%2CP%29+%3D+%5Cfrac%7B1%7D%7B%5Csqrt%7BP%7D%7D+%5Cint_%7B-%5Cinfty%7D%5E%5Cinfty+x%28t%29+y%28%5Cfrac%7Bt-+s%7D%7BP%7D%29%5C%3B+dt+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ w(s,P) = &#92;frac{1}{&#92;sqrt{P}} &#92;int_{-&#92;infty}^&#92;infty x(t) y(&#92;frac{t- s}{P})&#92;; dt } " class="latex" /></p>
<h3> The results </h3>
<p>Dara Shayda started with the air pressure anomaly at Darwin and Tahiti, measured monthly from 1866 to 2012.  Taking DGaussianWavelet[4] as his wavelet, he computed the continuous wavelet transform <img src="https://s0.wp.com/latex.php?latex=w%28s%2CP%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="w(s,P)" class="latex" /> as above.  To show us the answer, he created a <b>scalogram</b>: </p>
<div align="center">
<a href="http://math.ucr.edu/home/baez/ecological/shayda/scalogram_darwin_dgauss4.jpg"><br />
<img width="450" src="https://i2.wp.com/math.ucr.edu/home/baez/ecological/shayda/scalogram_darwin_dgauss4.jpg" /></a>
</div>
<p>This is a 2-dimensional color plot showing roughly how big the continuous wavelet transform <img src="https://s0.wp.com/latex.php?latex=w%28s%2CP%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="w(s,P)" class="latex" /> is for different shifts <img src="https://s0.wp.com/latex.php?latex=s&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s" class="latex" /> and periods <img src="https://s0.wp.com/latex.php?latex=P.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="P." class="latex" />  Blue means it&#8217;s very small, green means it&#8217;s bigger, yellow means even bigger and red means very large.  </p>
<p>Tahiti gave this:</p>
<div align="center">
<a href="http://math.ucr.edu/home/baez/ecological/shayda/scalogram_tahiti_dgauss4.jpg"><br />
<img width="450" src="https://i2.wp.com/math.ucr.edu/home/baez/ecological/shayda/scalogram_tahiti_dgauss4.jpg" /></a>
</div>
<p>You&#8217;ll notice that the patterns at Darwin and Tahiti are similar in character, but notably different in detail.  For example, the red spots, where our chosen wavelet shows up strongly with period of order ~100 months, occur at different times.</p>
<p><b>Puzzle 1.</b> What is the meaning of the &#8216;spikes&#8217; in these scalograms?  What sort of signal would give a spike of this sort?</p>
<p><b>Puzzle 2.</b> Do a <a href="https://en.wikipedia.org/wiki/Gabor_transform">Gabor transform</a>, also known as a &#8216;windowed Fourier transform&#8217;, of the same data.  Blake Pollard explained the Gabor transform in his article <a href="https://johncarlosbaez.wordpress.com/2013/01/30/milankovich-vs-the-ice-ages/">Milankovitch vs the Ice Ages</a>.  This is a way to see how much a signal wiggles at a given frequency at a given time: we multiply the signal by a shifted Gaussian and then takes its Fourier transform.  </p>
<p><b>Puzzle 3.</b>  Read about continuous wavelet transforms.  If we want to reconstruct our signal <img src="https://s0.wp.com/latex.php?latex=x&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x" class="latex" /> from its continuous wavelet transform, why should we use a wavelet <img src="https://s0.wp.com/latex.php?latex=y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="y" class="latex" /> with </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B%5Cint_%7B-%5Cinfty%7D%5E%5Cinfty+y%28t%29+%5C%3B+d+t+%3D+0+%3F+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{&#92;int_{-&#92;infty}^&#92;infty y(t) &#92;; d t = 0 ? } " class="latex" /></p>
<p>In fact we want a somewhat stronger condition, which is implied by the above equation when the Fourier transform of <img src="https://s0.wp.com/latex.php?latex=y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="y" class="latex" /> is smooth and integrable:</p>
<p>&bull; <a href="https://en.wikipedia.org/wiki/Continuous_wavelet_transform">Continuous wavelet transform</a>, Wikipedia.</p>
<h3> Another way to understand correlations </h3>
<p>David Tweed mentioned another approach from signal processing to understanding the quantity</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B++%5Clangle+x+y+%5Crangle+%3D+%5Cfrac%7B1%7D%7Bn%7D+%5Csum_%7Bi+%3D+1%7D%5En+x_i+y_i+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{  &#92;langle x y &#92;rangle = &#92;frac{1}{n} &#92;sum_{i = 1}^n x_i y_i } " class="latex" /></p>
<p>If we&#8217;ve got two lists of data <img src="https://s0.wp.com/latex.php?latex=x&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="y" class="latex" /> that we want to compare to see if they behave similarly, the first thing we ought to do is multiplicatively scale each one so they&#8217;re of comparable magnitude. There are various possibilities for assigning a scale, but a reasonable one is to ensure they have equal &#8216;energy&#8217;</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B++%5Csum_%7Bi%3D1%7D%5En+x_i%5E2+%3D+%5Csum_%7Bi%3D1%7D%5En+y_i%5E2+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{  &#92;sum_{i=1}^n x_i^2 = &#92;sum_{i=1}^n y_i^2 } " class="latex" /></p>
<p>(This can be achieved by dividing each list by its standard deviation, which is equivalent to what was done in the main derivation above.)  Once we&#8217;ve done that then it&#8217;s clear that looking at </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B++%5Csum_%7Bi%3D1%7D%5En+%28x_i-y_i%29%5E2+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{  &#92;sum_{i=1}^n (x_i-y_i)^2 } " class="latex" /> </p>
<p>gives small values when they have a very good match and progressively bigger values as they become less similar. Observe that</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Barray%7D%7Bccl%7D++%5Cdisplaystyle%7B%5Csum_%7Bi%3D1%7D%5En+%28x_i-y_i%29%5E2+%7D++%26%3D%26+%5Cdisplaystyle%7B+%5Csum_%7Bi%3D1%7D%5En+%28x_i%5E2+-+2+x_i+y_i+%2B+y_i%5E2%29+%7D%5C%5C++%26%3D%26+%5Cdisplaystyle%7B+%5Csum_%7Bi%3D1%7D%5En+x_i%5E2+-+2+%5Csum_%7Bi%3D1%7D%5En+x_i+y_i+%2B+%5Csum_%7Bi%3D1%7D%5En+y_i%5E2+%7D++%5Cend%7Barray%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;begin{array}{ccl}  &#92;displaystyle{&#92;sum_{i=1}^n (x_i-y_i)^2 }  &amp;=&amp; &#92;displaystyle{ &#92;sum_{i=1}^n (x_i^2 - 2 x_i y_i + y_i^2) }&#92;&#92;  &amp;=&amp; &#92;displaystyle{ &#92;sum_{i=1}^n x_i^2 - 2 &#92;sum_{i=1}^n x_i y_i + &#92;sum_{i=1}^n y_i^2 }  &#92;end{array} " class="latex" /></p>
<p>Since we&#8217;ve scaled things so that <img src="https://s0.wp.com/latex.php?latex=%5Csum_%7Bi%3D1%7D%5En+x_i%5E2&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;sum_{i=1}^n x_i^2" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=%5Csum_%7Bi%3D1%7D%5En+y_i%5E2&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;sum_{i=1}^n y_i^2" class="latex" />  are constants, we can see that when <img src="https://s0.wp.com/latex.php?latex=%5Csum_%7Bi%3D1%7D%5En+x_i+y_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;sum_{i=1}^n x_i y_i" class="latex" /> becomes bigger, </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Csum_%7Bi%3D1%7D%5En+%28x_i-y_i%29%5E2+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;sum_{i=1}^n (x_i-y_i)^2 }" class="latex" /> </p>
<p>becomes smaller.  So, </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B%5Csum_%7Bi%3D1%7D%5En+x_i+y_i%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{&#92;sum_{i=1}^n x_i y_i} " class="latex" /></p>
<p>serves as a measure of how close the lists are, under these assumptions. </p>
									</div>

				<p class="postmetadata">
				<img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/speech_bubble.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2014/08/01/exploring-climate-data-part-1/#comments">19 Comments</a>				| <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/documents.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/category/climate/" rel="category tag">climate</a>, <a href="https://johncarlosbaez.wordpress.com/category/mathematics/" rel="category tag">mathematics</a>, <a href="https://johncarlosbaez.wordpress.com/category/probability/" rel="category tag">probability</a>								 | <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/permalink.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2014/08/01/exploring-climate-data-part-1/" rel="bookmark" title="Permanent Link to Exploring Climate Data (Part&nbsp;1)">Permalink</a>
<br /><img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/figure_ver1.gif" alt="" /> Posted by John Baez				</p>
			</div>
			<hr />
		
			<div class="post-18424 post type-post status-publish format-standard hentry category-climate" id="post-18424">
				<h2><a href="https://johncarlosbaez.wordpress.com/2014/07/23/el-nino-project-part-6/" rel="bookmark">El Niño Project (Part&nbsp;6)</a></h2>
				<small>23 July, 2014</small><br />


				<div class="entry">
					<p><i>guest post by <b>Steven Wenner</b></i></p>
<p>Hi, I&#8217;m Steve Wenner.  </p>
<p>I’m an industrial statistician with over 40 years of experience in a wide range applications (quality, reliability, product development, consumer research, biostatistics); but, somehow, time series only rarely crossed my path.  Currently I’m working for a large consumer products company.</p>
<p>My undergraduate degree is in physics, and I also have a master’s in pure math.  I never could reconcile how physicists used math (explain that Dirac delta function to me again in math terms?  Heaviside calculus?  On the other hand, I thought category theory was abstract nonsense until John showed me otherwise!).  Anyway, I had to admit that I lacked the talent to pursue pure math or theoretical physics, so I became a statistician.  I never regretted it&mdash;statistics has provided a very interesting and intellectually challenging career.  </p>
<p>I got interested in Ludescher <i>et al</i>’s paper on El Ni&ntilde;o prediction by reading <a href="https://johncarlosbaez.wordpress.com/2014/07/01/el-nino-project-part-3/">Part 3</a> of this series.   I have no expertise in climate science, except for an intense interest in the subject as a concerned citizen.  So, I won&#8217;t talk about things like how Ludescher <i>et al</i> use a nonstandard definition of &#8216;El Niño&#8217;&#8212;that&#8217;s a topic for another time.  Instead, I&#8217;ll look at some statistical aspects of their paper:</p>
<p>&bull; Josef Ludescher, Avi Gozolchiani, Mikhail I. Bogachev, Armin Bunde, Shlomo Havlin, and Hans Joachim Schellnhuber, <a href="http://www.climatelinc.eu/fileadmin/UG_ADVANCED/Publications/BIU_-_Avi__Halvin__et_al-Very_early_warning_of_next_El_Nino.pdf">Very early warning of next El Niño</a>, <a href="http://www.pnas.org/content/early/2014/02/07/1323058111"><i>Proceedings of the National Academy of Sciences</i></a>, February 2014.  (Click title for free version, journal name for official version.)</p>
<h3> Analysis </h3>
<p>I downloaded the NOAA adjusted monthly temperature anomaly data and compared the El Niño periods with the charts in this paper.  I found what appear to be two errors (“phantom” El Niños) and noted some interesting situations.  Some of these are annotated on the images below.  Click to enlarge them:</p>
<div align="center"><a href="http://math.ucr.edu/home/baez/ecological/el_nino/wenner/figure_1.png"><img width="440" src="https://i1.wp.com/math.ucr.edu/home/baez/ecological/el_nino/wenner/figure_1.png" /></a>
</div>
<p>&nbsp; </p>
<div align="center"><a><img width="440" src="https://i0.wp.com/math.ucr.edu/home/baez/ecological/el_nino/wenner/figure_2.png" /></a>
</div>
<p>I also listed for each year whether an El Niño initiation was predicted, or not, and whether one actually happened.  I did the predictions five ways: first, I listed the author’s “arrows” as they appeared on their charts, and then I tried to match their predictions by following in turn four sets of rules.  Nevertheless, I could not come up with any detailed rules that exactly reproduced the author’s results.  </p>
<p>These were the rules I used:</p>
<p>An El Niño initiation is predicted for a calendar year if during the preceding year the average link strength crossed above the 2.82 threshold.  However, we could also invoke additional requirements.  Two possibilities are:</p>
<p>1. Preemption rule:  the prediction of a new El Niño is canceled if the preceding year ends in an El Niño period.</p>
<p>2. End-of-year rule:  the link strength must be above 2.82 at year&#8217;s end. </p>
<p>I counted the predictions using all four combinations of these two rules and compared the results to the arrows on the charts.</p>
<p>I defined an “El Niño initiation month” to be a month where the monthly average adjusted temperature anomaly rises up to at least 0.5 C and remains above or equal to 0.5 &deg;C for at least five months.  Note that the NOAA El Niño monthly temperature estimates are rounded to hundredths; and, on occasion, the anomaly is reported as exactly 0.5 &deg;C.  I found slightly better agreement with the authors’ El Niño periods if I counted an anomaly of exactly 0.5 &deg;C as satisfying the threshold criterion, instead of using the strictly “greater than” condition.</p>
<p>Anyway, I did some formal hypothesis testing and estimation under all five scenarios.  The good news is that under most scenarios the prediction method gave better results than merely guessing.  (But, I wonder how many things the authors tried before they settled on their final method?  Also, did they do all their work on the learning series, and then only at the end check the validation series&#8212;or were they checking both as they went about their investigations?)  </p>
<p>The bad news is that the predictions varied with the method, and the methods were rather weak.  For instance, in the training series there were 9 El Niño periods in 30 years; the authors’ rules (whatever they were, exactly) found five of the nine.  At the same time, they had three false alarms in the 21 years that did not have an El Niño initiated.  </p>
<p>I used <a href="https://en.wikipedia.org/wiki/Fisher%27s_exact_test">Fisher’s exact test</a> to compute some p-values.  Suppose (as our &#8216;null hypothesis&#8217;) that Ludescher <i>et al&#8217;</i>s method does not improve the odds of a successful prediction of an El Nino initiation.  What&#8217;s the probability of that method getting at least as many predictions right just by chance?  Answer: 0.032 &#8211; this is marginally more significant than the conventional 1 in 20 chance that is the usual threshold for rejecting a null hypothesis, but still not terribly convincing.  This was, by the way, the most significant of the five p-values for the alternative rule sets applied to the learning series.</p>
<p>I also computed the “relative risk” statistics for all scenarios; for instance, we are more than three times as likely to see an El Niño initiation if Ludescher <i>et al</i> predict one, than if they predict otherwise (the 90% confidence interval for that ratio is 1.2 to 9.7, with the point estimate 3.4).  Here is a screen shot of some statistics for that case:</p>
<div align="center"><a href="http://math.ucr.edu/home/baez/ecological/el_nino/wenner/figure_3.png"><img width="450" src="https://i2.wp.com/math.ucr.edu/home/baez/ecological/el_nino/wenner/figure_3.png" /></a>
</div>
<div align="center"><a href="http://math.ucr.edu/home/baez/ecological/el_nino/wenner/figure_4.png"><img width="450" src="https://i1.wp.com/math.ucr.edu/home/baez/ecological/el_nino/wenner/figure_4.png" /></a>
</div>
<p>Here is a screen shot of part of the spreadsheet list I made.  In the margin on the right I made comments about special situations of interest. </p>
<div align="center"><a href="http://math.ucr.edu/home/baez/ecological/el_nino/wenner/figure_5.png"><img width="450" src="https://i0.wp.com/math.ucr.edu/home/baez/ecological/el_nino/wenner/figure_5.png" /></a>
</div>
<p>Again, click to enlarge&#8212;but my whole working spreadsheet is <a href="http://math.ucr.edu/home/baez/ecological/el_nino/wenner/ElNinoTemps.xlsx">available</a> with more details for anyone who wishes to see it.  I did the statistical analysis with a program called <a href="http://www.jmp.com/software/">JMP</a>, a product of the SAS corporation.</p>
<p>My overall impression from all this is that Ludescher <i>et al</i> are suggesting a somewhat arbitrary (and not particularly well-defined) method for revealing the relationship between link strength and El Niño initiation, if, indeed, a relationship exists.  Slight variations in the interpretation of their criteria and slight variations in the data result in appreciably different predictions.  I wonder if there are better ways to analyze these two correlated time series. </p>
									</div>

				<p class="postmetadata">
				<img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/speech_bubble.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2014/07/23/el-nino-project-part-6/#comments">29 Comments</a>				| <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/documents.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/category/climate/" rel="category tag">climate</a>								 | <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/permalink.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2014/07/23/el-nino-project-part-6/" rel="bookmark" title="Permanent Link to El Niño Project (Part&nbsp;6)">Permalink</a>
<br /><img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/figure_ver1.gif" alt="" /> Posted by John Baez				</p>
			</div>
			<hr />
		
			<div class="post-17737 post type-post status-publish format-standard hentry category-art" id="post-17737">
				<h2><a href="https://johncarlosbaez.wordpress.com/2014/07/18/the-harmonograph/" rel="bookmark">The Harmonograph</a></h2>
				<small>18 July, 2014</small><br />


				<div class="entry">
					<div align="center">
<a href="http://anitachowdry.wordpress.com/2013/06/23/developing-the-harmonograph-project-for-my-m-a/"><img width="350" src="https://i0.wp.com/math.ucr.edu/home/baez/cultural/harmonograph/harmo-1.jpg" /></a></div>
<p><a href="http://www.anitachowdry.com/about/4583037010">Anita Chowdry</a> is an artist based in London.  While many are exploring electronic media and computers, she&#8217;s going in the opposite direction, exploring craftsmanship and the hands-on manipulation of matter.  I find this exciting, perhaps because I spend most of my days working on my laptop, becoming starved for richer sensations.  She writes:</p>
<blockquote><p>
Today, saturated as we are with the ephemeral intangibility of virtual objects and digital functions, there is a resurgence of interest in the ingenious mechanical contraptions of pre-digital eras, and in the processes of handcraftsmanship and engagement with materials. The solid corporality of analogue machines, the perceivable workings of their kinetic energy, and their direct invitation to experience their science through hands-on interaction brings us back in touch with our humanity.
</p></blockquote>
<p>The &#8216;steampunk&#8217; movement is one way people are expressing this renewed interest, but Anita Chowdry goes a bit deeper than some of that.  For starters, she&#8217;s studied all sorts of delightful old-fashioned crafts, like <a href="http://anitachowdry.wordpress.com/2012/06/12/getting-started-with-silverpoint-drawing/">silverpoint</a>, a style of drawing used before the invention of graphite pencils.  The tool is just a piece of silver wire mounted on a writing implement; a bit of silver rubs off and creates a gray line.  The effect is very subtle:</p>
<div align="center"><a href="http://anitachowdry.wordpress.com/2012/06/12/getting-started-with-silverpoint-drawing/"><img src="https://i0.wp.com/math.ucr.edu/home/baez/cultural/harmonograph/silverpoint-shells-2.jpg" /></a></div>
<p>In January she went to Cairo and <a href="http://anitachowdry.wordpress.com/2014/02/25/working-with-a-calligrapher-at-the-thesaurus-islamicus-foundation/">worked with a master calligrapher</a>, Ahmed Fares, to recreate the title page of a 16th-century copy of Avicenna&#8217;s <i>Canon of Medicine</i>, or <i>al-Qanun fi’l Tibb</i>:</p>
<div align="center">
<a href="http://anitachowdry.wordpress.com/2014/02/25/working-with-a-calligrapher-at-the-thesaurus-islamicus-foundation/"><img width="450" src="https://i0.wp.com/math.ucr.edu/home/baez/cultural/harmonograph/ahmed-fares.jpg" /></a></div>
<p>This required making gold ink:</p>
<blockquote><p>
The secret is actually pure hard work; rubbing it by hand with honey for hours on end to break up the particles of gold into the finest powder, and then washing it thoroughly in distilled water to remove all impurities.
</p></blockquote>
<p>The results:</p>
<div align="center">
<a href="http://anitachowdry.wordpress.com/2014/02/25/working-with-a-calligrapher-at-the-thesaurus-islamicus-foundation/"><img width="450" src="https://i2.wp.com/math.ucr.edu/home/baez/cultural/harmonograph/ibn-sina-reconstruction_piece.jpg" /></a></div>
<p>I met her in Oxford this March, and we visited the Museum of the History of Science together.  This was a perfect place, because it&#8217;s right next to the famous Bodleian, and it&#8217;s full of astrolabes, sextants, ancient slide rules and the like&#8230;</p>
<div align="center">
<a href="http://anitachowdry.wordpress.com/2014/02/25/working-with-a-calligrapher-at-the-thesaurus-islamicus-foundation/"><img width="450" src="https://i1.wp.com/math.ucr.edu/home/baez/cultural/harmonograph/astrolabe.jpg" /></a></div>
<p>&#8230; and one of Anita Chowdry&#8217;s new projects involves another piece of romantic old technology: the harmonograph!</p>
<h3> The harmonograph </h3>
<p>A <b>harmonograph</b> is a mechanical apparatus that uses pendulums to draw a geometric image.  The simplest so-called &#8216;lateral&#8217; or &#8216;rectilinear&#8217; harmonograph uses two pendulums: one moves a pen back and forth along one axis, while the other moves the drawing surface back and forth along a perpendicular axis. By varying their amplitudes, frequencies and the phase difference, we can get quite a number of different patterns.  In the linear approximation where the pendulums don&#8217;t swing too high, we get <a href="https://en.wikipedia.org/wiki/Lissajous_curve">Lissajous curves</a>:</p>
<div align="center">
<img src="https://s0.wp.com/latex.php?latex=x%28t%29+%3D+A+%5Csin%28a+t+%2B+%5Cdelta%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x(t) = A &#92;sin(a t + &#92;delta)" class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=y%28t%29+%3D+B+%5Csin%28b+t%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="y(t) = B &#92;sin(b t)" class="latex" />
</div>
<p>For example, when the amplitudes <img src="https://s0.wp.com/latex.php?latex=A&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=B&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="B" class="latex" /> are both 1, the frequencies are <img src="https://s0.wp.com/latex.php?latex=a+%3D+3&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="a = 3" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=b+%3D+4%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="b = 4," class="latex" /> and the phase difference <img src="https://s0.wp.com/latex.php?latex=%5Cdelta&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;delta" class="latex" /> is <img src="https://s0.wp.com/latex.php?latex=%5Cpi%2F2%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi/2," class="latex" /> we get this:</p>
<div align="center">
<a href="https://commons.wikimedia.org/wiki/File:Lissajous_curve_3by4.svg"><img width="250" src="https://i1.wp.com/math.ucr.edu/home/baez/cultural/harmonograph/lissajous_curve.png" /></a></div>
<p>Harmonographs don&#8217;t serve any concrete practical purpose that I know; they&#8217;re a diversion, an educational device, or a form of art for art&#8217;s sake.  They go back to the mid-1840s.</p>
<p>It&#8217;s not clear who invented the harmonograph.  People often credit <a href="https://en.wikipedia.org/wiki/Hugh_Blackburn">Hugh Blackburn</a>, a professor of mathematics at the University of Glasgow who was a friend of the famous physicist Kelvin.  He is indeed known for studying a pendulum hanging on a V-shaped string, in 1844.  This is now called the <a href="https://en.wikipedia.org/wiki/Blackburn_pendulum">Blackburn pendulum</a>.  But it&#8217;s not used in any harmonograph I know about.</p>
<p>On the other hand, Anita Chowdry <a href="http://www.anitachowdry.com/harmonograph-resources/4585944436">has a book</a> called <i>The Harmonograph. Illustrated by Designs actually Drawn by the Machine</i>, written in 1893 by one H. Irwine Whitty.  This book says the harmonograph</p>
<blockquote><p>
was first constructed by Mr. Tisley, of the firm Tisley and Spiller, the well-known opticians&#8230;
</p></blockquote>
<p>So, it remains mysterious.</p>
<p>The harmonograph peaked in popularity in the 1890s.  I have no idea how popular it ever was; it seems a rather cerebral form of entertainment.   As the figures from Whitty&#8217;s book show, it was sometimes used to illustrate the Pythagorean theory of chords as frequency ratios.  Indeed, this explains the name &#8216;harmomograph&#8217;:</p>
<div align="center">
<a href="http://anitachowdry.wordpress.com/2014/06/22/antique-harmonograph-drawings/"><img width="450" src="https://i2.wp.com/math.ucr.edu/home/baez/cultural/harmonograph/antique-harmo-3.jpg" /></a></div>
<p>At left the frequencies are exactly <img src="https://s0.wp.com/latex.php?latex=a+%3D+3%2C+b+%3D+2%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="a = 3, b = 2," class="latex" /> just as we&#8217;d have in two notes making a major fifth.  Three choices of phase difference are shown.  In the pictures at right, actually drawn by the machine, the frequencies aren&#8217;t perfectly tuned, so we get more complicated Lissajous curves.</p>
<p>How big was the harmonograph craze, and how long did it last?  It&#8217;s hard for me to tell, but this book published in 1918 gives some clues:</p>
<p>&bull; Archibald Williams, <a href="http://chestofbooks.com/crafts/popular-mechanics/Things-To-Make/#.U8Xnl7EdqgU"><i>Things to Make</i></a>: Home-made harmonographs (<a href="http://chestofbooks.com/crafts/popular-mechanics/Things-To-Make/I-Home-Made-Harmonographs.html">part 1</a>, <a href="http://chestofbooks.com/crafts/popular-mechanics/Things-To-Make/I-Home-Made-Harmonographs-Part-2.html#.U8Xn6bEdqgU">part 2</a>, <a href="http://chestofbooks.com/crafts/popular-mechanics/Things-To-Make/I-Home-Made-Harmonographs-Part-3.html#.U8XoC7EdqgU">part 3</a>), Thomas Nelson and Sons, Ltd., 1918.</p>
<p>It discusses the lateral harmonograph.  Then it treats Joseph Goold&#8217;s &#8216;twin elliptic pendulum harmonograph&#8217;, which has a pendulum free to swing in all directions connected to a pen, and second pendulum free to swing in all directions affecting the motion of the paper.  It also shows a miniature version of the same thing, and how to build it yourself.  It explains the connection with harmony theory.  And it explains the <i>value</i> of the harmonograph:</p>
<blockquote>
<h4> Value of the harmonograph </h4>
<p>A small portable harmonograph will be found to be a good means of entertaining friends at home or elsewhere. The gradual growth of the figure, as the card moves to and fro under the pen, will arouse the interest of the least scientifically inclined person; in fact, the trouble is rather to persuade spectators that they have had enough than to attract their attention. The cards on which designs have been drawn are in great request, so that the pleasure of the entertainment does not end with the mere exhibition. An album filled with picked designs, showing different harmonies and executed in inks of various colours, is a formidable rival to the choicest results of the amateur photographer&#8217;s skill.
</p></blockquote>
<p>&#8220;In great request&#8221;&#8212;this makes it sound like harmonographs were all the rage!  On the other hand, I smell a whiff of desperate salesmanship, and he begins the chapter by saying:</p>
<blockquote><p>
Have you ever heard of the harmonograph? If not, or if at the most you have very hazy ideas as to what it is, let me explain.
</p></blockquote>
<p>So even at its height of popularity, I doubt most people knew what a harmonograph was. And as time passed, more peppy diversions came along and pushed it aside.  The phonograph, for example, began to catch on in the 1890s.  But the harmonograph never completely disappeared.  If you look on YouTube, you&#8217;ll find <a href="http://www.youtube.com/results?search_query=harmonograph">quite a number</a>.</p>
<h3> The harmonograph project </h3>
<p>Anita Chowdry got an M.A. from Central Saint Martin’s college of Art and Design.  That&#8217;s located near St. Pancras Station in London.</p>
<div align="center"><a href="https://www.flickr.com/photos/shamsa/8613630867/in/photostream/?rb=1"><img width="450" src="https://i0.wp.com/math.ucr.edu/home/baez/cultural/harmonograph/st_pancras_station.jpg" /></a></div>
<p>She built a harmonograph as part of her course work, and it worked well, but she wanted to make a more elegant, polished version.  Influenced by the Victorian engineering of St. Pancras Station, she decided that &#8220;steel would be the material of choice.&#8221;</p>
<p>So, starting in 2013, she began <a href="http://anitachowdry.wordpress.com/2013/06/24/designing-the-harmonograph-sculpture/">designing a steel harmonograph</a> with the help of her tutor Eleanor Crook and the engineering metalwork technician Ricky Lee Brawn.</p>
<div align="center"><a href="http://anitachowdry.wordpress.com/2013/06/24/designing-the-harmonograph-sculpture/"><img width="450" src="https://anitachowdry.files.wordpress.com/2013/06/small-harmo-2.jpg?w=450" /></a></div>
<p>Artist and technician David Stewart helped her make the steel parts.  <a href="http://anitachowdry.wordpress.com/2013/06/30/working-with-steel-in-the-metal-workshop/">Learning to work with steel</a> was a key part of this art project:</p>
<blockquote><p>
The first stage of making the steel harmonograph was to cut out and prepare all the structural components. In a sense, the process is a bit like tailoring&#8212;you measure and cut out all the pieces, and then put them together an a logical order, investing each stage with as much care and craftsmanship as you can muster. For the flat steel components I had <a href="https://en.wikipedia.org/wiki/Medium-density_fibreboard">medium-density fibreboard</a> forms cut on the college <a href="https://en.wikipedia.org/wiki/Numerical_control">numerical control machine</a>, which David Stewart used as patterns to plasma-cut the shapes out of mild carbon-steel. We had a total of fifteen flat pieces for the basal structure, which were to be welded to a large central cylinder.</p>
<p>My job was to ‘finish’ the plasma-cut pieces:  I refined the curves with an angle-grinder, drilled the holes that created the delicate openwork patterns, sanded everything to smooth the edges, then repeatedly heated and quenched each piece at the forge to darken and strengthen them. When Dave first placed the angle-grinder in my hands I was terrified&#8212;the sheer speed and power and noise of the monstrous thing connecting with the steel with a shower of sparks had a brutality and violence about it that I had never before experienced. But once I got used to the heightened energy of the process it became utterly enthralling. The grinder began to feel as fluent and expressive as a brush, and the steel felt responsive and alive. Like all metalwork processes, it demands a total, immersive concentration&#8212;you can get lost in it for hours!
</p></blockquote>
<p>Ricky Lee Brawn worked with her to <a href="http://anitachowdry.wordpress.com/2013/07/20/fabricating-the-harmonograph-detailing-in-brass/">make the brass parts</a>:</p>
<div align="center"><a href="http://anitachowdry.wordpress.com/2013/07/20/fabricating-the-harmonograph-detailing-in-brass/"><img width="400" src="https://i1.wp.com/math.ucr.edu/home/baez/cultural/harmonograph/ricky-brawn-at-lathe.jpg" /></a></div>
<p>Below you can see the brass piece he&#8217;s making, called a <a href="https://en.wikipedia.org/wiki/Finial">finial</a>, among the steel legs of the partially finished harmonograph:</p>
<div align="center"><a href="http://anitachowdry.wordpress.com/2013/06/30/working-with-steel-in-the-metal-workshop/"><img width="400" src="https://i0.wp.com/math.ucr.edu/home/baez/cultural/harmonograph/table-2-copy.jpg" /></a></div>
<p>There are three legs, each with three feet.</p>
<blockquote><p>
The groups of three look right, because I conceived the entire structure on the basis of the three pendulums working at angles of 60 degrees in relation to one another (forming an equilateral triangle)&#8212;so the magic number is three and its multiples.
</p></blockquote>
<p>With three pendulums you can generate more complicated generalizations of Lissajous curves.  In the language of music, three frequencies gives you a triplet!</p>
<p>Things become still more complex if we leave the linear regime, where motions are described by sines and cosines.   I don&#8217;t understand Anita Chowdry&#8217;s harmonograph well enough to know if nonlinearity plays a crucial role.  But it gives patterns like these:</p>
<div align="center"><a href="http://anitachowdry.wordpress.com/2013/06/30/working-with-steel-in-the-metal-workshop/"><img width="400" src="https://i1.wp.com/math.ucr.edu/home/baez/cultural/harmonograph/harmonograph_image_4.jpg" /></a></div>
<div align="center"><a href="http://anitachowdry.wordpress.com/2013/06/30/working-with-steel-in-the-metal-workshop/"><img width="400" src="https://i2.wp.com/math.ucr.edu/home/baez/cultural/harmonograph/harmonograph_image_7.jpg" /></a></div>
<p>Here is the completed harmonograph, called the &#8216;Iron Genie&#8217;, in action <a href="http://anitachowdry.wordpress.com/2014/01/11/filming-in-the-crypt/">in the crypt</a> of the St. Pancras Church:</p>
<span class="embed-youtube" style="text-align:center; display: block;"><iframe class="youtube-player" width="450" height="253" src="https://www.youtube.com/embed/Anl9R1MQlS0?version=3&#038;rel=1&#038;showsearch=0&#038;showinfo=1&#038;iv_load_policy=1&#038;fs=1&#038;hl=en&#038;autohide=2&#038;wmode=transparent" allowfullscreen="true" style="border:0;" sandbox="allow-scripts allow-same-origin allow-popups allow-presentation"></iframe></span>
<p>And now, I&#8217;m happy to say, it&#8217;s <a href="http://anitachowdry.wordpress.com/2014/07/11/iron-genie-at-the-museum-of-the-history-of-science-oxford/">on display</a> at the Museum of the History of Science, where we met in Oxford.  If you&#8217;re in the area, give it a look!  She&#8217;s giving free public talks about it at 3 pm on</p>
<p>&bull; Saturday July 19th<br />
&bull; Saturday August 16th<br />
&bull; Saturday September 20th</p>
<p>in 2014.  And if you can&#8217;t visit Oxford, you can still visit <a href="http://anitachowdry.wordpress.com/">her blog</a>!</p>
<div align="center"><a href="http://anitachowdry.wordpress.com/2014/07/11/iron-genie-at-the-museum-of-the-history-of-science-oxford/"><img width="440" src="https://i0.wp.com/math.ucr.edu/home/baez/cultural/harmonograph/harmonograph_in_history_of_science_museum_1.jpg" /></a></div>
<h3> The mathematics </h3>
<p>I think the mathematics of harmonographs deserves more thought.  The basic math required for this was developed by the Irish mathematician <a href="https://en.wikipedia.org/wiki/William_Rowan_Hamilton">William Rowan Hamilton</a> around 1834.  Hamilton was just the sort of character who would have enjoyed the harmonograph.  But other crucial ideas were contributed by Jacobi, Poincar&eacute; and many others.</p>
<p>In a simple &#8216;lateral&#8217; device, the position and velocity of the machine takes 4 numbers to describe: the two pendulum&#8217;s angles and angular velocities.  In the language of classical mechanics, the space of states of the harmonograph is a 4-dimensional <a href="https://en.wikipedia.org/wiki/Symplectic_manifold">symplectic manifold</a>, say <img src="https://s0.wp.com/latex.php?latex=X.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="X." class="latex" />  Ignoring friction, its motion is described by <a href="https://en.wikipedia.org/wiki/Hamiltonian_mechanics">Hamilton&#8217;s equations</a>.  These equations can give behavior ranging from <a href="https://en.wikipedia.org/wiki/Integrable_system#Hamiltonian_systems_and_Liouville_integrability">completely integrable</a> (as orderly as possible) to chaotic.</p>
<p>For small displacements our lateral harmonograph about the state of rest, I believe its behavior will be completely integrable.  If so, for any initial conditions, its motion will trace out a spiral on some 2-dimensional torus <img src="https://s0.wp.com/latex.php?latex=T&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T" class="latex" /> sitting inside <img src="https://s0.wp.com/latex.php?latex=X.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="X." class="latex" />  The position of pen on paper provides a map</p>
<p><img src="https://s0.wp.com/latex.php?latex=f+%3A+X+%5Cto+%5Cmathbb%7BR%7D%5E2&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="f : X &#92;to &#92;mathbb{R}^2" class="latex" /></p>
<p>and so the spiral is mapped to some curve on the paper!</p>
<p>We can ask what sort of curves can arise.  Lissajous curves are the simplest, but I don&#8217;t know what to say in general.  We might be able to understand their qualitative features without actually solving Hamilton&#8217;s equations.  For example, there are two points where the curves seem to &#8216;focus&#8217; here:</p>
<div align="center"><a href="http://anitachowdry.wordpress.com/2013/06/30/working-with-steel-in-the-metal-workshop/"><img width="400" src="https://i1.wp.com/math.ucr.edu/home/baez/cultural/harmonograph/harmonograph_image_7a.jpg" /></a></div>
<p>That&#8217;s the kind of thing mathematical physicists can try to understand, a bit like <a href="https://en.wikipedia.org/wiki/Caustic_%28optics%29">caustics</a> in optics.</p>
<p>If we have a &#8216;twin elliptic pendulum harmonograph&#8217;, the state space <img src="https://s0.wp.com/latex.php?latex=X&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="X" class="latex" /> becomes 8-dimensional, and <img src="https://s0.wp.com/latex.php?latex=T&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T" class="latex" /> becomes 4-dimensional if the system is completely integrable.  I don&#8217;t know the dimension of the state space for Anita Chowdry&#8217;s harmonograph, because I don&#8217;t know if her 3 pendulums can swing in just one direction each, or two!</p>
<p>But the big question is whether a given harmonograph is completely integrable&#8230; in which case the story I&#8217;m telling goes through&#8230; or whether it&#8217;s chaotic, in which case we should expect it to make very irregular pictures.  A <a href="https://en.wikipedia.org/wiki/Double_pendulum">double pendulum</a>&#8212;that is, a pendulum hanging on another pendulum&#8212;will be chaotic if it starts far enough from its point of rest.</p>
<p>Here is a chaotic &#8216;double compound pendulum&#8217;, meaning that it&#8217;s made of two rods:</p>
<div align="center"><a href="https://en.wikipedia.org/wiki/Double_pendulum#mediaviewer/File:Double-compound-pendulum.gif"><img src="https://i2.wp.com/math.ucr.edu/home/baez/cultural/harmonograph/double_compound_pendulum.gif" /></a></div>
<h3> Acknowledgements </h3>
<p>Almost all the pictures here were taken by Anita Chowdry, and I thank her for letting me use them.  The photo of her harmonograph in the Museum of the History of Science was taken by Keiko Ikeuchi, and the copyright for this belongs to the Museum of the History of Science, Oxford.  The video was made by Josh Jones.  The image of a Lissajous curve was made by Alessio Damato and put on Wikicommons with a <a href="https://commons.wikimedia.org/wiki/File:Lissajous_curve_3by4.svg">Creative Commons Attribution-Share Alike</a> license.  The double compound pendulum was made by Catslash and put on Wikicommons in the <a href="https://commons.wikimedia.org/wiki/File:Double-compound-pendulum.gif">public domain</a>.</p>
									</div>

				<p class="postmetadata">
				<img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/speech_bubble.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2014/07/18/the-harmonograph/#comments">37 Comments</a>				| <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/documents.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/category/art/" rel="category tag">art</a>								 | <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/permalink.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2014/07/18/the-harmonograph/" rel="bookmark" title="Permanent Link to The Harmonograph">Permalink</a>
<br /><img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/figure_ver1.gif" alt="" /> Posted by John Baez				</p>
			</div>
			<hr />
		
			<div class="post-18217 post type-post status-publish format-standard hentry category-climate category-software" id="post-18217">
				<h2><a href="https://johncarlosbaez.wordpress.com/2014/07/12/el-nino-project-part-5/" rel="bookmark">El Niño Project (Part&nbsp;5)</a></h2>
				<small>12 July, 2014</small><br />


				<div class="entry">
					<p>&nbsp;</p>
<div align="center">
<img width="450" src="https://lh6.googleusercontent.com/-l4tAc8oumTU/U6o8Ugy1DOI/AAAAAAAAwgY/ApsMCKE99pU/w653-h434-no/angry-programmer.jpg" />
</div>
<p>And now for some comic relief.</p>
<p><a href="https://johncarlosbaez.wordpress.com/2014/07/08/el-nino-project-part-4/">Last time</a> I explained how to download some weather data and start analyzing it, using programs written by <a href="http://www.azimuthproject.org/azimuth/show/Graham+Jones">Graham Jones</a>.  When you read that, did you think &#8220;Wow, that&#8217;s easy!&#8221;  Or did you think &#8220;Huh?  Run programs in R?  How am I supposed to do that?&#8221;</p>
<p>If you&#8217;re in the latter group, you&#8217;re like me.   But I managed to do it.  And this is the tale of how.  It&#8217;s a blow-by-blow account of my first steps, my blunders, my fears.  </p>
<p>I hope that if you&#8217;re intimidated by programming, my tale will prove that <i>you too</i> can do this stuff&#8230; provided you have smart friends, or read this article.  </p>
<p>More precisely, this article explains how to:</p>
<p>&bull; download and run software that runs the programming language R;</p>
<p>&bull; download temperature data from the National Center for Atmospheric Research;</p>
<p>&bull; use R to create a file of temperature data for a given latitude/longitude rectangle for a given time interval.</p>
<p>I will not attempt to explain how to program in R.</p>
<p>If you want to copy what I&#8217;m doing, please remember that a few details depend on the operating system.  Since I don&#8217;t care about operating systems, I use a Windows PC.  If you use something better, some details will differ for you.</p>
<p>Also: at the end of this article there are some very basic programming puzzles.  </p>
<h3> A sad history </h3>
<p>First, let me explain a bit about my relation to computers.</p>
<p>I first saw a computer at the Lawrence Hall of Science in Berkeley, back when I was visiting my uncle in the summer of 1978.  It was really cool!   They had some terminals where you could type programs in BASIC and run them.</p>
<p>I got especially excited when he gave me the book <a href="https://en.wikipedia.org/wiki/Computer_Lib/Dream_Machines"><i>Computer Lib/Dream Machines</i></a> by Ted Nelson.  It espoused the visionary idea that people could write texts on computers all around the world&#8212;&#8220;hypertexts&#8221; where you could click on a link in one and hop to another!  </p>
<p>I did more programming the next year in high school, sitting in a concrete block room with a teletype terminal that was connected to a mainframe somewhere far away.  I stored my programs on paper tape.   But my excitement gradually dwindled, because I was having more fun doing math and physics using just pencil and paper.  My own brain was more easy to program than the machine.   I did not start a computer company.  I did not get rich.  I learned quantum mechanics, and relativity, and G&ouml;del&#8217;s theorem.</p>
<p>Later I did some programming in APL in college, and still later I did a bit in Mathematica in the early 1990s&#8230; but nothing much, and nothing sophisticated.  Indeed, none of these languages would be the ones you&#8217;d choose to explore sophisticated ideas in computation!  </p>
<p>I&#8217;ve just never been very interested&#8230; until now.  I now want to do a lot of data analysis. It will be embarrassing to keep asking other people to do all of it for me.  I need to learn how to do it myself.   </p>
<p>Maybe you&#8217;d like to do this stuff too&mdash;or at least watch me make a fool of myself.  So here&#8217;s my tale, from the start.  </p>
<h3> Downloading and running R </h3>
<p>To use the programs written by Graham, I need to use <a href="https://en.wikipedia.org/wiki/R_%28programming_language%29">R</a>, a language currently popular among statisticians.  It is not the language my programmer friends would want me to learn&mdash;they&#8217;d want me to use something like Python.  But tough!  I can learn that later.</p>
<p>To download R to my Windows PC, I cleverly type <code>download R</code> into Google, and go to the top website it recommends:</p>
<p>&bull; <a href="http://cran.r-project.org/bin/windows/base/">http://cran.r-project.org/bin/windows/base/</a></p>
<p>I click the big fat button on top saying </p>
<p><code>Download R 3.1.0 for Windows</code></p>
<p>and get asked to save a file <code>R-3.1.0-win.exe</code>.  I save it in my Downloads folder; it takes a while to download since it was 57 megabytes.  When I get it, I click on it and follow the easy default installation instructions.  My Desktop window now has a little icon on it that says <code>R</code>.</p>
<p>Clicking this, I get an interface where I can type commands after a red </p>
<p><code>&gt;</code> </p>
<p>symbol.  Following Graham&#8217;s advice, I start by trying </p>
<p><code>&gt; 2^(1:8)</code></p>
<p>which generates a list of powers of 2 from 2<sup>1</sup> to 2<sup>8</sup>, like this:</p>
<p><code>[1]   2   4   8  16  32  64 128 256</code></p>
<p>Then I try</p>
<p><code>&gt; mean(2^(1:8))</code></p>
<p>which gives the arithmetic mean of this list.  Somewhat more fun is</p>
<p><code>&gt; plot(rnorm(20))</code></p>
<p>which plots a bunch of points, apparently 20 <a href="https://en.wikipedia.org/wiki/Standard_normal_deviate">standard normal deviates</a>.  </p>
<p>When I hear &#8220;20 standard normal deviates&#8221; I think of the members of a typical math department&#8230; but no, those are <i>deviants</i>.  Standard normal <i>deviates</i> are random numbers chosen from a Gaussian distribution of mean zero and variance 1.  </p>
<h3> Downloading climate data </h3>
<p>To do something more interesting, I need to input <i>data</i>.</p>
<p>The papers by Ludescher <i>et al</i> use surface air temperatures in a certain patch of the Pacific, so I want to get ahold of those. They&#8217;re here:</p>
<p>&bull; <a href="http://www.esrl.noaa.gov/psd/data/gridded/data.ncep.reanalysis.surface.html">NCEP/NCAR Reanalysis 1: Surface</a>.</p>
<p><b>NCEP</b> is the <a href="http://www.ncep.noaa.gov/">National Centers for Environmental Prediction</a>, and <b>NCAR</b> is the <a href="http://ncar.ucar.edu/">National Center for Atmospheric Research</a>.  They have a bunch of files <a href="http://www.esrl.noaa.gov/psd/cgi-bin/db_search/DBSearch.pl?Dataset=NCEP+Reanalysis+Daily+Averages+Surface+Level&amp;Variable=Air+Temperature&amp;group=0&amp;submit=Search">here</a> containing worldwide daily average temperatures on a 2.5 degree latitude &times; 2.5 degree longitude grid (that&#8217;s 144 &times;  73 grid points), from 1948 to 2010.  And if you go <a href="http://www.esrl.noaa.gov/psd/cgi-bin/DataAccess.pl?DB_dataset=NCEP+Reanalysis+Daily+Averages+Surface+Level&amp;DB_variable=Air+temperature&amp;DB_statistic=Mean&amp;DB_tid=41710&amp;DB_did=33&amp;DB_vid=668">here</a>, the website will help you get data from within a chosen rectangle in a grid, for a chosen time interval.</p>
<p>These are NetCDF files.  <b>NetCDF</b> stands for <a href="http://www.unidata.ucar.edu/software/netcdf/">Network Common Data Form</a>:</p>
<blockquote><p>
NetCDF is a set of software libraries and self-describing, machine-independent data formats that support the creation, access, and sharing of array-oriented scientific data.
</p></blockquote>
<p>According to my student Blake Pollard:</p>
<blockquote><p>
&#8230; the method of downloading a bunch of raw data via <b>ftp</b> (<a href="https://en.wikipedia.org/wiki/File_Transfer_Protocol">file transfer protocol</a>) is a great one to become familiar with. If you poke around on <a href="ftp://ftp.cdc.noaa.gov/Datasets/">ftp://ftp.cdc.noaa.gov/Datasets</a> or some other ftp servers maintained by government agencies you will find all the data you could ever want.  Examples of things you can download for free: raw multispectral satellite images, processed data products, &#8216;re-analysis&#8217; data (which is some way of combining analysis/simulation to assimilate data), sea surface temperature anomalies at resolutions much higher than 2.5 degrees (although you pay for that in file size). Also, believe it or not, people actually use NetCDF files quite widely, so once you know how to play around with those you&#8217;ll find the world quite literally at your fingertips!
</p></blockquote>
<p>I know about ftp: I&#8217;m so old that I know this was around before the web existed.  Back then it meant &#8220;faster than ponies&#8221;.  But I need to get R to accept data from these NetCDF files: that&#8217;s what scares me!</p>
<p>Graham said that R has a &#8220;package&#8221; called <a href="http://cran.r-project.org/web/packages/RNetCDF/index.html">RNetCDF</a> for using NetCDF files.  So, I need to get ahold of this package, download some files in the NetCDF format, and somehow get R to eat those files with the help of this package.  </p>
<p>At first I was utterly clueless!  However, after a bit of messing around, I notice that right on top of the R interface there&#8217;s a menu item called <code>Packages</code>.  I boldly click on this and choose <code>Install Package(s)</code>.  </p>
<p>I am rewarded with an enormous alphabetically ordered list of packages&#8230; obviously statisticians have lots of stuff they like to do over and over!  I find <code>RNetCDF</code>, click on that and click something like &#8220;OK&#8221;.</p>
<p>I&#8217;m asked if I want to use a &#8220;personal library&#8221;.  I click &#8220;no&#8221;, and get an error message.  So I click &#8220;yes&#8221;.  The computer barfs out some promising text:</p>
<p><code>utils:::menuInstallPkgs()<br />
trying URL 'http://cran.stat.nus.edu.sg/bin/windows/contrib/3.1/RNetCDF_1.6.2-3.zip'<br />
Content type 'application/zip' length 548584 bytes (535 Kb)<br />
opened URL<br />
downloaded 535 Kb</p>
<p>package ‘RNetCDF’ successfully unpacked and MD5 sums checked</p>
<p>The downloaded binary packages are in<br />
        C:\Users\JOHN\AppData\Local\Temp\Rtmp4qJ2h8\downloaded_packages</code></p>
<p>Success!  <img src="https://i2.wp.com/math.ucr.edu/home/baez/emoticons/celebrating.gif" alt="" /></p>
<p>But now I need to figure out how to download a file and get R to eat it and digest it with the help of <code>RNetCDF</code>.</p>
<p>At this point my <i>deus ex machina</i>, Graham, descends from the clouds and says:</p>
<blockquote><p>
You can download the files from your browser. It is probably easiest to do that for starters. Put<br />
<code>ftp://ftp.cdc.noaa.gov/Datasets/ncep.reanalysis.dailyavgs/surface/</code><br />
into the browser, then right-click a file and Save link as&#8230;</p>
<p>This code will download a bunch of them:<br />
<code><br />
for (year in 1950:1979) {<br />
  download.file(url=paste0("ftp://ftp.cdc.noaa.gov/Datasets/ncep.reanalysis.dailyavgs/surface/air.sig995.", year, ".nc"), destfile=paste0("air.sig995.", year, ".nc"), mode="wb")<br />
  }<br />
</code></p>
<p>It will put them into the &#8220;working directory&#8221;, probably <code>C:\Users\JOHN\Documents</code>. You can find the working directory using <code>getwd()</code>, and change it with <code>setwd()</code>. But you must use / not \ in the filepath.
</p></blockquote>
<p>Compared to UNIX, the Windows operating system has the peculiarity of using \ instead of / in <a href="https://en.wikipedia.org/wiki/Path_%28computing%29#Representations_of_paths_by_operating_system_and_shell">path names</a>, but R uses the UNIX conventions even on Windows.   </p>
<p>So, after some mistakes, in the R interface I type</p>
<p><code>&gt; setwd("C:/Users/JOHN/Documents/My Backups/azimuth/el nino")</code></p>
<p>and then type</p>
<p><code>&gt; getwd()</code></p>
<p>to see if I&#8217;ve succeeded.  I&#8217;m rewarded with </p>
<p><code>[1] "C:/Users/JOHN/Documents/My Backups/azimuth/el nino"</code></p>
<p>Good!  </p>
<p>Then, following Graham&#8217;s advice, I cut-and-paste this into the R interface:</p>
<p><code>for (year in 1950:1979) {<br />
  download.file(url=paste0("ftp://ftp.cdc.noaa.gov/Datasets/ncep.reanalysis.dailyavgs/surface/air.sig995.", year, ".nc"), destfile=paste0("air.sig995.", year, ".nc"), mode="wb")<br />
  }</code></p>
<p>It seems to be working!   A little bar appears showing how each year&#8217;s data is getting downloaded.  It chugs away, taking a couple minutes for each year’s worth of data.</p>
<h3> Using R to process NetCDF files </h3>
<p>Okay, now I&#8217;ve got all the worldwide daily average temperatures on a 2.5 degree latitude × 2.5 degree longitude grid from 1950 to 1970.  </p>
<p><i>The world is MINE!</i>  <img src="https://i1.wp.com/math.ucr.edu/home/baez/emoticons/boing.gif" /></p>
<p>But what do I do with it?  Graham&#8217;s advice is again essential, along with a little R program, or <b>script</b>, that he wrote:</p>
<blockquote><p>
The R script <code>netcdf-convertor.R</code> from</p>
<p><a href="https://github.com/azimuth-project/el-nino/tree/master/R">https://github.com/azimuth-project/el-nino/tree/master/R</a></p>
<p>will eat the file, digest it, and spit it out again. It contains instructions.
</p></blockquote>
<p>I go to this URL, which is on <a href="https://en.wikipedia.org/wiki/GitHub">GitHub</a>, a popular free web-based service for software development.  You can store programs here, edit them, and GitHub will help you keep track of the different versions.  I know almost nothing about this stuff, but I&#8217;ve seen it before, so I&#8217;m not intimidated.</p>
<p>I click on the blue thing that says <code>netcdf-convertor.R</code> and see something that looks like the right script.  Unfortunately I can&#8217;t see how to download it!  I eventually see a button I&#8217;d overlooked, cryptically labelled “Raw”.  I realize that since I don&#8217;t want a roasted or oven-broiled piece of software, I should click on this.  I indeed succeed in downloading <code>netcdf-convertor.R</code> this way.   Graham later says I could have done something better, but oh well.  I&#8217;m just happy nothing has actually exploded yet.</p>
<p>Once I&#8217;ve downloaded this script, I open it using an text processor and look at it.  At top are a bunch of comments written by Graham:</p>
<p><code><br />
######################################################<br />
######################################################</p>
<p># You should be able to use this by editing this<br />
# section only.</p>
<p>setwd("C:/Users/Work/AAA/Programming/ProgramOutput/Nino")</p>
<p>lat.range &lt;- 13:14<br />
lon.range &lt;- 142:143</p>
<p>firstyear &lt;- 1957<br />
lastyear &lt;- 1958</p>
<p>outputfilename &lt;- paste0(&quot;Scotland-&quot;, firstyear, &quot;-&quot;, lastyear, &quot;.txt&quot;)</p>
<p>######################################################<br />
######################################################</p>
<p>#                  Explanation</p>
<p># 1. Use setwd() to set the working directory<br />
# to the one containing the .nc files such as<br />
# air.sig995.1951.nc.<br />
# Example:<br />
# setwd(&quot;C:/Users/Work/AAA/Programming/ProgramOutput/Nino&quot;)</p>
<p># 2. Supply the latitude and longitude range.  The<br />
# NOAA data is every 2.5 degrees. The ranges are<br />
# supplied as the number of steps of this size.<br />
# For latitude, 1 means North Pole, 73 means South<br />
# Pole. For longitude, 1 means 0 degrees East, 37<br />
# is 90E, 73 is 180, 109 is 90W or 270E, 144 is<br />
# 2.5W.</p>
<p># These roughly cover Scotland.<br />
# lat.range &lt;- 13:14<br />
# lon.range &lt;- 142:143</p>
<p># These are the area used by Ludescher et al,<br />
# 2013. It is 27x69 points which are then<br />
# subsampled to 9 by 23.<br />
# lat.range &lt;- 24:50<br />
# lon.range &lt;- 48:116 </p>
<p># 3. Supply the years<br />
# firstyear &lt;- 1950<br />
# lastyear &lt;- 1952</p>
<p># 4. Supply the output name as a text string.<br />
# paste0() concatenates strings which you may find<br />
# handy:<br />
# outputfilename &lt;- paste0(&quot;Pacific-&quot;, firstyear, &quot;-&quot;, lastyear, &quot;.txt&quot;)</p>
<p>######################################################<br />
######################################################</p>
<p>#            Example of output</p>
<p>#  S013E142 S013E143 S014E142 S014E143<br />
#  Y1950P001 281.60000272654 281.570002727211 281.60000272654 280.970002740622<br />
#  Y1950P002 280.740002745762 280.270002756268 281.070002738386 280.49000275135<br />
#  Y1950P003 280.100002760068 278.820002788678 281.120002737269 280.070002760738<br />
#  Y1950P004 281.070002738386 279.420002775267 281.620002726093 280.640002747998<br />
#  ...<br />
#  Y1950P193 285.450002640486 285.290002644062 285.720002634451 285.75000263378<br />
#  Y1950P194 285.570002637804 285.640002636239 286.070002626628 286.570002615452<br />
#  Y1950P195 285.92000262998 286.220002623275 286.200002623722 286.620002614334<br />
#  ...<br />
#  Y1950P364 276.100002849475 275.350002866238 276.37000284344 275.200002869591<br />
#  Y1950P365 276.990002829581 275.820002855733 276.020002851263 274.72000288032<br />
#  Y1951P001 278.220002802089 277.470002818853 276.700002836064 275.870002854615<br />
#  Y1951P002 277.750002812594 276.890002831817 276.650002837181 275.520002862439<br />
#  ...<br />
#  Y1952P365 280.35000275448 280.120002759621 280.370002754033 279.390002775937</p>
<p># There is one row for each day, and 365 days in<br />
# each year (leap days are omitted). In each row,<br />
# you have temperatures in Kelvin for each grid<br />
# point in a rectangle.</p>
<p># S13E142 means 13 steps South from the North Pole<br />
# and 142 steps East from Greenwich. The points<br />
# are in reading order, starting at the top-left<br />
# (Northmost, Westmost) and going along the top<br />
# row first.</p>
<p># Y1950P001 means year 1950, day 1. (P because<br />
# longer periods might be used later.)</p>
<p>######################################################<br />
######################################################<br />
</code></p>
<p>The instructions are admirably detailed concerning what I should do, but they don&#039;t say where the output will appear when I do it.   This makes me nervous.  I guess I should just try it.  After all, the program is not called DestroyTheWorld.</p>
<p>Unfortunately, at this point a lot of things start acting weird.  </p>
<p>It&#039;s too complicated and boring to explain in detail, but basically, I keep getting a <code>file missing</code> error message.  I don&#039;t understand why this happens under some conditions and not others.  I try lots of experiments.  </p>
<p>Eventually I discover that one year of temperature data failed to download&mdash;the year 1949, right after the first year available!  So, I&#039;m getting the error message whenever I try to do anything involving that year of data.</p>
<p>To fix the problem, I simply download the 1949 data by hand from here:</p>
<p>&bull; <a href="ftp://ftp.cdc.noaa.gov/Datasets/ncep.reanalysis.dailyavgs/surface/"> ftp://ftp.cdc.noaa.gov/Datasets/ncep.reanalysis.dailyavgs/surface/</a></p>
<p>(You can open ftp addresses in a web browser just like http addresses.)  I put it in my working directory for R, and everything is fine again.  Whew!</p>
<p>By the time things I get this file, I sort of know what to do&mdash;after all, I&#039;ve spent about an hour trying lots of different things.   </p>
<p>I decide to create a file listing temperatures near where I live in Riverside from 1948 to 1979.  To do this, I open Graham&#039;s script  <code>netcdf-convertor.R</code> in a word processor and change this section:<br />
<code><br />
setwd(&quot;C:/Users/Work/AAA/Programming/ProgramOutput/Nino&quot;)<br />
lat.range &lt;- 13:14<br />
lon.range &lt;- 142:143<br />
firstyear &lt;- 1957<br />
lastyear &lt;- 1958<br />
outputfilename &lt;- paste0(&quot;Scotland-&quot;, firstyear, &quot;-&quot;, lastyear, &quot;.txt&quot;)<br />
</code></p>
<p>to this:<br />
<code><br />
setwd(&quot;C:/Users/JOHN/Documents/My Backups/azimuth/el nino&quot;)<br />
lat.range &lt;- 23:23<br />
lon.range &lt;- 98:98<br />
firstyear &lt;- 1948<br />
lastyear &lt;- 1979<br />
outputfilename &lt;- paste0(&quot;Riverside-&quot;, firstyear, &quot;-&quot;, lastyear, &quot;.txt&quot;)<br />
</code></p>
<p>Why?  Well, I want it to put the file in my working directory.  I want the years from 1948 to 1979.  And I want temperature data from where I live!  </p>
<p>Googling the info, I see Riverside, California is at 33.9481° N, 117.3961° W.  34&deg; N is about 56 degrees south of the North Pole, which is 22 steps of size 2.5°. And because some idiot decided everyone should count starting at 1 instead of 0 even in contexts like this, the North Pole itself is step 1, not step 0&#8230; so Riverside is latitude step 23. That&#039;s why I write:</p>
<p><code>lat.range &lt;- 23:23</code></p>
<p>Similarly, 117.5° W is 242.5° E, which is 97 steps of size 2.5°&#8230; which counts as step 98 according to this braindead system.  That&#039;s why I write:</p>
<p><code>lon.range &lt;- 98:98</code></p>
<p>Having done this, I save the file <code>netcdf-convertor.R</code> under another name, <code>Riverside.R</code>.  </p>
<p>And then I do some stuff that it took some fiddling around to discover.</p>
<p>First, in my R interface I go to the menu item <code>File</code>, at far left, and click on <code>Open script</code>.   It lets me browse around, so I go to my working directory for R and choose <code>Riverside.R</code>.  A little window called <code>R editor</code> opens up in my R interface, containing this script.</p>
<p>I&#039;m probably not doing this optimally, but I can now right-click on the R editor and see a menu with a choice called <code>Select all</code>.  If I click this, everything in the window turns blue.  Then I can right-click again and choose <code>Run line or selection</code>.  And the script runs!</p>
<p><i>Voil&agrave;!</i></p>
<p>It huffs and puffs, and then stops.  I peek in my working directory, and see that a file called</p>
<p><code>Riverside.1948-1979.txt</code></p>
<p>has been created.  When I open it, it has lots of lines, starting with these:<br />
<code><br />
S023E098<br />
Y1948P001 279.95<br />
Y1948P002 280.14<br />
Y1948P003 282.27<br />
Y1948P004 283.97<br />
Y1948P005 284.27<br />
Y1948P006 286.97<br />
</code></p>
<p>As Graham promised, each line has a year and day label, followed by a vector&#8230; which in my case is just a single number, since I only wanted the temperature in one location.  I&#8217;m hoping this is the temperature near Riverside, in kelvin.</p>
<h3> A small experiment </h3>
<p>To see if this is working, I&#8217;d like to plot these temperatures and see if they make sense.  Unfortunately I have no idea how to get R to take a file containing data of the sort I have and plot it!   I need to learn how, but right now I&#8217;m exhausted, so  I use another method to get the job done&mdash; a method that&#8217;s too suboptimal and embarrassing to describe here.  (Hint: it involves the word &#8220;Excel&#8221;.)</p>
<p>I do a few things, but here&#8217;s the most interesting one&#8212;namely, not very interesting.  I plot the temperatures for 1963:</p>
<div align="center">
<a href="http://math.ucr.edu/home/baez/ecological/riverside_temperature_1963.jpg"><br />
<img width="450" src="https://i0.wp.com/math.ucr.edu/home/baez/ecological/riverside_temperature_1963.jpg" /></a>
</div>
<p>I compare it to some publicly available data, not from Riverside, but from nearby Los Angeles:</p>
<div align="center">
<a href="http://weatherspark.com/history/30699/1963/Los-Angeles-California-United-States"><br />
<img width="450" src="https://i2.wp.com/fs.weatherspark.com.s3.amazonaws.com/production/reports/history/year/000/030/699/1963/temperature_temperature_f.png" alt="" /></a>
</div>
<p>As you can see, there was a cold day on January 13th, when the temperature dropped to 33&deg;F.  That seems to be visible on the graph I made, and looking at the data from which I made the graph, I see the temperature dropped to 251.4 kelvin on the 13th: that&#8217;s -7&deg;F, very cold for here.  It <i>does</i> get colder around Riverside than in Los Angeles in the winter, since it&#8217;s a desert, with temperatures not buffered by the ocean.  So, this <i>does</i> seem compatible with the public records.  That&#8217;s mildly reassuring.</p>
<p>But other features of the graph don&#8217;t match, and I&#8217;m not quite sure if they should or not.  So, all this very tentative and unimpressive.  However, I&#8217;ve managed to  get over some of my worst fears, download some temperature data, and graph it! Now I need to learn how to use R to do statistics with this data, and graph it in a better way.</p>
<h3> Puzzles </h3>
<p>You can help me out by answering these puzzles.  Later I might pose puzzles where you can help us write really interesting programs.  But for now it&#8217;s just about learning R.</p>
<p><b>Puzzle 1.</b>  Given a text file with lots of lines of this form:<br />
<code><br />
S023E098<br />
Y1948P001 279.95<br />
Y1948P002 280.14<br />
Y1948P003 282.27<br />
Y1948P004 283.97<br />
</code></p>
<p>write an R program that creates a huge vector, or list of numbers, like this:<br />
<code><br />
279.95, 280.14, 282.27, 283.97, ...<br />
</code></p>
<p><b>Puzzle 2:</b> Extend the above program so that it plots this list of numbers, or outputs it to a new file.</p>
<p>If you want to test your programs, here&#8217;s the actual file: </p>
<p>&bull; <a href="http://math.ucr.edu/home/baez/ecological/el_nino/Riverside-1948-1979.txt">Riverside-1948-1979.txt</a></p>
<h3> More puzzles </h3>
<p>If those puzzles are too easy, here are two more.  I gave these last time, but everyone was too wimpy to tackle them.</p>
<p><b>Puzzle 3.</b>  Modify the software so that it uses the same method to predict El Ni&ntilde;os from 1980 to 2013.  You&#8217;ll have to adjust two lines in <code>netcdf-convertor-ludescher.R</code>:</p>
<pre>
firstyear &lt;- 1948
lastyear &lt;- 1980
</pre>
<p>should become</p>
<pre>
firstyear &lt;- 1980
lastyear &lt;- 2013
</pre>
<p>or whatever range of years you want.  You&#8217;ll also have to adjust names of years in <code>ludescher-replication.R</code>.  Search the file for the string <code>19</code> and make the necessary changes.  Ask me if you get stuck.</p>
<p><b>Puzzle 4.</b> Right now we average the link strength over all pairs <img src="https://s0.wp.com/latex.php?latex=%28i%2Cj%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(i,j)" class="latex" /> where <img src="https://s0.wp.com/latex.php?latex=i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i" class="latex" /> is a node in the <b>El Ni&ntilde;o basin</b> defined by Ludescher <i>et al</i> and <img src="https://s0.wp.com/latex.php?latex=j&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="j" class="latex" /> is a node outside this basin.  The basin consists of the red dots here:</p>
<div align="center"><a href="http://math.ucr.edu/home/baez/ecological/el_nino/ludescher_el_nino_cooperativity_1.jpg"><br />
<img width="450" src="https://i2.wp.com/math.ucr.edu/home/baez/ecological/el_nino/ludescher_el_nino_cooperativity_1a.jpg" /></a>
</div>
<p>What happens if you change the definition of the El Ni&ntilde;o basin?  For example, can you drop those annoying two red dots that are south of the rest, without messing things up?  <i>Can you get better results if you change the shape of the basin?</i></p>
<p>To study these questions you need to rewrite <code>ludescher-replication.R</code> a bit.  Here&#8217;s where Graham defines the El Ni&ntilde;o basin:</p>
<pre>
ludescher.basin &lt;- function() {
  lats &lt;- c( 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6)
  lons &lt;- c(11,12,13,14,15,16,17,18,19,20,21,22,16,22)
  stopifnot(length(lats) == length(lons))
  list(lats=lats,lons=lons)
}
</pre>
<p>These are lists of latitude and longitude coordinates: (5,11), (5,12), (5,13), etc.  A coordinate like (5,11) means the little circle that&#8217;s 5 down and 11 across in the grid on the above map.  So, that&#8217;s the leftmost point in Ludescher&#8217;s El Ni&ntilde;o basin.  By changing these lists, you can change the definition of the El Ni&ntilde;o basin.  </p>
<p>Next time I&#8217;ll discuss some criticisms of Ludescher <i>et al&#8217;</i>s paper, but later we will return to analyzing temperature data, looking for interesting patterns.</p>
									</div>

				<p class="postmetadata">
				<img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/speech_bubble.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2014/07/12/el-nino-project-part-5/#comments">41 Comments</a>				| <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/documents.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/category/climate/" rel="category tag">climate</a>, <a href="https://johncarlosbaez.wordpress.com/category/software/" rel="category tag">software</a>								 | <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/permalink.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2014/07/12/el-nino-project-part-5/" rel="bookmark" title="Permanent Link to El Niño Project (Part&nbsp;5)">Permalink</a>
<br /><img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/figure_ver1.gif" alt="" /> Posted by John Baez				</p>
			</div>
			<hr />
		
			<div class="post-18316 post type-post status-publish format-standard hentry category-climate" id="post-18316">
				<h2><a href="https://johncarlosbaez.wordpress.com/2014/07/08/el-nino-project-part-4/" rel="bookmark">El Niño Project (Part&nbsp;4)</a></h2>
				<small>8 July, 2014</small><br />


				<div class="entry">
					<p>As the first big step in our El Niño prediction project, Graham Jones replicated the paper by Ludescher <i>et al</i> that I explained <a href="https://johncarlosbaez.wordpress.com/2014/07/01/el-nino-project-part-3/">last time</a>. Let&#8217;s see how this works!</p>
<p>Graham did it using <a href="https://en.wikipedia.org/wiki/R_%28programming_language%29">R</a>, a programming language that&#8217;s good for statistics. If you prefer another language, go ahead and write software for that&#8230; and let us know! We can add it to our repository.</p>
<p>Today I&#8217;ll explain this stuff to people who know their way around computers. But I&#8217;m not one of those people! So, next time I&#8217;ll explain the nitty-gritty details in a way that may be helpful to people more like me.</p>
<h3>Getting temperature data</h3>
<p>Say you want to predict El Niños from 1950 to 1980 using Ludescher <i>et al&#8217;</i>s method. To do this, you need daily average surface air temperatures in this grid in the Pacific Ocean:</p>
<div align="center"><a href="http://math.ucr.edu/home/baez/ecological/el_nino/ludescher_el_nino_cooperativity_1.jpg"><img src="https://i2.wp.com/math.ucr.edu/home/baez/ecological/el_nino/ludescher_el_nino_cooperativity_1a.jpg" alt="" width="450" /></a></div>
<p>Each square here is 7.5° × 7.5°. To compute these temperatures, you have to start with temperatures on a grid with smaller squares that are 2.5° × 2.5° in size:</p>
<p>• Earth System Research Laboratory, <a href="http://www.esrl.noaa.gov/psd/cgi-bin/db_search/DBSearch.pl?Dataset=NCEP+Reanalysis+Daily+Averages+Surface+Level&amp;Variable=Air+Temperature&amp;group=0&amp;submit=Search">NCEP Reanalysis Daily Averages Surface Level</a>, or <a href="ftp://ftp.cdc.noaa.gov/Datasets/ncep.reanalysis.dailyavgs/surface/">ftp site</a>.</p>
<p>This website will give you daily average surface air temperatures in whatever rectangle and time interval you want. It delivers this data in a format called <b>NetCDF</b>, meaning <a href="http://www.unidata.ucar.edu/software/netcdf/">Network Common Data Form</a>.</p>
<p>We&#8217;ll take a different approach. We&#8217;ll download <i>all</i> the temperatures in this database, and then extract the data we need using R scripts. That way, when we play other games with temperature data later, we&#8217;ll already have it.</p>
<p>So, go ahead and download all the files from <code>air.sig995. 1948.nc</code> to <code>air.sig995.2013.nc</code>. It will take a while&#8230; but you&#8217;ll own the world.</p>
<p>There are different ways to do this. If you have R fired up, just cut-and-paste this into the console:</p>
<pre>for (year in 1950:1979) { 
  download.file(url=paste0(
  "ftp://ftp.cdc.noaa.gov/Datasets/ncep.reanalysis.dailyavgs/surface/air.sig995.", 
  year, ".nc"), 
  destfile=paste0("air.sig995.", year, ".nc"), mode="wb") 
  }
</pre>
<h3>Getting the temperatures you need</h3>
<p>Now you have files of daily average temperatures on a 2.5° by 2.5° grid from 1948 to 2013. Make sure all these files are in your working directory for R, and download this R script from GitHub:</p>
<p>• <a href="https://github.com/johncarlosbaez/el-nino/blob/master/R/netcdf-convertor-ludescher.R">netcdf-convertor-ludescher.R</a></p>
<p>You can use this to get the temperatures in any time interval and any rectangle of grid points you want. The details are explained in the script. But the defaults are set to precisely what you need now!</p>
<p>So, just run this script. You should get a file called <code>Pacific-1948-1980.txt</code>. This has daily average temperatures in the region we care about, from 1948 to 1980. It should start with a really long line listing locations in a 27 × 69 grid, starting with S024E48 and ending with S248E116. I&#8217;ll explain this coordinate scheme at the end of this post. Then come hundreds of lines listing temperatures in kelvin at those locations on successive days. The first of these lines should start with Y1948P001, meaning the first day of 1948.</p>
<p>And I know what you&#8217;re dying to ask: yes, leap days are omitted! This annoys the perfectionist in me&#8230; but leap years make data analysis more complicated, so Ludescher <i>et al</i> ignore leap days, and we will too.</p>
<h3>Getting the El Niño data</h3>
<p>You&#8217;ll use this data to predict El Niños, so you also want a file of the <b>Niño 3.4</b> index. Remember from last time, this says how much hotter the surface of this patch of seawater is than usual for this time of year:</p>
<div align="center"><a href="http://www.bom.gov.au/climate/enso/indices/about.shtml"><br /> <img src="https://i0.wp.com/math.ucr.edu/home/baez/ecological/el_nino/nino_3.4_region.gif" alt="" width="450" /><br /> </a></div>
<p>You can download the file from here:</p>
<p>• <a href="https://github.com/johncarlosbaez/el-nino/blob/master/R/nino3.4-anoms.txt"><code>nino3.4-anoms.txt</code></a></p>
<p>This is a copy of the <a href="http://www.cpc.noaa.gov/products/analysis_monitoring/ensostuff/detrend.nino34.ascii.txt">monthly Niño 3.4 index</a> from the US National Weather Service, which I discussed last time. It has monthly Niño 3.4 data in the column called <code>ANOM</code>.</p>
<p>Put this file in your working directory.</p>
<h3>Predicting El Niños</h3>
<p>Now for the cool part. <a href="https://johncarlosbaez.wordpress.com/2014/07/01/el-nino-project-part-3/">Last time</a> I explained the `average link strength&#8217;, which Ludescher <i>et al</i> use to predict El Niños. Now you&#8217;ll compute it.</p>
<p>You&#8217;ve got <code>Pacific-1948-1980.txt</code> and <code>nino3.4-anoms.txt</code> in your working directory. Download this R script written by Graham Jones, and run it:</p>
<p>• <a href="https://github.com/johncarlosbaez/el-nino/blob/master/R/ludescher-replication.R"><code>ludescher-replication.R</code></a></p>
<p>It takes about 45 minutes on my laptop. It computes the average link strength <img src="https://s0.wp.com/latex.php?latex=S&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S" class="latex" /> at ten-day intervals. Then it plots <img src="https://s0.wp.com/latex.php?latex=S&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S" class="latex" /> in red and the Niño 3.4 index in blue, like this:</p>
<div align="center"><a href="http://math.ucr.edu/home/baez/ecological/el_nino/ludescher_replication.jpg"><br /> <img src="https://i2.wp.com/math.ucr.edu/home/baez/ecological/el_nino/ludescher_replication_small.jpg" alt="" width="450" /></a></div>
<p>(Click to enlarge.) The shaded region is where the Niño 3.4 index is below 0.5°C. When the blue curve escapes this region and then stays above 0.5°C for at least 5 months, Ludescher <i>et al</i> say that there&#8217;s an El Niño.</p>
<p>The horizontal red line shows the threshold <img src="https://s0.wp.com/latex.php?latex=%5Ctheta+%3D+2.82.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;theta = 2.82." class="latex" /> When <img src="https://s0.wp.com/latex.php?latex=S&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S" class="latex" /> exceeds this, and the Niño 3.4 index is not <i>already</i> over 0.5°C, Ludescher <i>et al</i> predict that there will be an El Niño in the next calendar year!</p>
<p>Our graph almost agrees with theirs:</p>
<div align="center"><a href="http://math.ucr.edu/home/baez/ecological/el_nino/ludescher_el_nino_cooperativity_2b.jpg"><br /> <img src="https://i0.wp.com/math.ucr.edu/home/baez/ecological/el_nino/ludescher_el_nino_cooperativity_2b.jpg" alt="" width="450" /></a></div>
<p>Here the green arrows show their successful predictions, dashed arrows show false alarms, and a little letter n appears next to each El Niño they failed to predict.</p>
<p>The graphs don&#8217;t match perfectly. For the blue curves, we could be using Niño 3.4 from different sources. Differences in the red curves are more interesting, since that&#8217;s where all the work is involved, and we&#8217;re starting with the same data. Besides actual bugs, which are always possible, I can think of various explanations. None of them are extremely interesting, so I&#8217;ll stick them in the last section!</p>
<p>If you want to get ahold of our output, you can do so here:</p>
<p>• <a href="https://github.com/johncarlosbaez/el-nino/blob/master/R/average-link-strength.txt"><code>average-link-strength.txt</code></a></p>
<p>This has the average link strength <img src="https://s0.wp.com/latex.php?latex=S&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S" class="latex" /> at 10-day intervals, starting from day 730 and going until day 12040, where day 1 is the first of January 1948.</p>
<p>So, you don&#8217;t actually have to run all these programs to get our final result. However, these programs will help you tackle some programming challenges which I&#8217;ll list now!</p>
<h3>Programming challenges</h3>
<p>There are lots of variations on the Ludescher <i>et al</i> paper which we could explore. Here are a few easy ones to get you started. If you do any of these, or anything else, let me know!</p>
<p>I&#8217;ll start with a really easy one, and work on up.</p>
<p><b>Challenge 1.</b> Repeat the calculation with temperature data from 1980 to 2013. You&#8217;ll have to adjust two lines in <code>netcdf-convertor-ludescher.R</code>:</p>
<pre>firstyear &lt;- 1948
lastyear &lt;- 1980
</pre>
<p>should become</p>
<pre>firstyear &lt;- 1980
lastyear &lt;- 2013
</pre>
<p>or whatever range of years you want. You&#8217;ll also have to adjust names of years in <code>ludescher-replication.R</code>. Search the file for the string <code>19</code> and make the necessary changes. Ask me if you get stuck.</p>
<p><b>Challenge 2.</b> Repeat the calculation with temperature data on a 2.5° × 2.5° grid instead of the coarser 7.5° × 7.5° grid Ludescher <i>et al</i> use. You&#8217;ve got the data you need. Right now, the program <code>ludescher-replication.R</code> averages out the temperatures over little 3 × 3 squares. It starts with temperatures on a 27 × 69 grid and averages them out to obtain temperatures on the 9 × 23 grid shown here:</p>
<div align="center"><a href="http://math.ucr.edu/home/baez/ecological/el_nino/ludescher_el_nino_cooperativity_1.jpg"><br /> <img src="https://i2.wp.com/math.ucr.edu/home/baez/ecological/el_nino/ludescher_el_nino_cooperativity_1a.jpg" alt="" width="250" /></a></div>
<p>Here&#8217;s where that happens:</p>
<pre># the data per day is reduced from e.g. 27x69 to 9x23. 

subsample.3x3 &lt;- function(vals) {
  stopifnot(dim(vals)[2] %% 3 == 0)
  stopifnot(dim(vals)[3] %% 3 == 0)
  n.sslats &lt;- dim(vals)[2]/3
  n.sslons &lt;- dim(vals)[3]/3
  ssvals &lt;- array(0, dim=c(dim(vals)[1], n.sslats, n.sslons))  
  for (d in 1:dim(vals)[1]) {
    for (slat in 1:n.sslats) {
      for (slon in 1:n.sslons) {
        ssvals[d, slat, slon] &lt;- mean(vals[d, (3*slat-2):(3*slat), (3*slon-2):(3*slon)])
      }
    }
  }
  ssvals
}
</pre>
<p>So, you need to eliminate this and change whatever else needs to be changed. What new value of the threshold <img src="https://s0.wp.com/latex.php?latex=%5Ctheta&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;theta" class="latex" /> looks good for predicting El Niños now? Most importantly: <i>can you get better at predicting El El Niños this way?</i></p>
<p>The calculation may take a lot longer, since you&#8217;ve got 9 times as many grid points and you&#8217;re calculating correlations between pairs. So if this is too tough, you can go the other way: use a coarser grid and see how much that <i>degrades</i> your ability to predict El Niños.</p>
<p><b>Challenge 3.</b> Right now we average the link strength over all pairs <img src="https://s0.wp.com/latex.php?latex=%28i%2Cj%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(i,j)" class="latex" /> where <img src="https://s0.wp.com/latex.php?latex=i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i" class="latex" /> is a node in the <b>El Niño basin</b> defined by Ludescher <i>et al</i> and <img src="https://s0.wp.com/latex.php?latex=j&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="j" class="latex" /> is a node outside this basin. The basin consists of the red dots here:</p>
<div align="center"><a href="http://math.ucr.edu/home/baez/ecological/el_nino/ludescher_el_nino_cooperativity_1.jpg"><br /> <img src="https://i2.wp.com/math.ucr.edu/home/baez/ecological/el_nino/ludescher_el_nino_cooperativity_1a.jpg" alt="" width="450" /></a></div>
<p>What happens if you change the definition of the El Niño basin? For example, can you drop those annoying two red dots that are south of the rest, without messing things up? <i>Can you get better results if you change the shape of the basin?</i></p>
<p>To study these questions you need to rewrite <code>ludescher-replication.R</code> a bit. Here&#8217;s where Graham defines the El Niño basin:</p>
<pre>ludescher.basin &lt;- function() {
  lats &lt;- c( 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6)
  lons &lt;- c(11,12,13,14,15,16,17,18,19,20,21,22,16,22)
  stopifnot(length(lats) == length(lons))
  list(lats=lats,lons=lons)
}
</pre>
<p>These are lists of latitude and longitude coordinates: (5,11), (5,12), (5,13), etc. A coordinate like (5,11) means the little circle that&#8217;s 5 down and 11 across in the grid on the above map. So, that&#8217;s the leftmost point in Ludescher&#8217;s El Niño basin. By changing these lists, you can change the definition of the El Niño basin. You&#8217;ll also have to change these lists if you tackle Challenge 2.</p>
<p>There&#8217;s a lot more you can do&#8230; the sky&#8217;s the limit! In the weeks to come, I&#8217;ll show you lots of things we&#8217;ve actually done.</p>
<h3>Annoying nuances</h3>
<p>Here are two reasons our average link strengths could differ from Ludescher&#8217;s.</p>
<p>Last time I mentioned that Ludescher <i>et al</i> claim to normalize their time-delayed cross-covariances in a sort of complicated way. I explained why I don&#8217;t think they could have actually used this method. In <code>ludescher-replication.R</code>, Graham used the simpler normalization described last time: namely, dividing by</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Csqrt%7B%5Clangle+T_i%28t%29%5E2+%5Crangle+-+%5Clangle+T_i%28t%29+%5Crangle%5E2%7D+%5C%3B+%5Csqrt%7B%5Clangle+T_j%28t-%5Ctau%29%5E2+%5Crangle+-+%5Clangle+T_j%28t-%5Ctau%29+%5Crangle%5E2%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;sqrt{&#92;langle T_i(t)^2 &#92;rangle - &#92;langle T_i(t) &#92;rangle^2} &#92;; &#92;sqrt{&#92;langle T_j(t-&#92;tau)^2 &#92;rangle - &#92;langle T_j(t-&#92;tau) &#92;rangle^2}" class="latex" /></p>
<p>instead of</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Csqrt%7B+%5Clangle+%28T_i%28t%29+-+%5Clangle+T_i%28t%29%5Crangle%29%5E2+%5Crangle%7D+%5C%3B+%5Csqrt%7B+%5Clangle+%28T_j%28t-%5Ctau%29+-+%5Clangle+T_j%28t-%5Ctau%29%5Crangle%29%5E2+%5Crangle%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;sqrt{ &#92;langle (T_i(t) - &#92;langle T_i(t)&#92;rangle)^2 &#92;rangle} &#92;; &#92;sqrt{ &#92;langle (T_j(t-&#92;tau) - &#92;langle T_j(t-&#92;tau)&#92;rangle)^2 &#92;rangle} " class="latex" /></p>
<p>Since we don&#8217;t really know what Ludescher <i>et al</i> did, they might have done something else.</p>
<p>We might also have used a different &#8216;subsampling&#8217; procedure. That&#8217;s a name for how we get from the temperature data on a 9 × 69 grid to temperatures on a 3 × 23 grid. While the original data files give temperatures named after grid points, each is really an area-averaged temperature for a 2.5° × 2.5° square. Is this square <i>centered</i> at the grid point, or is the square having that grid point as its north-west corner, or what? I don&#8217;t know.</p>
<p>This data is on a grid where the coordinates are the number of steps of 2.5 degrees, counting from 1. So, for latitude, 1 means the North Pole, 73 means the South Pole. For longitude, 1 means the prime meridian, 37 means 90° east, 73 means 180° east, 109 means 270°E or 90°W, and 144 means 2.5° west. It&#8217;s an annoying system, as far as I&#8217;m concerned.</p>
<p>In <code>ludescher-replication.R</code> we use this range of coordinates:</p>
<pre>lat.range &lt;- 24:50
lon.range &lt;- 48:116 
</pre>
<p>That&#8217;s why your file <code>Pacific-1948-1980.txt</code> has locations starting with S024E48 and ending with S248E116. Maybe Ludescher <i>et al</i> used a slightly different range or subsampling procedure!</p>
<p>There are probably lots of other nuances I haven&#8217;t noticed. Can you think of some?</p>
									</div>

				<p class="postmetadata">
				<img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/speech_bubble.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2014/07/08/el-nino-project-part-4/#comments">20 Comments</a>				| <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/documents.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/category/climate/" rel="category tag">climate</a>								 | <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/permalink.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2014/07/08/el-nino-project-part-4/" rel="bookmark" title="Permanent Link to El Niño Project (Part&nbsp;4)">Permalink</a>
<br /><img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/figure_ver1.gif" alt="" /> Posted by John Baez				</p>
			</div>
			<hr />
		
			<div class="post-18298 post type-post status-publish format-standard hentry category-biology category-conferences category-information-and-entropy" id="post-18298">
				<h2><a href="https://johncarlosbaez.wordpress.com/2014/07/04/entropy-and-information-in-biological-systems-part-2/" rel="bookmark">Entropy and Information in Biological Systems (Part&nbsp;2)</a></h2>
				<small>4 July, 2014</small><br />


				<div class="entry">
					<p><a href="http://socrates.berkeley.edu/~hartelab/">John Harte</a>, <a href="http://people.mbi.ucla.edu/marcharper/">Marc Harper</a> and I are running a workshop!  Now you can apply here to attend:</p>
<p>&bull; <a href="http://www.nimbios.org/workshops/WS_entropy">Information and entropy in biological systems</a>, National Institute for Mathematical and Biological Synthesis, Knoxville Tennesee, Wednesday-Friday, 8-10 April 2015.  </p>
<p>Click the link, read the stuff and scroll down to &#8220;CLICK HERE&#8221; to apply.  The deadline is 12 November 2014.</p>
<p>Financial support for travel, meals, and lodging is available for workshop attendees who need it.  We will choose among the applicants and invite 10-15 of them.  </p>
<div align="center"><a href="http://www.nimbios.org/"><img width="450" src="https://i0.wp.com/www.utk.edu/tntoday/images/nimbios_logo_lg.jpg" /></a></div>
<h3> The idea </h3>
<p>Information theory and entropy methods are becoming powerful tools in biology, from the level of individual cells, to whole ecosystems, to experimental design, model-building, and the measurement of biodiversity. The aim of this investigative workshop is to synthesize different ways of applying these concepts to help systematize and unify work in biological systems. Early attempts at &#8220;grand syntheses&#8221; often misfired, but applications of information theory and entropy to specific highly focused topics in biology have been increasingly successful. In ecology, entropy maximization methods have proven successful in predicting the distribution and abundance of species. Entropy is also widely used as a measure of biodiversity. Work on the role of information in game theory has shed new light on evolution. As a population evolves, it can be seen as gaining information about its environment. The principle of maximum entropy production has emerged as a fascinating yet controversial approach to predicting the behavior of biological systems, from individual organisms to whole ecosystems. This investigative workshop will bring together top researchers from these diverse fields to share insights and methods and address some long-standing conceptual problems.</p>
<p>So, here are the goals of our workshop:</p>
<p>&bull; To study the validity of the principle of Maximum Entropy Production (MEP), which states that biological systems &#8211; and indeed all open, non-equilibrium systems &#8211; act to produce entropy at the maximum rate.</p>
<p>&bull; To familiarize all the participants with applications to ecology of the MaxEnt method: choosing the probabilistic hypothesis with the highest entropy subject to the constraints of our data. We will compare MaxEnt with competing approaches and examine whether MaxEnt provides a sufficient justification for the principle of MEP.</p>
<p>&bull; To clarify relations between known characterizations of entropy, the use of entropy as a measure of biodiversity, and the use of MaxEnt methods in ecology.</p>
<p>&bull; To develop the concept of evolutionary games as &#8220;learning&#8221; processes in which information is gained over time.</p>
<p>&bull; To study the interplay between information theory and the thermodynamics of individual cells and organelles.</p>
<p>For more details, go <a href="https://johncarlosbaez.wordpress.com/2013/11/02/entropy-and-information-in-biological-systems/">here</a>.  </p>
<p>If you&#8217;ve got colleagues who might be interested in this, please let them know.  You can download a PDF suitable for printing and putting on a bulletin board by clicking on this:</p>
<div align="center">
<a href="http://math.ucr.edu/home/baez/nimbios/WS_entropy_flier.pdf"><br />
<img src="https://i0.wp.com/math.ucr.edu/home/baez/nimbios/WS_entropy_flier.jpg" /></a>
</div>
									</div>

				<p class="postmetadata">
				<img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/speech_bubble.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2014/07/04/entropy-and-information-in-biological-systems-part-2/#comments">6 Comments</a>				| <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/documents.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/category/biology/" rel="category tag">biology</a>, <a href="https://johncarlosbaez.wordpress.com/category/conferences/" rel="category tag">conferences</a>, <a href="https://johncarlosbaez.wordpress.com/category/information-and-entropy/" rel="category tag">information and entropy</a>								 | <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/permalink.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2014/07/04/entropy-and-information-in-biological-systems-part-2/" rel="bookmark" title="Permanent Link to Entropy and Information in Biological Systems (Part&nbsp;2)">Permalink</a>
<br /><img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/figure_ver1.gif" alt="" /> Posted by John Baez				</p>
			</div>
			<hr />
		
			<div class="post-18263 post type-post status-publish format-standard hentry category-climate" id="post-18263">
				<h2><a href="https://johncarlosbaez.wordpress.com/2014/07/01/el-nino-project-part-3/" rel="bookmark">El Ni&ntilde;o Project (Part&nbsp;3)</a></h2>
				<small>1 July, 2014</small><br />


				<div class="entry">
					<p>In February, this paper claimed there&#8217;s a 75% chance the next El Niño will arrive by the end of 2014:</p>
<p>&bull; Josef Ludescher, Avi Gozolchiani, Mikhail I. Bogachev, Armin Bunde, Shlomo Havlin, and Hans Joachim Schellnhuber, <a href="http://www.climatelinc.eu/fileadmin/UG_ADVANCED/Publications/BIU_-_Avi__Halvin__et_al-Very_early_warning_of_next_El_Nino.pdf">Very early warning of next El Niño</a>, <a href="http://www.pnas.org/content/early/2014/02/07/1323058111"><i>Proceedings of the National Academy of Sciences</i></a>, February 2014.  (Click title for free version, journal name for official version.)</p>
<p>Since it was published in a reputable journal, it created a big stir!  Being able to predict an El Ni&ntilde;o more than 6 months in advance would be a big deal.  El Ni&ntilde;os can cause billions of dollars of damage.</p>
<p>But that&#8217;s not the only reason we at the Azimuth Project want to analyze, criticize and improve this paper.  Another reason is that it uses a <i>climate network</i>&mdash;and we like network theory.</p>
<p>Very roughly, the idea is this.   Draw a big network of dots representing different places in the Pacific Ocean.  For each pair of dots, compute a number saying how strongly correlated the temperatures are at those two places.   The paper claims that when a El Ni&ntilde;o is getting ready to happen, the average of these numbers is big.  In other words, temperatures in the Pacific tend to go up and down in synch!</p>
<p>Whether this idea is right or wrong, it&#8217;s interesting&mdash;and it&#8217;s not very hard for programmers to dive in and study it.</p>
<p>Two Azimuth members have done just that: <a href="http://www.azimuthproject.org/azimuth/show/David+Tanzer">David Tanzer</a>, a software developer who works for financial firms in New York, and <a href="http://www.azimuthproject.org/azimuth/show/Graham+Jones">Graham Jones</a>, a self-employed programmer who also works on genomics and Bayesian statistics.  These guys have really brought new life to the Azimuth Code Project in the last few weeks, and it&#8217;s exciting!  It&#8217;s even gotten me to do some programming myself.</p>
<p>Soon I&#8217;ll start talking about the programs they&#8217;ve written, and how you can help.  But today I&#8217;ll summarize the paper by Ludescher <i>et al</i>.  Their methodology is also explained here:</p>
<p>&bull; Josef Ludescher, Avi Gozolchiani, Mikhail I. Bogachev, Armin Bunde, Shlomo Havlin, and Hans Joachim Schellnhuber, <a href="http://www.pnas.org/content/early/2013/06/26/1309353110.full.pdf+html">Improved El Niño forecasting by cooperativity detection</a>, <i>Proceedings of the National Academy of Sciences</i>, 30 May 2013.</p>
<h3> The basic idea </h3>
<p>The basic idea is to use a climate network.  There are lots of variants on this idea, but here&#8217;s a simple one.   Start with a bunch of dots representing different places on the Earth.  For any pair of dots <img src="https://s0.wp.com/latex.php?latex=i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=j%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="j," class="latex" /> compute the <a href="https://en.wikipedia.org/wiki/Cross-correlation">cross-correlation</a> of temperature histories at those two places.  Call some function of this the &#8216;link strength&#8217; for that pair of dots.  Compute the average link strength&#8230; and get excited when this gets bigger than a certain value.</p>
<p>The papers by Ludescher <i>et al</i> use this strategy to predict El Ni&ntilde;os. They build their climate network using correlations between daily temperature data for 14 grid points in the El Niño basin and 193 grid points outside this region, as shown here:</p>
<div align="center">
<a href="http://www.pnas.org/content/early/2013/06/26/1309353110.full.pdf+html"><br />
<img width="450" src="https://i2.wp.com/math.ucr.edu/home/baez/ecological/el_nino/ludescher_el_nino_cooperativity_1a.jpg" alt="" /></a>
</div>
<p>The red dots are the points in the El Ni&ntilde;o basin.</p>
<p>Starting from this temperature data, they compute an &#8216;average link strength&#8217; in a way I&#8217;ll describe later.  When this number is bigger than a certain fixed value, they claim an El Ni&ntilde;o is coming.</p>
<p>How do they decide if they&#8217;re right?  How do we tell when an El Ni&ntilde;o actually arrives?  One way is to use the &#8216;Ni&ntilde;o 3.4 index&#8217;.  This the area-averaged sea surface temperature anomaly in the yellow region here:</p>
<div align="center">
<a href="http://www.esrl.noaa.gov/psd/forecasts/sstlim/for1gl.html"><img width="450" src="https://i0.wp.com/math.ucr.edu/home/baez/ecological/el_nino/nino_3.4_region.gif" alt="" /></a>
</div>
<p><b>Anomaly</b> means the temperature minus its average over time: how much <i>hotter than usual</i> it is.  When the Ni&ntilde;o 3.4 index is over 0.5&deg;C for at least 5 months, Ludescher <i>et al</i> say there&#8217;s an El Ni&ntilde;o.   (By the way, this is not the <a href="http://ggweather.com/enso/oni.htm">standard definition</a>.  But we will discuss that some other day.)</p>
<p>Here is what they get:</p>
<div align="center"><a href="http://www.pnas.org/content/early/2013/06/26/1309353110.full.pdf+html"><br />
<img width="450" src="https://i1.wp.com/math.ucr.edu/home/baez/ecological/el_nino/ludescher_el_nino_cooperativity_2a.jpg" alt="" /></a></div>
<p>The blue peaks are El Ni&ntilde;os: episodes where the Ni&ntilde;o 3.4 index is over 0.5&deg;C for at least 5 months.</p>
<p>The red line is their &#8216;average link strength&#8217;.  Whenever this exceeds a certain threshold <img src="https://s0.wp.com/latex.php?latex=%5CTheta+%3D+2.82%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Theta = 2.82," class="latex" /> and the Ni&ntilde;o 3.4 index is not <i>already</i> over 0.5&deg;C, they predict an El Ni&ntilde;o will start in the following calendar year.</p>
<p>The green arrows show their successful predictions.  The dashed arrows show their false alarms.  A little letter n appears next to each El Ni&ntilde;o that they failed to predict.</p>
<p>You&#8217;re probably wondering where the number <img src="https://s0.wp.com/latex.php?latex=2.82&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="2.82" class="latex" /> came from.  They get it from a learning algorithm that finds this threshold by optimizing the predictive power of their model.  Chart A here shows the &#8216;learning phase&#8217; of their calculation.  In this phase, they adjusted the threshold <img src="https://s0.wp.com/latex.php?latex=%5CTheta&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Theta" class="latex" /> so their procedure would do a good job.  Chart B shows the &#8216;testing phase&#8217;.  Here they used the value of <img src="https://s0.wp.com/latex.php?latex=%5CTheta&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Theta" class="latex" /> chosen in the learning phase, and checked to see how good a job it did.  I&#8217;ll let you read their paper for more details on how they chose <img src="https://s0.wp.com/latex.php?latex=%5CTheta.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Theta." class="latex" /></p>
<p>But what about their prediction now?  That&#8217;s the green arrow at far right here:</p>
<div align="center">
<a href="http://www.climatelinc.eu/fileadmin/UG_ADVANCED/Publications/BIU_-_Avi__Halvin__et_al-Very_early_warning_of_next_El_Nino.pdf"><br />
<img width="450" src="https://i2.wp.com/math.ucr.edu/home/baez/ecological/el_nino/ludescher_el_nino_warning_a.jpg" alt="" /><br />
</a>
</div>
<p>On 17 September 2013, the red line went above the threshold!   So, their scheme predicts an El Ni&ntilde;o sometime in 2014.  The chart at right is a zoomed-in version that shows the red line in August, September, October and November of 2013.</p>
<h3> The details </h3>
<p>Now I mainly need to explain how they compute their &#8216;average link strength&#8217;.</p>
<p>Let <img src="https://s0.wp.com/latex.php?latex=i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i" class="latex" /> stand for any point in this 9 &times; 23 grid:</p>
<div align="center">
<a href="http://math.ucr.edu/home/baez/ecological/el_nino/ludescher_el_nino_cooperativity_1.jpg"><br />
<img width="450" src="https://i2.wp.com/math.ucr.edu/home/baez/ecological/el_nino/ludescher_el_nino_cooperativity_1a.jpg" alt="" /><br />
</a></div>
<p>For each day <img src="https://s0.wp.com/latex.php?latex=t&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="t" class="latex" /> between June 1948 and November 2013, let <img src="https://s0.wp.com/latex.php?latex=%5Ctilde%7BT%7D_i%28t%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tilde{T}_i(t)" class="latex" /> be the average surface air temperature at the point <img src="https://s0.wp.com/latex.php?latex=i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i" class="latex" /> on day <img src="https://s0.wp.com/latex.php?latex=t.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="t." class="latex" /></p>
<p>Let <img src="https://s0.wp.com/latex.php?latex=T_i%28t%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T_i(t)" class="latex" /> be <img src="https://s0.wp.com/latex.php?latex=%5Ctilde%7BT%7D_i%28t%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tilde{T}_i(t)" class="latex" /> minus its <b>climatological average</b>.  For example, if <img src="https://s0.wp.com/latex.php?latex=t&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="t" class="latex" /> is June 1st 1970, we average the temperature at location <img src="https://s0.wp.com/latex.php?latex=i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i" class="latex" /> over all June 1sts from 1948 to 2013, and subtract that from <img src="https://s0.wp.com/latex.php?latex=%5Ctilde%7BT%7D_i%28t%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tilde{T}_i(t)" class="latex" /> to get <img src="https://s0.wp.com/latex.php?latex=T_i%28t%29.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T_i(t)." class="latex" /></p>
<p>They call <img src="https://s0.wp.com/latex.php?latex=T_i%28t%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T_i(t)" class="latex" /> the <b>temperature anomaly</b>.</p>
<p>(A subtlety here: when we are doing prediction we can&#8217;t know the future temperatures, so the climatological average is only the average over <i>past</i> days meeting the above criteria.)</p>
<p>For any function of time, denote its moving average over the last 365 days by:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Clangle+f%28t%29+%5Crangle+%3D+%5Cfrac%7B1%7D%7B365%7D+%5Csum_%7Bd+%3D+0%7D%5E%7B364%7D+f%28t+-+d%29+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;langle f(t) &#92;rangle = &#92;frac{1}{365} &#92;sum_{d = 0}^{364} f(t - d) }" class="latex" /></p>
<p>Let <img src="https://s0.wp.com/latex.php?latex=i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i" class="latex" /> be a point in the El Niño basin, and <img src="https://s0.wp.com/latex.php?latex=j&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="j" class="latex" /> be a point outside it.  For any time lag <img src="https://s0.wp.com/latex.php?latex=%5Ctau&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau" class="latex" /> between 0 and 200 days, define the <b>time-delayed cross-covariance</b> by:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Clangle+T_i%28t%29+T_j%28t+-+%5Ctau%29+%5Crangle+-+%5Clangle+T_i%28t%29+%5Crangle+%5Clangle+T_j%28t+-+%5Ctau%29+%5Crangle++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;langle T_i(t) T_j(t - &#92;tau) &#92;rangle - &#92;langle T_i(t) &#92;rangle &#92;langle T_j(t - &#92;tau) &#92;rangle  " class="latex" /></p>
<p>Note that this is a way of studying the linear correlation between the temperature anomaly at node <img src="https://s0.wp.com/latex.php?latex=i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i" class="latex" /> and the temperature anomaly a time <img src="https://s0.wp.com/latex.php?latex=%5Ctau&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau" class="latex" /> earlier at some node <img src="https://s0.wp.com/latex.php?latex=j.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="j." class="latex" />  So, it&#8217;s about how temperature anomalies inside the El Ni&ntilde;o basin are correlated to temperature anomalies outside this basin at earlier times.</p>
<p>Ludescher <i>et al</i> then normalize this, defining the <b>time-delayed cross-correlation</b> <img src="https://s0.wp.com/latex.php?latex=C_%7Bi%2Cj%7D%5E%7Bt%7D%28-%5Ctau%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="C_{i,j}^{t}(-&#92;tau)" class="latex" /> to be the time-delayed cross-covariance divided by</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Csqrt%7B%5CBig%7B%5Clangle%7D+%28T_i%28t%29++++++-+%5Clangle+T_i%28t%29%5Crangle%29%5E2++++++%5CBig%7B%5Crangle%7D%7D+%5C%3B+++++%5Csqrt%7B%5CBig%7B%5Clangle%7D+%28T_j%28t-%5Ctau%29+-+%5Clangle+T_j%28t-%5Ctau%29%5Crangle%29%5E2+%5CBig%7B%5Crangle%7D%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;sqrt{&#92;Big{&#92;langle} (T_i(t)      - &#92;langle T_i(t)&#92;rangle)^2      &#92;Big{&#92;rangle}} &#92;;     &#92;sqrt{&#92;Big{&#92;langle} (T_j(t-&#92;tau) - &#92;langle T_j(t-&#92;tau)&#92;rangle)^2 &#92;Big{&#92;rangle}} " class="latex" /></p>
<p>This is something like the standard deviation of <img src="https://s0.wp.com/latex.php?latex=T_i%28t%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T_i(t)" class="latex" /> times the standard deviation of <img src="https://s0.wp.com/latex.php?latex=T_j%28t+-+%5Ctau%29.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T_j(t - &#92;tau)." class="latex" />  Dividing by standard deviations is what people <a href="https://en.wikipedia.org/wiki/Cross-correlation#Normalized_cross-correlation">usually do</a> to turn covariances into correlations.  But there are some potential problems here, which I&#8217;ll discuss later.</p>
<p>They define <img src="https://s0.wp.com/latex.php?latex=C_%7Bi%2Cj%7D%5E%7Bt%7D%28%5Ctau%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="C_{i,j}^{t}(&#92;tau)" class="latex" /> in a similar way, by taking</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Clangle+T_i%28t+-+%5Ctau%29+T_j%28t%29+%5Crangle+-+%5Clangle+T_i%28t+-+%5Ctau%29+%5Crangle+%5Clangle+T_j%28t%29+%5Crangle++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;langle T_i(t - &#92;tau) T_j(t) &#92;rangle - &#92;langle T_i(t - &#92;tau) &#92;rangle &#92;langle T_j(t) &#92;rangle  " class="latex" /></p>
<p>and normalizing it.  So, this is about how temperature anomalies outside the El Ni&ntilde;o basin are correlated to temperature anomalies inside this basin at earlier times.</p>
<p>Next, for nodes <img src="https://s0.wp.com/latex.php?latex=i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=j%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="j," class="latex" /> and for each time <img src="https://s0.wp.com/latex.php?latex=t%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="t," class="latex" /> they determine the maximum, the mean and the standard deviation of <img src="https://s0.wp.com/latex.php?latex=%7CC_%7Bi%2Cj%7D%5Et%28%5Ctau%29%7C%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="|C_{i,j}^t(&#92;tau)|," class="latex" /> as <img src="https://s0.wp.com/latex.php?latex=%5Ctau&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau" class="latex" /> ranges from -200 to 200 days.</p>
<p>They define the <b>link strength</b> <img src="https://s0.wp.com/latex.php?latex=S_%7Bi+j%7D%28t%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S_{i j}(t)" class="latex" /> as the difference between the maximum and the mean value, divided by the standard deviation.</p>
<p>Finally, they let <img src="https://s0.wp.com/latex.php?latex=S%28t%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S(t)" class="latex" /> be the <b>average link strength</b>, calculated by averaging <img src="https://s0.wp.com/latex.php?latex=S_%7Bi+j%7D%28t%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S_{i j}(t)" class="latex" /> over all pairs <img src="https://s0.wp.com/latex.php?latex=%28i%2Cj%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(i,j)" class="latex" /> where <img src="https://s0.wp.com/latex.php?latex=i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i" class="latex" /> is a node in the El Niño basin and <img src="https://s0.wp.com/latex.php?latex=j&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="j" class="latex" /> is a node outside.</p>
<p>They compute <img src="https://s0.wp.com/latex.php?latex=S%28t%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S(t)" class="latex" /> for every 10th day between January 1950 and November 2013.  When <img src="https://s0.wp.com/latex.php?latex=S%28t%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S(t)" class="latex" /> goes over 2.82, and the Ni&ntilde;o 3.4 index is not <i>already</i> over 0.5&deg;C, they predict an El Ni&ntilde;o in the next calendar year.</p>
<p>There&#8217;s more to say about their methods.  We&#8217;d like you to help us check their work and improve it.   Soon I want to show you Graham Jones&#8217; software for replicating their calculations!  But right now I just want to conclude by:</p>
<p>&bull; mentioning a potential problem in the math, and</p>
<p>&bull; telling you where to get the data used by Ludescher <i>et al</i>.</p>
<h3> Mathematical nuances </h3>
<p>Ludescher <i>et al</i> normalize the time-delayed cross-covariance in a somewhat odd way.  They claim to divide it by</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Csqrt%7B%5CBig%7B%5Clangle%7D+%28T_i%28t%29++++++-+%5Clangle+T_i%28t%29%5Crangle%29%5E2++++++%5CBig%7B%5Crangle%7D%7D+%5C%3B+++++%5Csqrt%7B%5CBig%7B%5Clangle%7D+%28T_j%28t-%5Ctau%29+-+%5Clangle+T_j%28t-%5Ctau%29%5Crangle%29%5E2+%5CBig%7B%5Crangle%7D%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;sqrt{&#92;Big{&#92;langle} (T_i(t)      - &#92;langle T_i(t)&#92;rangle)^2      &#92;Big{&#92;rangle}} &#92;;     &#92;sqrt{&#92;Big{&#92;langle} (T_j(t-&#92;tau) - &#92;langle T_j(t-&#92;tau)&#92;rangle)^2 &#92;Big{&#92;rangle}} " class="latex" /></p>
<p>This is a strange thing, since it has nested angle brackets.  The angle brackets are defined as a running average over the 365 days, so this quantity involves data going back twice as long: 730 days.  Furthermore, the &#8216;link strength&#8217; involves the above expression where <img src="https://s0.wp.com/latex.php?latex=%5Ctau&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau" class="latex" /> goes up to 200 days.</p>
<p>So, taking their definitions at face value, Ludescher <i>et al</i> could not actually compute their &#8216;link strength&#8217; until 930 days after the surface temperature data first starts at the beginning of 1948.  That would be <i>late 1950</i>.  But their graph of the link strength starts at the <i>beginning</i> of 1950!</p>
<p>Perhaps they actually normalized the time-delayed cross-covariance by dividing it by this:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Csqrt%7B%5Cbig%7B%5Clangle%7D+T_i%28t%29%5E2+%5Cbig%7B%5Crangle%7D+-+%5Cbig%7B%5Clangle%7D+T_i%28t%29%5Cbig%7B%5Crangle%7D%5E2%7D+%5C%3B+%5Csqrt%7B%5Cbig%7B%5Clangle%7D+T_j%28t-%5Ctau%29%5E2+%5Cbig%7B%5Crangle%7D+-+%5Cbig%7B%5Clangle%7D+T_j%28t-%5Ctau%29%5Cbig%7B%5Crangle%7D%5E2%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;sqrt{&#92;big{&#92;langle} T_i(t)^2 &#92;big{&#92;rangle} - &#92;big{&#92;langle} T_i(t)&#92;big{&#92;rangle}^2} &#92;; &#92;sqrt{&#92;big{&#92;langle} T_j(t-&#92;tau)^2 &#92;big{&#92;rangle} - &#92;big{&#92;langle} T_j(t-&#92;tau)&#92;big{&#92;rangle}^2} " class="latex" /></p>
<p>This simpler expression avoids nested angle brackets, and it makes more sense conceptually.  It is the standard deviation of <img src="https://s0.wp.com/latex.php?latex=T_i%28t%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T_i(t)" class="latex" /> over the last 365 days, times of the standard deviation of <img src="https://s0.wp.com/latex.php?latex=T_i%28t-%5Ctau%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T_i(t-&#92;tau)" class="latex" /> over the last 365 days.</p>
<p>As <a href="http://www.azimuthproject.org/azimuth/show/Nadja+Kutz">Nadja Kutz</a> noted, the expression written by Ludescher <i>et al</i> does not equal this simpler expression, since:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5CBig%7B%5Clangle%7D+T_i%28t%29+%5C%3B+%5Clangle+T_i%28t%29+%5Crangle+%5CBig%7B%5Crangle%7D+%5Cneq+%5Cbig%7B%5Clangle%7D+T_i%28t%29+%5Cbig%7B%5Crangle%7D+%5C%3B+%5Cbig%7B%5Clangle%7D+T_i%28t%29+%5Cbig%7B%5Crangle%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Big{&#92;langle} T_i(t) &#92;; &#92;langle T_i(t) &#92;rangle &#92;Big{&#92;rangle} &#92;neq &#92;big{&#92;langle} T_i(t) &#92;big{&#92;rangle} &#92;; &#92;big{&#92;langle} T_i(t) &#92;big{&#92;rangle} " class="latex" /></p>
<p>The reason is that</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Barray%7D%7Bccl%7D+%5CBig%7B%5Clangle%7D+T_i%28t%29+%5C%3B+%5Clangle+T_i%28t%29+%5Crangle+%5CBig%7B%5Crangle%7D+%26%3D%26+%5Cdisplaystyle%7B+%5Cfrac%7B1%7D%7B365%7D+%5Csum_%7Bd+%3D+0%7D%5E%7B364%7D+T_i%28t-d%29+%5Clangle+T_i%28t-d%29+%5Crangle%7D+%5C%5C++%5C%5C++%26%3D%26+%5Cdisplaystyle%7B+%5Cfrac%7B1%7D%7B365%7D+%5Csum_%7Bd+%3D+0%7D%5E%7B364%7D+%5Cfrac%7B1%7D%7B365%7D+%5Csum_%7BD+%3D+0%7D%5E%7B364%7D+T_i%28t-d%29+T_i%28t-d-D%29%7D+%5Cend%7Barray%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;begin{array}{ccl} &#92;Big{&#92;langle} T_i(t) &#92;; &#92;langle T_i(t) &#92;rangle &#92;Big{&#92;rangle} &amp;=&amp; &#92;displaystyle{ &#92;frac{1}{365} &#92;sum_{d = 0}^{364} T_i(t-d) &#92;langle T_i(t-d) &#92;rangle} &#92;&#92;  &#92;&#92;  &amp;=&amp; &#92;displaystyle{ &#92;frac{1}{365} &#92;sum_{d = 0}^{364} &#92;frac{1}{365} &#92;sum_{D = 0}^{364} T_i(t-d) T_i(t-d-D)} &#92;end{array}" class="latex" /></p>
<p>which is generically different from</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5CBig%7B%5Clangle%7D+%5Clangle+T_i%28t%29+%5Crangle+%5C%3B%5Clangle+T_i%28t%29+%5Crangle+%5CBig%7B%5Crangle%7D+%3D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Big{&#92;langle} &#92;langle T_i(t) &#92;rangle &#92;;&#92;langle T_i(t) &#92;rangle &#92;Big{&#92;rangle} = " class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7B1%7D%7B365%7D+%5Csum_%7BD+%3D+0%7D%5E%7B364%7D+%28%5Cfrac%7B1%7D%7B365%7D+%5Csum_%7Bd+%3D+0%7D%5E%7B364%7D+T_i%28t-d-D%29%29%28%5Cfrac%7B1%7D%7B365%7D+%5Csum_%7Bd+%3D+0%7D%5E%7B364%7D+T_i%28t-d-D%29+%29+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{1}{365} &#92;sum_{D = 0}^{364} (&#92;frac{1}{365} &#92;sum_{d = 0}^{364} T_i(t-d-D))(&#92;frac{1}{365} &#92;sum_{d = 0}^{364} T_i(t-d-D) ) }" class="latex" /></p>
<p>since the terms in the latter expression contain products <img src="https://s0.wp.com/latex.php?latex=T_i%28t-364-364%29T_i%28t-364-364%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T_i(t-364-364)T_i(t-364-364)" class="latex" /> that can&#8217;t appear in the former.</p>
<p>Moreover:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Barray%7D%7Bccl%7D+%5CBig%7B%5Clangle%7D+%28T_i%28t%29+-+%5Clangle+T_i%28t%29+%5Crangle%29%5E2+%5CBig%7B%5Crangle%7D+%26%3D%26+%5CBig%7B%5Clangle%7D+T_i%28t%29%5E2+-+2+T_i%28t%29+%5Clangle+T_i%28t%29+%5Crangle+%2B+%5Clangle+T_i%28t%29+%5Crangle%5E2+%5CBig%7B%5Crangle%7D+%5C%5C++%5C%5C++%26%3D%26+%5Clangle+T_i%28t%29%5E2+%5Crangle+-+2+%5Cbig%7B%5Clangle%7D+T_i%28t%29+%5Clangle+T_i%28t%29+%5Crangle+%5Cbig%7B%5Crangle%7D+%2B++%5Cbig%7B%5Clangle%7D+%5Clangle+T_i%28t%29+%5Crangle%5E2+%5Cbig%7B%5Crangle%7D+%5Cend%7Barray%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;begin{array}{ccl} &#92;Big{&#92;langle} (T_i(t) - &#92;langle T_i(t) &#92;rangle)^2 &#92;Big{&#92;rangle} &amp;=&amp; &#92;Big{&#92;langle} T_i(t)^2 - 2 T_i(t) &#92;langle T_i(t) &#92;rangle + &#92;langle T_i(t) &#92;rangle^2 &#92;Big{&#92;rangle} &#92;&#92;  &#92;&#92;  &amp;=&amp; &#92;langle T_i(t)^2 &#92;rangle - 2 &#92;big{&#92;langle} T_i(t) &#92;langle T_i(t) &#92;rangle &#92;big{&#92;rangle} +  &#92;big{&#92;langle} &#92;langle T_i(t) &#92;rangle^2 &#92;big{&#92;rangle} &#92;end{array}" class="latex" /></p>
<p>But since <img src="https://s0.wp.com/latex.php?latex=%5Cbig%7B%5Clangle%7D+T_i%28t%29+%5Clangle+T_i%28t%29+%5Crangle+%5Cbig%7B%5Crangle%7D+%5Cneq+%5Cbig%7B%5Clangle%7D+%5Clangle+T_i%28t%29+%5Crangle+%5C%3B+%5Clangle+T_i%28t%29+%5Crangle+%5Cbig%7B%5Crangle%7D%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;big{&#92;langle} T_i(t) &#92;langle T_i(t) &#92;rangle &#92;big{&#92;rangle} &#92;neq &#92;big{&#92;langle} &#92;langle T_i(t) &#92;rangle &#92;; &#92;langle T_i(t) &#92;rangle &#92;big{&#92;rangle}," class="latex" /> as was just shown, those terms do not cancel out in the above expression.  In particular, this means that</p>
<p><img src="https://s0.wp.com/latex.php?latex=-2+%5Cbig%7B%5Clangle%7D+T_i%28t%29+%5Clangle+T_i%28t%29+%5Crangle+%5Cbig%7B%5Crangle%7D+%2B+%5Cbig%7B%5Clangle%7D+%5Clangle+T_i%28t%29+%5Crangle+%5Clangle+T_i%28t%29+%5Crangle+%5Cbig%7B%5Crangle%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="-2 &#92;big{&#92;langle} T_i(t) &#92;langle T_i(t) &#92;rangle &#92;big{&#92;rangle} + &#92;big{&#92;langle} &#92;langle T_i(t) &#92;rangle &#92;langle T_i(t) &#92;rangle &#92;big{&#92;rangle} " class="latex" /></p>
<p>contains terms <img src="https://s0.wp.com/latex.php?latex=T_i%28t-364-364%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T_i(t-364-364)" class="latex" /> which do not appear in <img src="https://s0.wp.com/latex.php?latex=%5Clangle+T_i%28t%29%5Crangle%5E2%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;langle T_i(t)&#92;rangle^2," class="latex" /> hence</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5CBig%7B%5Clangle%7D+%28T_i%28t%29+-+%5Clangle+T_i%28t%29+%5Crangle%29%5E2+%5CBig%7B%5Crangle%7D++%5Cneq+%5Clangle+T_i%28t%29%5E2%5Crangle+-+%5Clangle+T_i%28t%29%5Crangle%5E2+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Big{&#92;langle} (T_i(t) - &#92;langle T_i(t) &#92;rangle)^2 &#92;Big{&#92;rangle}  &#92;neq &#92;langle T_i(t)^2&#92;rangle - &#92;langle T_i(t)&#92;rangle^2 " class="latex" /></p>
<p>So at least for the case of the standard deviation it is clear that those two definitions are not the same for a running mean.  For the covariances this would still need to be shown.</p>
<h3> Surface air temperatures </h3>
<p>Remember that <img src="https://s0.wp.com/latex.php?latex=%5Ctilde%7BT%7D_i%28t%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tilde{T}_i(t)" class="latex" /> is the average surface air temperature at the grid point <img src="https://s0.wp.com/latex.php?latex=i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i" class="latex" /> on day <img src="https://s0.wp.com/latex.php?latex=t.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="t." class="latex" />  You can get these temperatures from here:</p>
<p>&bull; Earth System Research Laboratory, <a href="http://www.esrl.noaa.gov/psd/cgi-bin/db_search/DBSearch.pl?Dataset=NCEP+Reanalysis+Daily+Averages+Surface+Level&amp;Variable=Air+Temperature&amp;group=0&amp;submit=Search">NCEP Reanalysis Daily Averages Surface Level</a>, or <a href="ftp://ftp.cdc.noaa.gov/Datasets/ncep.reanalysis.dailyavgs/surface/">ftp site</a>.</p>
<p>These sites will give you worldwide daily average temperatures on a 2.5&deg; latitude &times; 2.5&deg; longitude grid (144 &times;  73 grid points), from 1948 to now.  Ihe website will help you get data from within a chosen rectangle in a grid, for a chosen time interval.  Alternatively, you can use the ftp site to download temperatures worldwide one year at a time.  Either way, you&#8217;ll get <a href="http://www.unidata.ucar.edu/software/netcdf/">&#8216;NetCDF files&#8217;</a>&mdash;a format we will discuss later, when we get into more details about programming!</p>
<h3> Ni&ntilde;o 3.4 </h3>
<p><b>Ni&ntilde;o 3.4</b> is the area-averaged sea surface temperature anomaly in the region 5&deg;S-5&deg;N and 170&deg;-120&deg;W.  You can get Ni&ntilde;o 3.4 data here:</p>
<p>You can get Ni&ntilde;o 3.4 data here:</p>
<p>&bull; <a href="http://www.esrl.noaa.gov/psd/gcos_wgsp/Timeseries/Nino34/">Ni&ntilde;o 3.4 data since 1870 calculated from the HadISST1</a>, NOAA.  Discussed in N. A. Rayner <i>et al</i>, Global analyses of sea surface temperature, sea ice, and night marine air temperature since the late nineteenth century, <a href="http://onlinelibrary.wiley.com/doi/10.1029/2002JD002670/abstract"><i>J. Geophys. Res.</i></a> <b>108</b> (2003), 4407.</p>
<p>You can also get Ni&ntilde;o 3.4 data here:</p>
<p>&bull; <a href="http://www.cpc.noaa.gov/products/analysis_monitoring/ensostuff/ONI_change.shtml">Monthly Ni&ntilde;o 3.4 index</a>, Climate Prediction Center, National Weather Service.</p>
<p>The actual temperatures in Celsius are close to those at the other website, but the anomalies are rather different, because they&#8217;re computed in a way that takes global warming into account.  See the website for details.</p>
<p>Ni&ntilde;o 3.4 is just one of several official regions in the Pacific:</p>
<div align="center">
<a href="http://www.bom.gov.au/climate/enso/indices/about.shtml"><br />
<img width="450" src="https://i1.wp.com/math.ucr.edu/home/baez/ecological/el_nino/nino_regions.gif" alt="" /><br />
</a>
</div>
<p>&bull; Niño 1: 80&deg;W-90&deg;W and 5&deg;S-10&deg;S.</p>
<p>&bull; Niño 2: 80&deg;W-90&deg;W and 0&deg;S-5&deg;S</p>
<p>&bull; Niño 3: 90&deg;W-150&deg;W and 5&deg;S-5&deg;N.</p>
<p>&bull; Niño 3.4: 120&deg;W-170&deg;W and 5&deg;S-5&deg;N.</p>
<p>&bull; Niño 4: 160&deg;E-150&deg;W and 5&deg;S-5&deg;N.</p>
<p>For more details, read this:</p>
<p>&bull; Kevin E. Trenberth, <a href="http://www.cgd.ucar.edu/staff/trenbert/trenberth.papers/defnBAMS.pdf">The definition of El Niño</a>, <i>Bulletin of the American Meteorological Society</i> <b>78</b> (1997), 2771&ndash;2777.</p>
									</div>

				<p class="postmetadata">
				<img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/speech_bubble.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2014/07/01/el-nino-project-part-3/#comments">33 Comments</a>				| <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/documents.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/category/climate/" rel="category tag">climate</a>								 | <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/permalink.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2014/07/01/el-nino-project-part-3/" rel="bookmark" title="Permanent Link to El Ni&ntilde;o Project (Part&nbsp;3)">Permalink</a>
<br /><img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/figure_ver1.gif" alt="" /> Posted by John Baez				</p>
			</div>
			<hr />
		
			<div class="post-18174 post type-post status-publish format-standard hentry category-chemistry category-mathematics" id="post-18174">
				<h2><a href="https://johncarlosbaez.wordpress.com/2014/06/26/chemical-reaction-networks/" rel="bookmark">Chemical Reaction Network&nbsp;Talks</a></h2>
				<small>26 June, 2014</small><br />


				<div class="entry">
					<p>A while ago I blogged about <a href="https://johncarlosbaez.wordpress.com/2014/06/10/the-computational-power-of-chemical-reaction-networks/">David Soloveichik&#8217;s talk</a> at this workshop:</p>
<p>&bull; <a href="https://johncarlosbaez.wordpress.com/2014/03/23/programming-with-chemical-reaction-networks/">Programming with Chemical Reaction Networks: Mathematical Foundations</a>,  Banff International Research Station, 8-13 June 2014.</p>
<p>Now the slides for his talk are available:</p>
<p>&bull; David Soloveichik, U.C. San Francisco, <a href="http://crn.thachuk.com/images/d/d5/Soloveichik-Banff_Tutorial.pdf">The computational power of chemical reaction networks</a>.</p>
<p>And now I&#8217;d like to tell you about three more talks!  </p>
<p>The first two are about ways one chemical reaction network can simulate another.  This is important for a couple of reasons.  First, in biology, a bunch of different chemical reactions can &#8216;accomplish the same task&#8217;&#8212;and we&#8217;d like to make this idea precise.  That&#8217;s what Luca Cardelli spoke about.  Second, people trying to do computation with chemistry are starting to simulate quite general reactions using DNA!  That&#8217;s what Sheung Woo Shin spoke about.</p>
<h3> Luca Cardelli </h3>
<p><a href="http://lucacardelli.name/">Luca Cardelli</a> was at Oxford when I was visiting this spring, but unfortunately I didn&#8217;t meet him!  He works for Microsoft on the interface of biology and computation.  At Banff, he talked about ways one chemical reaction network can simulate another.  His slides are here:</p>
<p>&bull; Luca Cardelli, <a href="http://lucacardelli.name/Talks/2014-06-11%20Morphisms%20of%20Reaction%20Networks%20%28Banff%29.pdf">Morphisms of reaction networks</a>.</p>
<p>He has a paper that gives a more detailed explanation of these ideas:</p>
<p>&bull; Luca Cardelli, <a href="http://lucacardelli.name/Papers/CRN%20Morphisms%20%28draft%29.pdf">Morphisms of reaction networks that couple structure to function</a>.</p>
<p>Here is my own disorganized explanation&#8230; with lots of informative but confusing digressions.  A <b>population protocol</b> is a chemical reaction with only 2-in, 2-out reactions. For example, this paper presents a population protocol that does &#8216;approximate majority detection&#8217;:</p>
<p>&bull; Dana Angluin, James Aspnes, and David Eisenstat, <a href="http://www.cs.yale.edu/homes/aspnes/papers/approximate-majority-abstract.html">A simple population protocol for fast robust approximate majority</a>, <i>Distributed Computing</i> <b>21</b> (2008), 87–102. </p>
<p>What&#8217;s the idea?  We start with two kinds of molecules, say <img src="https://s0.wp.com/latex.php?latex=x&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x" class="latex" />’s and <img src="https://s0.wp.com/latex.php?latex=y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="y" class="latex" />’s, and we want to see which one is in the majority, so we run these chemical reactions:</p>
<p><img src="https://s0.wp.com/latex.php?latex=x+%2B+y+%5Cto+x+%2B+b&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x + y &#92;to x + b" class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=x+%2B+y+%5Cto+y+%2B+b&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x + y &#92;to y + b" class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=x+%2B+b+%5Cto+2x&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x + b &#92;to 2x" class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=y+%2B+b+%5Cto+2y+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="y + b &#92;to 2y " class="latex" /></p>
<p>See?  All the reactions have 2 molecules going in and 2 going out. The <img src="https://s0.wp.com/latex.php?latex=b&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="b" class="latex" /> molecules act as &#8216;undecided voters&#8217; who become either an <img src="https://s0.wp.com/latex.php?latex=x&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x" class="latex" /> or a <img src="https://s0.wp.com/latex.php?latex=y%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="y," class="latex" /> depending on who they meet first.  </p>
<p>If we start with about <img src="https://s0.wp.com/latex.php?latex=n&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="n" class="latex" /> molecules, in <img src="https://s0.wp.com/latex.php?latex=O%28n+%5Clog+n%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="O(n &#92;log n)" class="latex" /> time these reactions are very likely to convert all <img src="https://s0.wp.com/latex.php?latex=x&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x" class="latex" />’s and <img src="https://s0.wp.com/latex.php?latex=y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="y" class="latex" />’s to whatever kind of molecule was in the <i>majority</i> initially&#8230; at least if the gap in the number of <img src="https://s0.wp.com/latex.php?latex=x&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x" class="latex" />’s and <img src="https://s0.wp.com/latex.php?latex=y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="y" class="latex" />’s is big enough.</p>
<p>Here&#8217;s another population protocol that also does the job:</p>
<p><img src="https://s0.wp.com/latex.php?latex=x+%2B+y+%5Cto+2b+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x + y &#92;to 2b " class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=x+%2B+b+%5Cto+2x+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x + b &#92;to 2x " class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=y+%2B+b+%5Cto+2y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="y + b &#92;to 2y" class="latex" /></p>
<p>And here&#8217;s a proof that one of these algorithms actually works&#8212;most of the time, when the initial difference in populations is big enough:</p>
<p>&bull; Etienne Perron, Dinkar Vasudevan, and Milan Vojonvic, <a href="http://research.microsoft.com/pubs/78881/tr-2008-114.pdf">Using three states for binary consensus on complete graphs</a>, Technical Report, MSR-TR-2008-114, Microsoft, September 2008.</p>
<p>If we use a discrete-time formalism to describe the dynamics, the proof seems to get harder.  See the paper by Angluin, Aspnes, and Eisenstat for the only known proof!  </p>
<p>Anyway, Luca Cardelli is interested in chemical reaction networks actually found in biology.  This approximate majority algorithm is seen quite clearly in a certain biological system: a certain &#8216;epigenetic switch&#8217;.  However, it is usually &#8216;obfuscated&#8217; or &#8216;encrypted&#8217;: hidden in a bigger, more complicated chemical reaction network.  For example, see:</p>
<p>&bull; Luca Cardelli and Attila Csikász-Nagy, <a href="http://www.nature.com/srep/2012/120913/srep00656/full/srep00656.html">The cell cycle switch is approximate majority obfuscated</a>, <i>Scientific Reports</i> <b>2</b> (2012).</p>
<p>This got him interested in developing a theory of morphisms between reaction networks, which could answer questions like: When can one CRN emulate another?  But these questions turn out to be much easier if we use the <a href="https://johncarlosbaez.wordpress.com/2011/09/09/network-theory-part-8/">rate equation</a> than with the master equation.  So, he asks: when can one CRN give the same rate equation as another?   </p>
<p>He found a sufficient condition that&#8217;s &#8216;purely syntactic&#8217;: you can tell if it holds by looking at the reaction networks, regardless of the rate constants.</p>
<p>Here&#8217;s the idea.  We say one network <b>emulates</b> another if for any rate constants of the second, we can find rate constants for the first that makes its rate equation have solutions exactly mimicking that of the second, but where several species in the first correspond to one in the second.  </p>
<p>For this to make sense, we assume there is a map sending:</p>
<p>&bull; species to species<br />
&bull; reactions to reactions</p>
<p>In a <b>chemical reaction network homomorphism</b>, the map on reactions is determined by the map on species in the obvious way.  For example, if species <img src="https://s0.wp.com/latex.php?latex=A&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A" class="latex" /> is sent to <img src="https://s0.wp.com/latex.php?latex=f%28A%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="f(A)" class="latex" /> and species <img src="https://s0.wp.com/latex.php?latex=B&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="B" class="latex" /> is sent to <img src="https://s0.wp.com/latex.php?latex=f%28B%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="f(B)" class="latex" /> then the reaction</p>
<p><img src="https://s0.wp.com/latex.php?latex=2A+%2B+B+%5Cto+3B+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="2A + B &#92;to 3B " class="latex" /></p>
<p>is sent to the reaction </p>
<p><img src="https://s0.wp.com/latex.php?latex=2f%28A%29+%2B+f%28B%29+%5Cto+3+f%28B%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="2f(A) + f(B) &#92;to 3 f(B)" class="latex" /></p>
<p>In this situation, to make the first network emulate the second, we need to set equal the initial concentrations of all species in the inverse image of a given species.</p>
<p>A <b>reactant homomorphism</b> from one chemical reaction network to another is more general: it sends species to species, and for any reaction in the first chemical reaction network with input </p>
<p><img src="https://s0.wp.com/latex.php?latex=A+%2B+B+%2B+C+%5Ccdots&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A + B + C &#92;cdots" class="latex" /> </p>
<p>there&#8217;s a reaction in the second with input </p>
<p><img src="https://s0.wp.com/latex.php?latex=f%28A%29+%2B+f%28B%29+%2B+f%28C%29+%2B+%5Ccdots+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="f(A) + f(B) + f(C) + &#92;cdots " class="latex" />  </p>
<p>(<b>Reactant</b> is another name for input.)</p>
<p>A <b>stoichiomorphism</b> is a kind of morphism that takes rate constants into account. See Cardelli&#8217;s paper for the definition.</p>
<p>The main theorem: given a stoichiomorphism from one chemical reaction network to another that&#8217;s also a reactant homomorphism, then the first emulates the second.</p>
<p>For a better explanation, read <a href="http://lucacardelli.name/Papers/CRN%20Morphisms%20%28draft%29.pdf">his paper</a>!  Here&#8217;s a cool picture from his paper showing a bunch of chemical reaction networks including the approximate majority network (labelled <b>AM</b>), many of which show up in biology, and morphisms between them:</p>
<p><a href="http://math.ucr.edu/home/baez/networks/cardelli_network_morphisms.jpg"><br />
<img width="450" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/cardelli_network_morphisms.jpg" alt="" /></a></p>
<p>Click to enlarge!  These chemical reaction networks are drawn in a special style: as <b>influence networks</b>, consisting of &#8216;gates&#8217; where process activates or deactivates another.  Each gate is a chemical reaction network of a certain form, schematically like this:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Boff%7D+%5Cleftrightarrow+%5Cmathrm%7Bintermediate%7D+%5Cleftrightarrow+%5Cmathrm%7Bon%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{off} &#92;leftrightarrow &#92;mathrm{intermediate} &#92;leftrightarrow &#92;mathrm{on}" class="latex" /> </p>
<p>where the forward reactions are catalyzed by one chemical and the reverse reactions are catalyzed by another.  A gate is like a switch that can be turned on or off.</p>
<p>While listening to this talk, I thought the way in which one CRN emulates another in Cardelli&#8217;s formalism looks awfully similar to the way one dynamical system emulates another in Eugene Lerman&#8217;s formalism:</p>
<p>&bull; Eugene Lerman, <a href="https://johncarlosbaez.wordpress.com/2014/03/18/networks-of-dynamical-systems/">Networks of dynamical systems</a>, Azimuth, 18 March 2014.</p>
<p>The following picture from Cardelli&#8217;s paper shows that one of his morphisms of reaction networks is like &#8216;covering map&#8217;.  This reminds me a lot of what&#8217;s happening in Lerman&#8217;s work.</p>
<p><a href="http://math.ucr.edu/home/baez/networks/cardelli_network_morphisms_2.jpg"><br />
<img width="450" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/cardelli_network_morphisms_2.jpg" alt="" /></a></p>
<p>Again, click to enlarge!</p>
<h3> Seung Woo Shin </h3>
<p>Seung Woo Shin was actually Brendan Fong&#8217;s roommate at the National University of Singapore while Brendan was working with me on chemical reaction networks.  Apparently they never talked about their work!  </p>
<p>Shin spoke about some other concepts of &#8216;morphism&#8217; between chemical reaction networks.  These other concepts do not involve reaction rates, just which chemicals can turn into which.  You can see his slides here:</p>
<p>&bull; Seung Woo Shin, <a href="http://crn.thachuk.com/images/a/a1/Shin_Banff_June2014.pdf">Verifying CRN implementations</a>.</p>
<p>and read his thesis for more details:</p>
<p>&bull; Seung Woo Shin, <a href="http://thesis.library.caltech.edu/6676/">Compiling and verifying DNA-based chemical reaction network implementations</a>, Masters thesis, Caltech, 2012.</p>
<blockquote><p> <b>Abstract:</b> One goal of molecular programming and synthetic biology is to build chemical circuits that can control chemical processes at the molecular level. Remarkably, it has been shown that synthesized DNA molecules can be used to construct complex chemical circuits that operate without any enzyme or cellular component. However, designing DNA molecules at the individual nucleotide base level is often difficult and laborious, and thus chemical reaction networks (CRNs) have been proposed as a higher-level programming language. So far, several general-purpose schemes have been described for designing synthetic DNA molecules that simulate the behavior of arbitrary CRNs, and many more are being actively investigated.</p>
<p>Here, we solve two problems related to this topic. First, we present a general-purpose CRN-to-DNA compiler that can apply user-defined compilation schemes for translating formal CRNs to domain-level specifications for DNA molecules. In doing so, we develop a language in which such schemes can be concisely and precisely described. This compiler can greatly reduce the amount of tedious manual labor faced by researchers working in the field. Second, we present a general method for the formal verification of the correctness of such compilation. We first show that this problem reduces to testing a notion of behavioral equivalence between two CRNs, and then we construct a mathematical formalism in which that notion can be precisely defined. Finally, we provide algorithms for testing that notion. This verification process can be thought of as an equivalent of model checking in molecular computation, and we hope that the generality of our verification techniques will eventually allow us to apply them not only to DNA-based CRN implementations but to a wider class of molecular programs.
</p></blockquote>
<p>His thesis built on this earlier paper:</p>
<p>&bull; David Soloveichik, Georg Seelig and Erik Winfree, <a href="http://www.pnas.org/content/early/2010/02/25/0909380107.full.pdf+html">DNA as a universal substrate for chemical kinetics</a>, <i>Proceedings of the National Academy of Sciences</i> (2010).</p>
<p>I think this work is fascinating and deeply related to category theory, so I talked to Shin and Winfree about it, and this is what we came up with:</p>
<p>&bull; <a href="http://crn.thachuk.com/index.php/CRN_equivalences">CRN equivalences</a>: progress report.</p>
<p>This is one of several <a href="http://crn.thachuk.com/index.php/Main_Page#Reporting">reports</a> on progress people at the workshop made on various <a href="http://crn.thachuk.com/index.php/Open_Problems">open problems</a>.</p>
<h3> David Anderson </h3>
<p>Brendan Fong and I wrote about David Anderson&#8217;s work in <a href="http://math.ucr.edu/home/baez/networks/networks_9.html">Part 9</a> of the network theory series.  It&#8217;s so impressive that I expected him to be older&#8230; older than me, I guess.  He&#8217;s not!</p>
<p>In his tutorial, he gave an overview of chemical reaction networks with an emphasis on the deficiency zero theorem.  Since many people were puzzled by the &#8216;deficiency&#8217; concept, they asked lots of questions.  But I&#8217;ve already explained that idea in <a href="http://math.ucr.edu/home/baez/networks/networks_21.html">Part 21</a>.  So, I&#8217;ll just mention a couple of cool theorems he told us about!</p>
<p><b>Theorem (Horn and Jackson).</b>  If a reaction network has a complex balanced equilibrium, then:</p>
<p>1. It has no equilibria that are not complex balanced.</p>
<p>2. The reaction network must be weakly reversible.</p>
<p>3.  Every stochiometric compatibility class contains precisely one complex balanced equilibrium.</p>
<p>I should have known this, since this work is classic.  But I don&#8217;t think I knew that the existence of <i>one</i> complex balanced equilibrium implied all this stuff!</p>
<p>He also mentioned this paper:</p>
<p>&bull; Guy Shinar and Martin Feinberg, Structural sources of robustness in biochemical reaction networks, <i><a href="http://www.sciencemag.org/content/327/5971/1389.full">Science</a></i> (2010).</p>
<p>which contains this amazing theorem:</p>
<p><b>Theorem (Shinar and Feinberg).</b>  Suppose there is a chemical reaction network such that: </p>
<p>1.  its deficiency equals one;</p>
<p>2.  it has a positive steady state;</p>
<p>3.  it has two &#8220;non-terminal complexes&#8221; that differ only in one species <img src="https://s0.wp.com/latex.php?latex=S.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S." class="latex" />  (&#8220;Non-terminal&#8221; is a concept that&#8217;s easier to explain with a picture of a reaction network).</p>
<p>Then the species <img src="https://s0.wp.com/latex.php?latex=S&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S" class="latex" /> is <b>absolutely robust</b>: with any initial conditions, the rate equation will approach an equilibrium where the concentration of <img src="https://s0.wp.com/latex.php?latex=S&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S" class="latex" /> approaches a specific fixed value <img src="https://s0.wp.com/latex.php?latex=c%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="c," class="latex" /> independent of the initial conditions!</p>
<p>However, things work very differently if we treat the system stochastically, using the master equation:</p>
<p>&bull; David F. Anderson, German A. Enciso and Matthew D. Johnston, <a href="http://arxiv.org/abs/1310.3761">Stochastic analysis of biochemical reaction networks with absolute concentration robustness</a>.</p>
<h3> More </h3>
<p>A lot more happened at this workshop!  There was a huge amount of discussion of the leader election problem, which is about how to cook up chemical reactions that create a &#8216;leader&#8217;: a single molecule of some sort.  </p>
<p>&bull; <a href="http://crn.thachuk.com/index.php/Open_Problems#Leader_election">Leader election</a>: the problem, and references.</p>
<p>&bull; <a href="http://crn.thachuk.com/index.php/Leader_election">Leader election</a>: progress report.</p>
<p>As I explained before, David Soloveichik talked about various forms of <i>digital</i> computation with chemical reaction networks.  David Doty talked about the very important flip side of the coin: <i>analog</i> computation.</p>
<p>&bull; David Doty, <a href="http://www.dna.caltech.edu/~ddoty/papers/riccrn-talk.pdf">Rate-independent computation by real-valued chemistry</a>.</p>
<p>There were also great talks by Lulu Qian and Erik Winfree, which I won&#8217;t try to summarize.  Qian does a lot of work in the lab making things actually happen, so if you&#8217;re a practical sort this is the talk to look at:</p>
<p>&bull; Lulu Qian, <a href="http://crn.thachuk.com/images/4/45/Qian_Banff_June2014.pdf">Implementing complex CRNs with modular DNA components</a>.</p>
<p>All in all, a very stimulating workshop.  The diversity of things one can ask about chemical reaction networks is quite exciting!  </p>
									</div>

				<p class="postmetadata">
				<img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/speech_bubble.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2014/06/26/chemical-reaction-networks/#comments">4 Comments</a>				| <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/documents.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/category/chemistry/" rel="category tag">chemistry</a>, <a href="https://johncarlosbaez.wordpress.com/category/mathematics/" rel="category tag">mathematics</a>								 | <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/permalink.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2014/06/26/chemical-reaction-networks/" rel="bookmark" title="Permanent Link to Chemical Reaction Network&nbsp;Talks">Permalink</a>
<br /><img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/figure_ver1.gif" alt="" /> Posted by John Baez				</p>
			</div>
			<hr />
		
			<div class="post-18170 post type-post status-publish format-standard hentry category-climate" id="post-18170">
				<h2><a href="https://johncarlosbaez.wordpress.com/2014/06/24/el-nino-project-part-2/" rel="bookmark">El Niño Project (Part&nbsp;2)</a></h2>
				<small>24 June, 2014</small><br />


				<div class="entry">
					<p>Before we dive into the exciting world of El Ni&ntilde;o prediction, and ways that you can help, let&#8217;s have a very <i>very</i> basic crash course on the physics of El Ni&ntilde;o.  </p>
<p>El Ni&ntilde;os are still rather mysterious.  But that doesn&#8217;t mean we should ignore what the experts know, or suspect.</p>
<h3> The basics </h3>
<p>Winds called <a href="http://en.wikipedia.org/wiki/Trade_wind">trade winds</a> blow west across the tropical Pacific, from the Americas to Asia.  During La Ni&ntilde;a years, water at the ocean&#8217;s surface moves along with the wind, warming up in the sunlight as it travels.  So, warm water collects at the ocean&#8217;s surface off the coast of Asia.  This creates more clouds and rainstorms there.  </p>
<p>Meanwhile, since surface water is being dragged west by the wind, cold water from below gets pulled up to take its place in the eastern Pacific, off the coast of South America.  </p>
<p>So, the temperature at the ocean&#8217;s surface looks like this:</p>
<div align="center">
<a href="http://www.pmel.noaa.gov/pubs/outstand/mcph2029/text.shtml"><br />
<img width="450" src="https://i1.wp.com/math.ucr.edu/home/baez/ecological/el_nino/sea_surface_temperature_december_1996.jpg" alt="" /><br />
</a>
</div>
<p>This situation is actually reinforced by a feedback loop.  Since the ocean&#8217;s surface is warmer near Asia, it heats the air and makes it rise.  This <i>helps</i> the trade winds blow toward Asia: they go there to fill the &#8216;gap&#8217; left by rising air. </p>
<p>Of course, you should be wondering: why do the trade winds blow <i>west</i> in the first place?</p>
<p>Without an answer to this, the story so far would work just as well if we switched the words &#8216;west&#8217; and &#8216;east&#8217;.   That wouldn&#8217;t mean the story is <i>wrong</i>.  It might just mean that there were two stable states of the Earth&#8217;s climate: a La Ni&ntilde;a state where the trade winds blow west, and another state&#8212;say, the El Ni&ntilde;o&#8212;where they blow east.  One could imagine a world permanently stuck in one of these phases.  Or perhaps it could flip between these two phases for some reason.</p>
<p>Something roughly like the last choice is actually true.  But it&#8217;s not so simple: there&#8217;s not a complete symmetry between west and east!  </p>
<p>Why not?  Mainly because the Earth is turning to the <i>east</i>.  Air near the equator warms up and rises, so new air from more northern or southern regions moves in to take its place.  But because the Earth is fatter at the equator, the equator is moving faster to the east.  So, this new air from other places is moving less quickly by comparison&#8230; so as seen by someone standing on the equator, it blows <i>west</i>.   This is called the <a href="http://en.wikipedia.org/wiki/Coriolis_effect">Coriolis effect</a>, and it produces winds like this:</p>
<div align="center">
<a href="http://upload.wikimedia.org/wikipedia/commons/6/6d/Earth_Global_Circulation.jpg"><br />
<img width="450" border="none" src="http://upload.wikimedia.org/wikipedia/commons/6/6d/Earth_Global_Circulation.jpg" /><br />
</a>
</div>
<p>Beware: a wind that blows to the west is called an <i>easterly</i>.  So the westward-blowing trade winds I&#8217;m talking about are called &quot;northeasterly trades&quot; and &quot;southeasterly trades&quot; on this picture.  </p>
<p>It&#8217;s also good to remember that the west Pacific touches the part of Asia also called the &#8216;Far East&#8217;, while the east Pacific touches the part of America also called the &#8216;West Coast&#8217;.  So, it&#8217;s easy to get confused!  If you find yourself getting confused, just repeat this sentence:</p>
<div align="center">
<b>The easterlies blow west from West Coast to Far East.</b>
</div>
<p>Everything will instantly become much clearer.</p>
<p>Terminology aside, the story so far should be clear.  The trade winds have a good intrinsic reason to blow west, but in the La Ni&ntilde;a phase they&#8217;re also part of a feedback loop where they make the western Pacific warmer&#8230; which in turn <i>helps</i> the trade winds blow west.</p>
<p>But now comes an El Ni&ntilde;o!  Now for some reason the westward winds weaken.  This lets the built-up warm water in the western Pacific slosh back east.  And with weaker westward winds, less cold water is pulled up to the surface in the eastern Pacific.  So, the eastern Pacific warms up.  This makes for more clouds and rain in the eastern Pacific&#8212;that&#8217;s when we get floods in Southern California.  And with the ocean warmer in the eastern Pacific, hot air rises there, which tends to counteract the westward winds even more.</p>
<p>In other words, all the feedbacks reverse themselves!  Here&#8217;s how it looked in the big El Ni&ntilde;o of 1997:</p>
<div align="center">
<a href="http://www.pmel.noaa.gov/pubs/outstand/mcph2029/text.shtml"><br />
<img width="450" src="https://i2.wp.com/math.ucr.edu/home/baez/ecological/el_nino/sea_surface_temperature_december_1997.jpg" alt="" /><br />
</a>
</div>
<p>But note: the trade winds never <i>mainly</i> blow east.  Even during an El Ni&ntilde;o they still blow west, just a bit <i>less</i>.  So, the climate is not flip-flopping between two symmetrical alternatives.  It&#8217;s flip-flopping between two <i>asymmetrical</i> alternatives.</p>
<p>Here&#8217;s how it goes!  The vertical height of the ocean is exaggerated here to show how water piles up:</p>
<div align="center">
<a href="http://www.pmel.noaa.gov/tao/vis/tao-vis.html"><img src="https://johncarlosbaez.files.wordpress.com/2014/05/t-dyn3.gif?w=450" alt="" /></a>
</div>
<p>Here we see the change in trade winds and ocean currents:</p>
<div align="center">
<a href="https://johncarlosbaez.files.wordpress.com/2014/05/sst-wind-cur-eqt-20c1.gif"><img src="https://johncarlosbaez.files.wordpress.com/2014/05/sst-wind-cur-eqt-20c1.gif?w=450" alt="" /></a>
</div>
<p>By the way, you can click on any of the pictures to get more information.</p>
<h3> But why? </h3>
<p>One huge remaining question is:  <i>why</i> do the trade winds weaken?   We could also ask the same question about the start of the La Ni&ntilde;a phase: why do the trade winds get stronger then?</p>
<p>The short answer is: nobody knows!  At least there&#8217;s no <i>one story</i> that everyone agrees on.  There are actually several stories&#8230; and perhaps more than one of them is true.  So, at this point it is worthwhile revisiting some actual data:</p>
<div align="center">
<a href="http://www.cpc.ncep.noaa.gov/products/analysis_monitoring/ensocycle/soi.shtml"><br />
<img border="none" width="450" src="http://www.cpc.ncep.noaa.gov/products/analysis_monitoring/ensocycle/soi_nino34.gif" alt="" /><br />
</a>
</div>
<p>The top graph shows variations in the water temperature of the tropical Eastern Pacific ocean.  When it&#8217;s hot we have El Ni&ntilde;os: those are the red hills in the top graph.  The blue valleys are La Ni&ntilde;as.  Note that it&#8217;s possible to have two El Ni&ntilde;os in a row without an intervening La Ni&ntilde;a, or vice versa!</p>
<p>The bottom graph shows the <a href="http://gcmd.nasa.gov/records/GCMD_NOAA_NWS_CPC_SOI.html"><b>Southern Oscillation Index</b></a> or <b>SOI</b>.  This is basically the air pressure in Tahiti minus the air pressure in Darwin, Australia, divided by its standard deviation.</p>
<p>So, when the SOI is high, the air pressure is higher in the east Pacific than in the west Pacific.  This is what we expect in an La Ni&ntilde;a: that&#8217;s why the westward trade winds are strong then!  Conversely, the SOI is low in the El Ni&ntilde;o phase.  This variation in the SOI is called the <b>Southern Oscillation</b>.</p>
<p>If you look at the graphs above, you&#8217;ll see how one looks almost like an upside-down version of the other.  So, El Ni&ntilde;o/La Ni&ntilde;a cycle is tightly linked to the Southern Oscillation.</p>
<p>Another thing you&#8217;ll see from is that the ENSO is far from perfectly periodic!  Here&#8217;s a graph of the Southern Oscillation Index going back a lot further:</p>
<div align="center">
<a href="http://faculty.washington.edu/kessler/figures.html"><br />
<img border="none" width="450" src="https://i2.wp.com/math.ucr.edu/home/baez/ecological/el_nino/kessler_soi-1876-1998.gif" alt="" /><br />
</a>
</div>
<p>So, there&#8217;s something inherently irregular about this oscillation.  It could be chaotic&#8212;meaning that tiny changes amplify as time goes by, making long-term prediction impossible.  It could be noisy&#8212;meaning that the randomness is mainly due to outside influences.  It could be somewhere in between!  But nobody is sure.</p>
<p>The graph above was made by William Kessler, an expert on El N&ntilde;o.  His FAQs are worth a look:</p>
<p>&bull; William Kessler, <a href="http://faculty.washington.edu/kessler/occasionally-asked-questions.html#q1">What is El Ni&ntilde;o and how does it relate to the usual situation in the tropical Pacific?</a></p>
<p>&bull; William Kessler, <a href="http://faculty.washington.edu/kessler/TALKS/ENSO-AMSteachers2.pdf">El Ni&ntilde;o: How it works, how we observe it</a>.</p>
<p>He describes some theories about why an El Ni&ntilde;o starts, and why it ends.  These theories involve three additional concepts:</p>
<p>&bull; The <a href="http://en.wikipedia.org/wiki/Thermocline"><b>thermocline</b></a> is the border between the warmer surface water in the ocean and the cold deep water, 100 to 200 meters below the surface.  During the La Ni&ntilde;a phase, warm water is blown to the western Pacific, and cold water is pulled up to the surface of the eastern Pacific.  So, the thermocline becomes deeper in the west than the east:</p>
<div align="center">
<a href="http://earthobservatory.nasa.gov/Features/ElNino/"><br />
<img width="250" src="https://i1.wp.com/earthobservatory.nasa.gov/Features/ElNino/Images/sst_depth_1-97.jpg" alt="" /><br />
</a>
</div>
<p>When an El Ni&ntilde;o occurs, the thermocline flattens out:</p>
<div align="center">
<a href="http://earthobservatory.nasa.gov/Features/ElNino/"><br />
<img width="250" src="https://i2.wp.com/earthobservatory.nasa.gov/Features/ElNino/Images/sst_depth_4-97.jpg" alt="" /><br />
</a>
</div>
<div align="center">
<a href="http://earthobservatory.nasa.gov/Features/ElNino/"><br />
<img width="250" src="https://i1.wp.com/earthobservatory.nasa.gov/Features/ElNino/Images/sst_depth_7-97.jpg" alt="" /><br />
</a>
</div>
<p>&bull; <a href="http://en.wikipedia.org/wiki/Rossby_wave"><b>Oceanic Rossby waves</b></a> are very low-frequency waves in the ocean&#8217;s surface and thermocline.   At the ocean&#8217;s surface they are only 5 centimeters high, but hundreds of kilometers across.  The surface waves are mirrored by waves in the thermocline, which are much taller, 10-50 meters in height.  When the surface goes up, the thermocline goes down!</p>
<p>&bull; The <a href="http://www.azimuthproject.org/azimuth/show/Madden-Julian+oscillation"><b>Madden-Julian oscillation</b></a> or <b>MJO</b> is the largest form of variability in the tropical atmosphere on time scales of 30-90 days.  It&#8217;s a pulse that moves east across the Indian Ocean and Pacific ocean at 4-8 meters/second.  It manifests itself as patches of anomalously <i>high</i> rainfall and also anomalously <i>low</i> rainfall.   Strong Madden-Julian Oscillations are often seen 6-12 months before an El Ni&ntilde;o starts!</p>
<p>With this bit of background, I hope you&#8217;re ready for what Kessler wrote in his <a href="http://faculty.washington.edu/kessler/occasionally-asked-questions.html#q1">El Ni&ntilde;o FAQ</a>:</p>
<blockquote><p>
There are two main theories at present. The first is that the event is initiated by the reflection from the western boundary of the Pacific of an oceanic Rossby wave (type of low-frequency planetary wave that moves only west). The reflected wave is supposed to lower the thermocline in the west-central Pacific and thereby warm the sea surface temperature by reducing the efficiency of upwelling to cool the surface. Then that makes winds blow towards the (slightly) warmer water and really start the event. The nice part about this theory is that the oceanic Rossby waves can be observed for months before the reflection, which implies that El Ni&ntilde;o is predictable.</p>
<p>The other idea is that the trigger is essentially random. The tropical convection (organized large-scale thunderstorm activity) in the rising air tends to occur in bursts that last for about a month, and these bursts propagate out of the Indian Ocean (known as the Madden-Julian Oscillation). Since the storms are geostrophic (rotating according to the turning of the earth, which means they rotate clockwise in the southern hemisphere and counter-clockwise in the north), storm winds on the equator always blow towards the east. If the storms are strong enough, or last long enough, then those eastward winds may be enough to start the sloshing. But specific Madden-Julian Oscillation events are not predictable much in advance (just as specific weather events are not predictable in advance), and so to the extent that this is the main element, then El Ni&ntilde;o will not be predictable.</p>
<p>In my opinion both these two processes can be important in different El Ni&ntilde;os. Some models that did not have the MJO storms were successful in predicting the events of 1986-87 and 1991-92. That suggests that the Rossby wave part was a main influence at that time. But those same models have failed to predict the events since then, and the westerlies have appeared to come from nowhere. It is also quite possible that these two general sets of ideas are incomplete, and that there are other causes entirely. The fact that we have very intermittent skill at predicting the major turns of the ENSO cycle (as opposed to the very good forecasts that can be made once an event has begun) suggests that there remain important elements that are await explanation.
</p></blockquote>
<p>So it&#8217;s complicated!  </p>
<p>Next time I&#8217;ll talk about <a href="http://phys.org/news/2014-02-controversial-approach-el-nino.html">a new paper</a> that tries to cut through these complications and predict El Ni&ntilde;os more than 6 months in advance, using a simple idea.   It&#8217;s a great opportunity for programmers to dive in and try to do better.  But I think we need to keep the subtleties in mind&#8230; at least somewhere in the back of our mind.</p>
									</div>

				<p class="postmetadata">
				<img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/speech_bubble.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2014/06/24/el-nino-project-part-2/#comments">12 Comments</a>				| <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/documents.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/category/climate/" rel="category tag">climate</a>								 | <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/permalink.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2014/06/24/el-nino-project-part-2/" rel="bookmark" title="Permanent Link to El Niño Project (Part&nbsp;2)">Permalink</a>
<br /><img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/figure_ver1.gif" alt="" /> Posted by John Baez				</p>
			</div>
			<hr />
		
		<div class="navigation">
			<div class="alignleft"><a href="https://johncarlosbaez.wordpress.com/2014/page/4/" >&laquo; Previous Entries</a></div>
			<div class="alignright"><a href="https://johncarlosbaez.wordpress.com/2014/page/2/" >Next Entries &raquo;</a></div>
		</div>

	
	</div>

	<div id="sidebar">
				<ul>

		 <li>

				<p>You are currently browsing the <a href="https://johncarlosbaez.wordpress.com/">Azimuth</a> blog archives for the year 2014.</p>

					</li> 
		<li id="recent-posts-3" class="widget widget_recent_entries">
		<h2 class="widgettitle">latest posts:</h2>

		<ul>
											<li>
					<a href="https://johncarlosbaez.wordpress.com/2021/09/26/classical-mechanics-versus-thermodynamics-part-4/">Classical Mechanics versus Thermodynamics (Part&nbsp;4)</a>
									</li>
											<li>
					<a href="https://johncarlosbaez.wordpress.com/2021/09/23/classical-mechanics-versus-thermodynamics-part-3/">Classical Mechanics versus Thermodynamics (Part&nbsp;3)</a>
									</li>
											<li>
					<a href="https://johncarlosbaez.wordpress.com/2021/09/22/maxwells-relations-part-3/">Maxwell&#8217;s Relations (Part&nbsp;3)</a>
									</li>
											<li>
					<a href="https://johncarlosbaez.wordpress.com/2021/09/18/maxwells-relations-part-two/">Maxwell&#8217;s Relations (Part&nbsp;2)</a>
									</li>
											<li>
					<a href="https://johncarlosbaez.wordpress.com/2021/09/17/maxwells-relations-part-1/">Maxwell&#8217;s Relations (Part&nbsp;1)</a>
									</li>
											<li>
					<a href="https://johncarlosbaez.wordpress.com/2021/09/13/the-cyclic-identity-for-partial-derivatives/">The Cyclic Identity for Partial&nbsp;Derivatives</a>
									</li>
											<li>
					<a href="https://johncarlosbaez.wordpress.com/2021/08/17/information-geometry-part-21/">Information Geometry (Part&nbsp;21)</a>
									</li>
											<li>
					<a href="https://johncarlosbaez.wordpress.com/2021/08/14/information-geometry-part-20/">Information Geometry (Part&nbsp;20)</a>
									</li>
											<li>
					<a href="https://johncarlosbaez.wordpress.com/2021/08/08/information-geometry-part-19/">Information Geometry (Part&nbsp;19)</a>
									</li>
											<li>
					<a href="https://johncarlosbaez.wordpress.com/2021/08/05/information-geometry-part-18/">Information Geometry (Part&nbsp;18)</a>
									</li>
					</ul>

		</li>
<li id="recent-comments-2" class="widget widget_recent_comments"><h2 class="widgettitle">latest comments:</h2>
				<table class="recentcommentsavatar" cellspacing="0" cellpadding="0" border="0">
					<tr><td title="Toby Bartels" class="recentcommentsavatartop" style="height:32px; width:32px;"><a href="http://tobybartels.name/" rel="nofollow"><img alt='' src='https://0.gravatar.com/avatar/68c7b083965f5073c50bf7c8d2aac358?s=32&#038;d=identicon&#038;r=G' class='avatar avatar-32' height='32' width='32' /></a></td><td class="recentcommentstexttop" style=""><a href="http://tobybartels.name/" rel="nofollow">Toby Bartels</a> on <a href="https://johncarlosbaez.wordpress.com/2021/09/23/classical-mechanics-versus-thermodynamics-part-3/#comment-172598">Classical Mechanics versus The&hellip;</a></td></tr><tr><td title="David Corfield" class="recentcommentsavatarend" style="height:32px; width:32px;"><img alt='' src='https://0.gravatar.com/avatar/34784534843022b3541c8ddd693718cb?s=32&#038;d=identicon&#038;r=G' class='avatar avatar-32' height='32' width='32' /></td><td class="recentcommentstextend" style="">David Corfield on <a href="https://johncarlosbaez.wordpress.com/2021/09/23/classical-mechanics-versus-thermodynamics-part-3/#comment-172597">Classical Mechanics versus The&hellip;</a></td></tr><tr><td title="Toby Bartels" class="recentcommentsavatarend" style="height:32px; width:32px;"><a href="http://tobybartels.name/" rel="nofollow"><img alt='' src='https://0.gravatar.com/avatar/68c7b083965f5073c50bf7c8d2aac358?s=32&#038;d=identicon&#038;r=G' class='avatar avatar-32' height='32' width='32' /></a></td><td class="recentcommentstextend" style=""><a href="http://tobybartels.name/" rel="nofollow">Toby Bartels</a> on <a href="https://johncarlosbaez.wordpress.com/2021/09/26/classical-mechanics-versus-thermodynamics-part-4/#comment-172596">Classical Mechanics versus The&hellip;</a></td></tr><tr><td title="David Corfield" class="recentcommentsavatarend" style="height:32px; width:32px;"><img alt='' src='https://lh3.googleusercontent.com/a/AATXAJxXcoKzwm_cY3LJp3qldhAQvZVoBimQd4xe5tDl=s96-c' class='avatar avatar-32' height='32' width='32' /></td><td class="recentcommentstextend" style="">David Corfield on <a href="https://johncarlosbaez.wordpress.com/2021/09/23/classical-mechanics-versus-thermodynamics-part-3/#comment-172590">Classical Mechanics versus The&hellip;</a></td></tr><tr><td title="amarashiki" class="recentcommentsavatarend" style="height:32px; width:32px;"><a href="http://gravatar.com/amarashiki" rel="nofollow"><img alt='' src='https://0.gravatar.com/avatar/62b2df0762257e75433ad6f161488c3a?s=32&#038;d=identicon&#038;r=G' class='avatar avatar-32' height='32' width='32' /></a></td><td class="recentcommentstextend" style=""><a href="http://gravatar.com/amarashiki" rel="nofollow">amarashiki</a> on <a href="https://johncarlosbaez.wordpress.com/2012/01/23/classical-mechanics-versus-thermodynamics-part-2/#comment-172566">Classical Mechanics versus The&hellip;</a></td></tr><tr><td title="John Baez" class="recentcommentsavatarend" style="height:32px; width:32px;"><a href="http://math.ucr.edu/home/baez/" rel="nofollow"><img alt='' src='https://0.gravatar.com/avatar/34784534843022b3541c8ddd693718cb?s=32&#038;d=identicon&#038;r=G' class='avatar avatar-32' height='32' width='32' /></a></td><td class="recentcommentstextend" style=""><a href="http://math.ucr.edu/home/baez/" rel="nofollow">John Baez</a> on <a href="https://johncarlosbaez.wordpress.com/2021/09/23/classical-mechanics-versus-thermodynamics-part-3/#comment-172560">Classical Mechanics versus The&hellip;</a></td></tr><tr><td title="domenico" class="recentcommentsavatarend" style="height:32px; width:32px;"><img alt='' src='https://2.gravatar.com/avatar/ba06491deb8346d20356ac2ae05893ee?s=32&#038;d=identicon&#038;r=G' class='avatar avatar-32' height='32' width='32' /></td><td class="recentcommentstextend" style="">domenico on <a href="https://johncarlosbaez.wordpress.com/2021/09/23/classical-mechanics-versus-thermodynamics-part-3/#comment-172559">Classical Mechanics versus The&hellip;</a></td></tr><tr><td title="domenico" class="recentcommentsavatarend" style="height:32px; width:32px;"><img alt='' src='https://2.gravatar.com/avatar/ba06491deb8346d20356ac2ae05893ee?s=32&#038;d=identicon&#038;r=G' class='avatar avatar-32' height='32' width='32' /></td><td class="recentcommentstextend" style="">domenico on <a href="https://johncarlosbaez.wordpress.com/2021/09/23/classical-mechanics-versus-thermodynamics-part-3/#comment-172558">Classical Mechanics versus The&hellip;</a></td></tr><tr><td title="Maxwell Relations | Equivalent eXchange" class="recentcommentsavatarend" style="height:32px; width:32px;"><a href="http://equivalentexchange.blog/2021/09/25/maxwell-relations/" rel="nofollow"></a></td><td class="recentcommentstextend" style=""><a href="http://equivalentexchange.blog/2021/09/25/maxwell-relations/" rel="nofollow">Maxwell Relations |&hellip;</a> on <a href="https://johncarlosbaez.wordpress.com/2021/09/22/maxwells-relations-part-3/#comment-172557">Maxwell&#8217;s Relations (Par&hellip;</a></td></tr><tr><td title="Maxwell Relations | Equivalent eXchange" class="recentcommentsavatarend" style="height:32px; width:32px;"><a href="http://equivalentexchange.blog/2021/09/25/maxwell-relations/" rel="nofollow"></a></td><td class="recentcommentstextend" style=""><a href="http://equivalentexchange.blog/2021/09/25/maxwell-relations/" rel="nofollow">Maxwell Relations |&hellip;</a> on <a href="https://johncarlosbaez.wordpress.com/2021/09/18/maxwells-relations-part-two/#comment-172556">Maxwell&#8217;s Relations (Par&hellip;</a></td></tr>				</table>
				</li>
<li id="text-3" class="widget widget_text"><h2 class="widgettitle">How To Write Math Here:</h2>
			<div class="textwidget"><p>You can <a href="http://en.wikibooks.org/wiki/LaTeX/Mathematics">include math in your comments using LaTeX</a>,  but you need to do it this way:</p>
<p>&#036;latex  E = mc^2&#036;</p>
<p>You need the word 'latex' right after the first dollar sign, and it needs a space after it.  Double dollar signs don't work, and other limitations apply, some described <a href="http://en.support.wordpress.com/latex/">here</a>.  You can't preview comments here, but I'm happy to fix errors.</p>
</div>
		</li>
<li id="categories-2" class="widget widget_categories"><h2 class="widgettitle">Read Posts On:</h2>

			<ul>
					<li class="cat-item cat-item-177"><a href="https://johncarlosbaez.wordpress.com/category/art/">art</a> (3)
</li>
	<li class="cat-item cat-item-4003"><a href="https://johncarlosbaez.wordpress.com/category/astronomy/">astronomy</a> (29)
</li>
	<li class="cat-item cat-item-8262191"><a href="https://johncarlosbaez.wordpress.com/category/azimuth/">azimuth</a> (60)
</li>
	<li class="cat-item cat-item-86856"><a href="https://johncarlosbaez.wordpress.com/category/biodiversity/">biodiversity</a> (38)
</li>
	<li class="cat-item cat-item-4936"><a href="https://johncarlosbaez.wordpress.com/category/biology/">biology</a> (107)
</li>
	<li class="cat-item cat-item-355244"><a href="https://johncarlosbaez.wordpress.com/category/carbon-emissions/">carbon emissions</a> (78)
</li>
	<li class="cat-item cat-item-5936"><a href="https://johncarlosbaez.wordpress.com/category/chemistry/">chemistry</a> (74)
</li>
	<li class="cat-item cat-item-6108"><a href="https://johncarlosbaez.wordpress.com/category/climate/">climate</a> (155)
</li>
	<li class="cat-item cat-item-5043"><a href="https://johncarlosbaez.wordpress.com/category/computer-science/">computer science</a> (57)
</li>
	<li class="cat-item cat-item-9204"><a href="https://johncarlosbaez.wordpress.com/category/conferences/">conferences</a> (81)
</li>
	<li class="cat-item cat-item-1098"><a href="https://johncarlosbaez.wordpress.com/category/culture/">culture</a> (4)
</li>
	<li class="cat-item cat-item-657"><a href="https://johncarlosbaez.wordpress.com/category/economics/">economics</a> (32)
</li>
	<li class="cat-item cat-item-1212"><a href="https://johncarlosbaez.wordpress.com/category/energy/">energy</a> (50)
</li>
	<li class="cat-item cat-item-25393"><a href="https://johncarlosbaez.wordpress.com/category/engineering/">engineering</a> (11)
</li>
	<li class="cat-item cat-item-14852"><a href="https://johncarlosbaez.wordpress.com/category/mathematics/game-theory/">game theory</a> (29)
</li>
	<li class="cat-item cat-item-1215"><a href="https://johncarlosbaez.wordpress.com/category/geography/">geography</a> (4)
</li>
	<li class="cat-item cat-item-337"><a href="https://johncarlosbaez.wordpress.com/category/health/">health</a> (4)
</li>
	<li class="cat-item cat-item-678"><a href="https://johncarlosbaez.wordpress.com/category/history/">history</a> (2)
</li>
	<li class="cat-item cat-item-23375499"><a href="https://johncarlosbaez.wordpress.com/category/information-and-entropy/">information and entropy</a> (92)
</li>
	<li class="cat-item cat-item-3558"><a href="https://johncarlosbaez.wordpress.com/category/jobs/">jobs</a> (11)
</li>
	<li class="cat-item cat-item-5465"><a href="https://johncarlosbaez.wordpress.com/category/journals/">journals</a> (5)
</li>
	<li class="cat-item cat-item-3582"><a href="https://johncarlosbaez.wordpress.com/category/mathematics/">mathematics</a> (479)
</li>
	<li class="cat-item cat-item-18"><a href="https://johncarlosbaez.wordpress.com/category/music/">music</a> (3)
</li>
	<li class="cat-item cat-item-3968"><a href="https://johncarlosbaez.wordpress.com/category/networks/">networks</a> (185)
</li>
	<li class="cat-item cat-item-154934"><a href="https://johncarlosbaez.wordpress.com/category/oceans/">oceans</a> (13)
</li>
	<li class="cat-item cat-item-1211"><a href="https://johncarlosbaez.wordpress.com/category/physics/">physics</a> (205)
</li>
	<li class="cat-item cat-item-10451"><a href="https://johncarlosbaez.wordpress.com/category/probability/">probability</a> (92)
</li>
	<li class="cat-item cat-item-4909"><a href="https://johncarlosbaez.wordpress.com/category/psychology/">psychology</a> (6)
</li>
	<li class="cat-item cat-item-3330"><a href="https://johncarlosbaez.wordpress.com/category/publishing/">publishing</a> (19)
</li>
	<li class="cat-item cat-item-46615"><a href="https://johncarlosbaez.wordpress.com/category/puzzles/">puzzles</a> (14)
</li>
	<li class="cat-item cat-item-4140243"><a href="https://johncarlosbaez.wordpress.com/category/quantum-technologies/">quantum technologies</a> (28)
</li>
	<li class="cat-item cat-item-562"><a href="https://johncarlosbaez.wordpress.com/category/questions/">questions</a> (3)
</li>
	<li class="cat-item cat-item-93974"><a href="https://johncarlosbaez.wordpress.com/category/risks/">risks</a> (48)
</li>
	<li class="cat-item cat-item-37893"><a href="https://johncarlosbaez.wordpress.com/category/seminars/">seminars</a> (21)
</li>
	<li class="cat-item cat-item-581"><a href="https://johncarlosbaez.wordpress.com/category/software/">software</a> (19)
</li>
	<li class="cat-item cat-item-39438"><a href="https://johncarlosbaez.wordpress.com/category/strategies/">strategies</a> (36)
</li>
	<li class="cat-item cat-item-6877"><a href="https://johncarlosbaez.wordpress.com/category/sustainability/">sustainability</a> (71)
</li>
	<li class="cat-item cat-item-66608272"><a href="https://johncarlosbaez.wordpress.com/category/the-practice-of-science/">the practice of science</a> (27)
</li>
	<li class="cat-item cat-item-61590"><a href="https://johncarlosbaez.wordpress.com/category/this-weeks-finds/">this week&#039;s finds</a> (18)
</li>
			</ul>

			</li>
<li id="linkcat-20924250" class="widget widget_links"><h2 class="widgettitle">also visit these:</h2>

	<ul class='xoxo blogroll'>
<li><a href="http://www.azimuthproject.org/azimuth/show/Azimuth+Blog" title="Go here to see what’s on this blog, organized by topic or author!">Azimuth Blog Overview</a></li>
<li><a href="http://www.azimuthproject.org/azimuth/show/HomePage" title="for scientists and engineers who want to save the planet">Azimuth Project</a></li>
<li><a href="http://bittooth.blogspot.com/" title="David Summers on energy: oil, gas and more">Bit Tooth Energy</a></li>
<li><a href="http://bravenewclimate.com/" title="Barry Brooks on climate and energy policy">Brave New Climate</a></li>
<li><a href="http://physics.ucsd.edu/do-the-math/" title="UC San Diego prof uses physics and estimation to assess energy, growth, options">Do the Math</a></li>
<li><a href="http://dotearth.blogs.nytimes.com/" title="Andrew Revkin’s environmental blog on the New York Times">Dot Earth</a></li>
<li><a href="http://e360.yale.edu/" title="News from the Yale School of Forestry &amp; Environmental Studies">Environment 360</a></li>
<li><a href="http://planet3.org/" title="A metablog on sustainability">Planet3.0</a></li>
<li><a href="http://www.realclimate.org/" title="climate science from climate scientists">RealClimate</a></li>
<li><a href="http://www.easterbrook.ca/steve/" title="Steve Easterbrook&#8217;s blog on software engineering and climate modeling">Serendipity</a></li>
<li><a href="http://scienceofdoom.com/" title="climate science in perspective">The Science of Doom</a></li>
<li><a href="http://e360.yale.edu/" title="opinion, analysis, reporting and debate on environmental issues">Yale Environment 360</a></li>

	</ul>
</li>

<li id="rss_links-3" class="widget widget_rss_links"><h2 class="widgettitle">RSS feeds:</h2>
<p class="size-small"><a class="feed-image-link" href="https://johncarlosbaez.wordpress.com/feed/" title="Subscribe to Posts"><img src="https://johncarlosbaez.wordpress.com/i/rss/red-small.png?m=1391188133h" alt="RSS Feed" /></a>&nbsp;<a href="https://johncarlosbaez.wordpress.com/feed/" title="Subscribe to Posts">RSS - Posts</a></p><p class="size-small"><a class="feed-image-link" href="https://johncarlosbaez.wordpress.com/comments/feed/" title="Subscribe to Comments"><img src="https://johncarlosbaez.wordpress.com/i/rss/red-small.png?m=1391188133h" alt="RSS Feed" /></a>&nbsp;<a href="https://johncarlosbaez.wordpress.com/comments/feed/" title="Subscribe to Comments">RSS - Comments</a></p>
</li>
<li id="blog_subscription-3" class="widget widget_blog_subscription jetpack_subscription_widget"><h2 class="widgettitle"><label for="subscribe-field">Email Subscription:</label></h2>

			<form
				action="https://subscribe.wordpress.com"
				method="post"
				accept-charset="utf-8"
				id=""
			>
				<p>Enter your email address to subscribe to this blog and receive notifications of new posts by email.</p>
					<div class="jetpack-subscribe-count">
						<p>
						Join 5,228 other followers						</p>
					</div>
									<p id="subscribe-email">
					<label
						id="subscribe-field-label"
						for="subscribe-field"
						class="screen-reader-text"
					>
						Email Address:					</label>

					<input
							type="email"
							name="email"
							
							style="width: 95%; padding: 1px 10px"
							placeholder="Enter your email address"
							value=""
							id="subscribe-field"
						/>				</p>

				<p id="subscribe-submit"
									>
                    <input type="hidden" name="action" value="subscribe"/>
                    <input type="hidden" name="blog_id" value="12777403"/>
                    <input type="hidden" name="source" value="https://johncarlosbaez.wordpress.com/2014/page/3/"/>
                    <input type="hidden" name="sub-type" value="widget"/>
                    <input type="hidden" name="redirect_fragment" value="blog_subscription-3"/>
					<input type="hidden" id="_wpnonce" name="_wpnonce" value="ffcb185558" />                    <button type="submit"
	                    	                        class="wp-block-button__link"
	                    		                	                >
	                    Sign me up!                    </button>
                </p>
            </form>
			
</li>
<li id="search-3" class="widget widget_search"><h2 class="widgettitle">SEARCH:</h2>
<form method="get" id="searchform" action="https://johncarlosbaez.wordpress.com/">
<div><label for="s" class="search-label">Search</label><input type="text" value="" name="s" id="s" />
<input type="submit" id="searchsubmit" value="Search" />
</div>
</form></li>
<li id="blog-stats-2" class="widget widget_blog-stats"><h2 class="widgettitle">Blog Stats:</h2>
		<ul>
			<li>4,177,577 hits</li>
		</ul>
		</li>
		</ul>
	</div>



<div id="footer">
	<p>
	<br />
	<a href="https://wordpress.com/?ref=footer_blog" rel="nofollow">Blog at WordPress.com.</a>
	</p>
</div>

</div>

				<script type="text/javascript">
		//<![CDATA[
		var infiniteScroll = JSON.parse( decodeURIComponent( '%7B%22settings%22%3A%7B%22id%22%3A%22content%22%2C%22ajaxurl%22%3A%22https%3A%5C%2F%5C%2Fjohncarlosbaez.wordpress.com%5C%2F%3Finfinity%3Dscrolling%22%2C%22type%22%3A%22scroll%22%2C%22wrapper%22%3Atrue%2C%22wrapper_class%22%3A%22infinite-wrap%22%2C%22footer%22%3Atrue%2C%22click_handle%22%3A%221%22%2C%22text%22%3A%22Older%20posts%22%2C%22totop%22%3A%22Scroll%20back%20to%20top%22%2C%22currentday%22%3A%2224.06.14%22%2C%22order%22%3A%22DESC%22%2C%22scripts%22%3A%5B%5D%2C%22styles%22%3A%5B%5D%2C%22google_analytics%22%3Afalse%2C%22offset%22%3A3%2C%22history%22%3A%7B%22host%22%3A%22johncarlosbaez.wordpress.com%22%2C%22path%22%3A%22%5C%2F2014%5C%2Fpage%5C%2F%25d%5C%2F%22%2C%22use_trailing_slashes%22%3Atrue%2C%22parameters%22%3A%22%22%7D%2C%22query_args%22%3A%7B%22paged%22%3A3%2C%22year%22%3A2014%2C%22error%22%3A%22%22%2C%22m%22%3A%22%22%2C%22p%22%3A0%2C%22post_parent%22%3A%22%22%2C%22subpost%22%3A%22%22%2C%22subpost_id%22%3A%22%22%2C%22attachment%22%3A%22%22%2C%22attachment_id%22%3A0%2C%22name%22%3A%22%22%2C%22pagename%22%3A%22%22%2C%22page_id%22%3A0%2C%22second%22%3A%22%22%2C%22minute%22%3A%22%22%2C%22hour%22%3A%22%22%2C%22day%22%3A0%2C%22monthnum%22%3A0%2C%22w%22%3A0%2C%22category_name%22%3A%22%22%2C%22tag%22%3A%22%22%2C%22cat%22%3A%22%22%2C%22tag_id%22%3A%22%22%2C%22author%22%3A%22%22%2C%22author_name%22%3A%22%22%2C%22feed%22%3A%22%22%2C%22tb%22%3A%22%22%2C%22meta_key%22%3A%22%22%2C%22meta_value%22%3A%22%22%2C%22preview%22%3A%22%22%2C%22s%22%3A%22%22%2C%22sentence%22%3A%22%22%2C%22title%22%3A%22%22%2C%22fields%22%3A%22%22%2C%22menu_order%22%3A%22%22%2C%22embed%22%3A%22%22%2C%22category__in%22%3A%5B%5D%2C%22category__not_in%22%3A%5B%5D%2C%22category__and%22%3A%5B%5D%2C%22post__in%22%3A%5B%5D%2C%22post__not_in%22%3A%5B%5D%2C%22post_name__in%22%3A%5B%5D%2C%22tag__in%22%3A%5B%5D%2C%22tag__not_in%22%3A%5B%5D%2C%22tag__and%22%3A%5B%5D%2C%22tag_slug__in%22%3A%5B%5D%2C%22tag_slug__and%22%3A%5B%5D%2C%22post_parent__in%22%3A%5B%5D%2C%22post_parent__not_in%22%3A%5B%5D%2C%22author__in%22%3A%5B%5D%2C%22author__not_in%22%3A%5B%5D%2C%22lazy_load_term_meta%22%3Afalse%2C%22posts_per_page%22%3A10%2C%22ignore_sticky_posts%22%3Afalse%2C%22suppress_filters%22%3Afalse%2C%22cache_results%22%3Afalse%2C%22update_post_term_cache%22%3Atrue%2C%22update_post_meta_cache%22%3Atrue%2C%22post_type%22%3A%22%22%2C%22nopaging%22%3Afalse%2C%22comments_per_page%22%3A%22100%22%2C%22no_found_rows%22%3Afalse%2C%22order%22%3A%22DESC%22%7D%2C%22query_before%22%3A%222021-09-26%2017%3A24%3A18%22%2C%22last_post_date%22%3A%222014-06-24%2000%3A30%3A46%22%2C%22body_class%22%3A%22infinite-scroll%20neverending%22%2C%22loading_text%22%3A%22Loading%20new%20page%22%2C%22stats%22%3A%22blog%3D12777403%26v%3Dwpcom%26tz%3D0%26user_id%3D0%26subd%3Djohncarlosbaez%26x_pagetype%3Dinfinite%22%7D%7D' ) );
		//]]>
		</script>
		<!--  -->
<script src='//0.gravatar.com/js/gprofiles.js?ver=202138y' id='grofiles-cards-js'></script>
<script id='wpgroho-js-extra'>
var WPGroHo = {"my_hash":""};
</script>
<script crossorigin='anonymous' type='text/javascript' src='https://s1.wp.com/wp-content/mu-plugins/gravatar-hovercards/wpgroho.js?m=1610363240h'></script>

	<script>
		// Initialize and attach hovercards to all gravatars
		( function() {
			function init() {
				if ( typeof Gravatar === 'undefined' ) {
					return;
				}

				if ( typeof Gravatar.init !== 'function' ) {
					return;
				}

				Gravatar.profile_cb = function ( hash, id ) {
					WPGroHo.syncProfileData( hash, id );
				};

				Gravatar.my_hash = WPGroHo.my_hash;
				Gravatar.init( 'body', '#wp-admin-bar-my-account' );
			}

			if ( document.readyState !== 'loading' ) {
				init();
			} else {
				document.addEventListener( 'DOMContentLoaded', init );
			}
		} )();
	</script>

		<div style="display:none">
	<div class="grofile-hash-map-68c7b083965f5073c50bf7c8d2aac358">
	</div>
	<div class="grofile-hash-map-34784534843022b3541c8ddd693718cb">
	</div>
	<div class="grofile-hash-map-7d52fbe20c8ac05886a296e9ee2159b1">
	</div>
	<div class="grofile-hash-map-62b2df0762257e75433ad6f161488c3a">
	</div>
	<div class="grofile-hash-map-ba06491deb8346d20356ac2ae05893ee">
	</div>
	</div>
		<div id="infinite-footer">
			<div class="container">
				<div class="blog-info">
					<a id="infinity-blog-title" href="https://johncarlosbaez.wordpress.com/" rel="home">
						Azimuth					</a>
				</div>
				<div class="blog-credits">
					<a href="https://wordpress.com/?ref=footer_blog" rel="nofollow">Blog at WordPress.com.</a> 				</div>
			</div>
		</div><!-- #infinite-footer -->
		
<script>
window.addEventListener( "load", function( event ) {
	var link = document.createElement( "link" );
	link.href = "https://s0.wp.com/wp-content/mu-plugins/actionbar/actionbar.css?v=20210915";
	link.type = "text/css";
	link.rel = "stylesheet";
	document.head.appendChild( link );

	var script = document.createElement( "script" );
	script.src = "https://s0.wp.com/wp-content/mu-plugins/actionbar/actionbar.js?v=20210920";
	script.defer = true;
	document.body.appendChild( script );
} );
</script>

			<div id="jp-carousel-loading-overlay">
			<div id="jp-carousel-loading-wrapper">
				<span id="jp-carousel-library-loading">&nbsp;</span>
			</div>
		</div>
		<div class="jp-carousel-overlay" style="display: none;">

		<div class="jp-carousel-container">
			<!-- The Carousel Swiper -->
			<div
				class="jp-carousel-wrap swiper-container jp-carousel-swiper-container jp-carousel-transitions"
				itemscope
				itemtype="https://schema.org/ImageGallery">
				<div class="jp-carousel swiper-wrapper"></div>
				<div class="jp-swiper-button-prev swiper-button-prev">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskPrev" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="9" height="12">
							<path d="M16.2072 16.59L11.6496 12L16.2072 7.41L14.8041 6L8.8335 12L14.8041 18L16.2072 16.59Z" fill="white"/>
						</mask>
						<g mask="url(#maskPrev)">
							<rect x="0.579102" width="23.8823" height="24" fill="#FFFFFF"/>
						</g>
					</svg>
				</div>
				<div class="jp-swiper-button-next swiper-button-next">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskNext" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="8" height="12">
							<path d="M8.59814 16.59L13.1557 12L8.59814 7.41L10.0012 6L15.9718 12L10.0012 18L8.59814 16.59Z" fill="white"/>
						</mask>
						<g mask="url(#maskNext)">
							<rect x="0.34375" width="23.8822" height="24" fill="#FFFFFF"/>
						</g>
					</svg>
				</div>
			</div>
			<!-- The main close buton -->
			<div class="jp-carousel-close-hint">
				<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
					<mask id="maskClose" mask-type="alpha" maskUnits="userSpaceOnUse" x="5" y="5" width="15" height="14">
						<path d="M19.3166 6.41L17.9135 5L12.3509 10.59L6.78834 5L5.38525 6.41L10.9478 12L5.38525 17.59L6.78834 19L12.3509 13.41L17.9135 19L19.3166 17.59L13.754 12L19.3166 6.41Z" fill="white"/>
					</mask>
					<g mask="url(#maskClose)">
						<rect x="0.409668" width="23.8823" height="24" fill="#FFFFFF"/>
					</g>
				</svg>
			</div>
			<!-- Image info, comments and meta -->
			<div class="jp-carousel-info">
				<div class="jp-carousel-info-footer">
					<div class="jp-carousel-pagination-container">
						<div class="jp-swiper-pagination swiper-pagination"></div>
						<div class="jp-carousel-pagination"></div>
					</div>
					<div class="jp-carousel-photo-title-container">
						<h2 class="jp-carousel-photo-caption"></h2>
					</div>
					<div class="jp-carousel-photo-icons-container">
						<a href="#" class="jp-carousel-icon-btn jp-carousel-icon-info" aria-label="Toggle photo metadata visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskInfo" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M12.7537 2C7.26076 2 2.80273 6.48 2.80273 12C2.80273 17.52 7.26076 22 12.7537 22C18.2466 22 22.7046 17.52 22.7046 12C22.7046 6.48 18.2466 2 12.7537 2ZM11.7586 7V9H13.7488V7H11.7586ZM11.7586 11V17H13.7488V11H11.7586ZM4.79292 12C4.79292 16.41 8.36531 20 12.7537 20C17.142 20 20.7144 16.41 20.7144 12C20.7144 7.59 17.142 4 12.7537 4C8.36531 4 4.79292 7.59 4.79292 12Z" fill="white"/>
									</mask>
									<g mask="url(#maskInfo)">
										<rect x="0.8125" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>
							</span>
						</a>
												<a href="#" class="jp-carousel-icon-btn jp-carousel-icon-comments" aria-label="Toggle photo comments visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskComments" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M4.3271 2H20.2486C21.3432 2 22.2388 2.9 22.2388 4V16C22.2388 17.1 21.3432 18 20.2486 18H6.31729L2.33691 22V4C2.33691 2.9 3.2325 2 4.3271 2ZM6.31729 16H20.2486V4H4.3271V18L6.31729 16Z" fill="white"/>
									</mask>
									<g mask="url(#maskComments)">
										<rect x="0.34668" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>

								<span class="jp-carousel-has-comments-indicator" aria-label="This image has comments."></span>
							</span>
						</a>
											</div>
				</div>
				<div class="jp-carousel-info-extra">
					<div class="jp-carousel-info-content-wrapper">
						<div class="jp-carousel-photo-title-container">
							<h2 class="jp-carousel-photo-title"></h2>
						</div>
						<div class="jp-carousel-comments-wrapper">
															<div id="jp-carousel-comments-loading">
									<span>Loading Comments...</span>
								</div>
								<div class="jp-carousel-comments"></div>
								<div id="jp-carousel-comment-form-container">
									<span id="jp-carousel-comment-form-spinner">&nbsp;</span>
									<div id="jp-carousel-comment-post-results"></div>
																														<form id="jp-carousel-comment-form">
												<label for="jp-carousel-comment-form-comment-field" class="screen-reader-text">Write a Comment...</label>
												<textarea
													name="comment"
													class="jp-carousel-comment-form-field jp-carousel-comment-form-textarea"
													id="jp-carousel-comment-form-comment-field"
													placeholder="Write a Comment..."
												></textarea>
												<div id="jp-carousel-comment-form-submit-and-info-wrapper">
													<div id="jp-carousel-comment-form-commenting-as">
																													<fieldset>
																<label for="jp-carousel-comment-form-email-field">Email (Required)</label>
																<input type="text" name="email" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-email-field" />
															</fieldset>
															<fieldset>
																<label for="jp-carousel-comment-form-author-field">Name (Required)</label>
																<input type="text" name="author" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-author-field" />
															</fieldset>
															<fieldset>
																<label for="jp-carousel-comment-form-url-field">Website</label>
																<input type="text" name="url" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-url-field" />
															</fieldset>
																											</div>
													<input
														type="submit"
														name="submit"
														class="jp-carousel-comment-form-button"
														id="jp-carousel-comment-form-button-submit"
														value="Post Comment" />
												</div>
											</form>
																											</div>
													</div>
						<div class="jp-carousel-image-meta">
							<div class="jp-carousel-title-and-caption">
								<div class="jp-carousel-photo-info">
									<h3 class="jp-carousel-caption" itemprop="caption description"></h3>
								</div>

								<div class="jp-carousel-photo-description"></div>
							</div>
							<ul class="jp-carousel-image-exif" style="display: none;"></ul>
							<a class="jp-carousel-image-download" target="_blank" style="display: none;">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="mask0" mask-type="alpha" maskUnits="userSpaceOnUse" x="3" y="3" width="19" height="18">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M5.84615 5V19H19.7775V12H21.7677V19C21.7677 20.1 20.8721 21 19.7775 21H5.84615C4.74159 21 3.85596 20.1 3.85596 19V5C3.85596 3.9 4.74159 3 5.84615 3H12.8118V5H5.84615ZM14.802 5V3H21.7677V10H19.7775V6.41L9.99569 16.24L8.59261 14.83L18.3744 5H14.802Z" fill="white"/>
									</mask>
									<g mask="url(#mask0)">
										<rect x="0.870605" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>
								<span class="jp-carousel-download-text"></span>
							</a>
							<div class="jp-carousel-image-map" style="display: none;"></div>
						</div>
					</div>
				</div>
			</div>
		</div>

		</div>
		<link rel='stylesheet' id='all-css-0-2' href='https://s1.wp.com/_static/??-eJyFy00OQDAQQOELGUP8xUKcpWoiZVTTadO4vVhY2LB8L/kwOdCHDWQD7hEcx8VYQa38EYUYJRlHHqZoZ6Zci2T4I1YKTukNnvGFgmGaYVHM5M933Wzch7Ktir5p+rpbL+lvP34=?cssminify=yes' type='text/css' media='all' />
<script id='jetpack-carousel-js-extra'>
var jetpackSwiperLibraryPath = {"url":"\/wp-content\/mu-plugins\/carousel\/swiper-bundle.js"};
var jetpackCarouselStrings = {"widths":[370,700,1000,1200,1400,2000],"is_logged_in":"","lang":"en","ajaxurl":"https:\/\/johncarlosbaez.wordpress.com\/wp-admin\/admin-ajax.php","nonce":"805b669379","display_exif":"1","display_comments":"1","display_geo":"1","single_image_gallery":"1","single_image_gallery_media_file":"","background_color":"black","comment":"Comment","post_comment":"Post Comment","write_comment":"Write a Comment...","loading_comments":"Loading Comments...","download_original":"View full size <span class=\"photo-size\">{0}<span class=\"photo-size-times\">\u00d7<\/span>{1}<\/span>","no_comment_text":"Please be sure to submit some text with your comment.","no_comment_email":"Please provide an email address to comment.","no_comment_author":"Please provide your name to comment.","comment_post_error":"Sorry, but there was an error posting your comment. Please try again later.","comment_approved":"Your comment was approved.","comment_unapproved":"Your comment is in moderation.","camera":"Camera","aperture":"Aperture","shutter_speed":"Shutter Speed","focal_length":"Focal Length","copyright":"Copyright","comment_registration":"0","require_name_email":"1","login_url":"https:\/\/johncarlosbaez.wordpress.com\/wp-login.php?redirect_to=https%3A%2F%2Fjohncarlosbaez.wordpress.com%2F2014%2F06%2F24%2Fel-nino-project-part-2%2F","blog_id":"12777403","meta_data":["camera","aperture","shutter_speed","focal_length","copyright"],"stats_query_args":"blog=12777403&v=wpcom&tz=0&user_id=0&subd=johncarlosbaez","is_public":"1"};
</script>
<script crossorigin='anonymous' type='text/javascript' src='https://s0.wp.com/_static/??-eJyNkN1uwyAMhV9oDkouKvVi2rMQcCNT/oZN07z9yNRMbTZFu8LH8J2DreYMJkXBKMqxsngjg/neOX5TT1ehQvZ1osiK4oUiyfJTHLzVNlCEURcVNAuWVoEUba68h1q2+6xYlsfRzdmkALmk+wIFW49lYygaXy3yCjWJYUTbtaCDj8xkJxRWXEc2hbJQivyXH8+XNDo0sjfbnG5kMSnNvNq5h84F+ddIT/FGl1QZvXIouY0PW+OAEfJoYdLer1t5Uf9Igu/97WTjPsJ7fxrO534YTr37Ai2cwB8='></script>
<script type="text/javascript">
// <![CDATA[
(function() {
try{
  if ( window.external &&'msIsSiteMode' in window.external) {
    if (window.external.msIsSiteMode()) {
      var jl = document.createElement('script');
      jl.type='text/javascript';
      jl.async=true;
      jl.src='/wp-content/plugins/ie-sitemode/custom-jumplist.php';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jl, s);
    }
  }
}catch(e){}
})();
// ]]>
</script><script type="text/javascript">
			(function() {
				var extend = function(out) {
					out = out || {};

					for (var i = 1; i < arguments.length; i++) {
						if (!arguments[i])
						continue;

						for (var key in arguments[i]) {
						if (arguments[i].hasOwnProperty(key))
							out[key] = arguments[i][key];
						}
					}

					return out;
				};
				extend( window.infiniteScroll.settings.scripts, ["postmessage","mobile-useragent-info","rlt-proxy","jquery-core","jquery-migrate","jquery","wpcom-actionbar-placeholder","grofiles-cards","wpgroho","devicepx","the-neverending-homepage","wpcom-masterbar-tracks-js","jquery.wpcom-proxy-request","wp-embed","jetpack-subscriptions-js","swfobject","videopress","jetpack-carousel","tiled-gallery","carousel-wpcom"] );
				extend( window.infiniteScroll.settings.styles, ["the-neverending-homepage","infinity-contempt","wp-block-library","mediaelement","wp-mediaelement","jetpack-layout-grid","jetpack-ratings","coblocks-frontend","wpcom-core-compat-playlist-styles","wpcom-text-widget-styles","wpcom-bbpress2-staff-css","contempt","geo-location-flair","reblogging","a8c-global-print","h4-global","global-styles","jetpack-global-styles-frontend-style","jetpack-carousel-swiper-css","jetpack-carousel","tiled-gallery"] );
			})();
		</script>
				<span id="infinite-aria" aria-live="polite"></span>
		<script src="//stats.wp.com/w.js?62" defer></script> <script type="text/javascript">
_tkq = window._tkq || [];
_stq = window._stq || [];
_tkq.push(['storeContext', {'blog_id':'12777403','blog_tz':'0','user_lang':'en','blog_lang':'en','user_id':'0'}]);
_stq.push(['view', {'blog':'12777403','v':'wpcom','tz':'0','user_id':'0','subd':'johncarlosbaez'}]);
_stq.push(['extra', {'crypt':'UE40eW5QN0p8M2Y/RE1TaVhzUzFMbjdWNHpwZGhTayxPSUFCMGNrd29+Smw0TDhnZmRTK0hlRi9QSGh6bi9GXVhBJWIlZlR5U1JMLU8/MkNtblkvY1d6eVImTEouL2UleTBRZmlNdkp0aWJaNFJhPS0uTVpHa1hIc25EbVJyQmw/SkZ+Q3lLcjU/NDBvQTZVV3RiMkYuKz1XUnVaX0lsJmh3L2xxcHNhKzVFcDhfWklkZkImNjl5OFdzKy5CNHlwT1QvQmduQ2xKY1Z0bVI3JW9+MythaEZ2SG9naWl+fHhYbzFTJlVDOUhxekVoNy5Dd0RGakhmdGxnXy9bLi9KPXUvSW84cXA4WzBlUVNsYS1SRUctaFExRUlVMnIzLW93VEhbbnpDc0FJQk5JdS1lT2NFPUtlZHdCaWtVRCYvUFI0Mm51Wy5jRiZKflJNQzFJbFZq'}]);
_stq.push([ 'clickTrackerInit', '12777403', '0' ]);
	</script>
<noscript><img src="https://pixel.wp.com/b.gif?v=noscript" style="height:1px;width:1px;overflow:hidden;position:absolute;bottom:1px;" alt="" /></noscript>
<script>
if ( 'object' === typeof wpcom_mobile_user_agent_info ) {

	wpcom_mobile_user_agent_info.init();
	var mobileStatsQueryString = "";
	
	if( false !== wpcom_mobile_user_agent_info.matchedPlatformName )
		mobileStatsQueryString += "&x_" + 'mobile_platforms' + '=' + wpcom_mobile_user_agent_info.matchedPlatformName;
	
	if( false !== wpcom_mobile_user_agent_info.matchedUserAgentName )
		mobileStatsQueryString += "&x_" + 'mobile_devices' + '=' + wpcom_mobile_user_agent_info.matchedUserAgentName;
	
	if( wpcom_mobile_user_agent_info.isIPad() )
		mobileStatsQueryString += "&x_" + 'ipad_views' + '=' + 'views';

	if( "" != mobileStatsQueryString ) {
		new Image().src = document.location.protocol + '//pixel.wp.com/g.gif?v=wpcom-no-pv' + mobileStatsQueryString + '&baba=' + Math.random();
	}
	
}
</script>
</body>
</html>