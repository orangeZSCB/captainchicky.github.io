<!DOCTYPE html>
<html amp lang="en" i-amphtml-layout="" i-amphtml-no-boilerplate="" transformed="self;v=1">
<head><meta charset="utf-8"><style amp-runtime="" i-amphtml-version="012109102127000">html{overflow-x:hidden!important}html.i-amphtml-fie{height:100%!important;width:100%!important}html:not([amp4ads]),html:not([amp4ads]) body{height:auto!important}html:not([amp4ads]) body{margin:0!important}body{-webkit-text-size-adjust:100%;-moz-text-size-adjust:100%;-ms-text-size-adjust:100%;text-size-adjust:100%}html.i-amphtml-singledoc.i-amphtml-embedded{-ms-touch-action:pan-y pinch-zoom;touch-action:pan-y pinch-zoom}html.i-amphtml-fie>body,html.i-amphtml-singledoc>body{overflow:visible!important}html.i-amphtml-fie:not(.i-amphtml-inabox)>body,html.i-amphtml-singledoc:not(.i-amphtml-inabox)>body{position:relative!important}html.i-amphtml-ios-embed-legacy>body{overflow-x:hidden!important;overflow-y:auto!important;position:absolute!important}html.i-amphtml-ios-embed{overflow-y:auto!important;position:static}#i-amphtml-wrapper{overflow-x:hidden!important;overflow-y:auto!important;position:absolute!important;top:0!important;left:0!important;right:0!important;bottom:0!important;margin:0!important;display:block!important}html.i-amphtml-ios-embed.i-amphtml-ios-overscroll,html.i-amphtml-ios-embed.i-amphtml-ios-overscroll>#i-amphtml-wrapper{-webkit-overflow-scrolling:touch!important}#i-amphtml-wrapper>body{position:relative!important;border-top:1px solid transparent!important}#i-amphtml-wrapper+body{visibility:visible}#i-amphtml-wrapper+body .i-amphtml-lightbox-element,#i-amphtml-wrapper+body[i-amphtml-lightbox]{visibility:hidden}#i-amphtml-wrapper+body[i-amphtml-lightbox] .i-amphtml-lightbox-element{visibility:visible}#i-amphtml-wrapper.i-amphtml-scroll-disabled,.i-amphtml-scroll-disabled{overflow-x:hidden!important;overflow-y:hidden!important}amp-instagram{padding:54px 0px 0px!important;background-color:#fff}amp-iframe iframe{box-sizing:border-box!important}[amp-access][amp-access-hide]{display:none}[subscriptions-dialog],body:not(.i-amphtml-subs-ready) [subscriptions-action],body:not(.i-amphtml-subs-ready) [subscriptions-section]{display:none!important}amp-experiment,amp-live-list>[update]{display:none}amp-list[resizable-children]>.i-amphtml-loading-container.amp-hidden{display:none!important}amp-list [fetch-error],amp-list[load-more] [load-more-button],amp-list[load-more] [load-more-end],amp-list[load-more] [load-more-failed],amp-list[load-more] [load-more-loading]{display:none}amp-list[diffable] div[role=list]{display:block}amp-story-page,amp-story[standalone]{min-height:1px!important;display:block!important;height:100%!important;margin:0!important;padding:0!important;overflow:hidden!important;width:100%!important}amp-story[standalone]{background-color:#000!important;position:relative!important}amp-story-page{background-color:#757575}amp-story .amp-active>div,amp-story .i-amphtml-loader-background{display:none!important}amp-story-page:not(:first-of-type):not([distance]):not([active]){transform:translateY(1000vh)!important}amp-autocomplete{position:relative!important;display:inline-block!important}amp-autocomplete>input,amp-autocomplete>textarea{padding:0.5rem;border:1px solid rgba(0,0,0,0.33)}.i-amphtml-autocomplete-results,amp-autocomplete>input,amp-autocomplete>textarea{font-size:1rem;line-height:1.5rem}[amp-fx^=fly-in]{visibility:hidden}amp-script[nodom],amp-script[sandboxed]{position:fixed!important;top:0!important;width:1px!important;height:1px!important;overflow:hidden!important;visibility:hidden}
/*# sourceURL=/css/ampdoc.css*/[hidden]{display:none!important}.i-amphtml-element{display:inline-block}.i-amphtml-blurry-placeholder{transition:opacity 0.3s cubic-bezier(0.0,0.0,0.2,1)!important;pointer-events:none}[layout=nodisplay]:not(.i-amphtml-element){display:none!important}.i-amphtml-layout-fixed,[layout=fixed][width][height]:not(.i-amphtml-layout-fixed){display:inline-block;position:relative}.i-amphtml-layout-responsive,[layout=responsive][width][height]:not(.i-amphtml-layout-responsive),[width][height][heights]:not([layout]):not(.i-amphtml-layout-responsive),[width][height][sizes]:not(img):not([layout]):not(.i-amphtml-layout-responsive){display:block;position:relative}.i-amphtml-layout-intrinsic,[layout=intrinsic][width][height]:not(.i-amphtml-layout-intrinsic){display:inline-block;position:relative;max-width:100%}.i-amphtml-layout-intrinsic .i-amphtml-sizer{max-width:100%}.i-amphtml-intrinsic-sizer{max-width:100%;display:block!important}.i-amphtml-layout-container,.i-amphtml-layout-fixed-height,[layout=container],[layout=fixed-height][height]:not(.i-amphtml-layout-fixed-height){display:block;position:relative}.i-amphtml-layout-fill,.i-amphtml-layout-fill.i-amphtml-notbuilt,[layout=fill]:not(.i-amphtml-layout-fill),body noscript>*{display:block;overflow:hidden!important;position:absolute;top:0;left:0;bottom:0;right:0}body noscript>*{position:absolute!important;width:100%;height:100%;z-index:2}body noscript{display:inline!important}.i-amphtml-layout-flex-item,[layout=flex-item]:not(.i-amphtml-layout-flex-item){display:block;position:relative;-ms-flex:1 1 auto;flex:1 1 auto}.i-amphtml-layout-fluid{position:relative}.i-amphtml-layout-size-defined{overflow:hidden!important}.i-amphtml-layout-awaiting-size{position:absolute!important;top:auto!important;bottom:auto!important}i-amphtml-sizer{display:block!important}@supports (aspect-ratio:1/1){i-amphtml-sizer.i-amphtml-disable-ar{display:none!important}}.i-amphtml-blurry-placeholder,.i-amphtml-fill-content{display:block;height:0;max-height:100%;max-width:100%;min-height:100%;min-width:100%;width:0;margin:auto}.i-amphtml-layout-size-defined .i-amphtml-fill-content{position:absolute;top:0;left:0;bottom:0;right:0}.i-amphtml-replaced-content,.i-amphtml-screen-reader{padding:0!important;border:none!important}.i-amphtml-screen-reader{position:fixed!important;top:0px!important;left:0px!important;width:4px!important;height:4px!important;opacity:0!important;overflow:hidden!important;margin:0!important;display:block!important;visibility:visible!important}.i-amphtml-screen-reader~.i-amphtml-screen-reader{left:8px!important}.i-amphtml-screen-reader~.i-amphtml-screen-reader~.i-amphtml-screen-reader{left:12px!important}.i-amphtml-screen-reader~.i-amphtml-screen-reader~.i-amphtml-screen-reader~.i-amphtml-screen-reader{left:16px!important}.i-amphtml-unresolved{position:relative;overflow:hidden!important}.i-amphtml-select-disabled{-webkit-user-select:none!important;-ms-user-select:none!important;user-select:none!important}.i-amphtml-notbuilt,[layout]:not(.i-amphtml-element),[width][height][heights]:not([layout]):not(.i-amphtml-element),[width][height][sizes]:not(img):not([layout]):not(.i-amphtml-element){position:relative;overflow:hidden!important;color:transparent!important}.i-amphtml-notbuilt:not(.i-amphtml-layout-container)>*,[layout]:not([layout=container]):not(.i-amphtml-element)>*,[width][height][heights]:not([layout]):not(.i-amphtml-element)>*,[width][height][sizes]:not([layout]):not(.i-amphtml-element)>*{display:none}amp-img:not(.i-amphtml-element)[i-amphtml-ssr]>img.i-amphtml-fill-content{display:block}.i-amphtml-notbuilt:not(.i-amphtml-layout-container),[layout]:not([layout=container]):not(.i-amphtml-element),[width][height][heights]:not([layout]):not(.i-amphtml-element),[width][height][sizes]:not(img):not([layout]):not(.i-amphtml-element){color:transparent!important;line-height:0!important}.i-amphtml-ghost{visibility:hidden!important}.i-amphtml-element>[placeholder],[layout]:not(.i-amphtml-element)>[placeholder],[width][height][heights]:not([layout]):not(.i-amphtml-element)>[placeholder],[width][height][sizes]:not([layout]):not(.i-amphtml-element)>[placeholder]{display:block;line-height:normal}.i-amphtml-element>[placeholder].amp-hidden,.i-amphtml-element>[placeholder].hidden{visibility:hidden}.i-amphtml-element:not(.amp-notsupported)>[fallback],.i-amphtml-layout-container>[placeholder].amp-hidden,.i-amphtml-layout-container>[placeholder].hidden{display:none}.i-amphtml-layout-size-defined>[fallback],.i-amphtml-layout-size-defined>[placeholder]{position:absolute!important;top:0!important;left:0!important;right:0!important;bottom:0!important;z-index:1}amp-img[i-amphtml-ssr]:not(.i-amphtml-element)>[placeholder]{z-index:auto}.i-amphtml-notbuilt>[placeholder]{display:block!important}.i-amphtml-hidden-by-media-query{display:none!important}.i-amphtml-element-error{background:red!important;color:#fff!important;position:relative!important}.i-amphtml-element-error:before{content:attr(error-message)}i-amp-scroll-container,i-amphtml-scroll-container{position:absolute;top:0;left:0;right:0;bottom:0;display:block}i-amp-scroll-container.amp-active,i-amphtml-scroll-container.amp-active{overflow:auto;-webkit-overflow-scrolling:touch}.i-amphtml-loading-container{display:block!important;pointer-events:none;z-index:1}.i-amphtml-notbuilt>.i-amphtml-loading-container{display:block!important}.i-amphtml-loading-container.amp-hidden{visibility:hidden}.i-amphtml-element>[overflow]{cursor:pointer;position:relative;z-index:2;visibility:hidden;display:initial;line-height:normal}.i-amphtml-layout-size-defined>[overflow]{position:absolute}.i-amphtml-element>[overflow].amp-visible{visibility:visible}template{display:none!important}.amp-border-box,.amp-border-box *,.amp-border-box :after,.amp-border-box :before{box-sizing:border-box}amp-pixel{display:none!important}amp-analytics,amp-auto-ads,amp-story-auto-ads{position:fixed!important;top:0!important;width:1px!important;height:1px!important;overflow:hidden!important;visibility:hidden}html.i-amphtml-fie>amp-analytics{position:initial!important}[visible-when-invalid]:not(.visible),form [submit-error],form [submit-success],form [submitting]{display:none}amp-accordion{display:block!important}@media (min-width:1px){:where(amp-accordion>section)>:first-child{margin:0;background-color:#efefef;padding-right:20px;border:1px solid #dfdfdf}:where(amp-accordion>section)>:last-child{margin:0}}amp-accordion>section{float:none!important}amp-accordion>section>*{float:none!important;display:block!important;overflow:hidden!important;position:relative!important}amp-accordion,amp-accordion>section{margin:0}amp-accordion:not(.i-amphtml-built)>section>:last-child{display:none!important}amp-accordion:not(.i-amphtml-built)>section[expanded]>:last-child{display:block!important}
/*# sourceURL=/css/ampshared.css*/</style><meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1"><meta property="og:type" content="article"><meta property="og:title" content="Petri Net Programming (Part 1)"><meta property="og:url" content="https://johncarlosbaez.wordpress.com/2012/10/01/petri-net-programming/"><meta property="og:description" content="guest post by David Tanzer Petri nets are a simple model of computation with a range of modelling applications that include chemical reaction networks, manufacturing processes, and population biolo…"><meta property="article:published_time" content="2012-10-01T18:11:22+00:00"><meta property="article:modified_time" content="2014-08-12T10:38:34+00:00"><meta property="og:site_name" content="Azimuth"><meta property="og:image" content="http://math.ucr.edu/home/baez/networks/pictures/HIV_petri_net.png"><meta property="og:image:width" content="450"><meta property="og:locale" content="en_US"><meta name="twitter:site" content="@wordpressdotcom"><meta name="twitter:text:title" content="Petri Net Programming (Part 1)"><meta name="twitter:image" content="http://math.ucr.edu/home/baez/networks/pictures/HIV_petri_net.png?w=144"><meta name="twitter:card" content="summary"><meta property="fb:app_id" content="249643311490"><meta property="article:publisher" content="https://www.facebook.com/WordPresscom"><meta name="generator" content="AMP Plugin v2.0.5; mode=reader; theme=legacy"><meta name="generator" content="WordPress.com"><title>Petri Net Programming (Part 1) – Azimuth</title><link rel="preconnect" href="https://cdn.ampproject.org"><link rel="preload" as="script" href="https://cdn.ampproject.org/v0.js"><script async="" src="https://cdn.ampproject.org/v0.js"></script><style amp-custom="">.jp-related-posts-i2__row{display:flex;margin-top:1.5rem}.jp-related-posts-i2__row:first-child{margin-top:0}.jp-related-posts-i2__post{flex-grow:1;flex-basis:0;margin:0 10px;display:flex;flex-direction:column;padding-left:0}.jp-related-posts-i2__row[data-post-count="3"] .jp-related-posts-i2__post{max-width:calc(33% - 20px)}.jp-related-posts-i2__row[data-post-count="2"] .jp-related-posts-i2__post,.jp-related-posts-i2__row[data-post-count="1"] .jp-related-posts-i2__post{max-width:calc(50% - 20px)}.jp-related-posts-i2__post-date,.jp-related-posts-i2__post-context{flex-direction:row;display:block}.jp-related-posts-i2__post-link{display:block;width:100%;line-height:1.2em}.jp-relatedposts-i2[data-layout=list] .jp-related-posts-i2__row{margin-top:0;display:block}.jp-relatedposts-i2[data-layout=list] .jp-related-posts-i2__post{max-width:none;margin:0}@media only screen and (max-width:640px){.jp-related-posts-i2__row{margin-top:0;display:block}.jp-related-posts-i2__row[data-post-count] .jp-related-posts-i2__post{max-width:none;margin:0;margin-top:1rem}}h1,h2,h3,h4,h5{overflow-wrap:break-word}ul{overflow-wrap:break-word}p{overflow-wrap:break-word}@-webkit-keyframes a{to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes a{to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@-webkit-keyframes b{0%{background-position:0 0}to{background-position:30px 0}}@keyframes b{0%{background-position:0 0}to{background-position:30px 0}}amp-img.amp-wp-enforced-sizes[layout="intrinsic"] > img{object-fit:contain}.amp-wp-enforced-sizes{max-width:100%;margin:0 auto}html{background:#0a89c0}body{background:#fff;color:#353535;font-family:Georgia,"Times New Roman",Times,Serif;font-weight:300;line-height:1.75em}p,ul{margin:0 0 1em;padding:0}a,a:visited{color:#0a89c0}a:hover,a:active,a:focus{color:#353535}blockquote{color:#353535;background:rgba(127,127,127,.125);border-left:2px solid #0a89c0;margin:8px 0 24px 0;padding:16px}blockquote p:last-child{margin-bottom:0}.amp-wp-meta,.amp-wp-header div,.amp-wp-title,.amp-wp-tax-category,.amp-wp-comments-link,.amp-wp-footer p,.back-to-top{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen-Sans","Ubuntu","Cantarell","Helvetica Neue",sans-serif}.amp-wp-header{background-color:#0a89c0}.amp-wp-header div{color:#fff;font-size:1em;font-weight:400;margin:0 auto;max-width:calc(840px - 32px);padding:.875em 16px;position:relative}.amp-wp-header a{color:#fff;text-decoration:none}.amp-wp-article{color:#353535;font-weight:400;margin:1.5em auto;max-width:840px;overflow-wrap:break-word;word-wrap:break-word}.amp-wp-article-header{align-items:center;align-content:stretch;display:flex;flex-wrap:wrap;justify-content:space-between;margin:1.5em 16px 0}.amp-wp-title{color:#353535;display:block;flex:1 0 100%;font-weight:900;margin:0 0 .625em;width:100%}.amp-wp-meta{color:#696969;display:inline-block;flex:2 1 50%;font-size:.875em;line-height:1.5em;margin:0 0 1.5em;padding:0}.amp-wp-article-header .amp-wp-meta:last-of-type{text-align:right}.amp-wp-article-header .amp-wp-meta:first-of-type{text-align:left}.amp-wp-byline amp-img,.amp-wp-byline .amp-wp-author{display:inline-block;vertical-align:middle}.amp-wp-byline amp-img{border:1px solid #0a89c0;border-radius:50%;position:relative;margin-right:6px}.amp-wp-posted-on{text-align:right}.amp-wp-article-content{margin:0 16px}.amp-wp-article-content ul{margin-left:1em}.amp-wp-article-content amp-img{margin:0 auto}.amp-wp-article-footer .amp-wp-meta{display:block}.amp-wp-tax-category{color:#696969;font-size:.875em;line-height:1.5em;margin:1.5em 16px}.amp-wp-comments-link{color:#696969;font-size:.875em;line-height:1.5em;text-align:center;margin:2.25em 0 1.5em}.amp-wp-comments-link a{border-style:solid;border-color:#c2c2c2;border-width:1px 1px 2px;border-radius:4px;background-color:transparent;color:#0a89c0;cursor:pointer;display:block;font-size:14px;font-weight:600;line-height:18px;margin:0 auto;max-width:200px;padding:11px 16px;text-decoration:none;width:50%;-webkit-transition:background-color .2s ease;transition:background-color .2s ease}.amp-wp-footer{border-top:1px solid #c2c2c2;margin:calc(1.5em - 1px) 0 0}.amp-wp-footer div{margin:0 auto;max-width:calc(840px - 32px);padding:1.25em 16px 1.25em;position:relative}.amp-wp-footer h2{font-size:1em;line-height:1.375em;margin:0 0 .5em}.amp-wp-footer p{color:#696969;font-size:.8em;line-height:1.5em;margin:0 85px 0 0}.amp-wp-footer a{text-decoration:none}.back-to-top{bottom:1.275em;font-size:.8em;font-weight:600;line-height:2em;position:absolute;right:16px}@font-face{font-family:"social-logos";src:url("/wp-content/mu-plugins/social-logos/social-logos.eot?5d3b4da4f6c2460dd842dbf9e0992ea6");font-weight:normal;font-style:normal}@font-face{font-family:"social-logos";src:url("/wp-content/mu-plugins/social-logos/social-logos.eot?5d3b4da4f6c2460dd842dbf9e0992ea6");src:url("/wp-content/mu-plugins/social-logos/social-logos.eot?5d3b4da4f6c2460dd842dbf9e0992ea6#iefix") format("embedded-opentype"),url("/wp-content/mu-plugins/social-logos/social-logos.woff") format("woff"),url("/wp-content/mu-plugins/social-logos/social-logos.ttf?5d3b4da4f6c2460dd842dbf9e0992ea6") format("truetype");font-weight:normal;font-style:normal;font-display:swap}.jp-related-posts-i2__row{display:flex;margin-top:1.5rem}.jp-related-posts-i2__row:first-child{margin-top:0}.jp-related-posts-i2__post{flex-grow:1;flex-basis:0;margin:0 10px;display:flex;flex-direction:column;padding-left:0}.jp-related-posts-i2__row[data-post-count="3"] .jp-related-posts-i2__post{max-width:calc(33% - 20px)}.jp-related-posts-i2__row[data-post-count="2"] .jp-related-posts-i2__post,.jp-related-posts-i2__row[data-post-count="1"] .jp-related-posts-i2__post{max-width:calc(50% - 20px)}.jp-related-posts-i2__post-date,.jp-related-posts-i2__post-context{flex-direction:row;display:block}.jp-related-posts-i2__post-link{display:block;width:100%;line-height:1.2em}.jp-relatedposts-i2[data-layout="list"] .jp-related-posts-i2__row{margin-top:0;display:block}.jp-relatedposts-i2[data-layout="list"] .jp-related-posts-i2__post{max-width:none;margin:0}@media only screen and (max-width: 640px){.jp-related-posts-i2__row{margin-top:0;display:block}.jp-related-posts-i2__row[data-post-count] .jp-related-posts-i2__post{max-width:none;margin:0;margin-top:1rem}}

/*# sourceURL=amp-custom.css */</style><link rel="canonical" href="https://johncarlosbaez.wordpress.com/2012/10/01/petri-net-programming/"><script type="application/ld+json">{"@context":"http:\/\/schema.org","publisher":{"@type":"Organization","name":"Azimuth","logo":{"@type":"ImageObject","url":"https:\/\/s2.wp.com\/wp-content\/plugins\/amp-2.0\/assets\/images\/amp-page-fallback-wordpress-publisher-logo.png"}},"@type":"BlogPosting","mainEntityOfPage":"https:\/\/johncarlosbaez.wordpress.com\/2012\/10\/01\/petri-net-programming\/","headline":"Petri Net Programming (Part 1)","datePublished":"2012-10-01T18:11:22+00:00","dateModified":"2014-08-12T10:38:34+00:00","author":{"@type":"Person","name":"John Baez"},"image":{"@type":"ImageObject","url":"http:\/\/math.ucr.edu\/home\/baez\/networks\/pictures\/HIV_petri_net.png","width":450,"height":0}}</script></head>

<body class="">

<header id="top" class="amp-wp-header">
	<div>
		<a href="https://johncarlosbaez.wordpress.com/">
									<span class="amp-site-title">
				Azimuth			</span>
		</a>
	</div>
</header>

<article class="amp-wp-article">
	<header class="amp-wp-article-header">
		<h1 class="amp-wp-title">Petri Net Programming (Part 1)</h1>
			<div class="amp-wp-meta amp-wp-byline">
					<amp-img src="https://secure.gravatar.com/avatar/34784534843022b3541c8ddd693718cb?s=24&amp;d=identicon&amp;r=g" alt="John Baez" width="24" height="24" layout="fixed" class="i-amphtml-layout-fixed i-amphtml-layout-size-defined" style="width:24px;height:24px;" i-amphtml-layout="fixed"></amp-img>
				<span class="amp-wp-author author vcard">John Baez</span>
	</div>
<div class="amp-wp-meta amp-wp-posted-on">
	<time datetime="2012-10-01T18:11:22+00:00">
		9 years ago	</time>
</div>
	</header>

	
	<div class="amp-wp-article-content">
		<p><i>guest post by <b><a href="http://www.azimuthproject.org/azimuth/show/David+Tanzer">David Tanzer</a></b></i></p>
<p>Petri nets are a simple model of computation with a range of modelling applications that include chemical reaction networks, manufacturing processes, and population biology dynamics.  They are graphs through which entities flow and have their types transformed.  They also have far-reaching mathematical properties which are the subject of an extensive literature.  See the <a href="http://math.ucr.edu/home/baez/networks/">network theory</a> series here on Azimuth for a panoramic and well-diagrammed introduction to the theory and applications of Petri nets.</p>
<p>In this article, I will introduce Petri nets and give an expository presentation of a program to simulate them.  I am hoping that this will be of interest to anyone who wants to see how scientific concepts can be formulated and actualized in computer software.  Here the simulator program will be applied to a “toy model” of a chemical reaction network for the synthesis and dissociation of H<sub>2</sub>O molecules.  The source code for this program should give the reader some “clay” to work with.   </p>
<p>This material will prepare you for the further topic of <i>stochastic</i> Petri nets, where the sequencing of the Petri net is probabilistically controlled. </p>
<h3> Definition of Petri nets </h3>
<p>A <b>Petri net</b> is a diagram with two kinds of nodes: container nodes, called <b>species</b> (or “places”, “states”), which can hold zero or more <b>tokens</b>, and <b>transition</b> nodes, which are “wired” to some containers called its <b>inputs</b> and some called its <b>outputs</b>.  A transition can have multiple input or output connections to a single container.   </p>
<p>When a transition <b>fires</b>, it removes one token from each input container, and adds one token to each output container.  When there are multiple inputs or outputs to the same container, then that many tokens get removed or added.</p>
<p>The total state of the Petri net is described by a <b>labelling</b> function which maps each container to the number of tokens it holds.  A transition is <b>enabled</b> to fire in a labelling if there are enough tokens at its input containers.  If no transitions are enabled, the it is <b>halted</b>.</p>
<p>The sequencing is non-deterministic, because in a given labelling there may be several transitions that are enabled.  Dataflow arises whenever one transition sends tokens to a container that is read by another transition.</p>
<p>Petri nets represent <i>entity conversion networks</i>, which consist of entities of different species, along with reactions that convert input entities to output entities.  Each entity is symbolized by a token in the net, and all the tokens for a species are grouped into an associated container.  The conversion of entities is represented by the transitions that transform tokens.</p>
<h3> Example 1: Disease processes </h3>
<p>Here’s an example discussed earlier <a href="https://johncarlosbaez.wordpress.com/2012/06/27/the-mathematics-of-biodiversity-part-3/">on Azimuth</a>.  It describes the virus that causes AIDS.  The species are <b>healthy</b> cell, <b>infected</b> cell, and <b>virion</b> (the technical term for an individual virus).  The transitions are for infection, production of healthy cells, reproduction of virions within an infected cell, death of healthy cells, death of infected cells, and death of virions.  </p>
<div align="center">
<amp-img width="450" src="https://i0.wp.com/math.ucr.edu/home/baez/networks/pictures/HIV_petri_net.png" height="336.26373626374" class="amp-wp-enforced-sizes i-amphtml-layout-intrinsic i-amphtml-layout-size-defined" layout="intrinsic" i-amphtml-layout="intrinsic"><i-amphtml-sizer class="i-amphtml-sizer"><img alt="" aria-hidden="true" class="i-amphtml-intrinsic-sizer" role="presentation" src="data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9JzMzNi4yNjM3MzYyNjM3NCcgd2lkdGg9JzQ1MCcgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB2ZXJzaW9uPScxLjEnLz4="></i-amphtml-sizer><noscript><img width="450" src="https://i0.wp.com/math.ucr.edu/home/baez/networks/pictures/HIV_petri_net.png" height="336.26373626374" class=""></noscript></amp-img></div>
<p>Here the species are yellow circles and the transitions are aqua squares.  Note that there are three transitions called “death” and two called “production.”  They are disambiguated by a Greek letter suffix.</p>
<p>• <b>production</b> (<amp-img src="https://s0.wp.com/latex.php?latex=%5Calpha&amp;bg=ffffff&amp;fg=333333&amp;s=0&amp;c=20201002" alt="\alpha" class="latex amp-wp-enforced-sizes i-amphtml-layout-intrinsic i-amphtml-layout-size-defined" width="10" height="7" layout="intrinsic" i-amphtml-layout="intrinsic"><i-amphtml-sizer class="i-amphtml-sizer"><img alt="" aria-hidden="true" class="i-amphtml-intrinsic-sizer" role="presentation" src="data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9JzcnIHdpZHRoPScxMCcgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB2ZXJzaW9uPScxLjEnLz4="></i-amphtml-sizer><noscript><img src="https://s0.wp.com/latex.php?latex=%5Calpha&amp;bg=ffffff&amp;fg=333333&amp;s=0&amp;c=20201002" alt="\alpha" class="latex" width="10" height="7"></noscript></amp-img>) describes the birth of one healthy cell, so it has no input and one <b>healthy</b> as output.  </p>
<p>• <b>death</b> (<amp-img src="https://s0.wp.com/latex.php?latex=%5Cgamma&amp;bg=ffffff&amp;fg=333333&amp;s=0&amp;c=20201002" alt="\gamma" class="latex amp-wp-enforced-sizes i-amphtml-layout-intrinsic i-amphtml-layout-size-defined" width="9" height="12" layout="intrinsic" i-amphtml-layout="intrinsic"><i-amphtml-sizer class="i-amphtml-sizer"><img alt="" aria-hidden="true" class="i-amphtml-intrinsic-sizer" role="presentation" src="data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9JzEyJyB3aWR0aD0nOScgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB2ZXJzaW9uPScxLjEnLz4="></i-amphtml-sizer><noscript><img src="https://s0.wp.com/latex.php?latex=%5Cgamma&amp;bg=ffffff&amp;fg=333333&amp;s=0&amp;c=20201002" alt="\gamma" class="latex" width="9" height="12"></noscript></amp-img>) has one <b>healthy</b> as input and no output.  </p>
<p>• <b>death</b> (<amp-img src="https://s0.wp.com/latex.php?latex=%5Cdelta&amp;bg=ffffff&amp;fg=333333&amp;s=0&amp;c=20201002" alt="\delta" class="latex amp-wp-enforced-sizes i-amphtml-layout-intrinsic i-amphtml-layout-size-defined" width="8" height="12" layout="intrinsic" i-amphtml-layout="intrinsic"><i-amphtml-sizer class="i-amphtml-sizer"><img alt="" aria-hidden="true" class="i-amphtml-intrinsic-sizer" role="presentation" src="data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9JzEyJyB3aWR0aD0nOCcgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB2ZXJzaW9uPScxLjEnLz4="></i-amphtml-sizer><noscript><img src="https://s0.wp.com/latex.php?latex=%5Cdelta&amp;bg=ffffff&amp;fg=333333&amp;s=0&amp;c=20201002" alt="\delta" class="latex" width="8" height="12"></noscript></amp-img>) has one <b>infected</b> as input and no output.  </p>
<p>• <b>death</b> (<amp-img src="https://s0.wp.com/latex.php?latex=%5Czeta&amp;bg=ffffff&amp;fg=333333&amp;s=0&amp;c=20201002" alt="\zeta" class="latex amp-wp-enforced-sizes i-amphtml-layout-intrinsic i-amphtml-layout-size-defined" width="8" height="16" layout="intrinsic" i-amphtml-layout="intrinsic"><i-amphtml-sizer class="i-amphtml-sizer"><img alt="" aria-hidden="true" class="i-amphtml-intrinsic-sizer" role="presentation" src="data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9JzE2JyB3aWR0aD0nOCcgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB2ZXJzaW9uPScxLjEnLz4="></i-amphtml-sizer><noscript><img src="https://s0.wp.com/latex.php?latex=%5Czeta&amp;bg=ffffff&amp;fg=333333&amp;s=0&amp;c=20201002" alt="\zeta" class="latex" width="8" height="16"></noscript></amp-img>) has one <b>virion</b> as input and no output.</p>
<p>• <b>infection</b> (<amp-img src="https://s0.wp.com/latex.php?latex=%5Cbeta&amp;bg=ffffff&amp;fg=333333&amp;s=0&amp;c=20201002" alt="\beta" class="latex amp-wp-enforced-sizes i-amphtml-layout-intrinsic i-amphtml-layout-size-defined" width="10" height="14" layout="intrinsic" i-amphtml-layout="intrinsic"><i-amphtml-sizer class="i-amphtml-sizer"><img alt="" aria-hidden="true" class="i-amphtml-intrinsic-sizer" role="presentation" src="data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9JzE0JyB3aWR0aD0nMTAnIHhtbG5zPSdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycgdmVyc2lvbj0nMS4xJy8+"></i-amphtml-sizer><noscript><img src="https://s0.wp.com/latex.php?latex=%5Cbeta&amp;bg=ffffff&amp;fg=333333&amp;s=0&amp;c=20201002" alt="\beta" class="latex" width="10" height="14"></noscript></amp-img>) takes one <b>healthy</b> and one <b>virion</b> as input, and has one <b>infected</b> cell as output.  </p>
<p>• <b>production</b> (<amp-img src="https://s0.wp.com/latex.php?latex=%5Cepsilon&amp;bg=ffffff&amp;fg=333333&amp;s=0&amp;c=20201002" alt="\epsilon" class="latex amp-wp-enforced-sizes i-amphtml-layout-intrinsic i-amphtml-layout-size-defined" width="7" height="7" layout="intrinsic" i-amphtml-layout="intrinsic"><i-amphtml-sizer class="i-amphtml-sizer"><img alt="" aria-hidden="true" class="i-amphtml-intrinsic-sizer" role="presentation" src="data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9JzcnIHdpZHRoPSc3JyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHZlcnNpb249JzEuMScvPg=="></i-amphtml-sizer><noscript><img src="https://s0.wp.com/latex.php?latex=%5Cepsilon&amp;bg=ffffff&amp;fg=333333&amp;s=0&amp;c=20201002" alt="\epsilon" class="latex" width="7" height="7"></noscript></amp-img>) describes the reproduction of the virus in an infected cell, so it has one <b>infected</b> as input, and one <b>infected</b> and one <b>virion</b> as output.</p>
<h3> Example 2: Population dynamics </h3>
<p>Here the tokens represent organisms, and the species are biological species.  This simple example involving two species, <b>wolf</b> and <b>rabbit</b>: </p>
<div align="center">
<amp-img width="450" src="https://i0.wp.com/math.ucr.edu/home/baez/networks/pictures/wolf-rabbit.png" height="133.48993288591" class="amp-wp-enforced-sizes i-amphtml-layout-intrinsic i-amphtml-layout-size-defined" layout="intrinsic" i-amphtml-layout="intrinsic"><i-amphtml-sizer class="i-amphtml-sizer"><img alt="" aria-hidden="true" class="i-amphtml-intrinsic-sizer" role="presentation" src="data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9JzEzMy40ODk5MzI4ODU5MScgd2lkdGg9JzQ1MCcgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB2ZXJzaW9uPScxLjEnLz4="></i-amphtml-sizer><noscript><img width="450" src="https://i0.wp.com/math.ucr.edu/home/baez/networks/pictures/wolf-rabbit.png" height="133.48993288591" class=""></noscript></amp-img></div>
<p>There are three transitions: <b>birth</b>, which inputs one <b>rabbit</b> and outputs <b>rabbit</b> + <b>rabbit</b> like asexual reproduction), <b>predation</b>, which converts <b>rabbit</b> plus <b>wolf</b> to <b>wolf</b> plus <b>wolf</b>, and <b>death</b>, which inputs one <b>wolf</b> and outputs nothing.</p>
<h3> Example 3: Chemical reaction networks </h3>
<p>Here the entities are chemical units:  molecules, isolated atoms, or ions.  Each chemical unit is represented by a token in the net, and a container holds all of the tokens for a chemical species.  Chemical reactions are then modeled as transitions that consume input tokens and generate output tokens.  </p>
<p>We will be using the following simplified model for <i>water formation and dissociation</i>:</p>
<p>• The species are H, O, and H<sub>2</sub>O. </p>
<p>• Transition <b>combine</b> inputs two H atoms and one O atom, and outputs an H<sub>2</sub>O molecule.</p>
<p>• Transition <b>split</b> is the reverse process, which inputs one H<sub>2</sub> and outputs two H and one O.</p>
<div align="center">
<amp-img width="390" src="https://i2.wp.com/math.ucr.edu/home/baez/networks/pictures/H2O-example.png" height="237.74774774775" class="amp-wp-enforced-sizes i-amphtml-layout-intrinsic i-amphtml-layout-size-defined" layout="intrinsic" i-amphtml-layout="intrinsic"><i-amphtml-sizer class="i-amphtml-sizer"><img alt="" aria-hidden="true" class="i-amphtml-intrinsic-sizer" role="presentation" src="data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9JzIzNy43NDc3NDc3NDc3NScgd2lkdGg9JzM5MCcgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB2ZXJzaW9uPScxLjEnLz4="></i-amphtml-sizer><noscript><img width="390" src="https://i2.wp.com/math.ucr.edu/home/baez/networks/pictures/H2O-example.png" height="237.74774774775" class=""></noscript></amp-img></div>
<p>Note that the model is intended to show the <i>idea</i> of chemical reaction Petri nets, so it is not physically realistic.  The actual reactions involve H<sub>2</sub> and O<sub>2</sub>, and there are intermediate transitions as well.   For more details, see <a href="http://math.ucr.edu/home/baez/networks/networks_3.html">Part 3</a> of the network theory series.</p>
<h3> A Petri net simulator </h3>
<p>The following Python script will simulate a Petri net, using parameters that describe the species, the transitions, and the initial labelling.  It will run the net for a specified number of steps.   At each step it chooses randomly among the enabled transitions, fires it, and prints the new labelling on the console.</p>
<h4> Download </h4>
<p>Here is the first <a href="http://www.cs.nyu.edu/tanzer/azimuth/petri1.py">Petri net simulator</a>.</p>
<h4> Running the script </h4>
<p>The model parameters are already coded into the script.  So let’s give it a whirl: </p>
<p>python petri1.py</p>
<p>This produced the output:</p>
<pre class="brush: plain; title: ; notranslate" title="">
    H, O, H2O, Transition
    5, 3, 4, split
    7, 4, 3, split
    9, 5, 2, combine
    7, 4, 3, combine
    5, 3, 4, split
    7, 4, 3, split
    9, 5, 2, split
    11, 6, 1, combine
    9, 5, 2, split
    11, 6, 1, split
    13, 7, 0, ...
</pre>
<p>We started out in a state with 5 H’s, 3 O’s, and 4 H<sub>2</sub>O’s, then a split took place, which increased H by 2, increased O by 1, and decreased H<sub>2</sub>O by one, then…</p>
<p>Running it again gives a different execution sequence.  </p>
<h4> Software structures used in the program </h4>
<p>Before performing a full dissection of the code, I’d like to make a digression to discuss some of the basic software constructs that are used in this program.  This is directed in particular to those of you who are coming from the science side, and are interested in learning more about programming.  </p>
<p>This program exercises a few of the basic mechanisms of object-oriented and functional programming.  The Petri net logic is bundled into the definition of a single <i>class</i> called PetriNet, and each  PetriNet <i>object</i> is an <i>instance</i> of the class.  This logic is grouped into <i>methods</i>, which are functions whose first parameter is bound to an instance of the class.</p>
<p>For example, here is the method IsHalted of the class PetriNet:</p>
<pre class="brush: python; title: ; notranslate" title="">
    def IsHalted(this):
        return len(this.EnabledTransitions()) == 0
</pre>
<p>The first parameter, conventionally called “this” or “self,” refers to the PetriNet class instance.  len returns the length of a list, and EnabledTransitions is a method that returns the list of transitions enabled in the current labelling.  </p>
<p>Here is the syntax for using the method:</p>
<pre class="brush: python; title: ; notranslate" title="">
    if petriNetInstance.IsHalted(): ...
</pre>
<p>If it were the case that IsHalted took additional parameters, the definition would look like this:</p>
<pre class="brush: python; title: ; notranslate" title="">
    def IsHalted(this, arg1, ..., argn):
</pre>
<p>and the call would look like this:</p>
<pre class="brush: python; title: ; notranslate" title="">
    if petriNetInstance.IsHalted(arg1, ..., argn)
</pre>
<p>Here is the definition of EnabledTransitions, which shows a basic element of functional programming:  </p>
<pre class="brush: python; title: ; notranslate" title="">
    def EnabledTransitions(this):
        return filter(lambda transition: transition.IsEnabled(this.labelling), this.transitions)
</pre>
<p>A PetriNet instance holds this list of Transition objects, called this.transitions.  The expression “lambda: transition …” is an <b>anonymous function</b> that maps a Transition object to the boolean result returned by calling the IsEnabled method on that transition, given the current labelling this.labelling.  The filter function takes an anonymous boolean-valued function and a list of objects, and returns the sublist consisting of those objects that satisfy this predicate.    </p>
<p>The program also gives an example of <i>class inheritance</i>, because the class PetriNet inherits all fields and methods from a base class called PetriNetBase.</p>
<h4> Python as a language for pedagogical and scientific programming </h4>
<p>We continue with our digression, to talk now about the choice of language.  With something as fundamental to our thinking as a language, it’s easy to see how the topic of language choice tends to become partisan.  Imagine, for example, a debate between different nationalities, about which language was more beautiful, logical, etc.  Here the issue is put into perspective by David Tweed from the Azimuth project:</p>
<blockquote><p> Programming languages are a lot like “motor vehicles”: a family car has different trade-offs to a sports car to a small van to a big truck to a motorbike to …. Each of these has their own niche where they make the most sense to use.
</p></blockquote>
<p>The Petri net simulator which I wrote in Python, and which will soon to be dissected, could have been equivalently written in any modern object-oriented programming language, such as C++, Java or C#.  I chose Python for the following reasons.  First, it is a scripting language.  This means that the casual user need not get involved with a  compilation step that is preparatory to running the program.  Second, it does provide the abstraction capabilities needed to express the Petri net model.  Third, I like the way that the syntax rolls out.  This syntax has been described as executable pseudo-code.  Finally, the language has a medium-sized user-base and support community.  </p>
<p>Python is good for proof of concept programs, and it works well as a pedagogical programming language.  Yet it is also practical.  It has been widely adopted in the field of scientific programming.  David Tweed explains it in these terms:</p>
<blockquote><p>
I think a big part of Python’s use comes from an the way that a lot of scientific programming is as much about “management” — parsing files of prexisting structured data, iterating over data, controlling network connections, calling C code, launching subprograms, etc — as much as “numeric computation”. This is where Python is particularly good, and it’s now acquired the NumPy &amp; SciPy extensions to speed up the numerical programming elements, but it’s primarily the higher level elements that make it attractive in science.
</p></blockquote>
<p>Because variables in Python are neither declared in the program text, nor inferred by the byte-code compiler, the types of the variables are known only at run time.  This has a negative impact on performance for data intensive calculations: rather than having the compiler generate the right code for the data type that is being processed, the types need to be checked at run time.  The NumPy and SciPy libraries address this by providing bulk array operations, e.g., addition of two matrices, in a native code library that is integrated with the Python runtime environment.  If this framework does not suffice for your high-performance numerical application, then you will have to turn to other languages, notably, C++.</p>
<p>All this being said, it is now time to return to the main topic of this article, which is the <i>content</i> of Petri net programming.</p>
<h4> Top-level structure of the Petri net simulator script </h4>
<p>At a high level, the script constructs a Petri net, constructs the initial labelling, and then runs the simulation for a given number of steps.</p>
<p>First construct the Petri net:</p>
<pre class="brush: python; title: ; notranslate" title="">  
    # combine: 2H + 1O -&gt; 1H2O
    combineSpec = ("combine", [["H",2],["O",1]], [["H2O",1]])

    # split: 1H2O -&gt; 2H + 1O 
    splitSpec = ("split", [["H2O",1]], [["H",2],["O",1]])

    petriNet = PetriNet(
        ["H","O","H2O"],         # species
        [combineSpec,splitSpec]  # transitions
    )
</pre>
<p>Then establish the initial labelling:</p>
<pre class="brush: python; title: ; notranslate" title="">
    initialLabelling = {"H":5, "O":3, "H2O":4}
</pre>
<p>Then run it for twenty steps:</p>
<pre class="brush: python; title: ; notranslate" title="">
    steps = 20
    petriNet.RunSimulation(steps, initialLabelling)
</pre>
<h4> Program code </h4>
<p>Species will be represented simply by their names, i.e., as strings.  PetriNet and Transition will be defined as object classes.  Each PetriNet instance holds a list of species names, a list of transition names, a list of Transition objects, and the current labelling.  The labelling is a dictionary from species name to token count.   Each Transition object contains an input dictionary and an input dictionary.  The input dictionary map the name of a species to the number of times that the transition takes it as input, and similarly for the output dictionary.</p>
<h5> Class PetriNet </h5>
<p>The PetriNet class has a top-level method called RunSimulation, which  makes repeated calls to FireOneRule.  FireOneRule obtains the list of enabled transitions, chooses one randomly, and fires it.  This is accomplished by the method SelectRandom, which uses a random integer between 1 and N to choose a transition from the list of enabled transitions.</p>
<pre class="brush: python; title: ; notranslate" title="">
    class PetriNet(PetriNetBase):
        def RunSimulation(this, iterations, initialLabelling): 
            this.PrintHeader()  # prints e.g. "H, O, H2O"
            this.labelling = initialLabelling
            this.PrintLabelling() # prints e.g. "3, 5, 2" 

            for i in range(iterations):
               if this.IsHalted():
                   print "halted"
                   return 
               else:
                   this.FireOneRule()
                   this.PrintLabelling(); 
            print "iterations completed" 
    
        def EnabledTransitions(this):
            return filter(lambda transition: transition.IsEnabled(this.labelling), this.transitions)
    
        def IsHalted(this):
            return len(this.EnabledTransitions()) == 0
    
        def FireOneRule(this):
            this.SelectRandom(this.EnabledTransitions()).Fire (this.labelling)

        def SelectRandom(this, items):
            randomIndex = randrange(len(items))
            return items[randomIndex]
</pre>
<h5> Class Transition </h5>
<p>The Transition class exposes two key methods.  IsEnabled takes a labeling as parameter, and returns a boolean saying whether the transition can fire.  This is determined by comparing the input map for the transition with the token counts in the labeling, to see if there is sufficient tokens for it to fire.  The Fire method takes a labelling in, and updates the counts in it to reflect the action of removing input tokens and creating output tokens.  </p>
<pre class="brush: python; title: ; notranslate" title="">
    class Transition:
        # Fields:
        # transitionName
        # inputMap: speciesName -&amp;gt; inputCount
        # outputMap: speciesName -&amp;gt; outputCount 
    
        # constructor
        def __init__(this, transitionName):
           this.transitionName = transitionName
           this.inputMap = {} 
           this.outputMap = {} 
    
        def IsEnabled(this, labelling):
           for inputSpecies in this.inputMap.keys():
              if labelling[inputSpecies] &amp;lt; this.inputMap[inputSpecies]: 
                  return False  # not enough tokens
           return True # good to go 
    
        def Fire(this, labelling):
           print this.transitionName
           for inputName in this.inputMap.keys():
              labelling[inputName] = labelling[inputName] - this.inputMap[inputName] 
           for outputName in this.outputMap.keys():
              labelling[outputName] = labelling[outputName] + this.outputMap[outputName] 
</pre>
<h5> Class PetriNetBase </h5>
<p>Notice that the class line for PetriNet declares that it inherits from a base class PetriNetBase.  The base class contains utility methods that support PetriNet:  PrintHeader, PrintLabelling, SelectRandom, and the constructor, which converts the transition specifications into Transition objects.</p>
<pre class="brush: python; title: ; notranslate" title="">
    class PetriNetBase:
        # Fields:
        # speciesNames
        # Transition list
        # labelling: speciesName -&amp;gt; token count 
    
        # constructor
        def __init__(this, speciesNames, transitionSpecs):
            this.speciesNames = speciesNames
            this.transitions = this.BuildTransitions(transitionSpecs)
    
        def BuildTransitions(this, transitionSpecs):
            transitions = []
            for (transitionName, inputSpecs, outputSpecs) in transitionSpecs:
                transition = Transition(transitionName)
                for degreeSpec in inputSpecs:
                    this.SetDegree(transition.inputMap, degreeSpec)
                for degreeSpec in outputSpecs:
                    this.SetDegree(transition.outputMap, degreeSpec)
                transitions.append(transition)
            return transitions 
    
        def SetDegree(this, dictionary, degreeSpec):
            speciesName = degreeSpec[0]
            if len(degreeSpec) == 2:
                degree = degreeSpec[1]
            else: 
                degree = 1
            dictionary[speciesName] = degree
    
        def PrintHeader(this):
            print string.join(this.speciesNames, ", ") + ", Transition"
               
        def PrintLabelling(this):
            for speciesName in this.speciesNames:
                print str(this.labelling[speciesName]) + ",", 
</pre>
<h3> Summary </h3>
<p>We’ve learned about an important model for computation, called Petri nets, and seen how it can be used to model a general class of entity conversion networks, which include chemical reaction networks as a major case.  Then we wrote a program to simulate them, and applied it to a simple model for formation and dissociation of water molecules.</p>
<p>This is a good beginning, but observe the following limitation of our current program:  it just randomly picks a rule.  When we run the program, the simulation makes a kind of random walk, back and forth, between the states of full synthesis and full dissociation.  But in a real chemical system, the rates at which the transitions fires are _probabilistically determined_, and depend, among other things, on the temperature.  With a high probability for formation, and a low probability for dissociation, we would expect the system to reach an equilibrium state in which H<sub>2</sub>O is the predominant “token” in the system.  The relative concentration of the various chemical species would be determined by the relative firing rates of the various transitions.</p>
<p>This gives motivation for the next article that I am writing, on <i>stochastic</i> Petri nets.  </p>
<h3> Programming exercises </h3>
<p>1.  Extend the constructor for PetriNet to accept a dictionary from transitionName to a number, which will give the relative probability of that transition firing.  Modify the firing rule logic to use these values.  This is a step in the direction of the stochastic Petri nets covered in the next article.</p>
<p>2.  Make a prediction about the overall evolution of the system, given fixed probabilities for synthesis and dissociation, and then run the program to see if your prediction is confirmed.</p>
<p>3.  If you like, improve the usability of the script, by passing the model parameters from the command line.  Use sys.argv and eval.  You can use single quotes, and pass a string like “{‘H’:5, ‘O’:3, ‘H2O’:4}” from the command line.</p>
<p>By the way: if you do this exercises, please post a comment including your code, or a link to your code!  To make Python code look pretty on this blog, see <a href="http://pythonconquerstheuniverse.wordpress.com/2011/11/06/posting-sourcecode-on-wordpress/">this</a>.</p>
<h3> Acknowledgements </h3>
<p>Thanks to David Tweed and Ken Webb for reviewing the code and coming up with improvements to the specification syntax for the Petri nets.   Thanks to Jacob Biamonte for the diagrams, and for energetically reviewing the article.  John Baez contributed the three splendid examples of Petri nets.  He also encouraged me along the way, and provided good support as an editor.</p>
<h3> Appendix: Notes on the language interpreter </h3>
<p>The sample program is written in Python, which is a low-fuss scripting language with abstraction capabilities.  The language is well-suited for proof-of-concept programming, and it has a medium-sized user base and support community.  The main website is <a href="http://www.python.org">www.python.org</a>.</p>
<p>You have a few distributions to choose from:</p>
<p>• If you are on a Linux or Mac type of system, it is likely to already be installed.  Just open a shell and type “python.”  Otherwise, use the package manager to install it.</p>
<p>• In Windows, you can use the version from the python.org web site.  Alternatively, install <a href="http://www.cygwin.com">cygwin</a>, and in the installer, select Python, along with any of your other favorite Linux-style packages.  Then you can partially pretend that you are working on a Linux type of system.</p>
<p>• The <a href="http://www.enthought.com">Enthought</a> Python distribution comes packaged with a suite of Python-based open-source scientific and numeric computing packages.  This includes ipython, scipy, numpy and matplotlib.</p>
<p>The program is distributed as a self-contained script, so in Linux and cygwin you can just execute ./petri1.py.  When running this way under cygwin, you can either refer to the cygwin version of the Python executable, or to any of the native Windows versions of interpreter. You just need to adjust the first line of the script to point to the python executable.  </p>
<div id="jp-post-flair" class="sharedaddy">
<nav class="jp-relatedposts-i2" data-layout="grid"><h3 class="jp-relatedposts-headline"><em>Related</em></h3><div class="jp-related-posts-i2__row" data-post-count="3"><ul id="related-posts-item-614fb49bcdb06" aria-labelledby="related-posts-item-614fb49bcdb06-label" class="jp-related-posts-i2__post" role="menuitem"><li class="jp-related-posts-i2__post-link"><a id="related-posts-item-614fb49bcdb06-label" href="https://johncarlosbaez.wordpress.com/2017/07/30/a-compositional-framework-for-reaction-networks/">A Compositional Framework for Reaction Networks</a></li><li class="jp-related-posts-i2__post-date">30 July, 2017</li><li class="jp-related-posts-i2__post-context">In "chemistry"</li></ul><ul id="related-posts-item-614fb49bcdb1c" aria-labelledby="related-posts-item-614fb49bcdb1c-label" class="jp-related-posts-i2__post" role="menuitem"><li class="jp-related-posts-i2__post-link"><a id="related-posts-item-614fb49bcdb1c-label" href="https://johncarlosbaez.wordpress.com/2011/03/31/network-theory-part-2/">Network Theory (Part 2)</a></li><li class="jp-related-posts-i2__post-date">31 March, 2011</li><li class="jp-related-posts-i2__post-context">In "biology"</li></ul><ul id="related-posts-item-614fb49bcdb28" aria-labelledby="related-posts-item-614fb49bcdb28-label" class="jp-related-posts-i2__post" role="menuitem"><li class="jp-related-posts-i2__post-link"><a id="related-posts-item-614fb49bcdb28-label" href="https://johncarlosbaez.wordpress.com/2011/11/12/network-theory-part-17/">Network Theory (Part 17)</a></li><li class="jp-related-posts-i2__post-date">12 November, 2011</li><li class="jp-related-posts-i2__post-context">In "biology"</li></ul></div></nav></div>	</div>

	<footer class="amp-wp-article-footer">
			<div class="amp-wp-meta amp-wp-tax-category">
		Categories: <a href="https://johncarlosbaez.wordpress.com/category/networks/" rel="category tag">networks</a>, <a href="https://johncarlosbaez.wordpress.com/category/software/" rel="category tag">software</a>	</div>

		<div class="amp-wp-meta amp-wp-comments-link">
		<a href="https://johncarlosbaez.wordpress.com/2012/10/01/petri-net-programming/#comments">
			Leave a Comment		</a>
	</div>
	</footer>
</article>

<footer class="amp-wp-footer">
	<div>
		<h2>Azimuth</h2>
		<a href="#top" class="back-to-top">Back to top</a>
	</div>
</footer>


	<amp-pixel src="https://pixel.wp.com/b.gif?rand=RANDOM&amp;host=johncarlosbaez.wordpress.com&amp;ref=DOCUMENT_REFERRER&amp;amp=1&amp;blog=12777403&amp;v=wpcom&amp;tz=0&amp;user_id=0&amp;post=12315&amp;subd=johncarlosbaez" class="i-amphtml-layout-fixed i-amphtml-layout-size-defined" style="width:1px;height:1px;" i-amphtml-layout="fixed"></amp-pixel>
	<amp-pixel src="https://pixel.wp.com/b.gif?rand=RANDOM&amp;v=wpcom-no-pv&amp;crypt=UE40eW5QN0p8M2Y%2FRE1TaVhzUzFMbjdWNHpwZGhTayxPSUFCMGNrd29%2BSmw0TDhnZmRTK0hlRi9QSGh6bi9GXVhBJWIlZlR5U1JMLU8%2FMkNtblkvY1d6eVImTEouL2UleTBRZmlNdkp0aWJaNFJhPS0uTVpHa1hIc25EbVJyQmw%2FSkZ%2BQ3lLcjU%2FNDBvQTZnVE1uVTJ3d3QlOVk0K11YdyVZQjhMbkVIamdIZ35XL21ZfE89T0FhZEgxK0w1aGIzc3Bvcls2WjM5SGJSLUtmMyZub3gzfkhkdC1hNnRvV1krOHJGQklKaCZiUXl4Q1FGd20%3D" class="i-amphtml-layout-fixed i-amphtml-layout-size-defined" style="width:1px;height:1px;" i-amphtml-layout="fixed"></amp-pixel>
	


</body></html>
