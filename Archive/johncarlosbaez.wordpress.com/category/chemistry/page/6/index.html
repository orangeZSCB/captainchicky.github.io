<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>chemistry | Azimuth | Page 6</title>
<link rel="profile" href="http://gmpg.org/xfn/11" />
<link rel="pingback" href="https://johncarlosbaez.wordpress.com/xmlrpc.php" />
<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s1.wp.com' />
<link rel='dns-prefetch' href='//s2.wp.com' />
<link rel='dns-prefetch' href='//s0.wp.com' />
<link rel='dns-prefetch' href='//s.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Azimuth &raquo; Feed" href="https://johncarlosbaez.wordpress.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Azimuth &raquo; Comments Feed" href="https://johncarlosbaez.wordpress.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Azimuth &raquo; chemistry Category Feed" href="https://johncarlosbaez.wordpress.com/category/chemistry/feed/" />
	<script type="text/javascript">
		/* <![CDATA[ */
		function addLoadEvent(func) {
			var oldonload = window.onload;
			if (typeof window.onload != 'function') {
				window.onload = func;
			} else {
				window.onload = function () {
					oldonload();
					func();
				}
			}
		}
		/* ]]> */
	</script>
			<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/s1.wp.com\/wp-includes\/js\/wp-emoji-release.min.js?m=1625065786h&ver=5.8.1"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([10084,65039,8205,55357,56613],[10084,65039,8203,55357,56613])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='all-css-0-1' href='https://s2.wp.com/_static/??-eJyNkttSAyEMhl9IlqVOdbxwfBYOEVOBZSBYeXuz1e6sVrveMDl9yU9AHrOwUyJIJGMTOTSPqUpMz5iQ+mIMttYbuVFMLxChytyMPJXFTBfcGfKNXQPFc6aAfFNq2A9KmobBSRMm+yoCmqJLl5V6gKURJhua4zGHKiM41BB46qxo5eSgOxQRwGvbh4hpG+fc2v8G/S3+pJSbAWU9S9Z9aiR8QfdD9r9bFE2YfN3A7fSF7QY18t4cVlqC4nd29WTzzjkes768+BXsiM4DMV7PtiB4v45kHiOMyQVqFXxGbFF8/pSZe4qP6u5W3T/sx3F3+ACgX/YH?cssminify=yes' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify {
	text-align:justify;
}
</style>
<style id='global-styles-inline-css'>
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--normal: 16px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--huge: 42px;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-normal-font-size{font-size: var(--wp--preset--font-size--normal) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-huge-font-size{font-size: var(--wp--preset--font-size--huge) !important;}
</style>
<link rel='stylesheet' id='all-css-2-1' href='https://s0.wp.com/_static/??-eJx9i0EKgCAQAD+ULYJRHaK3qJhY666o0fezW126zcAMGNR09LaUDq4kLFN1VCGeIuHpAxXwjgWy1TUwfURsqEP+W7MzyL6hh1a99JnWuEg1zEpNo1T7DZLtMYQ=?cssminify=yes' type='text/css' media='all' />
<link rel='stylesheet' id='print-css-3-1' href='https://s2.wp.com/wp-content/mu-plugins/global-print/global-print.css?m=1465851035h&cssminify=yes' type='text/css' media='print' />
<style id='jetpack-global-styles-frontend-style-inline-css'>
:root { --font-headings: unset; --font-base: unset; --font-headings-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif; --font-base-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif;}
</style>
<link rel='stylesheet' id='all-css-6-1' href='https://s0.wp.com/wp-content/themes/h4/global.css?m=1420737423h&cssminify=yes' type='text/css' media='all' />
<script id='wpcom-actionbar-placeholder-js-extra'>
var actionbardata = {"siteID":"12777403","siteName":"Azimuth","siteURL":"http:\/\/johncarlosbaez.wordpress.com","siteHost":"johncarlosbaez.wordpress.com","icon":"<img alt='' src='https:\/\/s2.wp.com\/i\/logo\/wpcom-gray-white.png' class='avatar avatar-50' height='50' width='50' \/>","canManageOptions":"","canCustomizeSite":"","isFollowing":"","themeSlug":"pub\/contempt","signupURL":"https:\/\/wordpress.com\/start\/","loginURL":"https:\/\/wordpress.com\/log-in?redirect_to=https%3A%2F%2Fjohncarlosbaez.wordpress.com%2F2013%2F07%2F10%2Fcoherence-for-solutions-of-the-master-equation%2F&signup_flow=account","themeURL":"","xhrURL":"https:\/\/johncarlosbaez.wordpress.com\/wp-admin\/admin-ajax.php","nonce":"e6f6fdfb46","isSingular":"","isFolded":"","isLoggedIn":"","isMobile":"","subscribeNonce":"<input type=\"hidden\" id=\"_wpnonce\" name=\"_wpnonce\" value=\"ffcb185558\" \/>","referer":"https:\/\/johncarlosbaez.wordpress.com\/category\/chemistry\/page\/6\/","canFollow":"1","feedID":"62242","statusMessage":"","subsEmailDefault":"instantly","customizeLink":"https:\/\/johncarlosbaez.wordpress.com\/wp-admin\/customize.php?url=https%3A%2F%2Fjohncarlosbaez.wordpress.com%2Fcategory%2Fchemistry%2Fpage%2F6%2F","i18n":{"view":"View site","follow":"Follow","following":"Following","edit":"Edit","login":"Log in","signup":"Sign up","customize":"Customize","report":"Report this content","themeInfo":"Get theme: Contempt","shortlink":"Copy shortlink","copied":"Copied","followedText":"New posts from this site will now appear in your <a href=\"https:\/\/wordpress.com\/read\">Reader<\/a>","foldBar":"Collapse this bar","unfoldBar":"Expand this bar","editSubs":"Manage subscriptions","viewReader":"View site in Reader","viewReadPost":"View post in Reader","subscribe":"Sign me up","enterEmail":"Enter your email address","followers":"Join 5,228 other followers","alreadyUser":"Already have a WordPress.com account? <a href=\"https:\/\/wordpress.com\/log-in?redirect_to=https%3A%2F%2Fjohncarlosbaez.wordpress.com%2F2013%2F07%2F10%2Fcoherence-for-solutions-of-the-master-equation%2F&signup_flow=account\">Log in now.<\/a>","stats":"Stats","notifyNewPosts":"Notify me of new posts","notifyNewPostsDetails":"Receive web and mobile notifications for new posts from this site.","emailNewPosts":"Email me new posts","emailNewPostsDetails":"You can customize your notification settings further <a href=\"https:\/\/wordpress.com\/following\/manage?s=johncarlosbaez.wordpress.com\">here<\/a>.","emailNewComments":"Email me new comments","instantly":"Instantly","daily":"Daily","weekly":"Weekly"}};
</script>
<script crossorigin='anonymous' type='text/javascript' src='https://s2.wp.com/_static/??-eJyFykEKwkAMQNELmQ4qtboQz1LbWDJMknGSQXt7K9SFILj6i//CI8Og4igeooWs5oxm/YRNtE34vqxXSgjVsCxAHEhu+sOV5JCLPufPIxlSHdHeM94rlnlNwyR/ETBNpXdc8YXP28OuOx3brt3HF3swRvU='></script>
<script type='text/javascript'>
	window.addEventListener( 'DOMContentLoaded', function() {
		rltInitialize( {"token":null,"iframeOrigins":["https:\/\/widgets.wp.com"]} );
	} );
</script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://johncarlosbaez.wordpress.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://s1.wp.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress.com" />

<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="website" />
<meta property="og:title" content="chemistry &#8211; Page 6 &#8211; Azimuth" />
<meta property="og:url" content="https://johncarlosbaez.wordpress.com/category/chemistry/" />
<meta property="og:site_name" content="Azimuth" />
<meta property="og:image" content="https://s0.wp.com/i/blank.jpg" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:site" content="@wordpressdotcom" />
<meta property="fb:app_id" content="249643311490" />

<!-- End Jetpack Open Graph Tags -->
<link rel="shortcut icon" type="image/x-icon" href="https://s1.wp.com/i/favicon.ico" sizes="16x16 24x24 32x32 48x48" />
<link rel="icon" type="image/x-icon" href="https://s1.wp.com/i/favicon.ico" sizes="16x16 24x24 32x32 48x48" />
<link rel="apple-touch-icon" href="https://s2.wp.com/i/webclip.png" />
<link rel='openid.server' href='https://johncarlosbaez.wordpress.com/?openidserver=1' />
<link rel='openid.delegate' href='https://johncarlosbaez.wordpress.com/' />
<link rel="search" type="application/opensearchdescription+xml" href="https://johncarlosbaez.wordpress.com/osd.xml" title="Azimuth" />
<link rel="search" type="application/opensearchdescription+xml" href="https://s1.wp.com/opensearch.xml" title="WordPress.com" />
<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>		<style type="text/css">
			.recentcomments a {
				display: inline !important;
				padding: 0 !important;
				margin: 0 !important;
			}

			table.recentcommentsavatartop img.avatar, table.recentcommentsavatarend img.avatar {
				border: 0px;
				margin: 0;
			}

			table.recentcommentsavatartop a, table.recentcommentsavatarend a {
				border: 0px !important;
				background-color: transparent !important;
			}

			td.recentcommentsavatarend, td.recentcommentsavatartop {
				padding: 0px 0px 1px 0px;
				margin: 0px;
			}

			td.recentcommentstextend {
				border: none !important;
				padding: 0px 0px 2px 10px;
			}

			.rtl td.recentcommentstextend {
				padding: 0px 10px 2px 0px;
			}

			td.recentcommentstexttop {
				border: none;
				padding: 0px 0px 0px 10px;
			}

			.rtl td.recentcommentstexttop {
				padding: 0px 10px 0px 0px;
			}
		</style>
		<meta name="application-name" content="Azimuth" /><meta name="msapplication-window" content="width=device-width;height=device-height" /><meta name="msapplication-task" content="name=Subscribe;action-uri=https://johncarlosbaez.wordpress.com/feed/;icon-uri=https://s1.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=Sign up for a free blog;action-uri=http://wordpress.com/signup/;icon-uri=https://s1.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=WordPress.com Support;action-uri=http://support.wordpress.com/;icon-uri=https://s1.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=WordPress.com Forums;action-uri=http://forums.wordpress.com/;icon-uri=https://s1.wp.com/i/favicon.ico" /><meta name="description" content="Posts about chemistry written by John Baez" />
<style type="text/css">
#headerimg{
	background: url(https://johncarlosbaez.files.wordpress.com/2010/08/azimuth_header.jpg) no-repeat;
}
#header h1 a, .description {
	color:#E5F2E9;
}
</style>
<!-- There is no amphtml version available for this URL. -->		<link rel="stylesheet" id="custom-css-css" type="text/css" href="https://s0.wp.com/?custom-css=1&#038;csblog=RBZ9&#038;cscache=6&#038;csrev=7" />
		</head>
<body class="archive paged category category-chemistry category-5936 paged-6 category-paged-6 customizer-styles-applied highlander-enabled highlander-light">

<div id="page">

<div id="header">
	<div id="headerimg" onclick="location.href='https://johncarlosbaez.wordpress.com';" style="cursor: pointer;">
		<h1><a href="https://johncarlosbaez.wordpress.com/">Azimuth</a></h1>
		<div class="description"></div>
	</div>
</div>

<ul id="pagebar" class="menu pagebar"><li ><a href="https://johncarlosbaez.wordpress.com/">Home</a></li><li class="page_item page-item-2"><a href="https://johncarlosbaez.wordpress.com/about/">About</a></li>
</ul>

<div id="grad" style="height: 65px; width: 100%; background: url(https://s2.wp.com/wp-content/themes/pub/contempt/images/blue_flower/topgrad.jpg);">&nbsp;</div>

	<div id="content">

	
		
			<div class="post-16438 post type-post status-publish format-standard hentry category-chemistry category-mathematics category-physics category-probability" id="post-16438">
				<h2><a href="https://johncarlosbaez.wordpress.com/2013/07/10/coherence-for-solutions-of-the-master-equation/" rel="bookmark">Coherence for Solutions of the Master&nbsp;Equation</a></h2>
				<small>10 July, 2013</small><br />


				<div class="entry">
					<p><i>guest post by <b><a href="http://arjunjainblog.wordpress.com/about/">Arjun Jain</a></b></i></p>
<p>I am a master&#8217;s student in the physics department of the Indian Institute of Technology Roorkee.  I&#8217;m originally from Delhi. Since some time now, I&#8217;ve been wanting to go into Mathematical Physics.  I hope to do a PhD in that. Apart from maths and physics, I am also quite passionate about art and music.  </p>
<p>Right now I am visiting John Baez at the Centre for Quantum Technologies, and we&#8217;re working on chemical reaction networks.  This post can be considered as an annotation to the last paragraph of John&#8217;s paper, <a href="http://arxiv.org/abs/1306.3451">Quantum Techniques for Reaction Networks</a>, where he raises the question of when a solution to the master equation that starts as a coherent state will remain coherent for all times.   Remember, the &#8216;master equation&#8217; describes the random evolution of collections of classical particles, and a &#8216;coherent state&#8217; is one where the probability distribution of particles of each type is a Poisson distribution.</p>
<p>If you&#8217;ve been following the <a href="http://math.ucr.edu/home/baez/networks/">network theory series</a> on this blog, you&#8217;ll know these concepts, and you&#8217;ll know the Anderson-Craciun-Kurtz theorem gives many examples of coherent states that remain coherent.  However, all these are <i>equilibrium</i> solutions of the master equation: they don&#8217;t change with time.  Moreover they are <i>complex balanced</i> equilibria: the rate at which any complex is produced equals the rate at which it is consumed.</p>
<p>There are also non-equilibrium examples where coherent states remain coherent.  But they seem rather rare, and I would like to explain why.  So, I will give a necessary condition for it to happen.  I&#8217;ll give the proof first, and then discuss some simple examples.  We will see that while the condition is necessary, it is not sufficient.</p>
<p>First, recall the setup.  If you&#8217;ve been following the <a href="http://math.ucr.edu/home/baez/networks/">network theory</a> series, you can skip the next section.</p>
<h3> Reaction networks </h3>
<p><b>Definition.</b>  A <b>reaction network</b> consists of:</p>
<p>&bull; a finite set <img src="https://s0.wp.com/latex.php?latex=S&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S" class="latex" /> of <b>species</b>,</p>
<p>&bull; a finite set <img src="https://s0.wp.com/latex.php?latex=K&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="K" class="latex" /> of complexes, where a <b>complex</b> is a finite sum of species, or in other words, an element of <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BN%7D%5ES%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{N}^S," class="latex" /> </p>
<p>&bull; a graph with <img src="https://s0.wp.com/latex.php?latex=K&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="K" class="latex" /> as its set of vertices and some set <img src="https://s0.wp.com/latex.php?latex=T&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T" class="latex" /> of edges.  </p>
<p>You should have in mind something like this:</p>
<div align="center">
<img width="200" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/chemical_reaction_network_part_17_II.png" />
</div>
<p>where our set of species is <img src="https://s0.wp.com/latex.php?latex=S+%3D+%5C%7BA%2CB%2CC%2CD%2CE%5C%7D%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S = &#92;{A,B,C,D,E&#92;}," class="latex" /> the complexes are things like <img src="https://s0.wp.com/latex.php?latex=A+%2B+E%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A + E," class="latex" /> and the arrows are the elements of <img src="https://s0.wp.com/latex.php?latex=T%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T," class="latex" /> called <b>transitions</b> or <b>reactions</b>.  So, we have functions </p>
<p><img src="https://s0.wp.com/latex.php?latex=s+%2C+t+%3A+T+%5Cto+K+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s , t : T &#92;to K " class="latex" /> </p>
<p>saying the <b>source</b> and <b>target</b> of each transition.</p>
<p>Next:</p>
<p><b>Definition.</b> A <b>stochastic reaction network</b> is a reaction network together with a function <img src="https://s0.wp.com/latex.php?latex=r%3A+T+%5Cto+%280%2C%5Cinfty%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="r: T &#92;to (0,&#92;infty)" class="latex" /> assigning a <b>rate constant</b> to each reaction.</p>
<p>From this we can write down the <b>master equation</b>, which describes how a stochastic state evolves in time:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bd%7D%7Bdt%7D+%5CPsi%28t%29+%3D+H+%5CPsi%28t%29+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{d}{dt} &#92;Psi(t) = H &#92;Psi(t) } " class="latex" /></p>
<p>Here <img src="https://s0.wp.com/latex.php?latex=%5CPsi%28t%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Psi(t)" class="latex" /> is a vector in the <b>stochastic Fock space</b>, which is the space of formal power series in a bunch of variables, one for each species, and <img src="https://s0.wp.com/latex.php?latex=H&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H" class="latex" /> is an operator on this space, called the <b>Hamiltonian</b>.</p>
<p>From now on I&#8217;ll number the species with numbers from <img src="https://s0.wp.com/latex.php?latex=1&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="1" class="latex" /> to <img src="https://s0.wp.com/latex.php?latex=k%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="k," class="latex" /> so</p>
<p><img src="https://s0.wp.com/latex.php?latex=S+%3D+%5C%7B1%2C+%5Cdots%2C+k%5C%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S = &#92;{1, &#92;dots, k&#92;}" class="latex" /></p>
<p>Then the stochastic Fock space consists of real formal power series in variables that I&#8217;ll call <img src="https://s0.wp.com/latex.php?latex=z_1%2C+%5Cdots%2C+z_k.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="z_1, &#92;dots, z_k." class="latex" />   We can write any of these power series as</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B%5CPsi+%3D+%5Csum_%7B%5Cell+%5Cin+%5Cmathbb%7BN%7D%5Ek%7D+%5Cpsi_%5Cell+z%5E%5Cell+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{&#92;Psi = &#92;sum_{&#92;ell &#92;in &#92;mathbb{N}^k} &#92;psi_&#92;ell z^&#92;ell }" class="latex" /></p>
<p>where </p>
<p><img src="https://s0.wp.com/latex.php?latex=z%5E%5Cell+%3D+z_1%5E%7B%5Cell_1%7D+%5Ccdots+z_k%5E%7B%5Cell_k%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="z^&#92;ell = z_1^{&#92;ell_1} &#92;cdots z_k^{&#92;ell_k}" class="latex" /></p>
<p>We have <b>annihilation</b> and <b>creation</b> operators on the stochastic Fock space:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+a_i+%5CPsi+%3D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+z_i%7D+%5CPsi+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ a_i &#92;Psi = &#92;frac{&#92;partial}{&#92;partial z_i} &#92;Psi }" class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+a_i%5E%5Cdagger+%5CPsi+%3D+z_i+%5CPsi+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ a_i^&#92;dagger &#92;Psi = z_i &#92;Psi }" class="latex" /></p>
<p>and the Hamiltonian is built from these as follows:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+H+%3D+%5Csum_%7B%5Ctau+%5Cin+T%7D+r%28%5Ctau%29+%5C%2C+%28%7Ba%5E%5Cdagger%7D%5E%7Bt%28%5Ctau%29%7D+-+%7Ba%5E%5Cdagger%7D%5E%7Bs%28%5Ctau%29%7D%29+%5C%2C+a%5E%7Bs%28%5Ctau%29%7D+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ H = &#92;sum_{&#92;tau &#92;in T} r(&#92;tau) &#92;, ({a^&#92;dagger}^{t(&#92;tau)} - {a^&#92;dagger}^{s(&#92;tau)}) &#92;, a^{s(&#92;tau)} } " class="latex" /></p>
<p>John explained this <a href="http://math.ucr.edu/home/baez/networks/networks_8.html#master_equation">here</a> (using slightly different notation), so I won&#8217;t go into much detail now, but I&#8217;ll say what all the symbols mean.  Remember that the source of a transition <img src="https://s0.wp.com/latex.php?latex=%5Ctau&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau" class="latex" /> is a complex, or list of natural numbers:</p>
<p><img src="https://s0.wp.com/latex.php?latex=s%28%5Ctau%29+%3D+%28s_1%28%5Ctau%29%2C+%5Cdots%2C+s_k%28%5Ctau%29%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s(&#92;tau) = (s_1(&#92;tau), &#92;dots, s_k(&#92;tau))" class="latex" /></p>
<p>So, the power <img src="https://s0.wp.com/latex.php?latex=a%5E%7Bs%28%5Ctau%29%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="a^{s(&#92;tau)}" class="latex" /> is really an abbreviation for a big product of annihilation operators, like this:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+a%5E%7Bs%28%5Ctau%29%7D+%3D+a_1%5E%7Bs_1%28%5Ctau%29%7D+%5Ccdots+a_k%5E%7Bs_k%28%5Ctau%29%7D+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ a^{s(&#92;tau)} = a_1^{s_1(&#92;tau)} &#92;cdots a_k^{s_k(&#92;tau)} }" class="latex" /></p>
<p>This describes the annihilation of all the inputs to the transition <img src="https://s0.wp.com/latex.php?latex=%5Ctau.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau." class="latex" />  Similarly, we define</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%7Ba%5E%5Cdagger%7D%5E%7Bs%28%5Ctau%29%7D+%3D+%7Ba_1%5E%5Cdagger%7D%5E%7Bs_1%28%5Ctau%29%7D+%5Ccdots+%7Ba_k%5E%5Cdagger%7D%5E%7Bs_k%28%5Ctau%29%7D+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ {a^&#92;dagger}^{s(&#92;tau)} = {a_1^&#92;dagger}^{s_1(&#92;tau)} &#92;cdots {a_k^&#92;dagger}^{s_k(&#92;tau)} }" class="latex" /></p>
<p>and</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%7Ba%5E%5Cdagger%7D%5E%7Bt%28%5Ctau%29%7D+%3D+%7Ba_1%5E%5Cdagger%7D%5E%7Bt_1%28%5Ctau%29%7D+%5Ccdots+%7Ba_k%5E%5Cdagger%7D%5E%7Bt_k%28%5Ctau%29%7D+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ {a^&#92;dagger}^{t(&#92;tau)} = {a_1^&#92;dagger}^{t_1(&#92;tau)} &#92;cdots {a_k^&#92;dagger}^{t_k(&#92;tau)} }" class="latex" /></p>
<h3> The result </h3>
<p>Here&#8217;s the result:</p>
<p><b>Theorem.</b>  If a solution <img src="https://s0.wp.com/latex.php?latex=%5CPsi%28t%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Psi(t)" class="latex" /> of the master equation is a coherent state for all times <img src="https://s0.wp.com/latex.php?latex=t+%5Cge+0%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="t &#92;ge 0," class="latex" /> then <img src="https://s0.wp.com/latex.php?latex=%5CPsi%280%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Psi(0)" class="latex" /> must be complex balanced except for complexes of degree 0 or 1.</p>
<p>This requires some explanation.  </p>
<p>First, saying that <img src="https://s0.wp.com/latex.php?latex=%5CPsi%28t%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Psi(t)" class="latex" /> is a <b>coherent state</b> means that it is an eigenvector of all the annihilation operators.  Concretely this means</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5CPsi+%28t%29+%3D+%5Cdisplaystyle%7B%5Cfrac%7Be%5E%7Bc%28t%29+%5Ccdot+z%7D%7D%7Be%5E%7Bc_1%28t%29+%2B+%5Ccdots+%2B+c_k%28t%29%7D%7D%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Psi (t) = &#92;displaystyle{&#92;frac{e^{c(t) &#92;cdot z}}{e^{c_1(t) + &#92;cdots + c_k(t)}}}" class="latex" /> </p>
<p>where </p>
<p><img src="https://s0.wp.com/latex.php?latex=c%28t%29+%3D+%28c_1%28t%29%2C+%5Cdots%2C+c_k%28t%29%29+%5Cin+%5B0%2C%5Cinfty%29%5Ek&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="c(t) = (c_1(t), &#92;dots, c_k(t)) &#92;in [0,&#92;infty)^k" class="latex" /> </p>
<p>and </p>
<p><img src="https://s0.wp.com/latex.php?latex=z+%3D+%28z_1%2C+%5Cdots%2C+z_k%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="z = (z_1, &#92;dots, z_k)" class="latex" /> </p>
<p>It will be helpful to write</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cmathbf%7B1%7D%3D+%281%2C1%2C1%2C...%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbf{1}= (1,1,1,...)" class="latex" /> </p>
<p>so we can write</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5CPsi+%28t%29+%3D+%5Cdisplaystyle%7B+e%5E%7Bc%28t%29+%5Ccdot+%28z+-+%5Cmathbf%7B1%7D%29%7D+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Psi (t) = &#92;displaystyle{ e^{c(t) &#92;cdot (z - &#92;mathbf{1})} }" class="latex" /> </p>
<p>Second, we say that a complex has <b>degree</b> <img src="https://s0.wp.com/latex.php?latex=d&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="d" class="latex" /> if it is a sum of exactly <img src="https://s0.wp.com/latex.php?latex=d&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="d" class="latex" /> species.  For example, in this reaction network:</p>
<div align="center">
<img width="200" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/chemical_reaction_network_part_17_II.png" />
</div>
<p>the complexes <img src="https://s0.wp.com/latex.php?latex=A+%2B+C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A + C" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=B+%2B+E&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="B + E" class="latex" /> have degree 2, while the rest have degree 1.  We use the word &#8216;degree&#8217; because each complex <img src="https://s0.wp.com/latex.php?latex=%5Cell&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;ell" class="latex" /> gives a monomial</p>
<p><img src="https://s0.wp.com/latex.php?latex=z%5E%5Cell+%3D+z_1%5E%7B%5Cell_1%7D+%5Ccdots+z_k%5E%7B%5Cell_k%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="z^&#92;ell = z_1^{&#92;ell_1} &#92;cdots z_k^{&#92;ell_k}" class="latex" /></p>
<p>and the degree of the complex is the degree of this monomial, namely</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cell_1+%2B+%5Ccdots+%2B+%5Cell_k+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;ell_1 + &#92;cdots + &#92;ell_k " class="latex" /></p>
<p>Third and finally, we say a solution <img src="https://s0.wp.com/latex.php?latex=%5CPsi%28t%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Psi(t)" class="latex" /> of the master equation is <b>complex balanced</b> for a specific complex <img src="https://s0.wp.com/latex.php?latex=%5Cell&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;ell" class="latex" /> if the total rate at which that complex is produced equals the total rate at which it&#8217;s destroyed. </p>
<p>Now we are ready to prove the theorem:</p>
<p><b>Proof.</b>  Consider the master equation</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle+%7B+%5Cfrac%7Bd+%5CPsi+%28t%29%7D%7Bd+t%7D+%3D+H+%5Cpsi+%28t%29+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle { &#92;frac{d &#92;Psi (t)}{d t} = H &#92;psi (t) }" class="latex" /></p>
<p>Assume that <img src="https://s0.wp.com/latex.php?latex=%5CPsi%28t%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Psi(t)" class="latex" /> is a coherent state for all <img src="https://s0.wp.com/latex.php?latex=t+%5Cge+0.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="t &#92;ge 0." class="latex" />  This means</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5CPsi+%28t%29+%3D+%5Cdisplaystyle%7B+e%5E%7Bc%28t%29+%5Ccdot+%28z+-+%5Cmathbf%7B1%7D%29%7D+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Psi (t) = &#92;displaystyle{ e^{c(t) &#92;cdot (z - &#92;mathbf{1})} }" class="latex" /></p>
<p>For convenience, we write <img src="https://s0.wp.com/latex.php?latex=c%28t%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="c(t)" class="latex" /> simply as <img src="https://s0.wp.com/latex.php?latex=c%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="c," class="latex" /> and similarly for the components <img src="https://s0.wp.com/latex.php?latex=c_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="c_i" class="latex" />.   Then we have</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bd%5CPsi%28t%29%7D%7Bdt%7D++%3D+%28%5Cdot%7Bc%7D+%5Ccdot+%28z+-+%5Cmathbf%7B1%7D%29%29+%5C%2C+e%5E%7Bc+%5Ccdot+%28z+-+%5Cmathbf%7B1%7D%29%7D+++%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{d&#92;Psi(t)}{dt}  = (&#92;dot{c} &#92;cdot (z - &#92;mathbf{1})) &#92;, e^{c &#92;cdot (z - &#92;mathbf{1})}   } " class="latex" /></p>
<p>On the other hand, the master equation gives</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Barray%7D%7Bccl%7D+%5Cdisplaystyle+%7B%5Cfrac%7Bd%5CPsi%28t%29%7D%7Bdt%7D%7D+%26%3D%26++%5Cdisplaystyle%7B+%5Csum_%7B%5Ctau+%5Cin+T%7D+r%28%5Ctau%29+%5C%2C+%28%7Ba%5E%5Cdagger%7D%5E%7Bt%28%5Ctau%29%7D+-+%7Ba%5E%5Cdagger%7D%5E%7Bs%28%5Ctau%29%7D%29+%5C%2C+a%5E%7Bs%28%5Ctau%29%7D+e%5E%7Bc+%5Ccdot+%28z+-+%5Cmathbf%7B1%7D%29%7D+%7D+%5C%5C++%5C%5C++%26%3D%26+%5Cdisplaystyle%7B%5Csum_%7B%5Ctau+%5Cin+T%7D+c%5E%7Bt%28%5Ctau%29%7D+r%28%5Ctau%29+%5C%2C+%28%7Bz%7D%5E%7Bt%28%5Ctau%29%7D+-+%7Bz%7D%5E%7Bs%28%5Ctau%29%7D%29+e%5E%7Bc+%5Ccdot+%28z+-+%5Cmathbf%7B1%7D%29%7D+%7D+%5Cend%7Barray%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;begin{array}{ccl} &#92;displaystyle {&#92;frac{d&#92;Psi(t)}{dt}} &amp;=&amp;  &#92;displaystyle{ &#92;sum_{&#92;tau &#92;in T} r(&#92;tau) &#92;, ({a^&#92;dagger}^{t(&#92;tau)} - {a^&#92;dagger}^{s(&#92;tau)}) &#92;, a^{s(&#92;tau)} e^{c &#92;cdot (z - &#92;mathbf{1})} } &#92;&#92;  &#92;&#92;  &amp;=&amp; &#92;displaystyle{&#92;sum_{&#92;tau &#92;in T} c^{t(&#92;tau)} r(&#92;tau) &#92;, ({z}^{t(&#92;tau)} - {z}^{s(&#92;tau)}) e^{c &#92;cdot (z - &#92;mathbf{1})} } &#92;end{array} " class="latex" /></p>
<p>So, </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%28%5Cdot%7Bc%7D+%5Ccdot+%28z+-+%5Cmathbf%7B1%7D%29%29+%5C%2C+e%5E%7Bc+%5Ccdot+%28z+-+%5Cmathbf%7B1%7D%29%7D++%3D%5Csum_%7B%5Ctau+%5Cin+T%7D+c%5E%7Bt%28%5Ctau%29%7D+r%28%5Ctau%29+%5C%2C+%28%7Bz%7D%5E%7Bt%28%5Ctau%29%7D+-+%7Bz%7D%5E%7Bs%28%5Ctau%29%7D%29+e%5E%7Bc+%5Ccdot+%28z+-+%5Cmathbf%7B1%7D%29%7D+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ (&#92;dot{c} &#92;cdot (z - &#92;mathbf{1})) &#92;, e^{c &#92;cdot (z - &#92;mathbf{1})}  =&#92;sum_{&#92;tau &#92;in T} c^{t(&#92;tau)} r(&#92;tau) &#92;, ({z}^{t(&#92;tau)} - {z}^{s(&#92;tau)}) e^{c &#92;cdot (z - &#92;mathbf{1})} }" class="latex" /></p>
<p>As a result, we get </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B++%5Cdot%7Bc%7D%5Ccdot+z+-%5Cdot%7Bc%7D%5Ccdot%5Cmathbf%7B1%7D+%3D++%5Csum_%7B%5Ctau+%5Cin+T%7D+c%5E%7Bs%28%5Ctau%29%7D+r%28%5Ctau%29+%5C%2C+%28%7Bz%7D%5E%7Bt%28%5Ctau%29%7D+-+%7Bz%7D%5E%7Bs%28%5Ctau%29%7D%29++%7D.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{  &#92;dot{c}&#92;cdot z -&#92;dot{c}&#92;cdot&#92;mathbf{1} =  &#92;sum_{&#92;tau &#92;in T} c^{s(&#92;tau)} r(&#92;tau) &#92;, ({z}^{t(&#92;tau)} - {z}^{s(&#92;tau)})  }." class="latex" /></p>
<p>Comparing the coefficients of all <img src="https://s0.wp.com/latex.php?latex=z%5E%5Cell%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="z^&#92;ell," class="latex" /> we obtain the following.  For <img src="https://s0.wp.com/latex.php?latex=%5Cell+%3D+0%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;ell = 0," class="latex" /> which is the only complex of degree zero, we get</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle+%7B+%5Csum_%7B%5Ctau%3A+t%28%5Ctau%29%3D0%7D+r%28%5Ctau%29+c%5E%7Bs%28%5Ctau%29%7D+-+%5Csum_%7B%5Ctau%5C%3B%3A%5C%3B+s%28%5Ctau%29%3D+0%7D+r%28%5Ctau%29+c%5E%7Bs%28%5Ctau%29%7D+%3D+-%5Cdot%7Bc%7D%5Ccdot%5Cmathbf%7B1%7D+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle { &#92;sum_{&#92;tau: t(&#92;tau)=0} r(&#92;tau) c^{s(&#92;tau)} - &#92;sum_{&#92;tau&#92;;:&#92;; s(&#92;tau)= 0} r(&#92;tau) c^{s(&#92;tau)} = -&#92;dot{c}&#92;cdot&#92;mathbf{1} }" class="latex" /></p>
<p>For the complexes <img src="https://s0.wp.com/latex.php?latex=%5Cell&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;ell" class="latex" /> of degree one, we get these equations:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle+%7B+%5Csum_%7B%5Ctau%5C%3B%3A%5C%3B+t%28%5Ctau%29%3D%281%2C0%2C0%2C%5Cdots%29%7D+r%28%5Ctau%29+c%5E%7Bs%28%5Ctau%29%7D+-+%5Csum_%7B%5Ctau+%5C%3B%3A%5C%3Bs%28%5Ctau%29%3D%281%2C0%2C0%2C%5Cdots%29%7D+r%28%5Ctau%29+c%5E%7Bs%28%5Ctau%29%7D%3D+%5Cdot%7Bc_1%7D+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle { &#92;sum_{&#92;tau&#92;;:&#92;; t(&#92;tau)=(1,0,0,&#92;dots)} r(&#92;tau) c^{s(&#92;tau)} - &#92;sum_{&#92;tau &#92;;:&#92;;s(&#92;tau)=(1,0,0,&#92;dots)} r(&#92;tau) c^{s(&#92;tau)}= &#92;dot{c_1} }" class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle+%7B+%5Csum_%7B%5Ctau%5C%3B+%3A%5C%3B+t%28%5Ctau%29%3D%280%2C1%2C0%2C%5Cdots%29%7D+r%28%5Ctau%29+c%5E%7Bs%28%5Ctau%29%7D+-+%5Csum_%7B%5Ctau%5C%3B%3A%5C%3B+s%28%5Ctau%29%3D%280%2C1%2C0%2C%5Cdots%29%7D+r%28%5Ctau%29+c%5E%7Bs%28%5Ctau%29%7D+%3D+%5Cdot%7Bc_2%7D+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle { &#92;sum_{&#92;tau&#92;; :&#92;; t(&#92;tau)=(0,1,0,&#92;dots)} r(&#92;tau) c^{s(&#92;tau)} - &#92;sum_{&#92;tau&#92;;:&#92;; s(&#92;tau)=(0,1,0,&#92;dots)} r(&#92;tau) c^{s(&#92;tau)} = &#92;dot{c_2} }" class="latex" /></p>
<p>and so on.   For all the remaining complexes <img src="https://s0.wp.com/latex.php?latex=%5Cell&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;ell" class="latex" /> we have</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle+%7B+%5Csum_%7B%5Ctau%5C%3B%3A%5C%3B+t%28%5Ctau%29%3D%5Cell%7D+r%28%5Ctau%29+c%5E%7Bs%28%5Ctau%29%7D+%3D+%5Csum_%7B%5Ctau+%5C%3B%3A%5C%3B+s%28%5Ctau%29%3D%5Cell%7D+r%28%5Ctau%29+c%5E%7Bs%28%5Ctau%29%7D+%7D.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle { &#92;sum_{&#92;tau&#92;;:&#92;; t(&#92;tau)=&#92;ell} r(&#92;tau) c^{s(&#92;tau)} = &#92;sum_{&#92;tau &#92;;:&#92;; s(&#92;tau)=&#92;ell} r(&#92;tau) c^{s(&#92;tau)} }." class="latex" /></p>
<p>This says that the total rate at which this complex is produced equals the total rate at which it&#8217;s destroyed.  So, our solution of the master equation is complex balanced for all complexes <img src="https://s0.wp.com/latex.php?latex=%5Cell&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;ell" class="latex" /> of degree greater than one.  This is our necessary condition.  &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;    &#9608;</p>
<p>To illustrate the theorem, I&#8217;ll consider three simple examples. The third example shows that the condition in the theorem, though necessary, is not sufficient.  Note that our proof also gives a necessary <i>and sufficient</i> condition for a coherent state to remain coherent: namely, that <i>all</i> the equations we listed hold, not just initially but for all times.  But this condition seems a bit complicated.</p>
<h3>Introducing amoebae into a Petri dish</h3>
<div align="center"><img width="100" src="https://i2.wp.com/math.ucr.edu/home/baez/networks/amoebae1.png" /></div>
<p>Suppose that there is an inexhaustible supply of amoebae, randomly floating around in a huge pond. Each time an amoeba comes into our collection area, we catch it and add it to the population of amoebae in the Petri dish.  Suppose that the rate constant for this process is 3.</p>
<p>So, the Hamiltonian is <img src="https://s0.wp.com/latex.php?latex=3%28a%5E%5Cdagger+-1%29.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="3(a^&#92;dagger -1)." class="latex" /> If we start with a coherent state, say </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle+%7B+%5CPsi%280%29%3D%5Cfrac%7Be%5E%7Bcz%7D%7D%7Be%5Ec%7D+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle { &#92;Psi(0)=&#92;frac{e^{cz}}{e^c} }" class="latex" /> </p>
<p>then </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle+%7B+%5CPsi%28t%29+%3D+e%5E%7B3%28a%5E%5Cdagger+-1%29t%7D+%5C%3B+%5Cfrac%7Be%5E%7Bcz%7D%7D%7Be%5Ec%7D++%3D+%5Cfrac%7Be%5E%7B%28c%2B3t%29z%7D%7D%7Be%5E%7Bc%2B3t%7D%7D+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle { &#92;Psi(t) = e^{3(a^&#92;dagger -1)t} &#92;; &#92;frac{e^{cz}}{e^c}  = &#92;frac{e^{(c+3t)z}}{e^{c+3t}} }" class="latex" /> </p>
<p>which is coherent at all times.</p>
<p>We can see that the condition of the theorem is satisfied, as all the complexes in the reaction network have degree 0 or 1.</p>
<h3>Amoebae reproducing and competing</h3>
<div align="center"><img width="450" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/amoebae2.png" /></div>
<p>This example shows a Petri dish with one species, amoebae, and two transitions: fission and competition. We suppose that the rate constant for fission is 2, while that for competition is 1. The Hamiltonian is then</p>
<p><img src="https://s0.wp.com/latex.php?latex=H%3D+2%28%7Ba%5E%5Cdagger%7D%5E2-a%5E%5Cdagger%29a+%2B+%28a%5E%5Cdagger-%7Ba%5E%5Cdagger%7D%5E2%29a%5E2&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H= 2({a^&#92;dagger}^2-a^&#92;dagger)a + (a^&#92;dagger-{a^&#92;dagger}^2)a^2" class="latex" /> </p>
<p>If we start off with the coherent state </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B%5CPsi%280%29+%3D+%5Cfrac%7Be%5E%7B2z%7D%7D%7Be%5E2%7D%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{&#92;Psi(0) = &#92;frac{e^{2z}}{e^2}}" class="latex" /> </p>
<p>we find that </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle+%7B%5CPsi%28t%29%3De%5E%7B2%28z%5E2-z%292%2B%28z-z%5E2%294%7D+%5C%3B+%5CPsi%280%29%7D%3D%5CPsi%280%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle {&#92;Psi(t)=e^{2(z^2-z)2+(z-z^2)4} &#92;; &#92;Psi(0)}=&#92;Psi(0)" class="latex" /></p>
<p>which is coherent.  It should be noted that the chosen initial state</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Be%5E%7B2z%7D%7D%7Be%5E2%7D%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{e^{2z}}{e^2}}" class="latex" /></p>
<p>was a complex balanced equilibrium solution. So, the Anderson–Craciun–Kurtz Theorem applies to this case.</p>
<h3>Amoebae reproducing, competing, and being introduced</h3>
<div align="center"><img width="450" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/amoebae3.png" /></div>
<p>This is a combination of the previous two examples, where apart from ongoing reproduction and competition, amoebae are being introduced into the dish with a rate constant 3.</p>
<p>As in the above examples, we might think that coherent states could remain coherent forever here too. Let&#8217;s check that.</p>
<p>Assuming that this was true,  if  </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B%5CPsi%28t%29+%3D+%5Cfrac%7Be%5E%7Bc%28t%29z%7D%7D%7Be%5E%7Bc%28t%29%7D%7D+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{&#92;Psi(t) = &#92;frac{e^{c(t)z}}{e^{c(t)}} }" class="latex" /> </p>
<p>then <img src="https://s0.wp.com/latex.php?latex=c%28t%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="c(t)" class="latex" /> would have to satisfy the following:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdot%7Bc%7D%28t%29+%3D+c%28t%29%5E2+%2B+3+-2c%28t%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;dot{c}(t) = c(t)^2 + 3 -2c(t)" class="latex" /> </p>
<p>and</p>
<p><img src="https://s0.wp.com/latex.php?latex=c%28t%29%5E2%3D2c%28t%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="c(t)^2=2c(t)" class="latex" /></p>
<p>Using the second equation, we get  </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdot%7Bc%7D%28t%29+%3D+3+%5CRightarrow+c+%3D+3t%2B+c_0&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;dot{c}(t) = 3 &#92;Rightarrow c = 3t+ c_0" class="latex" /> </p>
<p>But this is certainly not a solution of the second equation. So, here we find that initially coherent states do not remain remain coherent for all times.  </p>
<p>However, if we choose </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B%5CPsi%280%29+%3D+%5Cfrac%7Be%5E%7B2z%7D%7D%7Be%5E2%7D%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{&#92;Psi(0) = &#92;frac{e^{2z}}{e^2}}" class="latex" /></p>
<p>then this coherent state is complex balanced except for complexes of degree 1, since it was in the previous example, and the only new feature of this example, at time zero, is that single amoebas are being introduced&#8212;and these are complexes of degree 1.  So, the condition of the theorem does hold.</p>
<p>So, the condition in the theorem is necessary but not sufficient.  However, it is easy to check, and we can use it to show that in many cases, coherent states must cease to be coherent.</p>
									</div>

				<p class="postmetadata">
				<img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/speech_bubble.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2013/07/10/coherence-for-solutions-of-the-master-equation/#comments">15 Comments</a>				| <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/documents.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/category/chemistry/" rel="category tag">chemistry</a>, <a href="https://johncarlosbaez.wordpress.com/category/mathematics/" rel="category tag">mathematics</a>, <a href="https://johncarlosbaez.wordpress.com/category/physics/" rel="category tag">physics</a>, <a href="https://johncarlosbaez.wordpress.com/category/probability/" rel="category tag">probability</a>								 | <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/permalink.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2013/07/10/coherence-for-solutions-of-the-master-equation/" rel="bookmark" title="Permanent Link to Coherence for Solutions of the Master&nbsp;Equation">Permalink</a>
<br /><img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/figure_ver1.gif" alt="" /> Posted by John Baez				</p>
			</div>
			<hr />
		
			<div class="post-16299 post type-post status-publish format-standard hentry category-chemistry category-mathematics category-physics category-probability" id="post-16299">
				<h2><a href="https://johncarlosbaez.wordpress.com/2013/07/01/the-large-number-limit-for-reaction-networks-part-1/" rel="bookmark">The Large-Number Limit for Reaction Networks (Part&nbsp;1)</a></h2>
				<small>1 July, 2013</small><br />


				<div class="entry">
					<p><i>Waiting for the other shoe to drop.</i></p>
<p>This is a figure of speech that means &#8216;waiting for the inevitable consequence of what&#8217;s come so far&#8217;.  Do you know where it comes from?  You have to imagine yourself in an apartment on the floor below someone who is taking off their shoes.  When you hear one, you know the next is coming.</p>
<p>There&#8217;s even an <a href="http://alt-usage-english.org/excerpts/fxwaitfo.html">old comedy routine</a> about this:</p>
<blockquote><p>
A guest who checked into an inn one night was warned to be quiet because the guest in the room next to his was a light sleeper.  As he undressed for bed, he dropped one shoe, which, sure enough, awakened the other guest.  He managed to get the other shoe off in silence, and got into bed.  An hour later, he heard a pounding on the wall and a shout:  &#8220;When are you going to drop the other shoe?&#8221;
</p></blockquote>
<p>When we were working on math together, James Dolan liked to say &#8220;the other shoe has dropped&#8221; whenever an inevitable consequence of some previous realization became clear.   There&#8217;s also the mostly British phrase <i>the penny has dropped</i>.  You say this when someone finally realizes the situation they&#8217;re in.</p>
<p>But sometimes one realization comes after another, in a long sequence.  Then it feels like it&#8217;s raining shoes!</p>
<div align="center">
<img src="https://i1.wp.com/math.ucr.edu/home/baez/mathematical/shoes_dropping.jpg" /></div>
<p>I guess that&#8217;s a rather strained metaphor.  Perhaps <i>falling like dominoes</i> is better for these long chains of realizations.</p>
<div align="center">
<img src="https://i0.wp.com/math.ucr.edu/home/baez/mathematical/dominoes_falling.gif" /></div>
<p>This is how I&#8217;ve felt in my recent research on the interplay between quantum mechanics, stochastic mechanics, statistical mechanics and extremal principles like the principle of least action.   The basics of these subjects should be completely figured out by now, but they aren&#8217;t&mdash;and a lot of what&#8217;s known, nobody bothered to tell most of us.</p>
<p>So, I was surprised to rediscover that <a href="https://johncarlosbaez.wordpress.com/2012/01/19/classical-mechanics-versus-thermodynamics-part-1/">the Maxwell relations in thermodynamics are formally identical to Hamilton&#8217;s equations in classical mechanics</a>&#8230; though in retrospect it&#8217;s obvious.   Thermodynamics obeys the principle of maximum entropy, while classical mechanics obeys the principle of least action.   Wherever there&#8217;s an extremal principle, <a href="http://en.wikipedia.org/wiki/Symplectic_geometry">symplectic geometry</a>, and equations like Hamilton&#8217;s equations, are sure to follow.</p>
<p>I was surprised to discover (or maybe rediscover, I&#8217;m not sure yet) that just as statistical mechanics is governed by the principle of maximum entropy, quantum mechanics is governed by a principle of maximum <a href="https://johncarlosbaez.wordpress.com/2011/12/22/quantropy/">&#8216;quantropy&#8217;</a>.  The analogy between statistical mechanics and quantum mechanics has been known at least since Feynman and Schwinger.  But this basic aspect was never explained to me!</p>
<p>I was also surprised to rediscover that simply by replacing amplitudes by probabilities in the formalism of quantum field theory, we get <a href="http:/math.ucr.edu/home/baez/stoch_stable.pdf">a nice formalism for studying stochastic many-body systems</a>.  This formalism happens to perfectly match the &#8216;stochastic Petri nets&#8217; and &#8216;reaction networks&#8217; already used in subjects from population biology to epidemiology to chemistry.  But now we can systematically borrow tools from quantum field theory!  All the tricks that particle physicists like&#8212;annihilation and creation operators, coherent states and so on&#8212;can be applied to problems like the battle between the AIDS virus and human white blood cells.</p>
<p>And, perhaps because I&#8217;m a bit slow on the uptake, I was surprised when yet another shoe came crashing to the floor the other day.</p>
<div align="center">
<img src="https://i0.wp.com/math.ucr.edu/home/baez/mathematical/shoe_dropping.jpg" /></div>
<p>Because quantum field theory has, at least formally, a nice limit where Planck&#8217;s constant goes to zero, the same is true for for stochastic Petri nets and reaction networks!</p>
<p>In quantum field theory, we call this the &#8216;classical limit&#8217;.   For example, if you have a really huge number of photons all in the same state, quantum effects sometimes become negligible, and we can describe them using the <i>classical</i> equations describing electromagnetism: the classical Maxwell equations.  In stochastic situations, it makes more sense to call this limit the &#8216;large-number limit&#8217;: the main point is that there are lots of particles in each state.</p>
<p>In quantum mechanics, different observables don&#8217;t commute, so the so-called <a href="http://en.wikipedia.org/wiki/Commutator#Ring_theory">commutator</a> matters a lot:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5BA%2CB%5D+%3D+AB+-+BA+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="[A,B] = AB - BA " class="latex" /></p>
<p>These commutators tend to be proportional to Planck&#8217;s constant.  So in the limit where Planck&#8217;s constant <img src="https://s0.wp.com/latex.php?latex=%5Chbar&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;hbar" class="latex" /> goes to zero, observables commute&#8230; but commutators continue to have a ghostly existence, in the form of <a href="http://en.wikipedia.org/wiki/Poisson_bracket">Poisson bracket</a>:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5C%7BA%2CB%5C%7D+%3D+%5Clim_%7B%5Chbar+%5Cto+0%7D+%5C%3B+%5Cfrac%7B1%7D%7B%5Chbar%7D+%5BA%2CB%5D+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;{A,B&#92;} = &#92;lim_{&#92;hbar &#92;to 0} &#92;; &#92;frac{1}{&#92;hbar} [A,B] } " class="latex" /></p>
<p>Poisson brackets are a key part of symplectic geometry&#8212;the geometry of classical mechanics.  So, this sort of geometry naturally shows up in the study of stochastic Petri nets!</p>
<p>Let me sketch how it works.  I&#8217;ll start with a section reviewing stuff you should already know if you&#8217;ve been following the <a href="http://math.ucr.edu/home/baez/networks/">network theory</a> series.</p>
<h3> The stochastic Fock space </h3>
<p>Suppose we have some finite set <img src="https://s0.wp.com/latex.php?latex=S&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S" class="latex" />.  We call its elements <b>species</b>, since we think of them as different kinds of things&#8212;e.g., kinds of chemicals, or kinds of organisms.</p>
<p>To describe the probability of having any number of things of each kind, we need the <b>stochastic Fock space</b>.  This is the space of real <a href="http://en.wikipedia.org/wiki/Formal_power_series">formal power series</a> in a bunch of variables, one for each element of <img src="https://s0.wp.com/latex.php?latex=S.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S." class="latex" />  It won&#8217;t hurt to simply say</p>
<p><img src="https://s0.wp.com/latex.php?latex=S+%3D+%5C%7B1%2C+%5Cdots%2C+k+%5C%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S = &#92;{1, &#92;dots, k &#92;}" class="latex" /></p>
<p>Then the stochastic Fock space is</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5B%5Bz_1%2C+%5Cdots%2C+z_k+%5D%5D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}[[z_1, &#92;dots, z_k ]] " class="latex" /></p>
<p>this being math jargon for the space of formal power series with real coefficients in some variables <img src="https://s0.wp.com/latex.php?latex=z_1%2C+%5Cdots%2C+z_k%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="z_1, &#92;dots, z_k," class="latex" /> one for each element of <img src="https://s0.wp.com/latex.php?latex=S.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S." class="latex" /></p>
<p>We write</p>
<p><img src="https://s0.wp.com/latex.php?latex=n+%3D+%28n_1%2C+%5Cdots%2C+n_k%29+%5Cin+%5Cmathbb%7BN%7D%5ES&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="n = (n_1, &#92;dots, n_k) &#92;in &#92;mathbb{N}^S" class="latex" /></p>
<p>and use this abbreviation:</p>
<p><img src="https://s0.wp.com/latex.php?latex=z%5En+%3D+z_1%5E%7Bn_1%7D+%5Ccdots+z_k%5E%7Bn_k%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="z^n = z_1^{n_1} &#92;cdots z_k^{n_k}" class="latex" /></p>
<p>We use <img src="https://s0.wp.com/latex.php?latex=z%5En&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="z^n" class="latex" /> to describe a state where we have <img src="https://s0.wp.com/latex.php?latex=n_1&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="n_1" class="latex" /> things of the first species, <img src="https://s0.wp.com/latex.php?latex=n_2&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="n_2" class="latex" /> of the second species, and so on.</p>
<p>More generally, a <b>stochastic state</b> is an element <img src="https://s0.wp.com/latex.php?latex=%5CPsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Psi" class="latex" /> of the stochastic Fock space with</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5CPsi+%3D+%5Csum_%7Bn+%5Cin+%5Cmathbb%7BN%7D%5Ek%7D+%5Cpsi_n+%5C%2C+z%5En+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;Psi = &#92;sum_{n &#92;in &#92;mathbb{N}^k} &#92;psi_n &#92;, z^n }" class="latex" /></p>
<p>where</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cpsi_n+%5Cge+0&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi_n &#92;ge 0" class="latex" /></p>
<p>and</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Csum_%7Bn++%5Cin+%5Cmathbb%7BN%7D%5Ek%7D+%5Cpsi_n+%3D+1+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;sum_{n  &#92;in &#92;mathbb{N}^k} &#92;psi_n = 1 }" class="latex" /></p>
<p>We use <img src="https://s0.wp.com/latex.php?latex=%5CPsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Psi" class="latex" /> to describe a state where <img src="https://s0.wp.com/latex.php?latex=%5Cpsi_n&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi_n" class="latex" /> is the probability of having <img src="https://s0.wp.com/latex.php?latex=n_1&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="n_1" class="latex" /> things of the first species, <img src="https://s0.wp.com/latex.php?latex=n_2&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="n_2" class="latex" /> of the second species, and so on.</p>
<p>The stochastic Fock space has some important operators on it: the <b>annihilation operators</b> given by</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+a_i+%5CPsi+%3D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+z_i%7D+%5CPsi+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ a_i &#92;Psi = &#92;frac{&#92;partial}{&#92;partial z_i} &#92;Psi }" class="latex" /></p>
<p>and the <b>creation operators</b> given by</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+a_i%5E%5Cdagger+%5CPsi+%3D+z_i+%5CPsi+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ a_i^&#92;dagger &#92;Psi = z_i &#92;Psi }" class="latex" /></p>
<p>From these we can define the <b>number operators</b>:</p>
<p><img src="https://s0.wp.com/latex.php?latex=N_i+%3D+a_i%5E%5Cdagger+a_i+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="N_i = a_i^&#92;dagger a_i " class="latex" /></p>
<p>Part of the point is that</p>
<p><img src="https://s0.wp.com/latex.php?latex=N_i+z%5En+%3D+n_i+z%5En+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="N_i z^n = n_i z^n " class="latex" /></p>
<p>This says the stochastic state <img src="https://s0.wp.com/latex.php?latex=z%5En&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="z^n" class="latex" /> is an eigenstate of all the number operators, with eigenvalues saying how many things there are of each species.</p>
<p>The annihilation, creation, and number operators obey some famous commutation relations, which are easy to check for yourself:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Ba_i%2C+a_j%5D+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="[a_i, a_j] = 0 " class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Ba_i%5E%5Cdagger%2C+a_j%5E%5Cdagger%5D+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="[a_i^&#92;dagger, a_j^&#92;dagger] = 0 " class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Ba_i%2C+a_j%5E%5Cdagger%5D+%3D+%5Cdelta_%7Bi+j%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="[a_i, a_j^&#92;dagger] = &#92;delta_{i j} " class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=%5BN_i%2C+N_j+%5D+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="[N_i, N_j ] = 0 " class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=%5BN_i+%2C+a_j%5E%5Cdagger%5D+%3D+%5Cdelta_%7Bi+j%7D+a_j%5E%5Cdagger+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="[N_i , a_j^&#92;dagger] = &#92;delta_{i j} a_j^&#92;dagger " class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=%5BN_i+%2C+a_j%5D+%3D+-+%5Cdelta_%7Bi+j%7D+a_j%5E%5Cdagger+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="[N_i , a_j] = - &#92;delta_{i j} a_j^&#92;dagger " class="latex" /></p>
<p>The last two have easy interpretations.  The first of these two implies</p>
<p><img src="https://s0.wp.com/latex.php?latex=N_i+a_i%5E%5Cdagger+%5CPsi+%3D+a_i%5E%5Cdagger+%28N_i+%2B+1%29+%5CPsi+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="N_i a_i^&#92;dagger &#92;Psi = a_i^&#92;dagger (N_i + 1) &#92;Psi " class="latex" /></p>
<p>This says that if we start in some state <img src="https://s0.wp.com/latex.php?latex=%5CPsi%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Psi," class="latex" /> create a thing of type <img src="https://s0.wp.com/latex.php?latex=i%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i," class="latex" /> and then count the things of that type, we get <i>one more</i> than if we counted the number of things before  creating one.  Similarly,</p>
<p><img src="https://s0.wp.com/latex.php?latex=N_i+a_i+%5CPsi+%3D+a_i+%28N_i+-+1%29+%5CPsi+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="N_i a_i &#92;Psi = a_i (N_i - 1) &#92;Psi " class="latex" /></p>
<p>says that if we annihilate a thing of type <img src="https://s0.wp.com/latex.php?latex=i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i" class="latex" /> and then count the things of that type, we get <i>one less</i> than if we counted the number of things before annihilating one.</p>
<h3> Introducing Planck&#8217;s constant </h3>
<p>Now let&#8217;s introduce an extra parameter into this setup.  To indicate the connection to quantum physics, I&#8217;ll call it <img src="https://s0.wp.com/latex.php?latex=%5Chbar%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;hbar," class="latex" /> which is the usual symbol for Planck&#8217;s constant. However, I want to emphasize that we&#8217;re not doing quantum physics here!  We&#8217;ll see that the limit where <img src="https://s0.wp.com/latex.php?latex=%5Chbar+%5Cto+0&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;hbar &#92;to 0" class="latex" /> is very interesting, but it will correspond to a limit where there are many things of each kind.</p>
<p>We&#8217;ll start by defining</p>
<p><img src="https://s0.wp.com/latex.php?latex=A_i+%3D+%5Chbar+%5C%2C+a_i+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A_i = &#92;hbar &#92;, a_i " class="latex" /></p>
<p>and</p>
<p><img src="https://s0.wp.com/latex.php?latex=C_i+%3D+a_i%5E%5Cdagger+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="C_i = a_i^&#92;dagger " class="latex" /></p>
<p>Here <img src="https://s0.wp.com/latex.php?latex=A&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A" class="latex" /> stands for &#8216;annihilate&#8217; and <img src="https://s0.wp.com/latex.php?latex=C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="C" class="latex" /> stands for &#8216;create&#8217;.  Think of <img src="https://s0.wp.com/latex.php?latex=A&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A" class="latex" /> as a <i>rescaled</i> annihilation operator.   Using this we can define a rescaled number operator:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cwidetilde%7BN%7D_i+%3D+C_i+A_i+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;widetilde{N}_i = C_i A_i " class="latex" /></p>
<p>So, we have</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cwidetilde%7BN%7D_i+%3D+%5Chbar+N_i+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;widetilde{N}_i = &#92;hbar N_i " class="latex" /></p>
<p>and this explains the meaning of the parameter <img src="https://s0.wp.com/latex.php?latex=%5Chbar.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;hbar." class="latex" />  The idea is that instead of counting things one at time, we count them in bunches of size <img src="https://s0.wp.com/latex.php?latex=1%2F%5Chbar.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="1/&#92;hbar." class="latex" /></p>
<p>For example, suppose <img src="https://s0.wp.com/latex.php?latex=%5Chbar+%3D+1%2F12.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;hbar = 1/12." class="latex" />  Then we&#8217;re counting things in dozens!  If we have a state <img src="https://s0.wp.com/latex.php?latex=%5CPsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Psi" class="latex" /> with</p>
<p><img src="https://s0.wp.com/latex.php?latex=N_i+%5CPsi+%3D+36+%5CPsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="N_i &#92;Psi = 36 &#92;Psi" class="latex" /></p>
<p>then there are 36 things of the <i>i</i>th kind.  But this implies</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cwidetilde%7BN%7D_i+%5CPsi+%3D+3+%5CPsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;widetilde{N}_i &#92;Psi = 3 &#92;Psi" class="latex" /></p>
<p>so there are 3 dozen things of the <i>i</i>th kind.</p>
<p>Chemists don&#8217;t count in dozens; they count things in big bunches called <a href="http://en.wikipedia.org/wiki/Mole_%28unit%29">moles</a>.  A mole is approximately the number of carbon atoms in 12 grams: Avogadro&#8217;s number, 6.02 &times; 10<sup>23</sup>.   When you count things by moles, you&#8217;re taking <img src="https://s0.wp.com/latex.php?latex=%5Chbar&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;hbar" class="latex" /> to be 1.66 &times; 10<sup>-24</sup>, the reciprocal of Avogadro&#8217;s number.</p>
<p>So, while in quantum mechanics Planck&#8217;s constant is &#8216;the quantum of action&#8217;, a unit of action, here it&#8217;s &#8216;the quantum of quantity&#8217;: the amount that corresponds to <i>one thing</i>.</p>
<p>We can easily work out the commutation relations of our new rescaled operators:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5BA_i%2C+A_j%5D+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="[A_i, A_j] = 0 " class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=%5BC_i%2C+C_j%5D+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="[C_i, C_j] = 0 " class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=%5BA_i%2C+C_j%5D+%3D+%5Chbar+%5C%2C+%5Cdelta_%7Bi+j%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="[A_i, C_j] = &#92;hbar &#92;, &#92;delta_{i j} " class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=%5B%5Cwidetilde%7BN%7D_i%2C+%5Cwidetilde%7BN%7D_j+%5D+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="[&#92;widetilde{N}_i, &#92;widetilde{N}_j ] = 0 " class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=%5B%5Cwidetilde%7BN%7D_i+%2C+C_j%5D+%3D+%5Chbar+%5C%2C++%5Cdelta_%7Bi+j%7D+C_j+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="[&#92;widetilde{N}_i , C_j] = &#92;hbar &#92;,  &#92;delta_{i j} C_j " class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=%5B%5Cwidetilde%7BN%7D_i+%2C+A_j%5D+%3D+-+%5Chbar+%5C%2C+%5Cdelta_%7Bi+j%7D+A_j+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="[&#92;widetilde{N}_i , A_j] = - &#92;hbar &#92;, &#92;delta_{i j} A_j " class="latex" /></p>
<p>These are just what you see in quantum mechanics!  The commutators are all proportional to <img src="https://s0.wp.com/latex.php?latex=%5Chbar.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;hbar." class="latex" /></p>
<p>Again, we can understand what these relations mean if we think a bit.  For example, the commutation relation for <img src="https://s0.wp.com/latex.php?latex=%5Cwidetilde%7BN%7D_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;widetilde{N}_i" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=C_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="C_i" class="latex" /> says</p>
<p><img src="https://s0.wp.com/latex.php?latex=N_i+C_i+%5CPsi+%3D+C_i+%28N_i+%2B+%5Chbar%29+%5CPsi+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="N_i C_i &#92;Psi = C_i (N_i + &#92;hbar) &#92;Psi " class="latex" /></p>
<p>This says that if we start in some state <img src="https://s0.wp.com/latex.php?latex=%5CPsi%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Psi," class="latex" /> create a thing of type <img src="https://s0.wp.com/latex.php?latex=i%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i," class="latex" /> and then count the things of that type, we get <i><img src="https://s0.wp.com/latex.php?latex=%5Chbar&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;hbar" class="latex" /> more</i> than if we counted the number of things before creating one.   This is because we are counting things not one at a time, but in bunches of size <img src="https://s0.wp.com/latex.php?latex=1%2F%5Chbar.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="1/&#92;hbar." class="latex" /></p>
<p>You may be wondering why I defined the rescaled annihilation operator to be <img src="https://s0.wp.com/latex.php?latex=%5Chbar&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;hbar" class="latex" /> times the original annihilation operator:</p>
<p><img src="https://s0.wp.com/latex.php?latex=A_i+%3D+%5Chbar+%5C%2C+a_i+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A_i = &#92;hbar &#92;, a_i " class="latex" /></p>
<p>but left the creation operator unchanged:</p>
<p><img src="https://s0.wp.com/latex.php?latex=C_i+%3D+a_i%5E%5Cdagger+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="C_i = a_i^&#92;dagger " class="latex" /></p>
<p>I&#8217;m wondering that too!  I&#8217;m not sure I&#8217;m doing things the best way yet.  I&#8217;ve also tried another more symmetrical scheme, taking <img src="https://s0.wp.com/latex.php?latex=A_k+%3D+%5Csqrt%7B%5Chbar%7D+%5C%2C+a_k+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A_k = &#92;sqrt{&#92;hbar} &#92;, a_k " class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=C_k+%3D+%5Csqrt%7B%5Chbar%7D+a_k%5E%5Cdagger.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="C_k = &#92;sqrt{&#92;hbar} a_k^&#92;dagger." class="latex" />    This gives the same commutation relations, but certain other formulas become more unpleasant.  I&#8217;ll explain that some other day.</p>
<p>Next, we can take the limit as <img src="https://s0.wp.com/latex.php?latex=%5Chbar+%5Cto+0&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;hbar &#92;to 0" class="latex" /> and define <b>Poisson brackets</b> of operators by</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5C%7BA%2CB%5C%7D+%3D+%5Clim_%7B%5Chbar+%5Cto+0%7D+%5C%3B+%5Cfrac%7B1%7D%7B%5Chbar%7D+%5BA%2CB%5D+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;{A,B&#92;} = &#92;lim_{&#92;hbar &#92;to 0} &#92;; &#92;frac{1}{&#92;hbar} [A,B] } " class="latex" /></p>
<p>To make this rigorous it&#8217;s best to proceed algebraically.   For this we treat <img src="https://s0.wp.com/latex.php?latex=%5Chbar&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;hbar" class="latex" /> as a formal variable rather than a specific number.  So, our number system becomes <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5B%5Chbar%5D%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}[&#92;hbar]," class="latex" /> the algebra of polynomials in <img src="https://s0.wp.com/latex.php?latex=%5Chbar&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;hbar" class="latex" />.  We define the <b>Weyl algebra</b> to be the algebra over <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5B%5Chbar%5D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}[&#92;hbar]" class="latex" /> generated by elements <img src="https://s0.wp.com/latex.php?latex=A_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A_i" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=C_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="C_i" class="latex" /> obeying</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5BA_i%2C+A_j%5D+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="[A_i, A_j] = 0 " class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=%5BC_i%2C+C_j%5D+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="[C_i, C_j] = 0 " class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=%5BA_i%2C+C_j%5D+%3D+%5Chbar+%5C%2C+%5Cdelta_%7Bi+j%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="[A_i, C_j] = &#92;hbar &#92;, &#92;delta_{i j} " class="latex" /></p>
<p>We can set <img src="https://s0.wp.com/latex.php?latex=%5Chbar+%3D+0&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;hbar = 0" class="latex" /> in this formalism; then the Weyl algebra reduces to the algebra of polynomials in the variables <img src="https://s0.wp.com/latex.php?latex=A_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A_i" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=C_i.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="C_i." class="latex" />  This algebra is commutative!  But we can define a <b>Poisson bracket</b> on this algebra by</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5C%7BA%2CB%5C%7D+%3D+%5Clim_%7B%5Chbar+%5Cto+0%7D+%5C%3B+%5Cfrac%7B1%7D%7B%5Chbar%7D+%5BA%2CB%5D+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;{A,B&#92;} = &#92;lim_{&#92;hbar &#92;to 0} &#92;; &#92;frac{1}{&#92;hbar} [A,B] } " class="latex" /></p>
<p>It takes a bit of work to explain to algebraists exactly what&#8217;s going on in this formula, because it involves an interplay between the algebra of polynomials in <img src="https://s0.wp.com/latex.php?latex=A_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A_i" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=C_i%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="C_i," class="latex" /> which is commutative, and the Weyl algebra, which is not.  I&#8217;ll be glad to explain the details if you want.  But if you&#8217;re a physicist, you can just follow your nose and figure out what the formula gives.  For example:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Barray%7D%7Bccl%7D+++%5C%7BA_i%2C+C_j%5C%7D+%26%3D%26+%5Cdisplaystyle%7B+%5Clim_%7B%5Chbar+%5Cto+0%7D+%5C%3B+%5Cfrac%7B1%7D%7B%5Chbar%7D+%5BA_i%2C+C_j%5D+%7D+%5C%5C++%5C%5C++%26%3D%26+%5Cdisplaystyle%7B+%5Clim_%7B%5Chbar+%5Cto+0%7D+%5C%3B+%5Cfrac%7B1%7D%7B%5Chbar%7D+%5C%2C+%5Chbar+%5C%2C+%5Cdelta_%7Bi+j%7D+%7D++%5C%5C++%5C%5C++%26%3D%26+%5Cdelta_%7Bi+j%7D+%5Cend%7Barray%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;begin{array}{ccl}   &#92;{A_i, C_j&#92;} &amp;=&amp; &#92;displaystyle{ &#92;lim_{&#92;hbar &#92;to 0} &#92;; &#92;frac{1}{&#92;hbar} [A_i, C_j] } &#92;&#92;  &#92;&#92;  &amp;=&amp; &#92;displaystyle{ &#92;lim_{&#92;hbar &#92;to 0} &#92;; &#92;frac{1}{&#92;hbar} &#92;, &#92;hbar &#92;, &#92;delta_{i j} }  &#92;&#92;  &#92;&#92;  &amp;=&amp; &#92;delta_{i j} &#92;end{array} " class="latex" /></p>
<p>Similarly, we have:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5C%7B+A_i%2C+A_j+%5C%7D+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;{ A_i, A_j &#92;} = 0 " class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=%5C%7B+C_i%2C+C_j+%5C%7D+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;{ C_i, C_j &#92;} = 0 " class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=%5C%7B+A_i%2C+C_j+%5C%7D+%3D+%5Cdelta_%7Bi+j%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;{ A_i, C_j &#92;} = &#92;delta_{i j} " class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=%5C%7B+%5Cwidetilde%7BN%7D_i%2C+%5Cwidetilde%7BN%7D_j+%5C%7D++%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;{ &#92;widetilde{N}_i, &#92;widetilde{N}_j &#92;}  = 0 " class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=%5C%7B+%5Cwidetilde%7BN%7D_i+%2C+C_j+%5C%7D+%3D+%5Cdelta_%7Bi+j%7D+C_j+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;{ &#92;widetilde{N}_i , C_j &#92;} = &#92;delta_{i j} C_j " class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=%5C%7B+%5Cwidetilde%7BN%7D_i+%2C+A_j+%5C%7D+%3D+-+%5Cdelta_%7Bi+j%7D+A_j+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;{ &#92;widetilde{N}_i , A_j &#92;} = - &#92;delta_{i j} A_j " class="latex" /></p>
<p>I should probably use different symbols for  <img src="https://s0.wp.com/latex.php?latex=A_i%2C+C_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A_i, C_i" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=%5Cwidetilde%7BN%7D_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;widetilde{N}_i" class="latex" /> after we&#8217;ve set <img src="https://s0.wp.com/latex.php?latex=%5Chbar+%3D+0%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;hbar = 0," class="latex" /> since they&#8217;re really different now, but I don&#8217;t have the patience to make up more names for things!</p>
<p>Now, we can think of <img src="https://s0.wp.com/latex.php?latex=A_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A_i" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=C_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="C_i" class="latex" /> as coordinate functions on a 2<i>k</i>-dimensional vector space, and all the polynomials in <img src="https://s0.wp.com/latex.php?latex=A_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A_i" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=C_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="C_i" class="latex" /> as functions on this space.  This space is what physicists would call a <a href="http://en.wikipedia.org/wiki/Phase_space">&#8216;phase space&#8217;</a>: they use this kind of space to describe the position and momentum of a particle, though here we are using it in a different way.  Mathematicians would call it a <a href="http://en.wikipedia.org/wiki/Symplectic_vector_space">&#8216;symplectic vector space&#8217;</a>, because it&#8217;s equipped with a special structure, called a symplectic structure, that lets us define Poisson brackets of smooth functions on this space.  We won&#8217;t need to get into that now, but it&#8217;s important&mdash;and it makes me happy to see it here.</p>
<h3> More </h3>
<p>There&#8217;s a lot more to do, but not today.  My main goal is to understand, in a really elegant way, how the master equation for a stochastic Petri net reduces to the rate equation in the large-number limit.  What we&#8217;ve done so far is start thinking of this as a <img src="https://s0.wp.com/latex.php?latex=%5Chbar+%5Cto+0&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;hbar &#92;to 0" class="latex" /> limit.  This should let us borrow ideas about classical limits in quantum mechanics, and apply them to stochastic mechanics.</p>
<p>Stay tuned!</p>
									</div>

				<p class="postmetadata">
				<img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/speech_bubble.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2013/07/01/the-large-number-limit-for-reaction-networks-part-1/#comments">11 Comments</a>				| <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/documents.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/category/chemistry/" rel="category tag">chemistry</a>, <a href="https://johncarlosbaez.wordpress.com/category/mathematics/" rel="category tag">mathematics</a>, <a href="https://johncarlosbaez.wordpress.com/category/physics/" rel="category tag">physics</a>, <a href="https://johncarlosbaez.wordpress.com/category/probability/" rel="category tag">probability</a>								 | <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/permalink.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2013/07/01/the-large-number-limit-for-reaction-networks-part-1/" rel="bookmark" title="Permanent Link to The Large-Number Limit for Reaction Networks (Part&nbsp;1)">Permalink</a>
<br /><img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/figure_ver1.gif" alt="" /> Posted by John Baez				</p>
			</div>
			<hr />
		
			<div class="post-16112 post type-post status-publish format-standard hentry category-chemistry category-networks category-probability" id="post-16112">
				<h2><a href="https://johncarlosbaez.wordpress.com/2013/06/11/quantum-techniques-for-reaction-networks/" rel="bookmark">Quantum Techniques for Reaction&nbsp;Networks</a></h2>
				<small>11 June, 2013</small><br />


				<div class="entry">
					<p>Fans of the <a href="http://math.ucr.edu/home/baez/networks/">network theory</a> series might like to look at this paper:</p>
<p>&bull; John Baez, <a href="http://arxiv.org/abs/1306.3451">Quantum techniques for reaction networks</a>, <i><a href="https://doi.org/10.1155/2018/7676309">Advances in Mathematical Physics</a></i> <b>2018</b> (2018), 7676309.</p>
<p>This paper tackles a basic question we never got around to discussing: how the <i>probabilistic</i> description of a system where bunches of things randomly interact and turn into other bunches of things can reduce to a <i>deterministic</i> description in the limit where there are lots of things!</p>
<p>Mathematically, such systems are given by &#8216;stochastic Petri nets&#8217;, or if you prefer, &#8216;stochastic reaction networks&#8217;.   These are just two equivalent pictures of the same thing.  For example, we could describe some chemical reactions using this Petri net:</p>
<div align="center"><img width="450" src="https://i0.wp.com/math.ucr.edu/home/baez/networks/pictures/chemistryNetBasicA.png" /></div>
<p>but chemists would use this reaction network:</p>
<div align="center">
C + O<sub>2</sub> &rarr; CO<sub>2</sub><br />
CO<sub>2</sub> + NaOH &rarr; NaHCO<sub>3</sub><br />
NaHCO<sub>3</sub> + HCl &rarr; H<sub>2</sub>O + NaCl + CO<sub>2</sub>
</div>
<p>Making either of them &#8216;stochastic&#8217; merely means that we specify a &#8216;rate constant&#8217; for each reaction, saying how probable it is.</p>
<p>For any such system we get a &#8216;master equation&#8217; describing how the probability of having any number of things of each kind changes with time.  In the class I taught on this last quarter, the students and I figured out how to derive from this an equation saying how the <i>expected</i> number of things of each kind changes with time.  Later I figured out a much slicker argument&#8230; but either way, we get this result:</p>
<p><b>Theorem.</b> For any stochastic reaction network and any stochastic state <img src="https://s0.wp.com/latex.php?latex=%5CPsi%28t%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Psi(t)" class="latex" /> evolving in time according to the master equation, then</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bd%7D%7Bdt%7D+%5Clangle+N+%5CPsi%28t%29+%5Crangle+%7D+%3D++%5Cdisplaystyle%7B%5Csum_%7B%5Ctau+%5Cin+T%7D%7D+%5C%2C+r%28%5Ctau%29+%5C%2C++%28s%28%5Ctau%29+-+t%28%5Ctau%29%29+%5C%3B++%5Cleft%5Clangle+N%5E%7B%5Cunderline%7Bs%28%5Ctau%29%7D%7D%5C%2C+%5CPsi%28t%29+%5Cright%5Crangle+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{d}{dt} &#92;langle N &#92;Psi(t) &#92;rangle } =  &#92;displaystyle{&#92;sum_{&#92;tau &#92;in T}} &#92;, r(&#92;tau) &#92;,  (s(&#92;tau) - t(&#92;tau)) &#92;;  &#92;left&#92;langle N^{&#92;underline{s(&#92;tau)}}&#92;, &#92;Psi(t) &#92;right&#92;rangle " class="latex" /></p>
<p>assuming the derivative exists.</p>
<p>Of course this will make no sense yet if you haven&#8217;t been following the network theory series!   But I explain all the notation in the paper, so don&#8217;t be scared.  The main point is that <img src="https://s0.wp.com/latex.php?latex=%5Clangle+N+%5CPsi%28t%29+%5Crangle&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;langle N &#92;Psi(t) &#92;rangle" class="latex" /> is a vector listing the expected number of things of each kind at time <img src="https://s0.wp.com/latex.php?latex=t.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="t." class="latex" />  The equation above says how this changes with time&#8230; but it closely resembles the &#8216;rate equation&#8217;, which describes the evolution of chemical systems in a <i>deterministic</i> way.</p>
<p>And indeed, the next big theorem says that the master equation actually <i>implies</i> the rate equation when the probability of having various numbers of things of each kind is given by a product of independent Poisson distributions.  In this case <img src="https://s0.wp.com/latex.php?latex=%5CPsi%28t%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Psi(t)" class="latex" /> is what people in quantum physics call a &#8216;coherent state&#8217;.  So:</p>
<p><b>Theorem.</b>  Given any stochastic reaction network, let<br />
<img src="https://s0.wp.com/latex.php?latex=%5CPsi%28t%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Psi(t)" class="latex" /> be a mixed state evolving in time according to the master equation.  If <img src="https://s0.wp.com/latex.php?latex=%5CPsi%28t%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Psi(t)" class="latex" /> is a coherent state when <img src="https://s0.wp.com/latex.php?latex=t+%3D+t_0%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="t = t_0," class="latex" /> then <img src="https://s0.wp.com/latex.php?latex=%5Clangle+N+%5CPsi%28t%29+%5Crangle+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;langle N &#92;Psi(t) &#92;rangle " class="latex" /> obeys the rate equation when <img src="https://s0.wp.com/latex.php?latex=t+%3D+t_0.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="t = t_0." class="latex" /></p>
<p>In most cases, this only applies exactly at one moment of time: later <img src="https://s0.wp.com/latex.php?latex=%5CPsi%28t%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Psi(t)" class="latex" /> will cease to be a coherent state.  Then we must resort to the previous theorem to see how the expected number of things of each kind changes with time.</p>
<p>But sometimes our state <img src="https://s0.wp.com/latex.php?latex=%5CPsi%28t%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Psi(t)" class="latex" /> will stay coherent forever! For one case where this happens, see the companion paper, which I blogged about <a href="https://johncarlosbaez.wordpress.com/2013/05/16/quantum-techniques-for-chemical-reaction-networks/">a little while ago</a>:</p>
<p>&bull; John Baez and Brendan Fong, <a href="http://math.ucr.edu/home/baez/ACK.pdf">Quantum techniques for studying equilibrium in reaction networks</a>.</p>
<p>We wrote this first, but logically it comes <i>after</i> the one I just finished now!</p>
<p>All this material will get folded into the <a href="http://math.ucr.edu/home/baez/networks">book</a> I&#8217;m writing with Jacob Biamonte.  There are just a few remaining loose ends that need to be tied up.</p>
									</div>

				<p class="postmetadata">
				<img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/speech_bubble.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2013/06/11/quantum-techniques-for-reaction-networks/#comments">46 Comments</a>				| <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/documents.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/category/chemistry/" rel="category tag">chemistry</a>, <a href="https://johncarlosbaez.wordpress.com/category/networks/" rel="category tag">networks</a>, <a href="https://johncarlosbaez.wordpress.com/category/probability/" rel="category tag">probability</a>								 | <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/permalink.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2013/06/11/quantum-techniques-for-reaction-networks/" rel="bookmark" title="Permanent Link to Quantum Techniques for Reaction&nbsp;Networks">Permalink</a>
<br /><img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/figure_ver1.gif" alt="" /> Posted by John Baez				</p>
			</div>
			<hr />
		
			<div class="post-15848 post type-post status-publish format-standard hentry category-chemistry category-mathematics category-probability" id="post-15848">
				<h2><a href="https://johncarlosbaez.wordpress.com/2013/05/16/quantum-techniques-for-chemical-reaction-networks/" rel="bookmark">Quantum Techniques for Studying Equilibrium in Reaction&nbsp;Networks</a></h2>
				<small>16 May, 2013</small><br />


				<div class="entry">
					<p>The summer before last, I invited <a href="http://www.azimuthproject.org/azimuth/show/Brendan+Fong">Brendan Fong</a> to Singapore to work with me on my new &#8216;network theory&#8217; project.  He quickly came up with a nice new proof of a result about mathematical chemistry.  We <a href="https://johncarlosbaez.wordpress.com/2011/09/13/network-theory-part-9/">blogged about it</a>, and I added it to my <a href="http://math.ucr.edu/home/baez/stoch_stable.pdf">book</a>, but then he became a grad student at Oxford and got distracted by other kinds of networks&#8212;namely, Bayesian networks.</p>
<p>So, we&#8217;ve just now finally written up this result as a self-contained paper:</p>
<p>• John Baez and Brendan Fong, <a href="http://arxiv.org/abs/1305.4988">Quantum techniques for studying equilibrium in reaction networks</a>, <i>Journal of Complex Networks</i> <b>3</b> (2014), 22&ndash;34.</p>
<p>Check it out!</p>
<p>The idea, in brief, is to use math from quantum field theory to give a somewhat new proof of the <a href="http://arxiv.org/abs/0803.3042">Anderson&#8211;Craciun&#8211;Kurtz theorem</a>.</p>
<p>This remarkable result says that in many cases, we can start with an equilibrium solution of the &#8216;rate equation&#8217; which describes the behavior of chemical reactions in a <i>deterministic</i> way in the limit of a <i>large numbers</i> of molecules, and get an equilibrium solution of the &#8216;master equation&#8217; which describes chemical reactions <i>probabilistically</i> for <i>any</i> number of molecules.</p>
<p>The trick, in our approach, is to start with a chemical reaction network, which is something like this:</p>
<div align="center">
<img src="https://i0.wp.com/math.ucr.edu/home/baez/networks/chemical_reaction_network_part_20_VI.png" />
</div>
<p>and use it to write down a Hamiltonian describing the time evolution of the probability that you have various numbers of each kind of molecule: A, B, C, D, E, &#8230;   Using ideas from quantum mechanics, we can write this Hamiltonian in terms of annihilation and creation operators&#8212;even though our problem involves probability theory, not quantum mechanics!  Then we can write down the equilibrium solution as a &#8216;coherent state&#8217;.  In quantum mechanics, that&#8217;s a quantum state that approximates a classical one as well as possible.</p>
<div align="center"><a href="http://www.av8n.com/physics/coherent-states.htm"><br />
<img width="450" src="https://i2.wp.com/www.av8n.com/physics/img48/glauber-movie.gif" /></a>
</div>
<p>All this is part of a larger plan to take tricks from quantum mechanics and apply them to &#8216;stochastic mechanics&#8217;, simply by working with real numbers representing probabilities instead of complex numbers representing amplitudes!</p>
<p>I should add that Brendan&#8217;s work on Bayesian networks is also very cool, and I plan to talk about it here and even work it into the grand network theory project I have in mind.   But this may take quite a long time, so for now you should read his paper:</p>
<p>• Brendan Fong, <a href="http://arxiv.org/abs/1301.6201">Causal theories: a categorical perspective on Bayesian networks</a>.</p>
									</div>

				<p class="postmetadata">
				<img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/speech_bubble.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2013/05/16/quantum-techniques-for-chemical-reaction-networks/#comments">9 Comments</a>				| <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/documents.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/category/chemistry/" rel="category tag">chemistry</a>, <a href="https://johncarlosbaez.wordpress.com/category/mathematics/" rel="category tag">mathematics</a>, <a href="https://johncarlosbaez.wordpress.com/category/probability/" rel="category tag">probability</a>								 | <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/permalink.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2013/05/16/quantum-techniques-for-chemical-reaction-networks/" rel="bookmark" title="Permanent Link to Quantum Techniques for Studying Equilibrium in Reaction&nbsp;Networks">Permalink</a>
<br /><img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/figure_ver1.gif" alt="" /> Posted by John Baez				</p>
			</div>
			<hr />
		
			<div class="post-15758 post type-post status-publish format-standard hentry category-chemistry category-networks category-physics" id="post-15758">
				<h2><a href="https://johncarlosbaez.wordpress.com/2013/04/23/network-theory-part-29/" rel="bookmark">Network Theory (Part&nbsp;29)</a></h2>
				<small>23 April, 2013</small><br />


				<div class="entry">
					<p>I&#8217;m talking about electrical circuits, but I&#8217;m interested in them as models of more general physical systems.  <a href="https://johncarlosbaez.wordpress.com/2013/04/10/network-theory-part-28/">Last time</a> we started seeing how this works.  We developed an analogy between electrical circuits and physical systems made of masses and springs, with friction:</p>
<table border="1">
<tr>
<td><b>Electronics</b></td>
<td><b>Mechanics</b></td>
</tr>
<tr>
<td>charge: <img src="https://s0.wp.com/latex.php?latex=Q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Q" class="latex" /></td>
<td>position: <img src="https://s0.wp.com/latex.php?latex=q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q" class="latex" /></td>
</tr>
<tr>
<td>current: <img src="https://s0.wp.com/latex.php?latex=I+%3D+%5Cdot%7BQ%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="I = &#92;dot{Q}" class="latex" /></td>
<td>velocity: <img src="https://s0.wp.com/latex.php?latex=v+%3D+%5Cdot%7Bq%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="v = &#92;dot{q} " class="latex" /></td>
</tr>
<tr>
<td>flux linkage: <img src="https://s0.wp.com/latex.php?latex=%5Clambda&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;lambda" class="latex" /></td>
<td>momentum: <img src="https://s0.wp.com/latex.php?latex=p&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p" class="latex" /> </td>
</tr>
<tr>
<td>voltage: <img src="https://s0.wp.com/latex.php?latex=V+%3D+%5Cdot%7B%5Clambda%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="V = &#92;dot{&#92;lambda}" class="latex" /></td>
<td>force: <img src="https://s0.wp.com/latex.php?latex=F+%3D+%5Cdot%7Bp%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="F = &#92;dot{p}" class="latex" /> </td>
</tr>
<tr>
<td>inductance: <img src="https://s0.wp.com/latex.php?latex=L&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="L" class="latex" /></td>
<td>mass: <img src="https://s0.wp.com/latex.php?latex=m&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="m" class="latex" /></td>
</tr>
<tr>
<td>resistance: <img src="https://s0.wp.com/latex.php?latex=R&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="R" class="latex" /></td>
<td>damping coefficient: <img src="https://s0.wp.com/latex.php?latex=r&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="r" class="latex" /> &nbsp;</td>
</tr>
<tr>
<td>inverse capacitance: <img src="https://s0.wp.com/latex.php?latex=1%2FC&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="1/C" class="latex" /> &nbsp;</td>
<td>spring constant: <img src="https://s0.wp.com/latex.php?latex=k&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="k" class="latex" /></td>
</tr>
</table>
<p>But this is just the first of a large set of analogies.  Let me list some, so you can see how wide-ranging they are!</p>
<h3> More analogies </h3>
<p>People in system dynamics often use <b>effort</b> as a term to stand for anything analogous to force or voltage, and <b>flow</b> as a general term to stand for anything analogous to velocity or electric current.  They call these variables <img src="https://s0.wp.com/latex.php?latex=e&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="e" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=f.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="f." class="latex" />   </p>
<p>To me it&#8217;s important that force is the time derivative of momentum, and velocity is the time derivative of position.   Following physicists, I write momentum as <img src="https://s0.wp.com/latex.php?latex=p&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p" class="latex" /> and position as <img src="https://s0.wp.com/latex.php?latex=q.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q." class="latex" />  So, I&#8217;ll usually write effort as <img src="https://s0.wp.com/latex.php?latex=%5Cdot%7Bp%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;dot{p}" class="latex" /> and flow as <img src="https://s0.wp.com/latex.php?latex=%5Cdot%7Bq%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;dot{q}" class="latex" />.  </p>
<p>Of course, &#8216;position&#8217; is a term special to mechanics; it&#8217;s nice to have a general term for the thing whose time derivative is flow, that applies to any context.  People in systems dynamics seem to use <b>displacement</b> as that general term.  </p>
<p>It would also be nice to have a general term for the thing whose time derivative is effort&#8230; but I don&#8217;t know one.  So, I&#8217;ll use the word <b>momentum</b>.</p>
<p>Now let&#8217;s see the analogies!  Let&#8217;s see how displacement <img src="https://s0.wp.com/latex.php?latex=q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q" class="latex" />, flow <img src="https://s0.wp.com/latex.php?latex=%5Cdot%7Bq%7D%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;dot{q}," class="latex" /> momentum <img src="https://s0.wp.com/latex.php?latex=p&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p" class="latex" /> and effort <img src="https://s0.wp.com/latex.php?latex=%5Cdot%7Bp%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;dot{p}" class="latex" /> show up in several subjects:</p>
<table border="1" align="center">
<tr>
<td> </td>
<td><b>displacement</b>: &nbsp;&nbsp; <img src="https://s0.wp.com/latex.php?latex=q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q" class="latex" /></td>
<td><b>flow</b>: &nbsp; &nbsp;&nbsp; <img src="https://s0.wp.com/latex.php?latex=%5Cdot+q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;dot q" class="latex" />  </td>
<td><b>momentum</b>: &nbsp;&nbsp;&nbsp;&nbsp; <img src="https://s0.wp.com/latex.php?latex=p+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p " class="latex" /></td>
<td><b>effort</b>: &nbsp; &nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <img src="https://s0.wp.com/latex.php?latex=%5Cdot+p&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;dot p" class="latex" /></td>
</tr>
<tr>
<td><b>Mechanics: translation</b></td>
<td> position</td>
<td> velocity </td>
<td> momentum </td>
<td> force </td>
</tr>
<tr>
<td><b>Mechanics: rotation</b></td>
<td> angle</td>
<td> angular velocity </td>
<td> angular momentum </td>
<td> torque </td>
</tr>
<tr>
<td><b>Electronics</b></td>
<td> charge </td>
<td> current </td>
<td> flux linkage </td>
<td> voltage </td>
</tr>
<td><b>Hydraulics</b></td>
<td> volume </td>
<td> flow </td>
<td> pressure momentum </td>
<td> pressure </td>
<tr>
<td><b>Thermal Physics</b></td>
<td> entropy </td>
<td> entropy flow </td>
<td> temperature momentum </td>
<td> temperature </td>
</tr>
<tr>
<td><b>Chemistry</b></td>
<td> moles </td>
<td> molar flow </td>
<td> chemical momentum </td>
<td> chemical potential </td>
</tr>
</table>
<p>We&#8217;d been considering mechanics of systems that move along a line, via translation, but we can also consider mechanics for systems that turn round and round, via rotation.  So, there are two rows for mechanics here.  </p>
<p>There&#8217;s a row for electronics, and then a row for hydraulics, which is closely analogous.  In this analogy, a pipe is like a wire.  The flow of water plays the role of current.  Water pressure plays the role of electrostatic potential.  The <i>difference</i> in water pressure between two ends of a pipe is like the voltage across a wire.  When water flows through a pipe, the power equals the flow times this pressure difference&mdash;just as in an electrical circuit the power is the current times the voltage across the wire.</p>
<p>A resistor is like a narrowed pipe:</p>
<div align="center">
<img src="https://i0.wp.com/math.ucr.edu/home/baez/networks/electronics_analogy_reduced_pipe_resistor.png" />
</div>
<p>An inductor is like a heavy turbine placed inside a pipe: this makes the water tend to keep flowing at the same rate it&#8217;s already flowing!  In other words, it provides a kind of &#8216;inertia&#8217; analogous<br />
to mass.  </p>
<p>A capacitor is like a tank with pipes coming in from both ends, and a rubber sheet dividing it in two lengthwise:</p>
<div align="center">
<img src="https://i2.wp.com/math.ucr.edu/home/baez/networks/electronics_analogy_flexible_tank_capacitor.png" />
</div>
<p>When studying electrical circuits as a kid, I was shocked when I first learned that capacitors <i>don&#8217;t let the electrons through</i>: it didn&#8217;t seem likely you could do anything useful with something like that!  But of course you can.  Similarly, this gizmo doesn&#8217;t let the water through. </p>
<p>A voltage source is like a compressor set up to maintain a specified pressure difference between the input and output: </p>
<div align="center">
<img width="250" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/electronics_analogy_compressor_effort_source.gif" />
</div>
<p>Similarly, a current source is like a pump set up to maintain a specified flow. </p>
<p>Finally, just as voltage is the time derivative of a fairly obscure quantity called &#8216;flux linkage&#8217;, pressure is the time derivative of an even more obscure quantity which has no standard name.  I&#8217;m calling it &#8216;pressure momentum&#8217;, thanks to the analogy</p>
<div align="center">
momentum: force :: pressure momentum: pressure
</div>
<p>Just as pressure has units of force per area, pressure momentum has units of momentum per area!  </p>
<p>People invented this analogy back when they were first struggling to understand electricity, before electrons had been observed:</p>
<p>&bull; <a href="http://en.wikipedia.org/wiki/Hydraulic_analogy">Hydraulic analogy</a>, Wikipedia.</p>
<p>The famous electrical engineer Oliver Heaviside pooh-poohed this analogy, calling it the &#8220;drain-pipe theory&#8221;. I think he was making fun of William Henry Preece. Preece was another electrical engineer, who liked the hydraulic analogy and disliked Heaviside&#8217;s fancy math. In his inaugural speech as president of the Institution of Electrical Engineers in 1893, Preece proclaimed:</p>
<blockquote><p>
    True theory does not require the abstruse language of mathematics to make it clear and to render it acceptable. All that is solid and substantial in science and usefully applied in practice, have been made clear by relegating mathematic symbols to their proper store place&mdash;the study.
</p></blockquote>
<p>According to the judgement of history, Heaviside made more progress in understanding electromagnetism than Preece. But there&#8217;s still a nice analogy between electronics and hydraulics.  And I&#8217;ll eventually use the abstruse language of mathematics to make it very precise!</p>
<p>But now let&#8217;s move on to the row called &#8216;thermal physics&#8217;.  We could also call this &#8216;thermodynamics&#8217;.  It works like this. Say you have a physical system in thermal equilibrium and all you can do is heat it up or cool it down &#8216;reversibly&#8217;&mdash;that is, while keeping it in thermal equilibrium all along. For example, imagine a box of gas that you can heat up or cool down. If you put a tiny amount <img src="https://s0.wp.com/latex.php?latex=dE&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="dE" class="latex" /> of energy into the system in the form of heat, then its entropy increases by a tiny amount <img src="https://s0.wp.com/latex.php?latex=dS.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="dS." class="latex" />  And they&#8217;re related by this equation:</p>
<p><img src="https://s0.wp.com/latex.php?latex=dE+%3D+TdS&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="dE = TdS" class="latex" /></p>
<p>where <img src="https://s0.wp.com/latex.php?latex=T&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T" class="latex" /> is the temperature.</p>
<p>Another way to say this is</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7BdE%7D%7Bdt%7D+%3D+T+%5Cfrac%7BdS%7D%7Bdt%7D+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{dE}{dt} = T &#92;frac{dS}{dt} } " class="latex" /></p>
<p>where <img src="https://s0.wp.com/latex.php?latex=t&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="t" class="latex" /> is time. On the left we have the power put into the system in the form of heat. But since power should be &#8216;effort&#8217; times &#8216;flow&#8217;, on the right we should have &#8216;effort&#8217; times &#8216;flow&#8217;. It makes some sense to call <img src="https://s0.wp.com/latex.php?latex=dS%2Fdt&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="dS/dt" class="latex" /> the &#8216;entropy flow&#8217;. So temperature, <img src="https://s0.wp.com/latex.php?latex=T%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T," class="latex" /> must play the role of &#8216;effort&#8217;.</p>
<p>This is a bit weird.  I don&#8217;t usually think of temperature as a form of &#8216;effort&#8217; analogous to force or torque. Stranger still, our analogy says that &#8216;effort&#8217; should be the time derivative of some kind of &#8216;momentum&#8217;, So, we need to introduce <b>temperature momentum</b>: the integral of temperature over time. I&#8217;ve never seen people talk about this concept, so it makes me a bit nervous.</p>
<p>But when we have a more complicated physical system like a piston full of gas in thermal equilibrium, we can see the analogy working. Now we have</p>
<p><img src="https://s0.wp.com/latex.php?latex=dE+%3D+TdS+-+PdV&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="dE = TdS - PdV" class="latex" /></p>
<p>The change in energy <img src="https://s0.wp.com/latex.php?latex=dE&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="dE" class="latex" /> of our gas now has two parts. There&#8217;s the change in heat energy <img src="https://s0.wp.com/latex.php?latex=TdS&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="TdS" class="latex" />, which we saw already. But now there&#8217;s also the change in energy due to compressing the piston! When we change the volume of the gas by a tiny amount <img src="https://s0.wp.com/latex.php?latex=dV%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="dV," class="latex" /> we put in energy <img src="https://s0.wp.com/latex.php?latex=-PdV.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="-PdV." class="latex" /></p>
<p>Now look back at the first chart I drew! It says that pressure is a form of &#8216;effort&#8217;, while volume is a form of &#8216;displacement&#8217;. If you believe that, the equation above should help convince you that temperature is also a form of effort, while entropy is a form of displacement.</p>
<p>But what about the minus sign? That&#8217;s no big deal: it&#8217;s the result of some arbitrary conventions. <img src="https://s0.wp.com/latex.php?latex=P&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="P" class="latex" /> is defined to be the <i>outward</i> pressure of the gas on our piston. If this is positive, reducing the volume of the gas takes a positive amount of energy, so we need to stick in a minus sign. I could eliminate this minus sign by changing some conventions&mdash;but if I did, the chemistry professors at UCR would haul me away and increase my heat energy by burning me at the stake.</p>
<p>Speaking of chemistry: here&#8217;s how the chemistry row in the  analogy chart works.  Suppose we have a piston full of gas made of different kinds of molecules, and there can be chemical reactions that change one kind into another. Now our equation gets fancier:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+dE+%3D+TdS+-+PdV+%2B+%5Csum_i++%5Cmu_i+dN_i+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ dE = TdS - PdV + &#92;sum_i  &#92;mu_i dN_i } " class="latex" /></p>
<p>Here <img src="https://s0.wp.com/latex.php?latex=N_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="N_i" class="latex" /> is the number of molecules of the <i>i</i>th kind, while <img src="https://s0.wp.com/latex.php?latex=%5Cmu_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mu_i" class="latex" /> is a quantity called a <b><a href="http://en.wikipedia.org/wiki/Chemical_potential">chemical potential</a></b>. The chemical potential simply says how much energy it takes to increase the number of molecules of a given kind.   So, we see that chemical potential is another form of effort, while number of molecules is another form of displacement.</p>
<p>But chemists are too busy to count molecules one at a time, so they count them in big bunches called &#8216;moles&#8217;. A <a href="http://en.wikipedia.org/wiki/Mole_%28unit%29"><b>mole</b></a> is the number of atoms in 12 grams of carbon-12. That&#8217;s roughly</p>
<div align="center">
602,214,150,000,000,000,000,000
</div>
<p>atoms. This is called <a href="http://en.wikipedia.org/wiki/Avogadro_constant"><b>Avogadro&#8217;s constant</b></a>.  If we used 1 gram of hydrogen, we&#8217;d get a very close number called &#8216;Avogadro&#8217;s number&#8217;, which leads to lots of jokes:</p>
<div align="center"><img width="300" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/avogadro.jpg" /></div>
<p>(He must be desperate because he looks so weird&#8230; sort of like a mole!)</p>
<p>So, instead of saying that the displacement in chemistry is called &#8216;number of molecules&#8217;, you&#8217;ll sound more like an expert if you say &#8216;moles&#8217;. And the corresponding flow is called <b>molar flow</b>.  </p>
<p>The truly obscure quantity in this row of the chart is the one whose time derivative is chemical potential!  I&#8217;m calling it <b>chemical momentum</b> simply because I don&#8217;t know another name.</p>
<p>Why are linear and angular momentum so famous compared to pressure momentum, temperature momentum and chemical momentum?  </p>
<p>I suspect it&#8217;s because the laws of physics are <i>symmetrical</i><br />
under translations and rotations.   When the assumptions of <a href="http://math.ucr.edu/home/baez/noether.html">Noether&#8217;s theorem</a> hold, this guarantees that the total momentum and angular momentum of a closed system are conserved.  Apparently the laws of physics lack the symmetries that would make the other kinds of momentum be conserved.  </p>
<p>This suggests that we should dig deeper and try to understand more deeply how this chart is connected to ideas in classical mechanics, like Noether&#8217;s theorem or symplectic geometry.  I will try to do that sometime later in this series.</p>
<p>More generally, we should try to understand <i>what gives rise</i> to a row in this analogy chart.  Are there are lots of rows I haven&#8217;t talked about yet, or just a few?  There are probably lots.  But are there lots of <i>practically important</i> rows that I haven&#8217;t talked about&#8212;ones that can serve as the basis for new kinds of engineering?   Or does something about the structure of the physical world limit the number of such rows?</p>
<h3> Mildly defective analogies </h3>
<p>Engineers care a lot about dimensional analysis.  So, they often make a big deal about the fact that while effort and flow have different dimensions in different rows of the analogy chart, the following four things are always true:</p>
<p>&bull; <img src="https://s0.wp.com/latex.php?latex=pq&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="pq" class="latex" /> has dimensions of action (= energy × time)<br />
&bull; <img src="https://s0.wp.com/latex.php?latex=%5Cdot%7Bp%7D+q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;dot{p} q" class="latex" /> has dimensions of energy<br />
&bull; <img src="https://s0.wp.com/latex.php?latex=p+%5Cdot%7Bq%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p &#92;dot{q}" class="latex" /> has dimensions of energy<br />
&bull; <img src="https://s0.wp.com/latex.php?latex=%5Cdot%7Bp%7D+%5Cdot%7Bq%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;dot{p} &#92;dot{q}" class="latex" /> has dimensions of power (= energy / time) </p>
<p>In fact any one of these things implies all the rest.</p>
<p>These facts are important when designing &#8216;mixed systems&#8217;, which combine different rows in the chart.  For example, in <a href="http://en.wikipedia.org/wiki/Mechatronics">mechatronics</a>, we combine mechanical and electronic elements in a single circuit!  And in a hydroelectric dam, power is converted from hydraulic to mechanical and then electric form:</p>
<div align="center">
<img width="450" src="https://i0.wp.com/math.ucr.edu/home/baez/networks/hydroelectric_dam.png" />
</div>
<p>One goal of network theory should be to develop a unified language for studying mixed systems!  Engineers have already done most of the hard work.   And they&#8217;ve realized that thanks to conservation of energy, working with pairs of flow and effort variables whose product has dimensions of power is very convenient.  It makes it easy to track the flow of energy through these systems.</p>
<p>However, people have tried to extend the analogy chart to include &#8216;mildly defective&#8217; examples where effort times flow doesn&#8217;t have dimensions of power. The two most popular are these:</p>
<table border="1" align="center">
<tr>
<td> </td>
<td><b>displacement</b>: &nbsp;&nbsp; <img src="https://s0.wp.com/latex.php?latex=q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q" class="latex" /></td>
<td><b>flow</b>: &nbsp; &nbsp;&nbsp; <img src="https://s0.wp.com/latex.php?latex=%5Cdot+q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;dot q" class="latex" />  </td>
<td><b>momentum</b>: &nbsp;&nbsp;&nbsp;&nbsp; <img src="https://s0.wp.com/latex.php?latex=p+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p " class="latex" /></td>
<td><b>effort</b>: &nbsp; &nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <img src="https://s0.wp.com/latex.php?latex=%5Cdot+p&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;dot p" class="latex" /></td>
</tr>
<tr>
<td><b>Heat flow</b></td>
<td> heat </td>
<td> heat flow </td>
<td> temperature momentum </td>
<td> temperature </td>
</tr>
<tr>
<td><b>Economics</b></td>
<td> inventory </td>
<td> product flow </td>
<td> economic momentum </td>
<td> product price </td>
</tr>
</table>
<p>The heat flow analogy comes up because people like to think of heat flow as analogous to electrical current, and temperature as analogous to voltage. Why? Because an insulated wall acts a bit like a resistor! The current flowing through a resistor is a function the voltage across it. Similarly, the heat flowing through an insulated wall is about proportional to the difference in temperature between the inside and the outside.</p>
<p>However, there&#8217;s a difference. Current times voltage has dimensions of power.  Heat flow times temperature does not have dimensions of power. In fact, heat flow by itself already has dimensions of power! So, engineers feel somewhat guilty about this analogy.</p>
<p>Being a mathematical physicist, a possible way out presents itself to me: use units where temperature is dimensionless! In fact such units are pretty popular in some circles. But I don&#8217;t know if this solution is a real one, or whether it causes some sort of trouble.</p>
<p>In the economic example, &#8216;energy&#8217; has been replaced by &#8216;money&#8217;. So other words, &#8216;inventory&#8217; times &#8216;product price&#8217; has units of money. And so does &#8216;product flow&#8217; times &#8216;economic momentum&#8217;! I&#8217;d never heard of <a href="http://en.wikipedia.org/wiki/Momentum_%28finance%29">economic momentum</a> before I started studying these analogies, but I didn&#8217;t make up that term.  It&#8217;s the thing whose time derivative is &#8216;product price&#8217;.  Apparently economists have noticed a tendency for rising prices to keep rising, and falling prices to keep falling&#8230; a tendency toward &#8216;conservation of momentum&#8217; that doesn&#8217;t fit into their models of rational behavior.</p>
<p>I&#8217;m suspicious of any attempt to make economics seem like physics. Unlike elementary particles or rocks, people don&#8217;t seem to be very well modelled by simple differential equations. However, some economists have used the above analogy to model economic systems. And I can&#8217;t help but find that interesting&mdash;even if intellectually dubious when taken too seriously. </p>
<h3> An auto-analogy </h3>
<p>Beside the analogy I&#8217;ve already described between electronics and mechanics, there&#8217;s another one, called &#8216;Firestone&#8217;s analogy&#8217;:</p>
<p>&bull; F.A. Firestone, <a href="http://hear.beckman.illinois.edu/wiki/uploads/Main/JournalClubSchedule2010/Firestone.pdf" rel="nofollow">A new analogy between mechanical and electrical systems</a>, <i><a href="http://asadl.org/jasa/resource/1/jasman/v4/i3/p249_s1" rel="nofollow">Journal of the Acoustical Society of America</a></i> <b>4</b> (1933), 249&ndash;267.</p>
<p><a href="https://johncarlosbaez.wordpress.com/2013/04/10/network-theory-part-28/#comment-27513">Alain Bossavit</a> pointed this out in the comments to Part 27.  The idea is to treat current as analogous to <i>force</i> instead of velocity&#8230; and treat voltage as analogous to <i>velocity</i> instead of force!</p>
<p>In other words, switch your <img src="https://s0.wp.com/latex.php?latex=p&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p" class="latex" />’s and <img src="https://s0.wp.com/latex.php?latex=q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q" class="latex" />’s:</p>
<table border="1">
<tr>
<td><b>Electronics</b></td>
<td><b>Mechanics &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (usual analogy)</b></td>
<td><b>Mechanics &nbsp; &nbsp;&nbsp; (Firestone&#8217;s analogy)</b></td>
</tr>
<tr>
<td>charge</td>
<td>position: <img src="https://s0.wp.com/latex.php?latex=q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q" class="latex" /></td>
<td>momentum: <img src="https://s0.wp.com/latex.php?latex=p&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p" class="latex" /></td>
</tr>
<tr>
<td>current</td>
<td>velocity: <img src="https://s0.wp.com/latex.php?latex=%5Cdot%7Bq%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;dot{q} " class="latex" /></td>
<td>force: <img src="https://s0.wp.com/latex.php?latex=%5Cdot%7Bp%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;dot{p}" class="latex" /> </td>
</tr>
<tr>
<td>flux linkage</td>
<td>momentum: <img src="https://s0.wp.com/latex.php?latex=p&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p" class="latex" /> </td>
<td>position: <img src="https://s0.wp.com/latex.php?latex=q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q" class="latex" /></td>
</tr>
<tr>
<td>voltage</td>
<td>force: <img src="https://s0.wp.com/latex.php?latex=%5Cdot%7Bp%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;dot{p}" class="latex" /> </td>
<td>velocity: <img src="https://s0.wp.com/latex.php?latex=%5Cdot%7Bq%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;dot{q} " class="latex" /></td>
</tr>
</table>
<p>This new analogy is not &#8216;mildly defective&#8217;: the product of effort and flow variables still has dimensions of power.  But why bother with another analogy?</p>
<p>It may be helpful to recall this circuit from last time:</p>
<div align="center">
<img src="https://i1.wp.com/math.ucr.edu/home/baez/networks/circuit_open_RLC_series_with_terminals.png" /></div>
<p>It&#8217;s described by this differential equation:</p>
<p><img src="https://s0.wp.com/latex.php?latex=L+%5Cddot%7BQ%7D+%2B+R+%5Cdot%7BQ%7D+%2B+C%5E%7B-1%7D+Q+%3D+V+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="L &#92;ddot{Q} + R &#92;dot{Q} + C^{-1} Q = V " class="latex" /></p>
<p>We used the &#8216;usual analogy&#8217; to translate it into classical mechanics problem, and we got a problem where an object of mass <img src="https://s0.wp.com/latex.php?latex=L&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="L" class="latex" /> is hanging from a spring with spring constant <img src="https://s0.wp.com/latex.php?latex=1%2FC&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="1/C" class="latex" /> and damping coefficient <img src="https://s0.wp.com/latex.php?latex=R%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="R," class="latex" /> and feeling an additional external force <img src="https://s0.wp.com/latex.php?latex=F%3A&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="F:" class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=m+%5Cddot%7Bq%7D+%2B+r+%5Cdot%7Bq%7D+%2B+k+q+%3D+F&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="m &#92;ddot{q} + r &#92;dot{q} + k q = F" class="latex" /></p>
<p>And that&#8217;s fine.  But there&#8217;s an intuitive sense in which all three forces are acting &#8216;in parallel&#8217; on the mass, rather than in series.  In other words, all side by side, instead of one after the other.</p>
<p>Using Firestone&#8217;s analogy, we get a different classical mechanics problem, where the three forces are acting in series. The spring is connected to source of friction, which in turn is connected to an external force.  </p>
<p>This may seem a bit mysterious.  But instead of trying to explain it, I&#8217;ll urge you to read his paper, which is short and clearly written.   I instead want to make a somewhat different point, which is that we can take a mechanical system, convert it to an electrical one following the usual analogy, and then convert back to a mechanical one using Firestone&#8217;s analogy.  This gives us an &#8216;auto-analogy&#8217; between mechanics and itself, which switches <img src="https://s0.wp.com/latex.php?latex=p&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=q.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q." class="latex" />  </p>
<p>And although I haven&#8217;t been able to figure out why from Firestone&#8217;s paper, I have other reasons for feeling sure this auto-analogy should contain a minus sign.  For example:</p>
<p><img src="https://s0.wp.com/latex.php?latex=p+%5Cmapsto+q%2C+%5Cqquad+q+%5Cmapsto+-p+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p &#92;mapsto q, &#92;qquad q &#92;mapsto -p " class="latex" /></p>
<p>In other words, it should correspond to a 90&deg; rotation in the <img src="https://s0.wp.com/latex.php?latex=%28p%2Cq%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(p,q)" class="latex" /> plane.  There&#8217;s nothing sacred about whether we rotate clockwise or counterclockwise; we can equally well do this:</p>
<p><img src="https://s0.wp.com/latex.php?latex=p+%5Cmapsto+-q%2C+%5Cqquad+q+%5Cmapsto+p+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p &#92;mapsto -q, &#92;qquad q &#92;mapsto p " class="latex" /></p>
<p>But we need the minus sign to get a so-called <a href="http://en.wikipedia.org/wiki/Symplectic_matrix#Symplectic_transformations">symplectic transformation</a> of the <img src="https://s0.wp.com/latex.php?latex=%28p%2Cq%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(p,q)" class="latex" /> plane.  And from my experience with classical mechanics, I&#8217;m pretty sure we want that.  If I&#8217;m wrong, please let me know!</p>
<p>I have a feeling we should revisit this issue when we get more deeply into the symplectic aspects of circuit theory.  So, I won&#8217;t go on now.  </p>
<h3> References </h3>
<p>The analogies I&#8217;ve been talking about are studied in a branch of engineering called <b><a href="http://en.wikipedia.org/wiki/System_dynamics">system dynamics</a></b>.  You can read more about it here:</p>
<p>&bull; Dean C. Karnopp, Donald L. Margolis and Ronald C. Rosenberg, <i>System Dynamics: a Unified Approach</i>, Wiley, New York, 1990.</p>
<p>&bull; Forbes T. Brown, <i>Engineering System Dynamics: a Unified Graph-Centered Approach</i>, CRC Press, Boca Raton, 2007.</p>
<p>&bull; Francois E. Cellier, <i>Continuous System Modelling</i>, Springer, Berlin, 1991. </p>
<p>System dynamics already uses lots of diagrams of networks.  One of my goals in weeks to come is to explain the category theory lurking behind these diagrams.</p>
									</div>

				<p class="postmetadata">
				<img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/speech_bubble.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2013/04/23/network-theory-part-29/#comments">37 Comments</a>				| <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/documents.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/category/chemistry/" rel="category tag">chemistry</a>, <a href="https://johncarlosbaez.wordpress.com/category/networks/" rel="category tag">networks</a>, <a href="https://johncarlosbaez.wordpress.com/category/physics/" rel="category tag">physics</a>								 | <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/permalink.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2013/04/23/network-theory-part-29/" rel="bookmark" title="Permanent Link to Network Theory (Part&nbsp;29)">Permalink</a>
<br /><img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/figure_ver1.gif" alt="" /> Posted by John Baez				</p>
			</div>
			<hr />
		
			<div class="post-13577 post type-post status-publish format-standard hentry category-chemistry category-networks category-oceans category-probability category-software" id="post-13577">
				<h2><a href="https://johncarlosbaez.wordpress.com/2012/12/20/petri-net-programming-part-2/" rel="bookmark">Petri Net Programming (Part&nbsp;2)</a></h2>
				<small>20 December, 2012</small><br />


				<div class="entry">
					<p><i>guest post by <b><a href="http://www.azimuthproject.org/azimuth/show/David+Tanzer">David A. Tanzer</a></b></i></p>
<h3>An introduction to stochastic Petri nets</h3>
<p>In the <a href="https://johncarlosbaez.wordpress.com/2012/10/01/petri-net-programming/">previous article</a>, I explored a simple computational model called Petri nets.  They are used to model reaction networks, and have applications in a wide variety of fields, including population ecology, gene regulatory networks, and chemical reaction networks.  I presented a simulator program for Petri nets, but it had an important limitation:  the model and the simulator contain no notion of the <i>rates</i> of the reactions.  But these rates critically determine the character of the dynamics of network.</p>
<p>Here I will introduce the topic of &#8216;stochastic Petri nets,&#8217; which extends the basic model to include reaction dynamics.  Stochastic means random, and it is presumed that there is an underlying <i>random process</i> that drives the reaction events.   This topic is rich in both its mathematical foundations and its practical applications.  A direct application of the theory yields the rate equation for chemical reactions, which is a cornerstone of chemical reaction theory.  The theory also gives algorithms for analyzing and simulating Petri nets.</p>
<p>We are now entering the &#8216;business&#8217; of software development for applications to science.  The business logic here is nothing but math and science itself.  Our study of this logic is not an academic exercise that is tangential to the implementation effort.  Rather, it is the first phase of a <i>complete</i> software development process for scientific programming applications.</p>
<p>The end goals of this series are to develop working code to analyze and simulate Petri nets, and to apply these tools to informative case studies.  But we have some work to do <i>en route</i>, because we need to truly understand the models in order to properly interpret the algorithms.   The key questions here are when, why, and to what extent the algorithms give results that are empirically predictive.  We will therefore be embarking on some exploratory adventures into the relevant theoretical foundations.  </p>
<p>The overarching subject area to which stochastic Petri nets belong has been described as <i>stochastic mechanics</i> in the <a href="http://math.ucr.edu/home/baez/networks/">network theory</a> series here on Azimuth.  The theme development here will partly parallel that of the network theory series, but with a different focus, since I am addressing a computationally oriented reader.  For an excellent text on the foundations and applications of stochastic mechanics, see:</p>
<p>&bull; Darren Wilkinson, <i>Stochastic Modelling for Systems Biology</i>, Chapman and Hall/CRC Press, Boca Raton, Florida, 2011.</p>
<h3>Review of basic Petri nets</h3>
<p>A Petri net is a graph with two kinds of nodes: species and transitions.  The net is populated with a collection of &#8216;tokens&#8217; that represent individual entities.   Each token is attached to one of the species nodes, and this attachment indicates the type of the token.   We may therefore view a species node as a container that holds all of the tokens of a given type.   </p>
<p>The transitions represent conversion reactions between the tokens.  Each transition is &#8216;wired&#8217; to a collection of input species-containers, and to a collection of output containers.   When it &#8216;fires&#8217;, it removes one token from each input container, and deposits one token to each output container. </p>
<p>Here is the example we gave, for a simplistic model of the formation and dissociation of H<sub>2</sub>O molecules:</p>
<div align="center">
<img width="450" src="https://i2.wp.com/math.ucr.edu/home/baez/networks/pictures/H2O-example.png" /></div>
<p>The circles are for species, and the boxes are for transitions.</p>
<p>The transition <b>combine</b> takes in two H tokens and one O token, and outputs one H<sub>2</sub>O token.  The reverse transition is <b>split</b>, which takes in one H<sub>2</sub>O, and outputs two H&#8217;s and one O.</p>
<p>An important application of Petri nets is to the modeling of <i>biochemical</i> reaction networks, which include the gene regulatory networks.  Since genes and enzymes are molecules, and their binding interactions are chemical reactions, the Petri net model is directly applicable.  For example, consider a transition that inputs one gene G, one enzyme E, and outputs the molecular form G &bull; E in which E is bound to a particular site on G.</p>
<p>Applications of Petri nets may differ widely in terms of the population sizes involved in the model.  In general chemistry reactions, the populations are measured in units of moles (where a mole is &#8216;Avogadro&#8217;s number&#8217; 6.022 &middot; 10<sup>23</sup> entities).  In gene regulatory networks, on the other hand, there may only be a handful of genes and enzymes involved in a reaction.  </p>
<p>This difference in scale leads to a qualitative difference in the modelling.  With small population sizes, the stochastic effects will predominate, but with large populations, a continuous, deterministic, average-based approximation can be used.</p>
<h3>Representing Petri nets by reaction formulas</h3>
<p>Petri nets can also be represented by formulas used for chemical reaction networks.  Here is the formula for the Petri net shown above:</p>
<p>H<sub>2</sub>O &harr; H + H + O</p>
<p>or the more compact:</p>
<p>H<sub>2</sub>O &harr; 2 H + O</p>
<p>The double arrow is a compact designation for <i>two</i> separate reactions, which happen to be opposites of each other.</p>
<p>By the way, this reaction is not physically realistic, because one doesn&#8217;t find isolated H and O atoms traveling around and meeting up to form water molecules.  This is the actual reaction pair that predominates in water:</p>
<p>2 H<sub>2</sub>O &harr; OH<sup>&#8211;</sup> + H<sub>3</sub>O<sup>+</sup></p>
<p>Here, a hydrogen nucleus H<sup>+</sup>, with one unit of positive charge, gets removed from one of the H<sub>2</sub>O molecules, leaving behind the <a href="http://en.wikipedia.org/wiki/Hydroxide"><b>hydroxide</b></a> ion OH<sup>&#8211;</sup>.  In the same stroke, this H<sup>+</sup> gets re-attached to the other H<sub>2</sub>O molecule, which thereby becomes a <a href="http://en.wikipedia.org/wiki/Hydronium"><b>hydronium</b></a> ion, H<sub>3</sub>O<sup>+</sup>.</p>
<p>For a more detailed example, consider this reaction chain, which is of concern to the ocean environment:</p>
<p>CO<sub>2</sub> + H<sub>2</sub>O &harr; H<sub>2</sub>CO<sub>3</sub> &harr; H<sup>+</sup> + HCO<sub>3</sub><sup>&#8211;</sup></p>
<p>This shows the formation of <a href="http://en.wikipedia.org/wiki/Carbonic_acid"><b>carbonic acid</b></a>, namely H<sub>2</sub>CO<sub>3</sub>, from water and carbon dioxide.  The next reaction represents the splitting of carbonic acid into a hydrogen ion and a negatively charged <a href="http://en.wikipedia.org/wiki/Bicarbonate"><b>bicarbonate ion</b></a>, HCO<sub>3</sub><sup>&#8211;</sup>.  There is a further reaction, in which a bicarbonate ion further ionizes into an H<sup>+</sup> and a doubly negative <a href="http://en.wikipedia.org/wiki/Carbonate"><b>carbonate ion</b></a> CO<sub>3</sub><sup>2-</sup>.   As the diagram indicates, for each of these reactions, a reverse reaction is also present.   For a more detailed description of this reaction network, see:</p>
<p>&bull; Stephen E. Bialkowski, <a href="http://ion.chem.usu.edu/~sbialkow/Classes/3650/Carbonate/Carbonic%20Acid.html">Carbon dioxide and carbonic acid</a>.</p>
<p>Increased levels of CO<sub>2</sub> in the atmosphere will change the balance of these reactions, leading to a higher concentration of hydrogen ions in the water, i.e., a more acidic ocean.  This is of concern because the metabolic processes of aquatic organisms is sensitive to the pH level of the water.   The ultimate concern is that entire food chains could be disrupted, if some of the organisms cannot survive in a higher pH environment.  See the Wikipedia page on <a href="http://en.wikipedia.org/wiki/Ocean_acidification">ocean acidification</a> for more information.</p>
<p><b>Exercise.</b> Draw Petri net diagrams for these reaction networks.</p>
<h3>Motivation for the study of Petri net dynamics</h3>
<p>The relative rates of the various reactions in a network critically determine the qualitative dynamics of the network as a whole.  This is because the reactions are &#8216;competing&#8217; with each other, and so their relative rates determine the direction in which the state of the system is changing.  For instance, if molecules are breaking down faster then they are being formed, then the system is moving towards full dissociation.  When the rates are equal, the processes balance out, and the system is in an equilibrium state.  Then, there are only temporary fluctuations around the equilibrium conditions.   </p>
<p>The rate of the reactions will depend on the number of tokens present in the system.  For example, if any of the input tokens are zero, then the transition can&#8217;t fire, and so its rate must be zero.  More generally, when there are few input tokens available, there will be fewer reaction events, and so the firing rates will be lower.</p>
<p>Given a specification for the rates in a reaction network, we can then pose the following kinds of questions about its dynamics:</p>
<p>&bull; Does the network have an equilibrium state? </p>
<p>&bull; If so, what are the concentrations of the species at equilibrium?  </p>
<p>&bull; How quickly does it approach the equilibrium? </p>
<p>&bull; At the equilibrium state, there will still be temporary fluctuations around the equilibrium concentrations.  What are the variances of these fluctuations? </p>
<p>&bull; Are there modes in which the network will oscillate between states? </p>
<p>This is the grail we seek.  </p>
<p>Aside from actually performing empirical experiments, such questions can be addressed either analytically or through simulation methods.  In either case, our first step is to define a theoretical model for the dynamics of a Petri net.</p>
<h3>Stochastic Petri nets</h3>
<p>A <b>stochastic Petri net</b> (with kinetics) is a Petri net that is augmented with a specification for the reaction dynamics.  It is defined by the following:  </p>
<p>&bull; An <b>underlying Petri net</b>, which consists of species, transitions, an input map, and an output map.  These maps assign to each transition a multiset of species.  (Multiset means that duplicates are allowed.)  Recall that the state of the net is defined by a <i>marking</i> function, that maps each species to its population count.</p>
<p>&bull; A <b>rate constant</b> that is associated with each transition.</p>
<p>&bull; A <b>kinetic model</b>, that gives the expected firing rate for each transition as a function of the current marking.  Normally, this kinetic function will include the rate constant as a multiplicative factor.</p>
<p>A further &#8216;sanity constraint&#8217; can be put on the kinetic function for a transition:  it should give a positive value if and only if all of its inputs are positive.</p>
<p>&bull; A <b>stochastic model</b>, which defines the probability distribution of the time intervals between firing events.  This specific distribution of the firing intervals for a transition will be a function of the expected firing rate in the current marking.</p>
<p>This definition is based on the standard treatments found, for example in:</p>
<p>&bull; M. Ajmone Marsan, <a href="http://www.fd.cvut.cz/department/k611/pedagog/tho_a/a_soubory/spn_introduction.pdf">Stochastic Petri nets: an elementary introduction</a>, in <i>Advances in Petri Nets</i>, Springer, Berlin, 1989, 1&#8211;23.</p>
<p>or Wilkinson&#8217;s book mentioned above.  I have also added an explicit mention of the kinetic model, based on the &#8216;kinetics&#8217; described in here:</p>
<p>&bull; Martin Feinberg, <a href="http://www.chbmeng.ohio-state.edu/~feinberg/LecturesOnReactionNetworks">Lectures on chemical reaction networks</a>.</p>
<p>There is an implied <i>random process</i> that drives the reaction events.  A classical random process is given by a container with &#8216;particles&#8217; that are randomly traveling around, bouncing off the walls, and colliding with each other.  This is the general idea behind  Brownian motion.  It is called a random process because the outcome results from an &#8216;experiment&#8217; that is not fully determined by the input specification.   In this experiment, you pour in the ingredients (particles of different types), set the temperature (the distributions of the velocities), give it a stir, and then see what happens.  The outcome consists of the paths taken by each of the particles.   </p>
<p>In an important limiting case, the stochastic behavior becomes deterministic, and the population sizes become continuous.  To see this, consider a graph of population sizes over time.  With larger population sizes, the relative jumps caused by the firing of individual transitions become smaller, and graphs look more like continuous curves.  In the limit, we obtain an approximation for high population counts, in which the graphs are continuous curves, and the concentrations are treated as continuous magnitudes.  In a similar way, a pitcher of sugar can be approximately viewed as a continuous fluid.  </p>
<p>This simplification permits the application of continuous mathematics to study of reaction network processes.  It leads to the basic <i>rate equation</i> for reaction networks, which specifies the direction of change of the system as a function of the current state of the system.  </p>
<p>In this article we will be exploring this continuous deterministic formulation of Petri nets, under what is known as the mass action kinetics.  This kinetics is one implementation of the general specification of a kinetic model, as defined above.  This means that it will define the <i>expected</i> firing rate of each transition, in a given marking of the net.  The probabilistic variations in the spacing of the reactions&#8212;around the mean given by the expected firing rate&#8212;is part of the stochastic dynamics, and will be addressed in a subsequent article. </p>
<h3>The mass-action kinetics</h3>
<p>Under the <b>mass action kinetics</b>, the expected firing rate of a transition is proportional to the product of the concentrations of its input species.   For instance, if the reaction were A + C &rarr; D, then the firing rate would be proportional to the concentration of A times the concentration of C, and if the reaction were A + A &rarr; D, it would be proportional to the square of the concentration of A.   </p>
<p>This principle is explained by Feinberg as follows:  </p>
<blockquote><p>For the reaction A+C &rarr; D, an occurrence requires that a molecule of A meet a molecule of C in the reaction, and we take the probability of such an encounter to be proportional to the product [of the concentrations of A and C].   Although we do not presume that every such encounter yields a molecule of D, we nevertheless take the occurrence rate of A+C &rarr; D to be governed by [the product of the concentrations].
</p></blockquote>
<p>For an in-depth proof of the mass action law, see this article:</p>
<p>&bull; Daniel Gillespie, <a href="http://citeseerx.ist.psu.edu/viewdoc/summary/?doi=10.1.1.159.5220">A rigorous definition of the chemical master equation</a>, 1992.</p>
<p>Note that we can easily pass back and forth between speaking of the population counts for the species, and the concentrations of the species, which is just the population count divided by the total volume V of the system.  The mass action law applies to both cases, the only difference being that the constant factors of (1/V) used for concentrations will get absorbed into the rate constants.</p>
<p>The mass action kinetics is a basic law of empirical chemistry.  But there are limits to its validity.  First, as indicated in the proof in the Gillespie, the mass action law rests on the assumptions that the system is well-stirred and in thermal equilibrium.  Further limits are discussed here:</p>
<p>&bull; Georg Job and Regina Ruffler, <a href="http://job-stiftung.de/pdf/buch/physical_chemistry_five_chapters.pdf"><i>Physical Chemistry</i></a> (first five chapters), Section 5.2, 2010.</p>
<p>They write:</p>
<blockquote><p> &#8230;precise measurements show that the relation above is not strictly adhered to. At higher concentrations, values depart quite noticeably from this relation. If we gradually move to lower concentrations, the differences become smaller. The equation here expresses a so-called “limiting law“ which strictly applies only when c &rarr; 0.
</p></blockquote>
<blockquote><p> In practice, this relation serves as a useful approximation up to rather high concentrations. In the case of electrically neutral substances, deviations are only noticeable above 100 mol m<sup>−3</sup>.  For ions, deviations become observable above 1 mol m<sup>−3</sup>, but they are so small that they are easily neglected if accuracy is not of prime concern.
</p></blockquote>
<p>Why would the mass action kinetics break down at high concentrations?  According to the book quoted, it is due to &#8220;molecular and ionic interactions.&#8221;  I haven&#8217;t yet found a more detailed explanation, but here is my supposition about what is meant by molecular interactions in this context.  Doubling the number of A molecules doubles the number of expected collisions between A and C molecules, but it also reduces the probability that any given A and C molecules that are within reacting distance will actually react.  The reaction probability is reduced because the A molecules are &#8216;competing&#8217; for reactions with the C molecules.  With more A molecules, it becomes more likely that a C molecule will simultaneously be within reacting distance of several A molecules; each of these A molecules reduces the probability that the other A molecules will react with the C molecule.   This is most pronounced when the concentrations in a gas get high enough that the molecules start to pack together to form a liquid.  </p>
<h3>The equilibrium relation for a pair of opposite reactions</h3>
<p>Suppose we have two opposite reactions:</p>
<p><img src="https://s0.wp.com/latex.php?latex=T%3A+A+%2B+B+%5Cstackrel%7Bu%7D%7B%5Clongrightarrow%7D+C+%2B+D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T: A + B &#92;stackrel{u}{&#92;longrightarrow} C + D " class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=T%27%3A+C+%2B+D+%5Cstackrel%7Bv%7D%7B%5Clongrightarrow%7D+A+%2B+B+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T&#039;: C + D &#92;stackrel{v}{&#92;longrightarrow} A + B " class="latex" /></p>
<p>Since the reactions have exactly opposite effects on the population sizes, in order for the population sizes to be in a stable equilibrium, the expected firing rates of <img src="https://s0.wp.com/latex.php?latex=T&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=T%27&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T&#039;" class="latex" /> must be equal: </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Brate%7D%28T%27%29+%3D+%5Cmathrm%7Brate%7D%28T%29+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{rate}(T&#039;) = &#92;mathrm{rate}(T) " class="latex" /></p>
<p>By mass action kinetics: </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Brate%7D%28T%29+%3D+u+%5BA%5D+%5BB%5D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{rate}(T) = u [A] [B] " class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Brate%7D%28T%27%29+%3D+v+%5BC%5D+%5BD%5D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{rate}(T&#039;) = v [C] [D] " class="latex" /></p>
<p>where <img src="https://s0.wp.com/latex.php?latex=%5BX%5D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="[X]" class="latex" /> means the concentration of <img src="https://s0.wp.com/latex.php?latex=X.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="X." class="latex" /></p>
<p>Hence at equilibrium:</p>
<p><img src="https://s0.wp.com/latex.php?latex=u+%5BA%5D+%5BB%5D+%3D+v+%5BC%5D+%5BD%5D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="u [A] [B] = v [C] [D] " class="latex" /></p>
<p>So:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7B%5BA%5D%5BB%5D%7D%7B%5BC%5D%5BD%5D%7D+%3D+%5Cfrac%7Bv%7D%7Bu%7D+%3D+K+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{[A][B]}{[C][D]} = &#92;frac{v}{u} = K }" class="latex" /></p>
<p>where <img src="https://s0.wp.com/latex.php?latex=K&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="K" class="latex" /> is the equilibrium constant for the reaction pair.  </p>
<h3>Equilibrium solution for the formation and dissociation of a diatomic molecule</h3>
<p>Let A be some type of atom, and let D = A<sub>2</sub> be the diatomic form of A.  Then consider the opposite reactions:</p>
<p><img src="https://s0.wp.com/latex.php?latex=A+%2B+A+%5Cstackrel%7Bu%7D%7B%5Clongrightarrow%7D+D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A + A &#92;stackrel{u}{&#92;longrightarrow} D " class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=D+%5Cstackrel%7Bv%7D%7B%5Clongrightarrow%7D+A+%2B+A+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="D &#92;stackrel{v}{&#92;longrightarrow} A + A " class="latex" /></p>
<p>From the preceding analysis, at equilibrium the following relation holds:</p>
<p><img src="https://s0.wp.com/latex.php?latex=u+%5BA%5D%5E2+%3D+v+%5BD%5D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="u [A]^2 = v [D] " class="latex" /></p>
<p>Let <img src="https://s0.wp.com/latex.php?latex=N%28A%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="N(A)" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=N%28B%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="N(B)" class="latex" /> be the population counts for A and B, and let</p>
<p><img src="https://s0.wp.com/latex.php?latex=N+%3D+N%28A%29+%2B+2+N%28D%29+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="N = N(A) + 2 N(D) " class="latex" /></p>
<p>be the total number of units of A in the system, whether they be in the form of atoms or diatoms.</p>
<p>The value of <img src="https://s0.wp.com/latex.php?latex=N&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="N" class="latex" /> is an invariant property of the system.  The reactions cannot change it, because they are just shuffling the units of A from one arrangement to the other.  By way of contrast, <img src="https://s0.wp.com/latex.php?latex=N%28A%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="N(A)" class="latex" /> is not an invariant quantity.</p>
<p>Dividing this equation by the total volume <img src="https://s0.wp.com/latex.php?latex=V&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="V" class="latex" />, we get:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5BN%5D+%3D+%5BA%5D+%2B+2+%5BD%5D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="[N] = [A] + 2 [D] " class="latex" /></p>
<p>where <img src="https://s0.wp.com/latex.php?latex=%5BN%5D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="[N]" class="latex" /> is the concentration of the units of A.</p>
<p>Given a fixed value for <img src="https://s0.wp.com/latex.php?latex=%5BN%5D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="[N]" class="latex" /> and the rate constants <img src="https://s0.wp.com/latex.php?latex=u&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="u" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=v&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="v" class="latex" />, we can then solve for the concentrations at equilibrium:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7Bu+%5BA%5D%5E2+%3D+v+%5BD%5D+%3D+v+%28%5BN%5D+-+%5BA%5D%29+%2F+2+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{u [A]^2 = v [D] = v ([N] - [A]) / 2 }" class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B2+u+%5BA%5D%5E2+%2B+v+%5BA%5D+-+v+%5BN%5D+%3D+0+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{2 u [A]^2 + v [A] - v [N] = 0 }" class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B%5BA%5D+%3D+%28-v+%5Cpm+%5Csqrt%7Bv%5E2+%2B+8+u+v+%5BN%5D%7D%29+%2F+4+u+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{[A] = (-v &#92;pm &#92;sqrt{v^2 + 8 u v [N]}) / 4 u }" class="latex" /></p>
<p>Since <img src="https://s0.wp.com/latex.php?latex=%5BA%5D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="[A]" class="latex" /> can&#8217;t be negative, only the positive square root is valid.</p>
<p>Here is the solution for the case where <img src="https://s0.wp.com/latex.php?latex=u+%3D+v+%3D+1&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="u = v = 1" class="latex" />:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B%5BA%5D+%3D+%28%5Csqrt%7B8+%5BN%5D+%2B+1%7D+-+1%29+%2F+4+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{[A] = (&#92;sqrt{8 [N] + 1} - 1) / 4 }" class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B%5BD%5D+%3D+%28%5BN%5D+-+%5BA%5D%29+%2F+2+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{[D] = ([N] - [A]) / 2 }" class="latex" /></p>
<h3>Conclusion</h3>
<p>We&#8217;ve covered a lot of ground, starting with the introduction of the stochastic Petri net model, followed by a general discussion of reaction network dynamics, the mass action laws, and calculating equilibrium solutions for simple reaction networks. </p>
<p>We still have a number of topics to cover on our journey into the foundations, before being able to write <i>informed</i> programs to solve problems with stochastic Petri nets.   Upcoming topics are (1) the deterministic rate equation for general reaction networks and its application to finding equilibrium solutions, and (2) an exploration of the <i>stochastic</i> dynamics of a Petri net.  These are the themes that will support our upcoming software development.</p>
									</div>

				<p class="postmetadata">
				<img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/speech_bubble.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2012/12/20/petri-net-programming-part-2/#comments">15 Comments</a>				| <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/documents.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/category/chemistry/" rel="category tag">chemistry</a>, <a href="https://johncarlosbaez.wordpress.com/category/networks/" rel="category tag">networks</a>, <a href="https://johncarlosbaez.wordpress.com/category/oceans/" rel="category tag">oceans</a>, <a href="https://johncarlosbaez.wordpress.com/category/probability/" rel="category tag">probability</a>, <a href="https://johncarlosbaez.wordpress.com/category/software/" rel="category tag">software</a>								 | <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/permalink.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2012/12/20/petri-net-programming-part-2/" rel="bookmark" title="Permanent Link to Petri Net Programming (Part&nbsp;2)">Permalink</a>
<br /><img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/figure_ver1.gif" alt="" /> Posted by John Baez				</p>
			</div>
			<hr />
		
			<div class="post-12882 post type-post status-publish format-standard hentry category-chemistry category-mathematics category-networks" id="post-12882">
				<h2><a href="https://johncarlosbaez.wordpress.com/2012/11/03/network-theory-part-25/" rel="bookmark">Network Theory (Part&nbsp;25)</a></h2>
				<small>3 November, 2012</small><br />


				<div class="entry">
					<p>In parts 2-24 of this <a href="http://math.ucr.edu/home/baez/networks/">network theory series</a>, we&#8217;ve been talking about Petri nets and reaction networks.   These parts are now getting turned into a book.  You can see a draft here:</p>
<p>&bull; John Baez and Jacob Biamonte, <a href="http://math.ucr.edu/home/baez/stoch_stable.pdf">A course on quantum techniques for stochastic mechanics</a>.</p>
<p>There&#8217;s a lot more to network theory than this.  But before I dive into the next big topic, I want to mention a few more odds and ends about Petri nets and reaction networks.   For example, their connection to logic and computation!</p>
<p>As we&#8217;ve seen, a stochastic Petri net can be used to describe a bunch of chemical reactions with certain reaction rates.  We could try to use these reactions to build a &#8216;chemical computer&#8217;.   But <i>how powerful can such a computer be?</i></p>
<p>I don&#8217;t know the answer.  But before people got interested in <i>stochastic</i> Petri nets, computer scientists spent quite some time studying plain old Petri nets, which don&#8217;t include the information about reaction rates.  They used these as simple models of computation.  And since computer scientists like to know which questions are <a href="http://en.wikipedia.org/wiki/Decidability_%28logic%29">decidable</a> by means of an algorithm and which aren&#8217;t, they proved some interesting theorems about decidability for Petri nets.  </p>
<p>Let me talk about: &#8216;reachability&#8217;: the question of which collections of molecules can turn into which other collections, given a fixed set of chemical reactions.   For example, suppose you have these chemical reactions:</p>
<div align="center">
<p>C + O<sub>2</sub> &rarr; CO<sub>2</sub></p>
<p>CO<sub>2</sub> + NaOH &rarr; NaHCO<sub>3</sub></p>
<p>NaHCO<sub>3</sub> + HCl &rarr; H<sub>2</sub>O + NaCl + CO<sub>2</sub>
</div>
<p>Can you use these to turn</p>
<div align="center">
C + O<sub>2</sub> + NaOH + HCl
</div>
<p>into </p>
<div align="center">
CO<sub>2</sub> + H<sub>2</sub>O + NaCl ?
</div>
<p>It&#8217;s not too hard to settle this particular question&#8212;we&#8217;ll do it soon.  But settling <i>all possible</i> such questions turns out to be very hard</p>
<h3> Reachability </h3>
<p>Remember: </p>
<p><b>Definition.</b> A <b>Petri net</b> consists of a set <img src="https://s0.wp.com/latex.php?latex=S&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S" class="latex" /> of <b>species</b> and a set <img src="https://s0.wp.com/latex.php?latex=T&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T" class="latex" /> of <b>transitions</b>, together with a function </p>
<p><img src="https://s0.wp.com/latex.php?latex=i+%3A+S+%5Ctimes+T+%5Cto+%5Cmathbb%7BN%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i : S &#92;times T &#92;to &#92;mathbb{N} " class="latex" /></p>
<p>saying how many copies of each state shows up as <b>input</b> for each transition, and a function</p>
<p><img src="https://s0.wp.com/latex.php?latex=o%3A+S+%5Ctimes+T+%5Cto+%5Cmathbb%7BN%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="o: S &#92;times T &#92;to &#92;mathbb{N}" class="latex" /></p>
<p>saying how many times it shows up as <b>output</b>.   </p>
<p>Today we&#8217;ll assume both <img src="https://s0.wp.com/latex.php?latex=S&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=T&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T" class="latex" /> are finite.</p>
<p>Jacob and I like to draw the species as yellow circles and the transitions as aqua boxes, in a charmingly garish color scheme chosen by Dave Tweed.   So, the chemical reactions I mentioned before:</p>
<div align="center">
<p>C + O<sub>2</sub> &rarr; CO<sub>2</sub></p>
<p>CO<sub>2</sub> + NaOH &rarr; NaHCO<sub>3</sub></p>
<p>NaHCO<sub>3</sub> + HCl &rarr; H<sub>2</sub>O + NaCl + CO<sub>2</sub>
</div>
<p>give this Petri net:</p>
<div align="center"><img width="400" src="https://i2.wp.com/math.ucr.edu/home/baez/networks/chemistryNetBasicA.png" alt="" /></div>
<p>A &#8216;complex&#8217; is, roughly, a way of putting dots in the yellow circles.   In chemistry this says how many molecules we have of each kind.  Here&#8217;s an example:</p>
<div align="center">
<img width="400" src="https://i1.wp.com/www.azimuthproject.org/azimuth/files/chemistryNetDot1A.png" alt="" />
</div>
<p>This complex happens to have just zero or one dot in each circle, but that&#8217;s not required: we could have any number of dots in each circle.  So, mathematically, a <b>complex</b> is a finite linear combination of species, with natural numbers as coefficients.  In other words, it&#8217;s an element of <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BN%7D%5ES.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{N}^S." class="latex" />   In this particular example it&#8217;s</p>
<div align="center">
C + O<sub>2</sub> + NaOH + HCl
</div>
<p>Given two complexes, we say one is <b>reachable</b> from another if, loosely speaking, we can get to it from the other by a finite sequence of transitions.  For example, earlier on I asked if we can get from the complex I just mentioned to the complex</p>
<div align="center">
CO<sub>2</sub> + H<sub>2</sub>O + NaCl
</div>
<p>which we can draw like this:</p>
<div align="center">
<img width="300" src="https://i1.wp.com/www.azimuthproject.org/azimuth/files/chemistryNetDot4.png" alt="" />
</div>
<p>And the answer is yes, we can do it with this sequence of transitions:</p>
<div align="center">
<img width="300" src="https://i1.wp.com/www.azimuthproject.org/azimuth/files/chemistryNetDot1A.png" alt="" />
</div>
<p>&nbsp;</p>
<div align="center">
<img width="300" src="https://i1.wp.com/www.azimuthproject.org/azimuth/files/chemistryNetDot2A.png" alt="" />
</div>
<p>&nbsp;</p>
<div align="center">
<img width="300" src="https://i1.wp.com/www.azimuthproject.org/azimuth/files/chemistryNetDot3.png" alt="" />
</div>
<p>&nbsp;</p>
<div align="center">
<img width="300" src="https://i1.wp.com/www.azimuthproject.org/azimuth/files/chemistryNetDot4.png" alt="" />
</div>
<p>This settles the question I asked earlier.</p>
<p>So in chemistry, reachability is all about whether it&#8217;s possible to use certain chemical reactions to turn one collection of molecules into another using a certain set of reactions.  I hope this is clear enough; I could formalize it further but it seems unnecessary.  If you have questions, ask me or read this:</p>
<p>&bull; <a href="http://en.wikipedia.org/wiki/Petri_net#Execution_semantics">Petri net: execution semantics</a>, Wikipedia.</p>
<h3> The reachability problem </h3>
<p>Now the <b>reachability problem</b> asks: given a Petri net and two complexes, is one reachable from the other?  </p>
<p>If the answer is &#8216;yes&#8217;, of course you can show that by an exhaustive search of all possibilities.  But if the answer is &#8216;no&#8217;, how can you be sure?  It&#8217;s not obvious, in general.  Back in the 1970&#8217;s, computer scientists felt this problem should be decidable by some algorithm&#8230; but they had a lot of trouble finding such an algorithm.  </p>
<p>In 1976, <a href="rjlipton.wordpress.com">Richard J. Lipton</a> showed that if such an algorithm existed, it would need to take at least an exponential amount of memory space and an exponential amount of time to run:</p>
<p>&bull; Richard J. Lipton, <a href="http://www.cs.yale.edu/publications/techreports/tr63.pdf">The reachability problem requires exponential space</a>, Technical Report 62, Yale University, 1976.</p>
<p>This means that most computer scientists would consider any algorithm to solve the reachability problem &#8216;infeasible&#8217;, since they like <a href="http://en.wikipedia.org/wiki/Time_complexity#Polynomial_time">polynomial time</a> algorithms.  </p>
<p>On the bright side, it means that Petri nets might be fairly powerful when viewed as computers themselves! After all, for a <a href="http://en.wikipedia.org/wiki/Universal_Turing_machine">universal Turing machine</a>, the analogue of the reachability problem is undecidable.  So if the reachability problem for Petri nets were decidable, they couldn&#8217;t be universal computers.  But if it were decidable but hard, Petri nets might be fairly powerful&#8212;though still not universal&#8212;computers.</p>
<p>In 1977, at the ACM Symposium on the Theory of Computing, two researchers presented a proof that reachability problem was decidable:</p>
<p>&bull; S. Sacerdote and R. Tenney, The decidability of the reachability problem for vector addition systems, <i>Conference Record of the Ninth Annual ACM Symposium on Theory of Computing, 2-4 May 1977, Boulder, Colorado, USA</i>, ACM, 1977, pp. 61&#8211;76.</p>
<p>However, it turned out to be flawed!  I read about this episode here:</p>
<p>&bull; James L. Peterson, <i>Petri Net Theory and the Modeling of Systems</i>, Prentice&#8211;Hall, New Jersey, 1981.</p>
<p>This is a very nice introduction to early work on Petri nets and decidability.   Peterson had an interesting idea, too:</p>
<blockquote><p>
There would seem to be a very useful connection between Petri nets and Presburger arithmetic.
</p></blockquote>
<p>He gave some evidence, and suggested using this to settle the decidability of the reachability problem.   I found that intriguing!  Let me explain why.</p>
<p><a href="http://en.wikipedia.org/wiki/Presburger_arithmetic">Presburger arithmetic</a> is a simple set of axioms for the arithmetic of natural numbers, much weaker than <a href="http://en.wikipedia.org/wiki/Peano_arithmetic">Peano arithmetic</a> or even <a href="http://en.wikipedia.org/wiki/Robinson_arithmetic">Robinson arithmetic</a>.  Unlike those other systems, Presburger arithmetic doesn&#8217;t mention multiplication.  And unlike those other systems, you can write an algorithm that decides whether any given statement in Presburger arithmetic is provable.  </p>
<p>However, any such algorithm must be very slow!   In 1974, Fischer and Rabin showed that any decision algorithm for Presburger arithmetic has a worst-case runtime of at least </p>
<p><img src="https://s0.wp.com/latex.php?latex=2%5E%7B2%5E%7Bc+n%7D%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="2^{2^{c n}}" class="latex" /> </p>
<p>for some constant <img src="https://s0.wp.com/latex.php?latex=c%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="c," class="latex" /> where <img src="https://s0.wp.com/latex.php?latex=n&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="n" class="latex" /> is the length of the statement.   So we say the complexity is at least doubly exponential.  That&#8217;s much worse than exponential!    On the other hand, an algorithm with a <i>triply</i> exponential run time was found by Oppen in 1978.   </p>
<p>I hope you see why this is intriguing.  Provability is a lot like reachability, since in a proof you&#8217;re trying to reach the conclusion starting from the assumptions using certain rules.  Like Presburger arithmetic, Petri nets are all about addition, since they consists of transitions going between linear combinations like this:</p>
<div align="center">
6 CO<sub>2</sub> + 6 H<sub>2</sub>O &rarr; C<sub>6</sub>H<sub>12</sub>O<sub>6</sub> + 6 O<sub>2</sub>
</div>
<p>That&#8217;s why the old literature calls Petri nets <b>vector addition systems</b>.   And finally, the difficulty of deciding provability in Presburger arithmetic smells a bit like the difficulty of deciding reachability in Petri nets.</p>
<p>So, I was eager to learn what happened after Peterson wrote his book.</p>
<p>For starters, in 1981, the very year Peterson&#8217;s book came out, Ernst Mayr showed that the reachability problem for Petri nets <i>is</i> decidable:</p>
<p>&bull; Ernst Mayr, Persistence of vector replacement systems is decidable, <i><a href="http://www.springerlink.com/content/w0106k6624406366/?MUD=MP">Acta Informatica</a></i> <b>15</b> (1981), 309&#8211;318.</p>
<p>As you can see from the title, Mayr actually proved some other property was decidable.  However, it follows that reachability is decidable, and Mayr pointed this out in his paper.  In fact the decidability of reachability for Petri nets is equivalent to lots of other interesting questions.  You can see a bunch here:</p>
<p>&bull; Javier Esparza and Mogens Nielsen, <a href="http://citeseerx.ist.psu.edu/viewdoc/download;jsessionid=5EBA38B02179E955EB84DCA21345710C?doi=10.1.1.2.3965&amp;rep=rep1&amp;type=pdf">Decidability issues for Petri nets&#8212;a survey</a>, <i>Bulletin of the European Association for Theoretical Computer Science</i> <b>52</b> (1994), 245&#8211;262.</p>
<p>Mayr&#8217;s algorithm was complicated.  Worse still, it seems to take a hugely long time to run.  It seems nobody knows an explicit bound on its runtime.  The runtim might even grow faster than any <a href="http://en.wikipedia.org/wiki/Primitive_recursive_function">primitive recursive</a> function.  The <a href="http://en.wikipedia.org/wiki/Ackermann_function">Ackermann function</a> and the closely related <a href="http://en.wikipedia.org/wiki/Ackermann_function#Ackermann_numbers">Ackermann numbers</a> are famous examples of functions that grow more rapidly than any primitive recursive function.  If you don&#8217;t know about these, now is the time to learn!</p>
<p>Remember that we can define multiplication by iterating addition:</p>
<p><img src="https://s0.wp.com/latex.php?latex=n+%5Ctimes+m+%3D+n+%2B+n+%2B+n+%2B+%5Ccdots+%2B+n&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="n &#92;times m = n + n + n + &#92;cdots + n" class="latex" /></p>
<p>where add <img src="https://s0.wp.com/latex.php?latex=n&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="n" class="latex" /> to itself <img src="https://s0.wp.com/latex.php?latex=m&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="m" class="latex" /> times.  Then we can define exponentiation by iterating multiplication:</p>
<p><img src="https://s0.wp.com/latex.php?latex=n+%5Cuparrow+m+%3D+n+%5Ctimes+n+%5Ctimes+n+%5Ctimes+%5Ccdots+%5Ctimes+n&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="n &#92;uparrow m = n &#92;times n &#92;times n &#92;times &#92;cdots &#92;times n" class="latex" /></p>
<p>where we multiply <img src="https://s0.wp.com/latex.php?latex=n&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="n" class="latex" /> by itself <img src="https://s0.wp.com/latex.php?latex=m&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="m" class="latex" /> times.  Here I&#8217;m using Knuth&#8217;s <a href="http://en.wikipedia.org/wiki/Knuth%27s_up-arrow_notation">up-arrow notation</a>.  Then we can define <a href="http://en.wikipedia.org/wiki/Tetration">tetration</a> by iterating exponentiation:</p>
<p><img src="https://s0.wp.com/latex.php?latex=n+%5Cuparrow%5E2+m+%3D+n+%5Cuparrow+%28n+%5Cuparrow+%28n+%5Cuparrow+%5Ccdots+%5Cuparrow+n%29%29%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="n &#92;uparrow^2 m = n &#92;uparrow (n &#92;uparrow (n &#92;uparrow &#92;cdots &#92;uparrow n)))" class="latex" /></p>
<p>Then we can define an operation <img src="https://s0.wp.com/latex.php?latex=%5Cuparrow%5E3&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;uparrow^3" class="latex" /> by iterating tetration, and so on.  All these functions are primitive recursive.  But the <img src="https://s0.wp.com/latex.php?latex=n&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="n" class="latex" />th <b>Ackermann number</b> is not; it&#8217;s defined to be</p>
<p><img src="https://s0.wp.com/latex.php?latex=n+%5Cuparrow%5En+n&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="n &#92;uparrow^n n" class="latex" /></p>
<p>This grows at an <i>insanely</i> rapid rate:</p>
<p><img src="https://s0.wp.com/latex.php?latex=1+%5Cuparrow+1+%3D+1&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="1 &#92;uparrow 1 = 1" class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=2+%5Cuparrow%5E2+2+%3D+4+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="2 &#92;uparrow^2 2 = 4 " class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=3+%5Cuparrow%5E3+3+%3D+3%5E%7B3%5E%7B3%5E%7B.%5E%7B.%5E%7B.%7D%7D%7D%7D%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="3 &#92;uparrow^3 3 = 3^{3^{3^{.^{.^{.}}}}}" class="latex" /></p>
<p>where we have a stack of <img src="https://s0.wp.com/latex.php?latex=3%5E%7B3%5E3%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="3^{3^3}" class="latex" /> threes&#8212;or in other words, <img src="https://s0.wp.com/latex.php?latex=3%5E%7B7625597484987%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="3^{7625597484987}" class="latex" /> threes!  When we get to <img src="https://s0.wp.com/latex.php?latex=4+%5Cuparrow%5E4+4%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="4 &#92;uparrow^4 4," class="latex" /> my mind boggles.  I wish it didn&#8217;t, but it does.</p>
<p>In 1998 someone came up with a faster algorithm: </p>
<p>&bull; Zakaria Bouziane, <a href="http://hal.inria.fr/inria-00073286/PDF/RR-3404.pdf">A primitive recursive algorithm for the general Petri net reachability problem</a>, in <i>39th Annual Symposium on Foundations of Computer Science</i>, IEEE, 1998, pp. 130-136.</p>
<p>Bouziane claimed this algorithm is doubly exponential in space and time.  That&#8217;s very slow, but not <i>insanely</i> slow.</p>
<p>However, it seems that Bouziane made a mistake:</p>
<p>&bull; Petr Jančar, Bouziane’s transformation of the Petri net reachability problem and incorrectness of the related algorithm, <a href="http://dx.doi.org/10.1016/j.ic.2008.06.003" rel="nofollow"><i>Information and Computation</i></a>, <b>206</b> (2008), 1259&#8211;1263.</p>
<p>So: if I tell you some chemicals and a bunch of reactions involving these chemicals, you can decide when some combination of these chemicals can turn into another combination.  But it may take a long time to decide this.  And we don&#8217;t know exactly how long: just more than &#8216;exponentially long&#8217;!</p>
<p>What about the connection to Presburger arithmetic?  This title suggests that it exists:</p>
<p>&bull; J&eacute;rôme Leroux, <a href="http://hal.inria.fr/docs/00/31/93/93/PDF/main.pdf">The general vector addition system reachability problem by Presburger inductive separators</a>, 2008.</p>
<p>But I don&#8217;t understand the paper well enough to be sure.  Can someone say more?  </p>
<p>Also, does anyone know more about the computational power of Petri nets?  They&#8217;re not universal computers, but is there a good way to say how powerful they are?  Does the fact that it takes a long time to settle the reachability question really imply that they have a lot of computational power?  </p>
<h3> Symmetric monoidal categories </h3>
<p>Next let me explain the secret reason I&#8217;m so fascinated by this.  This section is mainly for people who like category theory.</p>
<p>As I mentioned once before, a Petri net is actually nothing but a presentation of a <a href="http://en.wikipedia.org/wiki/Braided_monoidal_category#Symmetric_monoidal_categories">symmetric monoidal category</a> that&#8217;s free on some set of objects and some set of morphisms going between tensor products of those objects:</p>
<p>&bull; <a href="http://www.ecs.soton.ac.uk/people/vs">Vladimiro Sassone</a>, <a href="http://eprints.ecs.soton.ac.uk/11951/1/strong-conf.pdf">On the category of Petri net computations</a>, <i>6th International Conference on Theory and Practice of Software Development</i>, Proceedings of TAPSOFT &#8217;95, Lecture Notes in Computer Science <b>915</b>, Springer, Berlin, pp. 334-348.</p>
<p>In chemistry we write the tensor product additively, but we could also write it as <img src="https://s0.wp.com/latex.php?latex=%5Cotimes&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;otimes" class="latex" />.  Then the reachability problem consists of questions of this general type:</p>
<blockquote><p>
Suppose we have a symmetric monoidal category freely generated by objects <img src="https://s0.wp.com/latex.php?latex=A%2C+B%2C+C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A, B, C" class="latex" /> and morphisms</p>
<p><img src="https://s0.wp.com/latex.php?latex=e%3A+A+%5Cto+B+%5Cotimes+C+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="e: A &#92;to B &#92;otimes C " class="latex" /> </p>
<p><img src="https://s0.wp.com/latex.php?latex=f%3A+A+%5Cotimes+A+%5Cotimes+B+%5Cto+A+%5Cotimes+C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="f: A &#92;otimes A &#92;otimes B &#92;to A &#92;otimes C" class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=g%3A+A+%5Cotimes+B+%5Cotimes+C+%5Cto+A+%5Cotimes+B+%5Cotimes+B&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="g: A &#92;otimes B &#92;otimes C &#92;to A &#92;otimes B &#92;otimes B" class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=h+%3A+B+%5Cotimes+A+%5Cotimes+A+%5Cto+B&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="h : B &#92;otimes A &#92;otimes A &#92;to B" class="latex" /></p>
<p>Is there a morphism from <img src="https://s0.wp.com/latex.php?latex=B+%5Cotimes+A+%5Cotimes+A&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="B &#92;otimes A &#92;otimes A" class="latex" /> to <img src="https://s0.wp.com/latex.php?latex=A+%5Cotimes+A&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A &#92;otimes A" class="latex" />?
</p></blockquote>
<p>This is reminiscent of the <a href="http://en.wikipedia.org/wiki/Word_problem_for_groups">word problem for groups</a> and other problems where we are given a presentation of an algebraic structure and have to decide if two elements are equal&#8230; but now, instead of asking whether two elements are equal we are asking if there is a morphism from one object to another.  So, it is fascinating that this problem is decidable&#8212;unlike the word problem for groups&#8212;but still very hard to decide.</p>
<p>Just in case you want to see a more formal statement, let me finish off by giving you that:</p>
<p><b>Reachability problem.</b>  Given a symmetric monoidal category <img src="https://s0.wp.com/latex.php?latex=C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="C" class="latex" /> freely generated by a finite set of objects and a finite set of morphisms between tensor products of these objects, and given two objects <img src="https://s0.wp.com/latex.php?latex=x%2Cy+%5Cin+C%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x,y &#92;in C," class="latex" /> is there a morphism <img src="https://s0.wp.com/latex.php?latex=f%3A+x+%5Cto+y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="f: x &#92;to y" class="latex" />?  </p>
<p><b>Theorem (Lipton,  Mayr).</b>  There is an algorithm that decides the reachability problem.  However, for any such algorithm, for any <img src="https://s0.wp.com/latex.php?latex=c+%3E+0%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="c &gt; 0," class="latex" /> the worst-case run-time exceeds <img src="https://s0.wp.com/latex.php?latex=2%5E%7Bc+n%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="2^{c n}" class="latex" /> where <img src="https://s0.wp.com/latex.php?latex=n&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="n" class="latex" /> is the size of the problem: the sum of the number of generating objects, the number of factors in the sources and targets of all the generating morphisms, and the number of factors in the objects <img src="https://s0.wp.com/latex.php?latex=x%2Cy+%5Cin+C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x,y &#92;in C" class="latex" /> for which the reachability problem is posed.  </p>
									</div>

				<p class="postmetadata">
				<img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/speech_bubble.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2012/11/03/network-theory-part-25/#comments">17 Comments</a>				| <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/documents.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/category/chemistry/" rel="category tag">chemistry</a>, <a href="https://johncarlosbaez.wordpress.com/category/mathematics/" rel="category tag">mathematics</a>, <a href="https://johncarlosbaez.wordpress.com/category/networks/" rel="category tag">networks</a>								 | <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/permalink.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2012/11/03/network-theory-part-25/" rel="bookmark" title="Permanent Link to Network Theory (Part&nbsp;25)">Permalink</a>
<br /><img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/figure_ver1.gif" alt="" /> Posted by John Baez				</p>
			</div>
			<hr />
		
			<div class="post-12286 post type-post status-publish format-standard hentry category-azimuth category-biology category-chemistry category-networks" id="post-12286">
				<h2><a href="https://johncarlosbaez.wordpress.com/2012/09/28/azimuth-news-part-2/" rel="bookmark">Azimuth News (Part&nbsp;2)</a></h2>
				<small>28 September, 2012</small><br />


				<div class="entry">
					<p>Last week I finished a draft of a <a href="http://arxiv.org/abs/1209.3632">book</a> and left Singapore, returning to my home in Riverside, California.  It&#8217;s strange and interesting, leaving the humid tropics for the dry chaparral landscape I know so well.</p>
<div align="center"><a href="http://math.ucr.edu/home/baez/diary/january_2008.html#january7.08"><img width="440" src="https://i2.wp.com/math.ucr.edu/home/baez/diary/riverside/two_trees.jpg" /></a></div>
<p>Now I&#8217;m back to my former life as a math professor at the University of California.  I&#8217;ll be going back to the Centre for Quantum Technology next summer, and summers after that, too.  But life feels different now: a 2-year period of no teaching allowed me to change my research direction, but now it&#8217;s time to teach people what I&#8217;ve learned!  </p>
<p>It also happens to be a time when the Azimuth Project is about to do a lot of interesting things.   So, let me tell you some news!</p>
<h3> Programming with Petri nets </h3>
<p>The Azimuth Project has a bunch of new members, who are bringing with them new expertise and lots of energy.  One of them is <a href="http://www.azimuthproject.org/azimuth/show/David+Tanzer">David Tanzer</a>, who was an undergraduate math major at U. Penn, and got a Ph.D. in computer science at NYU.  Now he&#8217;s a software developer, and he lives in Brooklyn, New York.</p>
<p>He writes:</p>
<blockquote>
<p>My areas of interest include:</p>
<p>&bull; Queryable encyclopedias</p>
<p>&bull; Machine representation of scientific theories</p>
<p>&bull; Machine representation of conflicts between contending theories</p>
<p>&bull; Social and technical structures to support group problem-solving activities</p>
<p>&bull; Balkan music, Afro-Latin rhythms, and jazz guitar</p>
<p>To me, the most meaningful applications of science are to the myriad of problems that beset the human race. So the Aziumuth Project is a good focal point for me.
</p></blockquote>
<p>And on Azimuth, he&#8217;s starting to write some articles on &#8216;programming with Petri nets&#8217;.   We&#8217;ve talked about them a lot in the <a href="http://math.ucr.edu/home/baez/networks/">network theory series</a>:</p>
<div align="center"><a href="http://math.ucr.edu/home/baez/networks/networks_3.html"><img width="300" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/pictures/SIRS.png" /></a></div>
<p>They&#8217;re a very general modelling tool in chemistry, biology and computer science, precisely the sort of tool we need for a deep understanding of the complex systems that keep our living planet going&#8212;though, let&#8217;s be perfectly clear about this, just one of <i>many</i> such tools, and one of the simplest.  But as mathematical physicists, Jacob Biamonte and I have studied Petri nets in a highly theoretical way, somewhat neglecting the all-important problem of how you write programs that simulate Petri nets!</p>
<p>Such programs are commercially available, but it&#8217;s good to see how to write them yourself, and that&#8217;s what David Tanzer will tell us.  He&#8217;ll use the language <a href="http://en.wikipedia.org/wiki/Python_%28programming_language%29">Python</a> to write these programs in a nice modern object-oriented way.  So, if you like coding, this is where <a href="http://www.usingenglish.com/reference/idioms/where+the+rubber+meets+the+road.html">the rubber meets the road</a>.</p>
<p>I&#8217;m no expert on programming, but it seems the modularity of Python code nicely matches the modularity of Petri nets.  This is something I&#8217;d like to get into more deeply someday, in my own effete theoretical way.  I think the category-theoretic foundations of computer languages like Python are worth understanding, perhaps more interesting in fact than purely functional languages like Haskell, which are better understood.  And I think they&#8217;ll turn out to be nicely related to the category-theoretic foundations of Petri nets and other networks I&#8217;m going to tell you about!  </p>
<p>And I believe this will be important if we want to develop &#8216;ecotechnology&#8217;, where our machines and even our programming methodologies borrow ingenuity and wisdom from biological processes&#8230; and learn to blend with nature instead of fighting it.</p>
<h3> Petri nets, systems biology, and beyond </h3>
<p>Another new member of the Azimuth Project is <a href="http://www.azimuthproject.org/azimuth/show/Ken+Webb">Ken Webb</a>.  He has a BA in Cognitive Science from Carleton University in Ottawa, and an MSc in Evolutionary and Adaptive Systems from The University of Sussex in Brighton.  Since then he&#8217;s worked for many years as a software developer and consultant, using many different languages and approaches.  </p>
<p>He writes:</p>
<blockquote><p>
Things that I’m interested in include:</p>
<p>&bull; networks of all types, hierarchical organization of network nodes, and practical applications</p>
<p>&bull; climate change, and “saving the planet”</p>
<p>&bull; programming code that anyone can run in their browser, and that anyone can edit and extend in their browser</p>
<p>&bull; approaches to software development that allow independently-developed apps to work together</p>
<p>&bull; the relationship between computer-science object-oriented (OO) concepts and math concepts</p>
<p>&bull; how everything is connected</p>
<p>I’ve been paying attention to the Azimuth Project because it parallels my own interests, but with a more math focus (math is not one of my strong points). As learning exercises, I’ve reimplemented a few of the applications mentioned on Azimuth pages. Some of my online workbooks (blog-like entries that are my way of taking active notes) were based on content at the Azimuth Project.
</p></blockquote>
<p>He&#8217;s started building a Petri net modeling and simulation tool called Xholon.  It&#8217;s written in Java and can be run online using Java Web Start (JNLP).  Using this tool you can completely specify Petri net models using XML.  You can see more details, and examples, on <a href="http://www.azimuthproject.org/azimuth/show/Ken+Webb">his Azimuth page</a>.  If I were smarter, or had more spare time, I would have already figured out how to include examples that actually run in an interactive way in blog articles here!  But more on that later.</p>
<p>Soon I hope Ken will finish a blog entry in which he discusses how Petri nets fit into a bigger setup that can also describe &#8216;containers&#8217;, where molecules are held in &#8216;membranes&#8217; and these membranes can allow chosen molecules through, and also split or merge&#8212;more like biology than inorganic chemistry.   His outline is very ambitious:</p>
<blockquote><p>
This tutorial works through one simple example to demonstrate the commonality/continuity between a large number of different ways that people use to understand the structure and behavior of the world around us. These include chemical reaction networks, Petri nets, differential equations, agent-based modeling, mind maps, <a href="http://en.wikipedia.org/wiki/Membrane_computing">membrane computing</a>, <a href="http://en.wikipedia.org/wiki/Unified_Modeling_Language">Unified Modeling Language</a>, <a href="http://en.wikipedia.org/wiki/SBML">Systems Biology Markup Language</a>, and <a href="http://en.wikipedia.org/wiki/Systems_Biology_Graphical_Notation">Systems Biology Graphical Notation</a>. The intended audience includes scientists, engineers, programmers, and other technically literate nonexperts. No math knowledge is required.
</p></blockquote>
<div align="center"><a href="http://www.azimuthproject.org/azimuth/show/Experiments+in+bigraphs"><br />
<img width="450" src="https://i1.wp.com/www.primordion.com/Xholon/samples/BloodPlasma_5246_1347894639990.png" /></a>
</div>
<h3> The Azimuth Server </h3>
<p>With help from <a href="http://www.azimuthproject.org/azimuth/show/Glyn+Adgie">Glyn Adgie</a> and <a href="http://www.azimuthproject.org/azimuth/show/Allan+Erskine">Allan Erskine</a>, <a href="http://www.azimuthproject.org/azimuth/show/Jim+Stuttard">Jim Stuttard</a> has been setting up a server for Azimuth.   All these folks are programmers, and  Jim Stuttard, in particular, was a systems consultant and software applications programmer in C, C++ and Java until 2001.  But he&#8217;s really interested in formal methods, and now he programs in <a href="http://en.wikipedia.org/wiki/Haskell_%28programming_language%29">Haskell</a>.</p>
<p>I won&#8217;t say anything about the Azimuth server, since I&#8217;ll get it wrong, it&#8217;s not quite ready yet, and Jim wisely prefers to get it working a bit more before <i>he</i> talks about it.   But you can get a feeling for what&#8217;s coming by going <a href="http://stuttard.org/">here</a>.  </p>
<h3> How to find out more </h3>
<p>You can follow what we&#8217;re doing by visiting the <a href="http://azimuth.mathforge.org/">Azimuth Forum</a>.  Most of our conversations there are open to the world, but some can only be seen if you <a href="http://www.azimuthproject.org/azimuth/show/Forum+help">become a member</a>.  This is easy to do, except for one little thing.  </p>
<p>Nobody, <b>nobody</b> <img src="https://i0.wp.com/math.ucr.edu/home/baez/emoticons/sm_upset.gif" />, seems capable of reading the directions where I say, in boldface for easy visibility:</p>
<blockquote><p>
<b>Use your whole real name as username. Spaces and capital letters are good.</b> So, for example, a username like ‘Tim van Beek’ is good, ‘timvanbeek’ not so good, and ‘Tim’ or ‘tvb’ won’t be allowed.
</p></blockquote>
<p>The main point is that we want people involved with the Azimuth Project to have clear identities.   The second, more minor point is that our software is not braindead, so you can choose a username that&#8217;s your actual name, like </p>
<div align="center">
Tim van Beek
</div>
<p>instead of having to choose something silly like</p>
<div align="center">
timvanbeek
</div>
<p>or </p>
<div align="center">
tim_van_beek
</div>
<p>But never mind me: I&#8217;m just a crotchety old curmudgeon.   Come join the fun and help us save the planet by developing software that explains climate science, biology, and ecology&#8212;and, just maybe, speeds up the development of <a href="http://math.ucr.edu/home/baez/networks/networks_1.html">green mathematics</a> and ecotechnology!</p>
<div align="center"><a href="http://math.ucr.edu/home/baez/networks/networks_1.html"><img src="https://i0.wp.com/math.ucr.edu/home/baez/networks/leaf.jpg" alt="" /></a></div>
									</div>

				<p class="postmetadata">
				<img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/speech_bubble.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2012/09/28/azimuth-news-part-2/#comments">5 Comments</a>				| <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/documents.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/category/azimuth/" rel="category tag">azimuth</a>, <a href="https://johncarlosbaez.wordpress.com/category/biology/" rel="category tag">biology</a>, <a href="https://johncarlosbaez.wordpress.com/category/chemistry/" rel="category tag">chemistry</a>, <a href="https://johncarlosbaez.wordpress.com/category/networks/" rel="category tag">networks</a>								 | <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/permalink.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2012/09/28/azimuth-news-part-2/" rel="bookmark" title="Permanent Link to Azimuth News (Part&nbsp;2)">Permalink</a>
<br /><img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/figure_ver1.gif" alt="" /> Posted by John Baez				</p>
			</div>
			<hr />
		
			<div class="post-12243 post type-post status-publish format-standard hentry category-chemistry category-mathematics category-networks category-physics" id="post-12243">
				<h2><a href="https://johncarlosbaez.wordpress.com/2012/09/18/a-course-on-quantum-techniques-for-stochastic-mechanics/" rel="bookmark">A Course on Quantum Techniques for Stochastic&nbsp;Mechanics</a></h2>
				<small>18 September, 2012</small><br />


				<div class="entry">
					<p>Jacob Biamonte and I have come out with a draft of a book!</p>
<p>&bull; <a href="http://arxiv.org/abs/1209.3632">A course on quantum techniques for stochastic mechanics</a>.</p>
<p>It&#8217;s based on the first 24 <a href="http://math.ucr.edu/home/baez/networks/">network theory</a> posts on this blog.    It owes a lot to everyone here, and the acknowledgements just scratch the surface of that indebtedness.  At some later time I&#8217;d like to go through the posts and find the top twenty people who need to be thanked.  But I&#8217;m leaving Singapore on Friday, going back to California to teach at U.C. Riverside, so I&#8217;ve been rushing to get something out before then.</p>
<p>If you see typos or other problems, please let us know!<br />
We&#8217;ve reorganized the original blog articles and polished them up a bit, but we plan to do more before publishing these notes as a book.  </p>
<p>I&#8217;m looking forward to teaching a seminar called <i>Mathematics of the Environment</i> when I get back to U.C. Riverside, and with luck I&#8217;ll put some notes from that on the blog here.  I will also be trying to round up a team of grad students to work on network theory. </p>
<p>The next big topics in the network theory series will be electrical circuits and Bayesian networks.  I&#8217;m beginning to see how these fit together with stochastic Petri nets in a unified framework, but I&#8217;ll need to talk and write about it to fill in all the details.</p>
<p>You can get a sense of what this course is about by reading this:</p>
<h3> Foreword </h3>
<p>This course is about a curious relation between two ways of describing situations that change randomly with the passage of time.  The old way is <i>probability theory</i> and the new way is <i>quantum theory</i></p>
<p>Quantum theory is based, not on probabilities, but on amplitudes.  We can use amplitudes to compute probabilities.  However, the relation between them is nonlinear: we take the absolute value of an amplitude and square it to get a probability.  It thus seems odd to treat amplitudes as directly analogous to probabilities.  Nonetheless, if we do this, some good things happen.  In particular, we can take techniques devised in quantum theory and apply them to probability theory.  This gives new insights into old problems.   </p>
<p>There is, in fact, a subject eager to be born, which is mathematically very much like quantum mechanics, but which features probabilities in the same equations where quantum mechanics features amplitudes.  We call this subject <b>stochastic mechanics</b></p>
<h4> Plan of the course </h4>
<div align="center"><img width="440" src="https://i2.wp.com/math.ucr.edu/home/baez/networks/chemistryNetBasicA.png" /></div>
<p>In Section 1 we introduce the basic object of study here: a &#8216;stochastic Petri net&#8217;.  A stochastic Petri net describes in a very general way how collections of things of different kinds can randomly interact and turn into other things.  If we consider large numbers of things, we obtain a simplified deterministic model called the &#8216;rate equation&#8217;, discussed in Section 2.  More fundamental, however, is the &#8216;master equation&#8217;, introduced in Section 3.  This describes how the probability of having various numbers of things of various kinds changes with time.  </p>
<p>In Section 4 we consider a very simple stochastic Petri net and notice that in this case, we can solve the master equation using techniques taken from quantum mechanics.   In Section 5 we sketch how to generalize this: for any stochastic Petri net, we can write down an operator called a &#8216;Hamiltonian&#8217; built from &#8216;creation and annihilation operators&#8217;, which describes the rate of change of the probability of having various numbers of things.  In Section 6 we illustrate this with an example taken from population biology.  In this example the rate equation is just the logistic equation, one of the simplest models in population biology.  The master equation describes reproduction and competition of organisms in a stochastic way.</p>
<div align="center"><img width="300" src="https://i2.wp.com/math.ucr.edu/home/baez/networks/feynman-diagram.png" /></div>
<p>In Section 7 we sketch how time evolution as described by the master equation can be written as a sum over Feynman diagrams.  We do not develop this in detail, but illustrate it with a predator&#8211;prey model from population biology.  In the process, we give a slicker way of writing down the Hamiltonian for any stochastic Petri net.</p>
<div align="center"><img width="440" src="https://i2.wp.com/math.ucr.edu/home/baez/networks/wolf-rabbit.png" /></div>
<p>In Section 8 we enter into a main theme of this course: the study of <i>equilibrium solutions</i> of the master and rate equations.  We present the Anderson&#8211;Craciun&#8211;Kurtz theorem, which shows how to get equilibrium solutions of the master equation from equilibrium solutions of the rate equation, at least if a certain technical condition holds.  Brendan Fong has translated Anderson, Craciun and Kurtz&#8217;s original proof into the language of annihilation and creation operators, and we give Fong&#8217;s proof here.  In this language, it turns out that the equilibrium solutions are mathematically just like &#8216;coherent states&#8217; in quantum mechanics.   </p>
<p>In Section 9 we give an example of the Anderson&#8211;Craciun&#8211;Kurtz theorem coming from a simple reversible reaction in chemistry.  This example leads to a puzzle that is resolved by discovering that the presence of &#8216;conserved quantities&#8217;&#8212;quantities that do not change with time&#8212;let us construct many equilibrium solutions of the rate equation other than those given by the Anderson&#8211;Craciun&#8211;Kurtz theorem.   </p>
<p>Conserved quantities are very important in quantum mechanics, and they are related to symmetries by a result called Noether&#8217;s theorem.  In Section 10 we describe a version of Noether&#8217;s theorem for stochastic mechanics, which we proved with the help of Brendan Fong.   This applies, not just to systems described by stochastic Petri nets, but a much more general class of processes called &#8216;Markov processes&#8217;.  In the analogy to quantum mechanics, Markov processes are analogous to arbitrary quantum systems whose time evolution is given by a Hamiltonian.  Stochastic Petri nets are analogous to a special case of these: the case where the Hamiltonian is built from annihilation and creation operators.  In Section 11 we state the analogy between quantum mechanics and stochastic mechanics more precisely, and with more attention to mathematical rigor.  This allows us to set the quantum and stochastic versions of Noether&#8217;s theorem side by side and compare them in Section 12.</p>
<div align="center"><img width="440" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/pseudorotation.png" /></div>
<p>In Section 13 we take a break from the heavy abstractions and look at a fun example from chemistry, in which a highly symmetrical molecule randomly hops between states.  These states can be seen as vertices of a graph, with the transitions as edges.  In this particular example we get a famous graph with 20 vertices and 30 edges, called the &#8216;Desargues graph&#8217;.  </p>
<div align="center"><img src="https://i2.wp.com/math.ucr.edu/home/baez/networks/300px-Desargues_graph_2COL.svg.png" /></div>
<p>In Section 14 we note that the Hamiltonian in this example is a &#8216;graph Laplacian&#8217;, and, following a computation done by Greg Egan, we work out the eigenvectors and eigenvalues of this Hamiltonian explicitly.  One reason graph Laplacians are interesting is that we can use them as Hamiltonians to describe time evolution in <i>both</i> stochastic <i>and</i> quantum mechanics.  Operators with this special property are called &#8216;Dirichlet operators&#8217;, and we discuss them in Section 15.   As we explain, they also describe electrical circuits made of resistors.    Thus, in a peculiar way, the intersection of quantum mechanics and stochastic mechanics is the study of electrical circuits made of resistors!</p>
<div align="center"><img width="440" src="https://i0.wp.com/math.ucr.edu/home/baez/networks/quantum-vs-probability-theory-IV.png" /></div>
<p>In Section 16, we study the eigenvectors and eigenvalues of an arbitrary Dirichlet operator.  We introduce a famous result called the Perron&#8211;Frobenius theorem for this purpose.   However, we also see that the Perron&#8211;Frobenius theorem is important for understanding the equilibria of Markov processes.   This becomes important later when we prove the &#8216;deficiency zero theorem&#8217;.</p>
<p>We introduce the deficiency zero theorem in Section 17.  This result, proved by the chemists Feinberg, Horn and Jackson, gives equilibrium solutions for the rate equation for a large class of stochastic Petri nets.  Moreover, these equilibria obey the extra condition that lets us apply the Anderson&#8211;Craciun&#8211;Kurtz theorem and obtain equlibrium solutions of the master equations as well.  However, the deficiency zero theorem is best stated, not in terms of stochastic Petri nets, but in terms of another, equivalent, formalism: &#8216;chemical reaction networks&#8217;.  So, we explain chemical reaction networks here, and use them heavily throughout the rest of the course.  However, because they are applicable to such a large range of problems, we call them simply &#8216;reaction networks&#8217;.    Like stochastic Petri nets, they describe  how collections of things of different kinds randomly interact and turn into other things.</p>
<div align="center"><img width="200" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/chemical_reaction_network_part_20_VII.png" /></div>
<p>In Section 18 we consider a simple example of the deficiency zero theorem taken from chemistry: a diatomic gas.   In Section 19 we apply the Anderson&#8211;Craciun&#8211;Kurtz theorem to the same example.</p>
<div align="center"><img src="https://i1.wp.com/math.ucr.edu/home/baez/networks/iodine.jpg" /></div>
<p>In Section 20 we begin the final phase of the course: proving the deficiency zero theorem, or at least a portion of it.  In this section we discuss the concept of &#8216;deficiency&#8217;, which had been introduced before, but not really explained: the definition that makes the deficiency easy to compute is not the one that says what this concept really means.  In Section 21 we show how to rewrite the rate equation of a stochastic Petri net&#8212;or equivalently, of a reaction network&#8212;in terms of a Markov process.  This is surprising because the rate equation is nonlinear, while the equation describing a Markov process is linear in the probabilities involved.  The trick is to use a nonlinear operation called &#8216;matrix exponentiation&#8217;.  In Section 22 we study equilibria for Markov processes.  Then, finally, in Section 23, we use these equilbria to obtain equilibrium solutions of the rate equation, completing our treatment of the deficiency zero theorem.</p>
<div align="center"><img width="200" src="https://i2.wp.com/math.ucr.edu/home/baez/networks/markov_process_vs_reaction_network_5.png" /></div>
									</div>

				<p class="postmetadata">
				<img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/speech_bubble.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2012/09/18/a-course-on-quantum-techniques-for-stochastic-mechanics/#comments">19 Comments</a>				| <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/documents.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/category/chemistry/" rel="category tag">chemistry</a>, <a href="https://johncarlosbaez.wordpress.com/category/mathematics/" rel="category tag">mathematics</a>, <a href="https://johncarlosbaez.wordpress.com/category/networks/" rel="category tag">networks</a>, <a href="https://johncarlosbaez.wordpress.com/category/physics/" rel="category tag">physics</a>								 | <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/permalink.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2012/09/18/a-course-on-quantum-techniques-for-stochastic-mechanics/" rel="bookmark" title="Permanent Link to A Course on Quantum Techniques for Stochastic&nbsp;Mechanics">Permalink</a>
<br /><img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/figure_ver1.gif" alt="" /> Posted by John Baez				</p>
			</div>
			<hr />
		
			<div class="post-11696 post type-post status-publish format-standard hentry category-chemistry category-mathematics category-networks category-probability" id="post-11696">
				<h2><a href="https://johncarlosbaez.wordpress.com/2012/08/23/network-theory-part-24/" rel="bookmark">Network Theory (Part&nbsp;24)</a></h2>
				<small>23 August, 2012</small><br />


				<div class="entry">
					<p>Now we&#8217;ve reached the climax of our story so far: we&#8217;re ready to prove the deficiency zero theorem.  First let&#8217;s talk about it informally a bit.  Then we&#8217;ll review the notation, and then&#8212;hang on to your seat!&#8212;we&#8217;ll give the proof.</p>
<p>The crucial trick is to relate a bunch of chemical reactions, described by a &#8216;reaction network&#8217; like this:</p>
<div align="center"><img width="200" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/chemical_reaction_network_part_20_VII.png" alt="" /></div>
<p>to a simpler problem where a system randomly hops between states arranged in the same pattern:</p>
<div align="center"><img width="200" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/markov_process_vs_reaction_network_4.png" alt="" /></div>
<p>This is sort of amazing, because we&#8217;ve thrown out lots of detail.  It&#8217;s also amazing because this simpler problem is <i>linear</i>.  In the original problem, the chance that a reaction turns a B + E into a D is proportional to the number of B&#8217;s <i>times</i> the number of E&#8217;s.  That&#8217;s nonlinear!  But in the simplified problem, the chance that your system hops from state 4 to state 3 is just proportional to the probability that it&#8217;s in state 4 to begin with.  That&#8217;s linear.  </p>
<p>The wonderful thing is that, at least under some conditions, we can find <i>equilibrium</i> solutions of our original problem starting from equilibrium solutions of the simpler problem. </p>
<p>Let&#8217;s roughly sketch how it works, and where we are so far.  Our simplified problem is described by an equation like this:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bd%7D%7Bd+t%7D+%5Cpsi+%3D+H+%5Cpsi+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{d}{d t} &#92;psi = H &#92;psi } " class="latex" /></p>
<p>where <img src="https://s0.wp.com/latex.php?latex=%5Cpsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi" class="latex" /> is a function that the probability of being in each state, and <img src="https://s0.wp.com/latex.php?latex=H&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H" class="latex" /> describes the probability per time of hopping from one state to another.   We can easily understand quite a lot about the equilibrium solutions, where <img src="https://s0.wp.com/latex.php?latex=%5Cpsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi" class="latex" /> doesn&#8217;t change at all:</p>
<p><img src="https://s0.wp.com/latex.php?latex=H+%5Cpsi+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H &#92;psi = 0 " class="latex" /></p>
<p>because this is a linear equation.  We did this in <a href="http://math.ucr.edu/home/baez/networks/networks_23.html">Part 23</a>.  Of course, when I say &#8216;easily&#8217;, that&#8217;s a relative thing: we needed to use the Perron&ndash;Frobenius theorem, which Jacob introduced in <a href="http://math.ucr.edu/home/baez/networks_20.html">Part 20</a>.  But that&#8217;s a well-known theorem in linear algebra, and it&#8217;s easy to apply here.</p>
<p>In <a href="http://math.ucr.edu/home/baez/networks_22.html">Part 22</a>, we saw that the original problem was described by an equation like this, called the &#8216;rate equation&#8217;:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bd+x%7D%7Bd+t%7D+%3D+Y+H+x%5EY++%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{d x}{d t} = Y H x^Y  } " class="latex" /></p>
<p>Here <img src="https://s0.wp.com/latex.php?latex=x&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x" class="latex" /> is a vector whose entries describe the amount of each kind of chemical: the amount of A&#8217;s, the amount of B&#8217;s, and so on.  The matrix <img src="https://s0.wp.com/latex.php?latex=H&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H" class="latex" /> is the same as in the simplified problem, but <img src="https://s0.wp.com/latex.php?latex=Y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y" class="latex" /> is a matrix that says how many times each chemical shows up in each spot in our reaction network:</p>
<div align="center"><img width="200" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/chemical_reaction_network_part_20_VII.png" alt="" /></div>
<p>The key thing to notice is <img src="https://s0.wp.com/latex.php?latex=x%5EY%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x^Y," class="latex" /> where we take a vector and raise it to the power of a matrix.   We explained this operation back in <a href="http://math.ucr.edu/home/baez/networks_22.html">Part 22</a>.  It&#8217;s this operation that says how many B + E pairs we have, for example, given the number of B&#8217;s and the number of E&#8217;s.  It&#8217;s this that makes the rate equation nonlinear.  </p>
<p>Now, we&#8217;re looking for equilibrium solutions of the rate equation, where the rate of change is zero:</p>
<p><img src="https://s0.wp.com/latex.php?latex=Y+H+x%5EY+%3D+0++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y H x^Y = 0  " class="latex" /></p>
<p>But in fact we&#8217;ll do even better!  We&#8217;ll find solutions of this:</p>
<p><img src="https://s0.wp.com/latex.php?latex=H+x%5EY+%3D+0&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H x^Y = 0" class="latex" /></p>
<p>And we&#8217;ll get these by taking our solutions of this:</p>
<p><img src="https://s0.wp.com/latex.php?latex=H+%5Cpsi+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H &#92;psi = 0 " class="latex" /></p>
<p>and adjusting them so that </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cpsi+%3D+x%5EY+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi = x^Y " class="latex" /></p>
<p>while <img src="https://s0.wp.com/latex.php?latex=%5Cpsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi" class="latex" /> remains a solution of <img src="https://s0.wp.com/latex.php?latex=H+%5Cpsi+%3D+0.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H &#92;psi = 0." class="latex" />  </p>
<p>But: how do we do this &#8216;adjusting&#8217;?  That&#8217;s the crux of the whole business!  That&#8217;s what we&#8217;ll do today.  </p>
<p>Remember, <img src="https://s0.wp.com/latex.php?latex=%5Cpsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi" class="latex" /> is a function that gives a probability for each &#8216;state&#8217;, or numbered box here:</p>
<div align="center"><img width="200" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/markov_process_vs_reaction_network_4.png" alt="" /></div>
<p>The picture here consists of two pieces, called &#8216;connected components&#8217;: the piece containing boxes 0 and 1, and the piece containing boxes 2, 3 and 4.  It turns out that we can multiply <img src="https://s0.wp.com/latex.php?latex=%5Cpsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi" class="latex" /> by a function that&#8217;s constant on each connected component, and if we had <img src="https://s0.wp.com/latex.php?latex=H+%5Cpsi+%3D+0&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H &#92;psi = 0" class="latex" /> to begin with, that will still be true afterward.  The reason is that there&#8217;s no way for <img src="https://s0.wp.com/latex.php?latex=%5Cpsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi" class="latex" /> to &#8216;leak across&#8217; from one component to another.  It&#8217;s like having water in separate buckets.  You can increase the amount of water in one bucket, and decrease it another, and as long as the water&#8217;s surface remains flat in each bucket, the whole situation remains in equilibrium.</p>
<p>That&#8217;s sort of obvious.  What&#8217;s not obvious is that we can adjust <img src="https://s0.wp.com/latex.php?latex=%5Cpsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi" class="latex" /> this way so as to ensure</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cpsi+%3D+x%5EY+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi = x^Y " class="latex" /></p>
<p>for some <img src="https://s0.wp.com/latex.php?latex=x.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x." class="latex" />  </p>
<p>And indeed, it&#8217;s not always true!  It&#8217;s only true if our reaction network obeys a special condition.  It needs to have &#8216;deficiency zero&#8217;.  We defined this concept back in <a href="http://math.ucr.edu/home/baez/networks/networks_21.html">Part 21</a>, but now we&#8217;ll finally use it for something.  It turns out to be precisely the right condition to guarantee we can tweak any function on our set of states,  multiplying it by a function that&#8217;s constant on each connected component, and get a new function <img src="https://s0.wp.com/latex.php?latex=%5Cpsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi" class="latex" /> with</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cpsi+%3D+x%5EY+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi = x^Y " class="latex" /></p>
<p>When all is said and done, that is the key to the deficiency zero theorem.</p>
<h3> Review </h3>
<p>The battle is almost upon us&mdash;we&#8217;ve got one last chance to review our notation.   We start with a <b>stochastic reaction network</b>:</p>
<div align="center">
<img src="https://i2.wp.com/math.ucr.edu/home/baez/networks/reaction_network_diagram_1.png" alt="" />
</div>
<p>This consists of:</p>
<p>&bull; finite sets of <b>transitions</b> <img src="https://s0.wp.com/latex.php?latex=T%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T," class="latex" /> <b>complexes</b> <img src="https://s0.wp.com/latex.php?latex=K&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="K" class="latex" /> and <b>species</b> <img src="https://s0.wp.com/latex.php?latex=S%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S," class="latex" /></p>
<p>&bull; a map <img src="https://s0.wp.com/latex.php?latex=r%3A+T+%5Cto+%280%2C%5Cinfty%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="r: T &#92;to (0,&#92;infty)" class="latex" /> giving a <b>rate constant</b> for each transition,</p>
<p>&bull; <b>source</b> and <b>target</b> maps <img src="https://s0.wp.com/latex.php?latex=s%2Ct+%3A+T+%5Cto+K&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s,t : T &#92;to K" class="latex" /> saying where each transition starts and ends,</p>
<p>&bull; a one-to-one map <img src="https://s0.wp.com/latex.php?latex=Y+%3A+K+%5Cto+%5Cmathbb%7BN%7D%5ES&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y : K &#92;to &#92;mathbb{N}^S" class="latex" /> saying how each complex is made of species.</p>
<p>Then we extend <img src="https://s0.wp.com/latex.php?latex=s%2C+t&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s, t" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=Y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y" class="latex" /> to linear maps:</p>
<div align="center">
<img src="https://i0.wp.com/math.ucr.edu/home/baez/networks/reaction_network_diagram_6.png" /></div>
<p>Then we put inner products on these vector spaces as described <a href="http://math.ucr.edu/home/baez/networks/networks_22.html">last time</a>, which lets us &#8216;turn around&#8217; the maps <img src="https://s0.wp.com/latex.php?latex=s&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=t&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="t" class="latex" /> by taking their adjoints:</p>
<p><img src="https://s0.wp.com/latex.php?latex=s%5E%5Cdagger%2C+t%5E%5Cdagger+%3A+%5Cmathbb%7BR%7D%5EK+%5Cto+%5Cmathbb%7BR%7D%5ET+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s^&#92;dagger, t^&#92;dagger : &#92;mathbb{R}^K &#92;to &#92;mathbb{R}^T " class="latex" /></p>
<p>More surprisingly, we can &#8216;turn around&#8217; <img src="https://s0.wp.com/latex.php?latex=Y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y" class="latex" /> and get a <i>nonlinear</i> map using &#8216;matrix exponentiation&#8217;:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Barray%7D%7Bccc%7D+%5Cmathbb%7BR%7D%5ES+%26%5Cto%26+%5Cmathbb%7BR%7D%5EK+%5C%5C+++++++++++++++++++++++++++++++x+++++%26%5Cmapsto%26+++x%5EY+%5Cend%7Barray%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;begin{array}{ccc} &#92;mathbb{R}^S &amp;&#92;to&amp; &#92;mathbb{R}^K &#92;&#92;                               x     &amp;&#92;mapsto&amp;   x^Y &#92;end{array} " class="latex" /></p>
<p>This is most easily understood by thinking of <img src="https://s0.wp.com/latex.php?latex=x&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x" class="latex" /> as a row vector and <img src="https://s0.wp.com/latex.php?latex=Y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y" class="latex" /> as a matrix:</p>
<p><img src="https://i1.wp.com/math.ucr.edu/home/baez/networks/matrix_exponential.png" /></p>
<p>Remember, complexes are made out of species.   The matrix entry <img src="https://s0.wp.com/latex.php?latex=Y_%7Bi+j%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y_{i j}" class="latex" /> says how many things of the <img src="https://s0.wp.com/latex.php?latex=j&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="j" class="latex" />th species there are in a complex of the <img src="https://s0.wp.com/latex.php?latex=i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i" class="latex" />th kind.   If <img src="https://s0.wp.com/latex.php?latex=%5Cpsi+%5Cin+%5Cmathbb%7BR%7D%5EK&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi &#92;in &#92;mathbb{R}^K" class="latex" /> says how many complexes there are of each kind, <img src="https://s0.wp.com/latex.php?latex=Y+%5Cpsi+%5Cin+%5Cmathbb%7BR%7D%5ES&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y &#92;psi &#92;in &#92;mathbb{R}^S" class="latex" /> says how many things there are of each species.  Conversely, if <img src="https://s0.wp.com/latex.php?latex=x+%5Cin+%5Cmathbb%7BR%7D%5ES&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x &#92;in &#92;mathbb{R}^S" class="latex" /> says how many things there are of each species, <img src="https://s0.wp.com/latex.php?latex=x%5EY+%5Cin+%5Cmathbb%7BR%7D%5EK&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x^Y &#92;in &#92;mathbb{R}^K" class="latex" /> says how many ways we can build each kind of complex from them.</p>
<p>So, we get these maps:</p>
<div align="center">
<img src="https://i0.wp.com/math.ucr.edu/home/baez/networks/reaction_network_diagram_7.png" /></div>
<p>Next, the <b>boundary operator</b> </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cpartial+%3A+%5Cmathbb%7BR%7D%5ET+%5Cto+%5Cmathbb%7BR%7D%5EK+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;partial : &#92;mathbb{R}^T &#92;to &#92;mathbb{R}^K " class="latex" /> </p>
<p>describes how each transition causes a change in complexes:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cpartial+%3D+t+-+s+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;partial = t - s " class="latex" /></p>
<p>As we saw <a href="http://math.ucr.edu/home/baez/networks/networks_24.html">last time</a>, there is a <b>Hamiltonian</b> </p>
<p><img src="https://s0.wp.com/latex.php?latex=H+%3A+%5Cmathbb%7BR%7D%5EK+%5Cto+%5Cmathbb%7BR%7D%5EK+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H : &#92;mathbb{R}^K &#92;to &#92;mathbb{R}^K " class="latex" /></p>
<p>describing a Markov processes on the set of complexes, given by</p>
<p><img src="https://s0.wp.com/latex.php?latex=H+%3D+%5Cpartial+s%5E%5Cdagger+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H = &#92;partial s^&#92;dagger " class="latex" /></p>
<p>But the star of the show is the rate equation.  This describes how the number of things of each species changes with time.  We write these numbers in a list and get a vector <img src="https://s0.wp.com/latex.php?latex=x+%5Cin+%5Cmathbb%7BR%7D%5ES&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x &#92;in &#92;mathbb{R}^S" class="latex" /> with nonnegative components.  The <b>rate equation</b> says:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bd+x%7D%7Bd+t%7D+%3D+Y+H+x%5EY+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{d x}{d t} = Y H x^Y } " class="latex" /></p>
<p>We can read this as follows:</p>
<p>&bull; <img src="https://s0.wp.com/latex.php?latex=x&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x" class="latex" /> says how many things of each species we have now.</p>
<p>&bull; <img src="https://s0.wp.com/latex.php?latex=x%5EY&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x^Y" class="latex" /> says how many complexes of each kind we can build from these species. </p>
<p>&bull; <img src="https://s0.wp.com/latex.php?latex=s%5E%5Cdagger+x%5EY&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s^&#92;dagger x^Y" class="latex" /> says how many transitions of each kind can originate starting from these complexes, with each transition weighted by its rate.</p>
<p>&bull; <img src="https://s0.wp.com/latex.php?latex=H+x%5EY+%3D+%5Cpartial+s%5E%5Cdagger+x%5EY&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H x^Y = &#92;partial s^&#92;dagger x^Y" class="latex" /> is the rate of change of the number of complexes of each kind, due to these transitions.  </p>
<p>&bull; <img src="https://s0.wp.com/latex.php?latex=Y+H+x%5EY&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y H x^Y" class="latex" /> is the rate of change of the number of things of each species.</p>
<h3> The zero deficiency theorem </h3>
<p>We are looking for <b>equilibrium solutions</b> of the rate equation, where the number of things of each species doesn&#8217;t change at all:</p>
<p><img src="https://s0.wp.com/latex.php?latex=Y+H+x%5EY+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y H x^Y = 0 " class="latex" /></p>
<p>In fact we will find <b>complex balanced</b> equilibrium solutions, where even the number of complexes of each kind doesn&#8217;t change:</p>
<p><img src="https://s0.wp.com/latex.php?latex=H+x%5EY+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H x^Y = 0 " class="latex" /></p>
<p>More precisely, we have:</p>
<p><b>Deficiency Zero Theorem (Child&#8217;s Version).</b>   Suppose we have a reaction network obeying these two conditions:</p>
<p>1. It is <b>weakly reversible</b>, meaning that whenever there&#8217;s a transition from one complex <img src="https://s0.wp.com/latex.php?latex=%5Ckappa&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;kappa" class="latex" /> to another <img src="https://s0.wp.com/latex.php?latex=%5Ckappa%27%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;kappa&#039;," class="latex" /> there&#8217;s a directed path of transitions going back from <img src="https://s0.wp.com/latex.php?latex=%5Ckappa%27&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;kappa&#039;" class="latex" /> to <img src="https://s0.wp.com/latex.php?latex=%5Ckappa.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;kappa." class="latex" /></p>
<p>2.  It has <b>deficiency zero</b>, meaning <img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bim%7D+%5Cpartial++%5Ccap+%5Cmathrm%7Bker%7D+Y+%3D+%5C%7B+0+%5C%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{im} &#92;partial  &#92;cap &#92;mathrm{ker} Y = &#92;{ 0 &#92;} " class="latex" />.</p>
<p>Then for any choice of rate constants there exists a complex balanced equilibrium solution of the rate equation where all species are present in nonzero amounts.  In other words, there exists <img src="https://s0.wp.com/latex.php?latex=x+%5Cin+%5Cmathbb%7BR%7D%5ES&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x &#92;in &#92;mathbb{R}^S" class="latex" /> with all components positive and such that:</p>
<p><img src="https://s0.wp.com/latex.php?latex=H+x%5EY+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H x^Y = 0 " class="latex" /></p>
<p><b>Proof.</b> Because our reaction network is weakly reversible, the theorems in <a href="http://math.ucr.edu/home/baez/networks/networks_23.html">Part 23</a> show there exists <img src="https://s0.wp.com/latex.php?latex=%5Cpsi+%5Cin+%280%2C%5Cinfty%29%5EK&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi &#92;in (0,&#92;infty)^K" class="latex" /> with </p>
<p><img src="https://s0.wp.com/latex.php?latex=H+%5Cpsi+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H &#92;psi = 0 " class="latex" /></p>
<p>This <img src="https://s0.wp.com/latex.php?latex=%5Cpsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi" class="latex" /> may not be of the form <img src="https://s0.wp.com/latex.php?latex=x%5EY%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x^Y," class="latex" /> but we shall adjust <img src="https://s0.wp.com/latex.php?latex=%5Cpsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi" class="latex" /> so that it becomes of this form, while still remaining a solution of <img src="https://s0.wp.com/latex.php?latex=H+%5Cpsi+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H &#92;psi = 0 " class="latex" />latex .   To do this, we need a couple of lemmas:</p>
<p><b>Lemma 1.</b> <img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bker%7D+%5Cpartial%5E%5Cdagger+%2B+%5Cmathrm%7Bim%7D+Y%5E%5Cdagger+%3D+%5Cmathbb%7BR%7D%5EK.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{ker} &#92;partial^&#92;dagger + &#92;mathrm{im} Y^&#92;dagger = &#92;mathbb{R}^K." class="latex" /> </p>
<p><b>Proof.</b>  We need to use a few facts from linear algebra.  If <img src="https://s0.wp.com/latex.php?latex=V&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="V" class="latex" /> is a finite-dimensional vector space with inner product, the <b><a href="http://en.wikipedia.org/wiki/Orthogonal_complement">orthogonal complement</a></b> <img src="https://s0.wp.com/latex.php?latex=L%5E%5Cperp&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="L^&#92;perp" class="latex" /> of a subspace <img src="https://s0.wp.com/latex.php?latex=L+%5Csubseteq+V&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="L &#92;subseteq V" class="latex" /> consists of vectors that are orthogonal to everything in <img src="https://s0.wp.com/latex.php?latex=L&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="L" class="latex" />:</p>
<p><img src="https://s0.wp.com/latex.php?latex=L%5E%5Cperp+%3D+%5C%7B+v+%5Cin+V+%3A+%5Cquad+%5Cforall+w+%5Cin+L+%5Cquad+%5Clangle+v%2C+w+%5Crangle+%3D+0+%5C%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="L^&#92;perp = &#92;{ v &#92;in V : &#92;quad &#92;forall w &#92;in L &#92;quad &#92;langle v, w &#92;rangle = 0 &#92;} " class="latex" /></p>
<p>We have</p>
<p><img src="https://s0.wp.com/latex.php?latex=%28L+%5Ccap+M%29%5E%5Cperp+%3D+L%5E%5Cperp+%2B+M%5E%5Cperp++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(L &#92;cap M)^&#92;perp = L^&#92;perp + M^&#92;perp  " class="latex" /></p>
<p>where <img src="https://s0.wp.com/latex.php?latex=L&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="L" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=M&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="M" class="latex" /> are subspaces of <img src="https://s0.wp.com/latex.php?latex=V&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="V" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=%2B&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="+" class="latex" /> denotes the sum of two subspaces: that is, the smallest subspace containing both.  Also, if <img src="https://s0.wp.com/latex.php?latex=T%3A+V+%5Cto+W&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T: V &#92;to W" class="latex" /> is a linear map between finite-dimensional vector spaces with inner product, we have</p>
<p><img src="https://s0.wp.com/latex.php?latex=%28%5Cmathrm%7Bker%7D+T%29%5E%5Cperp+%3D+%5Cmathrm%7Bim%7D+T%5E%5Cdagger+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(&#92;mathrm{ker} T)^&#92;perp = &#92;mathrm{im} T^&#92;dagger " class="latex" /></p>
<p>and</p>
<p><img src="https://s0.wp.com/latex.php?latex=%28%5Cmathrm%7Bim%7D+T%29%5E%5Cperp+%3D+%5Cmathrm%7Bker%7D+T%5E%5Cdagger+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(&#92;mathrm{im} T)^&#92;perp = &#92;mathrm{ker} T^&#92;dagger " class="latex" /></p>
<p>Now, because our reaction network has deficiency zero, we know that</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bim%7D+%5Cpartial+%5Ccap+%5Cmathrm%7Bker%7D+Y+%3D+%5C%7B+0+%5C%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{im} &#92;partial &#92;cap &#92;mathrm{ker} Y = &#92;{ 0 &#92;} " class="latex" /></p>
<p>Taking the orthogonal complement of both sides, we get</p>
<p><img src="https://s0.wp.com/latex.php?latex=%28%5Cmathrm%7Bim%7D+%5Cpartial+%5Ccap+%5Cmathrm%7Bker%7D+Y%29%5E%5Cperp+%3D+%5Cmathbb%7BR%7D%5EK+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(&#92;mathrm{im} &#92;partial &#92;cap &#92;mathrm{ker} Y)^&#92;perp = &#92;mathbb{R}^K " class="latex" /></p>
<p>and using the rules we mentioned, we obtain</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bker%7D+%5Cpartial%5E%5Cdagger+%2B+%5Cmathrm%7Bim%7D+Y%5E%5Cdagger+%3D+%5Cmathbb%7BR%7D%5EK+++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{ker} &#92;partial^&#92;dagger + &#92;mathrm{im} Y^&#92;dagger = &#92;mathbb{R}^K   " class="latex" /></p>
<p>as desired.   &nbsp;  &#9608;</p>
<p>Now, given a vector <img src="https://s0.wp.com/latex.php?latex=%5Cphi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;phi" class="latex" /> in <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5EK&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^K" class="latex" /> or <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5ES&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^S" class="latex" /> with all positive components, we can define the <b>logarithm</b> of such a vector, component-wise:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%28%5Cln+%5Cphi%29_i+%3D+%5Cln+%28%5Cphi_i%29+++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(&#92;ln &#92;phi)_i = &#92;ln (&#92;phi_i)   " class="latex" /></p>
<p>Similarly, for any vector <img src="https://s0.wp.com/latex.php?latex=%5Cphi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;phi" class="latex" /> in either of these spaces, we can define its <b>exponential</b> in a component-wise way:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%28%5Cexp+%5Cphi%29_i+%3D+%5Cexp%28%5Cphi_i%29++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(&#92;exp &#92;phi)_i = &#92;exp(&#92;phi_i)  " class="latex" /></p>
<p>These operations are inverse to each other.  Moreover:</p>
<p><b>Lemma 2.</b>  The nonlinear operator </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Barray%7D%7Bccc%7D+%5Cmathbb%7BR%7D%5ES+%26%5Cto%26+%5Cmathbb%7BR%7D%5EK+%5C%5C+++++++++++++++++++++++++++++++x+++++%26%5Cmapsto%26+++x%5EY+%5Cend%7Barray%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;begin{array}{ccc} &#92;mathbb{R}^S &amp;&#92;to&amp; &#92;mathbb{R}^K &#92;&#92;                               x     &amp;&#92;mapsto&amp;   x^Y &#92;end{array} " class="latex" /></p>
<p>is related to the linear operator</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Barray%7D%7Bccc%7D+%5Cmathbb%7BR%7D%5ES+%26%5Cto%26+%5Cmathbb%7BR%7D%5EK+%5C%5C+++++++++++++++++++++++++++++++x+++++%26%5Cmapsto%26+++Y%5E%5Cdagger+x+%5Cend%7Barray%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;begin{array}{ccc} &#92;mathbb{R}^S &amp;&#92;to&amp; &#92;mathbb{R}^K &#92;&#92;                               x     &amp;&#92;mapsto&amp;   Y^&#92;dagger x &#92;end{array} " class="latex" /></p>
<p>by the formula </p>
<p><img src="https://s0.wp.com/latex.php?latex=x%5EY+%3D+%5Cexp%28Y%5E%5Cdagger+%5Cln+x+%29+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x^Y = &#92;exp(Y^&#92;dagger &#92;ln x ) " class="latex" /></p>
<p>which holds for all <img src="https://s0.wp.com/latex.php?latex=x+%5Cin+%280%2C%5Cinfty%29%5ES.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x &#92;in (0,&#92;infty)^S." class="latex" />  </p>
<p><b>Proof.</b>  A straightforward calculation.  By the way, this formula would look a bit nicer if we treated <img src="https://s0.wp.com/latex.php?latex=%5Cln+x&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;ln x" class="latex" /> as a row vector and multiplied it on the right by <img src="https://s0.wp.com/latex.php?latex=Y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y" class="latex" />: then we would have</p>
<p><img src="https://s0.wp.com/latex.php?latex=x%5EY+%3D+%5Cexp%28%28%5Cln+x%29+Y%29+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x^Y = &#92;exp((&#92;ln x) Y) " class="latex" /></p>
<p>The problem is that we are following the usual convention of multiplying vectors by matrices on the left, yet writing the matrix on the right in <img src="https://s0.wp.com/latex.php?latex=x%5EY.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x^Y." class="latex" />  Taking the transpose <img src="https://s0.wp.com/latex.php?latex=Y%5E%5Cdagger&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y^&#92;dagger" class="latex" /> of the matrix <img src="https://s0.wp.com/latex.php?latex=Y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y" class="latex" /> serves to compensate for this.  &nbsp;  &#9608;</p>
<p>Now, given our vector <img src="https://s0.wp.com/latex.php?latex=%5Cpsi+%5Cin+%280%2C%5Cinfty%29%5EK&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi &#92;in (0,&#92;infty)^K" class="latex" /> with <img src="https://s0.wp.com/latex.php?latex=H+%5Cpsi+%3D+0%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H &#92;psi = 0," class="latex" /> we can take its logarithm and get <img src="https://s0.wp.com/latex.php?latex=%5Cln+%5Cpsi+%5Cin+%5Cmathbb%7BR%7D%5EK.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;ln &#92;psi &#92;in &#92;mathbb{R}^K." class="latex" />   Lemma 1 says that</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5EK+%3D+%5Cmathrm%7Bker%7D+%5Cpartial%5E%5Cdagger+%2B+%5Cmathrm%7Bim%7D+Y%5E%5Cdagger+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^K = &#92;mathrm{ker} &#92;partial^&#92;dagger + &#92;mathrm{im} Y^&#92;dagger " class="latex" /></p>
<p>so we can write</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cln+%5Cpsi+%3D++%5Calpha+%2B+Y%5E%5Cdagger+%5Cbeta+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;ln &#92;psi =  &#92;alpha + Y^&#92;dagger &#92;beta " class="latex" /></p>
<p>where <img src="https://s0.wp.com/latex.php?latex=%5Calpha+%5Cin+%5Cmathrm%7Bker%7D+%5Cpartial%5E%5Cdagger&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;alpha &#92;in &#92;mathrm{ker} &#92;partial^&#92;dagger" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=%5Cbeta+%5Cin+%5Cmathbb%7BR%7D%5ES.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;beta &#92;in &#92;mathbb{R}^S." class="latex" />  Moreover, we can write</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cbeta+%3D+%5Cln+x+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;beta = &#92;ln x " class="latex" /></p>
<p>for some <img src="https://s0.wp.com/latex.php?latex=x+%5Cin+%280%2C%5Cinfty%29%5ES%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x &#92;in (0,&#92;infty)^S," class="latex" /> so that</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cln+%5Cpsi+%3D+%5Calpha+%2B+Y%5E%5Cdagger+%28%5Cln+x%29+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;ln &#92;psi = &#92;alpha + Y^&#92;dagger (&#92;ln x) " class="latex" /></p>
<p>Exponentiating both sides component-wise, we get</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cpsi++%3D+++%5Cexp%28%5Calpha%29+%5C%3B+%5Cexp%28Y%5E%5Cdagger+%28%5Cln+x%29%29+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi  =   &#92;exp(&#92;alpha) &#92;; &#92;exp(Y^&#92;dagger (&#92;ln x)) " class="latex" /></p>
<p>where at right we are taking the component-wise product of vectors.  Thanks to Lemma 2, we conclude that</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cpsi+%3D+%5Cexp%28%5Calpha%29+x%5EY+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi = &#92;exp(&#92;alpha) x^Y " class="latex" /></p>
<p>So, we have taken <img src="https://s0.wp.com/latex.php?latex=%5Cpsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi" class="latex" /> and <i>almost</i> written it in the form <img src="https://s0.wp.com/latex.php?latex=x%5EY&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x^Y" class="latex" />&#8212;but not quite!  We can adjust <img src="https://s0.wp.com/latex.php?latex=%5Cpsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi" class="latex" /> to make it be of this form:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cexp%28-%5Calpha%29+%5Cpsi+%3D+x%5EY+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;exp(-&#92;alpha) &#92;psi = x^Y " class="latex" /></p>
<p>Clearly all the components of <img src="https://s0.wp.com/latex.php?latex=%5Cexp%28-%5Calpha%29+%5Cpsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;exp(-&#92;alpha) &#92;psi" class="latex" /> are positive, since the same is true for both <img src="https://s0.wp.com/latex.php?latex=%5Cpsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=%5Cexp%28-%5Calpha%29.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;exp(-&#92;alpha)." class="latex" />  So, the only remaining task is to check that </p>
<p><img src="https://s0.wp.com/latex.php?latex=H%28%5Cexp%28-%5Calpha%29+%5Cpsi%29+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H(&#92;exp(-&#92;alpha) &#92;psi) = 0 " class="latex" /></p>
<p>We do this using two lemmas:</p>
<p><b>Lemma 3.</b>    If <img src="https://s0.wp.com/latex.php?latex=H+%5Cpsi+%3D+0&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H &#92;psi = 0" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=%5Calpha+%5Cin+%5Cmathrm%7Bker%7D+%5Cpartial%5E%5Cdagger%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;alpha &#92;in &#92;mathrm{ker} &#92;partial^&#92;dagger," class="latex" /> then <img src="https://s0.wp.com/latex.php?latex=H%28%5Cexp%28-%5Calpha%29+%5Cpsi%29+%3D+0.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H(&#92;exp(-&#92;alpha) &#92;psi) = 0." class="latex" /> </p>
<p><b>Proof.</b>  It is enough to check that multiplication by <img src="https://s0.wp.com/latex.php?latex=%5Cexp%28-%5Calpha%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;exp(-&#92;alpha)" class="latex" /> commutes with the Hamiltonian <img src="https://s0.wp.com/latex.php?latex=H%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H," class="latex" /> since then</p>
<p><img src="https://s0.wp.com/latex.php?latex=H%28%5Cexp%28-%5Calpha%29+%5Cpsi%29+%3D+%5Cexp%28-%5Calpha%29+H+%5Cpsi+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H(&#92;exp(-&#92;alpha) &#92;psi) = &#92;exp(-&#92;alpha) H &#92;psi = 0 " class="latex" /></p>
<p>Recall from <a href="http://math.ucr.edu/home/baez/networks/networks_23.html">Part 23</a> that <img src="https://s0.wp.com/latex.php?latex=H&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H" class="latex" /> is the Hamiltonian of a Markov process associated to this &#8216;graph with rates&#8217;:</p>
<div align="center"><img src="https://i1.wp.com/math.ucr.edu/home/baez/networks/markov_process_diagram_1.png" /></div>
<p>As noted here:</p>
<p>&bull; John Baez and Brendan Fong, <a href="http://arxiv.org/abs/1203.2035">A Noether theorem for Markov processes</a>.</p>
<p>multiplication by some function on <img src="https://s0.wp.com/latex.php?latex=K&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="K" class="latex" /> commutes with <img src="https://s0.wp.com/latex.php?latex=H&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H" class="latex" /> if and only if that function is constant on each connected component of this graph.   Such functions are called <b>conserved quantities</b>.  </p>
<p>So, it suffices to show that <img src="https://s0.wp.com/latex.php?latex=%5Cexp%28-%5Calpha%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;exp(-&#92;alpha)" class="latex" /> is constant on each connected component.   For this, it is enough to show that <img src="https://s0.wp.com/latex.php?latex=%5Calpha&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;alpha" class="latex" /> itself is constant on each connected component.  But this will follow from the next lemma, since <img src="https://s0.wp.com/latex.php?latex=%5Calpha+%5Cin+%5Cmathrm%7Bker%7D+%5Cpartial%5E%5Cdagger.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;alpha &#92;in &#92;mathrm{ker} &#92;partial^&#92;dagger." class="latex" />  &nbsp;  &#9608;</p>
<p><b>Lemma 4.</b>  A function <img src="https://s0.wp.com/latex.php?latex=%5Calpha+%5Cin+%5Cmathbb%7BR%7D%5EK&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;alpha &#92;in &#92;mathbb{R}^K" class="latex" /> is a conserved quantity iff <img src="https://s0.wp.com/latex.php?latex=%5Cpartial%5E%5Cdagger+%5Calpha+%3D+0+.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;partial^&#92;dagger &#92;alpha = 0 ." class="latex" />   In other words, <img src="https://s0.wp.com/latex.php?latex=%5Calpha&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;alpha" class="latex" /> is constant on each connected component of the graph <img src="https://s0.wp.com/latex.php?latex=s%2C+t%3A+T+%5Cto+K&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s, t: T &#92;to K" class="latex" /> iff <img src="https://s0.wp.com/latex.php?latex=%5Cpartial%5E%5Cdagger+%5Calpha+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;partial^&#92;dagger &#92;alpha = 0 " class="latex" />.</p>
<p><b>Proof.</b>  Suppose <img src="https://s0.wp.com/latex.php?latex=%5Cpartial%5E%5Cdagger+%5Calpha+%3D+0%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;partial^&#92;dagger &#92;alpha = 0," class="latex" /> or in other words, <img src="https://s0.wp.com/latex.php?latex=%5Calpha+%5Cin+%5Cmathrm%7Bker%7D+%5Cpartial%5E%5Cdagger%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;alpha &#92;in &#92;mathrm{ker} &#92;partial^&#92;dagger," class="latex" /> or in still other words, <img src="https://s0.wp.com/latex.php?latex=%5Calpha+%5Cin+%28%5Cmathrm%7Bim%7D+%5Cpartial%29%5E%5Cperp.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;alpha &#92;in (&#92;mathrm{im} &#92;partial)^&#92;perp." class="latex" />  To show that <img src="https://s0.wp.com/latex.php?latex=%5Calpha&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;alpha" class="latex" /> is constant on each connected component, it suffices to show that whenever we have two complexes connected by a transition, like this:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Ctau%3A+%5Ckappa+%5Cto+%5Ckappa%27+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau: &#92;kappa &#92;to &#92;kappa&#039; " class="latex" /></p>
<p>then <img src="https://s0.wp.com/latex.php?latex=%5Calpha&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;alpha" class="latex" /> takes the same value at both these complexes:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Calpha_%5Ckappa+%3D+%5Calpha_%7B%5Ckappa%27%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;alpha_&#92;kappa = &#92;alpha_{&#92;kappa&#039;} " class="latex" /></p>
<p>To see this, note</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cpartial+%5Ctau+%3D+t%28%5Ctau%29+-+s%28%5Ctau%29+%3D+%5Ckappa%27+-+%5Ckappa+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;partial &#92;tau = t(&#92;tau) - s(&#92;tau) = &#92;kappa&#039; - &#92;kappa " class="latex" /></p>
<p>and since <img src="https://s0.wp.com/latex.php?latex=%5Calpha+%5Cin+%28%5Cmathrm%7Bim%7D+%5Cpartial%29%5E%5Cperp%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;alpha &#92;in (&#92;mathrm{im} &#92;partial)^&#92;perp," class="latex" /> we conclude</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Clangle+%5Calpha%2C+%5Ckappa%27+-+%5Ckappa+%5Crangle+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;langle &#92;alpha, &#92;kappa&#039; - &#92;kappa &#92;rangle = 0 " class="latex" /></p>
<p>But calculating this inner product, we see</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Calpha_%7B%5Ckappa%27%7D+-+%5Calpha_%7B%5Ckappa%7D+%3D+0++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;alpha_{&#92;kappa&#039;} - &#92;alpha_{&#92;kappa} = 0  " class="latex" /></p>
<p>as desired.  </p>
<p>For the converse, we simply turn the argument around: if <img src="https://s0.wp.com/latex.php?latex=%5Calpha&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;alpha" class="latex" /> is constant on each connected component, we see <img src="https://s0.wp.com/latex.php?latex=%5Clangle+%5Calpha%2C+%5Ckappa%27+-+%5Ckappa+%5Crangle+%3D+0&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;langle &#92;alpha, &#92;kappa&#039; - &#92;kappa &#92;rangle = 0" class="latex" /> whenever there is a transition <img src="https://s0.wp.com/latex.php?latex=%5Ctau+%3A+%5Ckappa+%5Cto+%5Ckappa%27.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau : &#92;kappa &#92;to &#92;kappa&#039;." class="latex" />  It follows that <img src="https://s0.wp.com/latex.php?latex=%5Clangle+%5Calpha%2C+%5Cpartial+%5Ctau+%5Crangle+%3D+0&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;langle &#92;alpha, &#92;partial &#92;tau &#92;rangle = 0" class="latex" /> for every transition <img src="https://s0.wp.com/latex.php?latex=%5Ctau%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau," class="latex" /> so <img src="https://s0.wp.com/latex.php?latex=%5Calpha+%5Cin+%28%5Cmathrm%7Bim%7D+%5Cpartial%29%5E%5Cperp+.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;alpha &#92;in (&#92;mathrm{im} &#92;partial)^&#92;perp ." class="latex" /></p>
<p>And thus concludes the proof of the lemma!   &nbsp;  &#9608;</p>
<p>And thus concludes the proof of the theorem!   &nbsp;  &#9608;</p>
<p>And thus concludes this post!   </p>
									</div>

				<p class="postmetadata">
				<img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/speech_bubble.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2012/08/23/network-theory-part-24/#comments">6 Comments</a>				| <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/documents.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/category/chemistry/" rel="category tag">chemistry</a>, <a href="https://johncarlosbaez.wordpress.com/category/mathematics/" rel="category tag">mathematics</a>, <a href="https://johncarlosbaez.wordpress.com/category/networks/" rel="category tag">networks</a>, <a href="https://johncarlosbaez.wordpress.com/category/probability/" rel="category tag">probability</a>								 | <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/permalink.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2012/08/23/network-theory-part-24/" rel="bookmark" title="Permanent Link to Network Theory (Part&nbsp;24)">Permalink</a>
<br /><img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/figure_ver1.gif" alt="" /> Posted by John Baez				</p>
			</div>
			<hr />
		
		<div class="navigation">
			<div class="alignleft"><a href="https://johncarlosbaez.wordpress.com/category/chemistry/page/7/" >&laquo; Previous Entries</a></div>
			<div class="alignright"><a href="https://johncarlosbaez.wordpress.com/category/chemistry/page/5/" >Next Entries &raquo;</a></div>
		</div>

	
	</div>

	<div id="sidebar">
				<ul>

		 <li>

				<p>You are currently browsing the archives for the chemistry category.</p>

					</li> 
		<li id="recent-posts-3" class="widget widget_recent_entries">
		<h2 class="widgettitle">latest posts:</h2>

		<ul>
											<li>
					<a href="https://johncarlosbaez.wordpress.com/2021/09/26/classical-mechanics-versus-thermodynamics-part-4/">Classical Mechanics versus Thermodynamics (Part&nbsp;4)</a>
									</li>
											<li>
					<a href="https://johncarlosbaez.wordpress.com/2021/09/23/classical-mechanics-versus-thermodynamics-part-3/">Classical Mechanics versus Thermodynamics (Part&nbsp;3)</a>
									</li>
											<li>
					<a href="https://johncarlosbaez.wordpress.com/2021/09/22/maxwells-relations-part-3/">Maxwell&#8217;s Relations (Part&nbsp;3)</a>
									</li>
											<li>
					<a href="https://johncarlosbaez.wordpress.com/2021/09/18/maxwells-relations-part-two/">Maxwell&#8217;s Relations (Part&nbsp;2)</a>
									</li>
											<li>
					<a href="https://johncarlosbaez.wordpress.com/2021/09/17/maxwells-relations-part-1/">Maxwell&#8217;s Relations (Part&nbsp;1)</a>
									</li>
											<li>
					<a href="https://johncarlosbaez.wordpress.com/2021/09/13/the-cyclic-identity-for-partial-derivatives/">The Cyclic Identity for Partial&nbsp;Derivatives</a>
									</li>
											<li>
					<a href="https://johncarlosbaez.wordpress.com/2021/08/17/information-geometry-part-21/">Information Geometry (Part&nbsp;21)</a>
									</li>
											<li>
					<a href="https://johncarlosbaez.wordpress.com/2021/08/14/information-geometry-part-20/">Information Geometry (Part&nbsp;20)</a>
									</li>
											<li>
					<a href="https://johncarlosbaez.wordpress.com/2021/08/08/information-geometry-part-19/">Information Geometry (Part&nbsp;19)</a>
									</li>
											<li>
					<a href="https://johncarlosbaez.wordpress.com/2021/08/05/information-geometry-part-18/">Information Geometry (Part&nbsp;18)</a>
									</li>
					</ul>

		</li>
<li id="recent-comments-2" class="widget widget_recent_comments"><h2 class="widgettitle">latest comments:</h2>
				<table class="recentcommentsavatar" cellspacing="0" cellpadding="0" border="0">
					<tr><td title="Toby Bartels" class="recentcommentsavatartop" style="height:32px; width:32px;"><a href="http://tobybartels.name/" rel="nofollow"><img alt='' src='https://0.gravatar.com/avatar/68c7b083965f5073c50bf7c8d2aac358?s=32&#038;d=identicon&#038;r=G' class='avatar avatar-32' height='32' width='32' /></a></td><td class="recentcommentstexttop" style=""><a href="http://tobybartels.name/" rel="nofollow">Toby Bartels</a> on <a href="https://johncarlosbaez.wordpress.com/2021/09/23/classical-mechanics-versus-thermodynamics-part-3/#comment-172598">Classical Mechanics versus The&hellip;</a></td></tr><tr><td title="David Corfield" class="recentcommentsavatarend" style="height:32px; width:32px;"><img alt='' src='https://0.gravatar.com/avatar/34784534843022b3541c8ddd693718cb?s=32&#038;d=identicon&#038;r=G' class='avatar avatar-32' height='32' width='32' /></td><td class="recentcommentstextend" style="">David Corfield on <a href="https://johncarlosbaez.wordpress.com/2021/09/23/classical-mechanics-versus-thermodynamics-part-3/#comment-172597">Classical Mechanics versus The&hellip;</a></td></tr><tr><td title="Toby Bartels" class="recentcommentsavatarend" style="height:32px; width:32px;"><a href="http://tobybartels.name/" rel="nofollow"><img alt='' src='https://0.gravatar.com/avatar/68c7b083965f5073c50bf7c8d2aac358?s=32&#038;d=identicon&#038;r=G' class='avatar avatar-32' height='32' width='32' /></a></td><td class="recentcommentstextend" style=""><a href="http://tobybartels.name/" rel="nofollow">Toby Bartels</a> on <a href="https://johncarlosbaez.wordpress.com/2021/09/26/classical-mechanics-versus-thermodynamics-part-4/#comment-172596">Classical Mechanics versus The&hellip;</a></td></tr><tr><td title="David Corfield" class="recentcommentsavatarend" style="height:32px; width:32px;"><img alt='' src='https://lh3.googleusercontent.com/a/AATXAJxXcoKzwm_cY3LJp3qldhAQvZVoBimQd4xe5tDl=s96-c' class='avatar avatar-32' height='32' width='32' /></td><td class="recentcommentstextend" style="">David Corfield on <a href="https://johncarlosbaez.wordpress.com/2021/09/23/classical-mechanics-versus-thermodynamics-part-3/#comment-172590">Classical Mechanics versus The&hellip;</a></td></tr><tr><td title="amarashiki" class="recentcommentsavatarend" style="height:32px; width:32px;"><a href="http://gravatar.com/amarashiki" rel="nofollow"><img alt='' src='https://0.gravatar.com/avatar/62b2df0762257e75433ad6f161488c3a?s=32&#038;d=identicon&#038;r=G' class='avatar avatar-32' height='32' width='32' /></a></td><td class="recentcommentstextend" style=""><a href="http://gravatar.com/amarashiki" rel="nofollow">amarashiki</a> on <a href="https://johncarlosbaez.wordpress.com/2012/01/23/classical-mechanics-versus-thermodynamics-part-2/#comment-172566">Classical Mechanics versus The&hellip;</a></td></tr><tr><td title="John Baez" class="recentcommentsavatarend" style="height:32px; width:32px;"><a href="http://math.ucr.edu/home/baez/" rel="nofollow"><img alt='' src='https://0.gravatar.com/avatar/34784534843022b3541c8ddd693718cb?s=32&#038;d=identicon&#038;r=G' class='avatar avatar-32' height='32' width='32' /></a></td><td class="recentcommentstextend" style=""><a href="http://math.ucr.edu/home/baez/" rel="nofollow">John Baez</a> on <a href="https://johncarlosbaez.wordpress.com/2021/09/23/classical-mechanics-versus-thermodynamics-part-3/#comment-172560">Classical Mechanics versus The&hellip;</a></td></tr><tr><td title="domenico" class="recentcommentsavatarend" style="height:32px; width:32px;"><img alt='' src='https://2.gravatar.com/avatar/ba06491deb8346d20356ac2ae05893ee?s=32&#038;d=identicon&#038;r=G' class='avatar avatar-32' height='32' width='32' /></td><td class="recentcommentstextend" style="">domenico on <a href="https://johncarlosbaez.wordpress.com/2021/09/23/classical-mechanics-versus-thermodynamics-part-3/#comment-172559">Classical Mechanics versus The&hellip;</a></td></tr><tr><td title="domenico" class="recentcommentsavatarend" style="height:32px; width:32px;"><img alt='' src='https://2.gravatar.com/avatar/ba06491deb8346d20356ac2ae05893ee?s=32&#038;d=identicon&#038;r=G' class='avatar avatar-32' height='32' width='32' /></td><td class="recentcommentstextend" style="">domenico on <a href="https://johncarlosbaez.wordpress.com/2021/09/23/classical-mechanics-versus-thermodynamics-part-3/#comment-172558">Classical Mechanics versus The&hellip;</a></td></tr><tr><td title="Maxwell Relations | Equivalent eXchange" class="recentcommentsavatarend" style="height:32px; width:32px;"><a href="http://equivalentexchange.blog/2021/09/25/maxwell-relations/" rel="nofollow"></a></td><td class="recentcommentstextend" style=""><a href="http://equivalentexchange.blog/2021/09/25/maxwell-relations/" rel="nofollow">Maxwell Relations |&hellip;</a> on <a href="https://johncarlosbaez.wordpress.com/2021/09/22/maxwells-relations-part-3/#comment-172557">Maxwell&#8217;s Relations (Par&hellip;</a></td></tr><tr><td title="Maxwell Relations | Equivalent eXchange" class="recentcommentsavatarend" style="height:32px; width:32px;"><a href="http://equivalentexchange.blog/2021/09/25/maxwell-relations/" rel="nofollow"></a></td><td class="recentcommentstextend" style=""><a href="http://equivalentexchange.blog/2021/09/25/maxwell-relations/" rel="nofollow">Maxwell Relations |&hellip;</a> on <a href="https://johncarlosbaez.wordpress.com/2021/09/18/maxwells-relations-part-two/#comment-172556">Maxwell&#8217;s Relations (Par&hellip;</a></td></tr>				</table>
				</li>
<li id="text-3" class="widget widget_text"><h2 class="widgettitle">How To Write Math Here:</h2>
			<div class="textwidget"><p>You can <a href="http://en.wikibooks.org/wiki/LaTeX/Mathematics">include math in your comments using LaTeX</a>,  but you need to do it this way:</p>
<p>&#036;latex  E = mc^2&#036;</p>
<p>You need the word 'latex' right after the first dollar sign, and it needs a space after it.  Double dollar signs don't work, and other limitations apply, some described <a href="http://en.support.wordpress.com/latex/">here</a>.  You can't preview comments here, but I'm happy to fix errors.</p>
</div>
		</li>
<li id="categories-2" class="widget widget_categories"><h2 class="widgettitle">Read Posts On:</h2>

			<ul>
					<li class="cat-item cat-item-177"><a href="https://johncarlosbaez.wordpress.com/category/art/">art</a> (3)
</li>
	<li class="cat-item cat-item-4003"><a href="https://johncarlosbaez.wordpress.com/category/astronomy/">astronomy</a> (29)
</li>
	<li class="cat-item cat-item-8262191"><a href="https://johncarlosbaez.wordpress.com/category/azimuth/">azimuth</a> (60)
</li>
	<li class="cat-item cat-item-86856"><a href="https://johncarlosbaez.wordpress.com/category/biodiversity/">biodiversity</a> (38)
</li>
	<li class="cat-item cat-item-4936"><a href="https://johncarlosbaez.wordpress.com/category/biology/">biology</a> (107)
</li>
	<li class="cat-item cat-item-355244"><a href="https://johncarlosbaez.wordpress.com/category/carbon-emissions/">carbon emissions</a> (78)
</li>
	<li class="cat-item cat-item-5936 current-cat"><a aria-current="page" href="https://johncarlosbaez.wordpress.com/category/chemistry/">chemistry</a> (74)
</li>
	<li class="cat-item cat-item-6108"><a href="https://johncarlosbaez.wordpress.com/category/climate/">climate</a> (155)
</li>
	<li class="cat-item cat-item-5043"><a href="https://johncarlosbaez.wordpress.com/category/computer-science/">computer science</a> (57)
</li>
	<li class="cat-item cat-item-9204"><a href="https://johncarlosbaez.wordpress.com/category/conferences/">conferences</a> (81)
</li>
	<li class="cat-item cat-item-1098"><a href="https://johncarlosbaez.wordpress.com/category/culture/">culture</a> (4)
</li>
	<li class="cat-item cat-item-657"><a href="https://johncarlosbaez.wordpress.com/category/economics/">economics</a> (32)
</li>
	<li class="cat-item cat-item-1212"><a href="https://johncarlosbaez.wordpress.com/category/energy/">energy</a> (50)
</li>
	<li class="cat-item cat-item-25393"><a href="https://johncarlosbaez.wordpress.com/category/engineering/">engineering</a> (11)
</li>
	<li class="cat-item cat-item-14852"><a href="https://johncarlosbaez.wordpress.com/category/mathematics/game-theory/">game theory</a> (29)
</li>
	<li class="cat-item cat-item-1215"><a href="https://johncarlosbaez.wordpress.com/category/geography/">geography</a> (4)
</li>
	<li class="cat-item cat-item-337"><a href="https://johncarlosbaez.wordpress.com/category/health/">health</a> (4)
</li>
	<li class="cat-item cat-item-678"><a href="https://johncarlosbaez.wordpress.com/category/history/">history</a> (2)
</li>
	<li class="cat-item cat-item-23375499"><a href="https://johncarlosbaez.wordpress.com/category/information-and-entropy/">information and entropy</a> (92)
</li>
	<li class="cat-item cat-item-3558"><a href="https://johncarlosbaez.wordpress.com/category/jobs/">jobs</a> (11)
</li>
	<li class="cat-item cat-item-5465"><a href="https://johncarlosbaez.wordpress.com/category/journals/">journals</a> (5)
</li>
	<li class="cat-item cat-item-3582"><a href="https://johncarlosbaez.wordpress.com/category/mathematics/">mathematics</a> (479)
</li>
	<li class="cat-item cat-item-18"><a href="https://johncarlosbaez.wordpress.com/category/music/">music</a> (3)
</li>
	<li class="cat-item cat-item-3968"><a href="https://johncarlosbaez.wordpress.com/category/networks/">networks</a> (185)
</li>
	<li class="cat-item cat-item-154934"><a href="https://johncarlosbaez.wordpress.com/category/oceans/">oceans</a> (13)
</li>
	<li class="cat-item cat-item-1211"><a href="https://johncarlosbaez.wordpress.com/category/physics/">physics</a> (205)
</li>
	<li class="cat-item cat-item-10451"><a href="https://johncarlosbaez.wordpress.com/category/probability/">probability</a> (92)
</li>
	<li class="cat-item cat-item-4909"><a href="https://johncarlosbaez.wordpress.com/category/psychology/">psychology</a> (6)
</li>
	<li class="cat-item cat-item-3330"><a href="https://johncarlosbaez.wordpress.com/category/publishing/">publishing</a> (19)
</li>
	<li class="cat-item cat-item-46615"><a href="https://johncarlosbaez.wordpress.com/category/puzzles/">puzzles</a> (14)
</li>
	<li class="cat-item cat-item-4140243"><a href="https://johncarlosbaez.wordpress.com/category/quantum-technologies/">quantum technologies</a> (28)
</li>
	<li class="cat-item cat-item-562"><a href="https://johncarlosbaez.wordpress.com/category/questions/">questions</a> (3)
</li>
	<li class="cat-item cat-item-93974"><a href="https://johncarlosbaez.wordpress.com/category/risks/">risks</a> (48)
</li>
	<li class="cat-item cat-item-37893"><a href="https://johncarlosbaez.wordpress.com/category/seminars/">seminars</a> (21)
</li>
	<li class="cat-item cat-item-581"><a href="https://johncarlosbaez.wordpress.com/category/software/">software</a> (19)
</li>
	<li class="cat-item cat-item-39438"><a href="https://johncarlosbaez.wordpress.com/category/strategies/">strategies</a> (36)
</li>
	<li class="cat-item cat-item-6877"><a href="https://johncarlosbaez.wordpress.com/category/sustainability/">sustainability</a> (71)
</li>
	<li class="cat-item cat-item-66608272"><a href="https://johncarlosbaez.wordpress.com/category/the-practice-of-science/">the practice of science</a> (27)
</li>
	<li class="cat-item cat-item-61590"><a href="https://johncarlosbaez.wordpress.com/category/this-weeks-finds/">this week&#039;s finds</a> (18)
</li>
			</ul>

			</li>
<li id="linkcat-20924250" class="widget widget_links"><h2 class="widgettitle">also visit these:</h2>

	<ul class='xoxo blogroll'>
<li><a href="http://www.azimuthproject.org/azimuth/show/Azimuth+Blog" title="Go here to see what’s on this blog, organized by topic or author!">Azimuth Blog Overview</a></li>
<li><a href="http://www.azimuthproject.org/azimuth/show/HomePage" title="for scientists and engineers who want to save the planet">Azimuth Project</a></li>
<li><a href="http://bittooth.blogspot.com/" title="David Summers on energy: oil, gas and more">Bit Tooth Energy</a></li>
<li><a href="http://bravenewclimate.com/" title="Barry Brooks on climate and energy policy">Brave New Climate</a></li>
<li><a href="http://physics.ucsd.edu/do-the-math/" title="UC San Diego prof uses physics and estimation to assess energy, growth, options">Do the Math</a></li>
<li><a href="http://dotearth.blogs.nytimes.com/" title="Andrew Revkin’s environmental blog on the New York Times">Dot Earth</a></li>
<li><a href="http://e360.yale.edu/" title="News from the Yale School of Forestry &amp; Environmental Studies">Environment 360</a></li>
<li><a href="http://planet3.org/" title="A metablog on sustainability">Planet3.0</a></li>
<li><a href="http://www.realclimate.org/" title="climate science from climate scientists">RealClimate</a></li>
<li><a href="http://www.easterbrook.ca/steve/" title="Steve Easterbrook&#8217;s blog on software engineering and climate modeling">Serendipity</a></li>
<li><a href="http://scienceofdoom.com/" title="climate science in perspective">The Science of Doom</a></li>
<li><a href="http://e360.yale.edu/" title="opinion, analysis, reporting and debate on environmental issues">Yale Environment 360</a></li>

	</ul>
</li>

<li id="rss_links-3" class="widget widget_rss_links"><h2 class="widgettitle">RSS feeds:</h2>
<p class="size-small"><a class="feed-image-link" href="https://johncarlosbaez.wordpress.com/feed/" title="Subscribe to Posts"><img src="https://johncarlosbaez.wordpress.com/i/rss/red-small.png?m=1391188133h" alt="RSS Feed" /></a>&nbsp;<a href="https://johncarlosbaez.wordpress.com/feed/" title="Subscribe to Posts">RSS - Posts</a></p><p class="size-small"><a class="feed-image-link" href="https://johncarlosbaez.wordpress.com/comments/feed/" title="Subscribe to Comments"><img src="https://johncarlosbaez.wordpress.com/i/rss/red-small.png?m=1391188133h" alt="RSS Feed" /></a>&nbsp;<a href="https://johncarlosbaez.wordpress.com/comments/feed/" title="Subscribe to Comments">RSS - Comments</a></p>
</li>
<li id="blog_subscription-3" class="widget widget_blog_subscription jetpack_subscription_widget"><h2 class="widgettitle"><label for="subscribe-field">Email Subscription:</label></h2>

			<form
				action="https://subscribe.wordpress.com"
				method="post"
				accept-charset="utf-8"
				id=""
			>
				<p>Enter your email address to subscribe to this blog and receive notifications of new posts by email.</p>
					<div class="jetpack-subscribe-count">
						<p>
						Join 5,228 other followers						</p>
					</div>
									<p id="subscribe-email">
					<label
						id="subscribe-field-label"
						for="subscribe-field"
						class="screen-reader-text"
					>
						Email Address:					</label>

					<input
							type="email"
							name="email"
							
							style="width: 95%; padding: 1px 10px"
							placeholder="Enter your email address"
							value=""
							id="subscribe-field"
						/>				</p>

				<p id="subscribe-submit"
									>
                    <input type="hidden" name="action" value="subscribe"/>
                    <input type="hidden" name="blog_id" value="12777403"/>
                    <input type="hidden" name="source" value="https://johncarlosbaez.wordpress.com/category/chemistry/page/6/"/>
                    <input type="hidden" name="sub-type" value="widget"/>
                    <input type="hidden" name="redirect_fragment" value="blog_subscription-3"/>
					<input type="hidden" id="_wpnonce" name="_wpnonce" value="ffcb185558" />                    <button type="submit"
	                    	                        class="wp-block-button__link"
	                    		                	                >
	                    Sign me up!                    </button>
                </p>
            </form>
			
</li>
<li id="search-3" class="widget widget_search"><h2 class="widgettitle">SEARCH:</h2>
<form method="get" id="searchform" action="https://johncarlosbaez.wordpress.com/">
<div><label for="s" class="search-label">Search</label><input type="text" value="" name="s" id="s" />
<input type="submit" id="searchsubmit" value="Search" />
</div>
</form></li>
<li id="blog-stats-2" class="widget widget_blog-stats"><h2 class="widgettitle">Blog Stats:</h2>
		<ul>
			<li>4,177,577 hits</li>
		</ul>
		</li>
		</ul>
	</div>



<div id="footer">
	<p>
	<br />
	<a href="https://wordpress.com/?ref=footer_blog" rel="nofollow">Blog at WordPress.com.</a>
	</p>
</div>

</div>

				<script type="text/javascript">
		//<![CDATA[
		var infiniteScroll = JSON.parse( decodeURIComponent( '%7B%22settings%22%3A%7B%22id%22%3A%22content%22%2C%22ajaxurl%22%3A%22https%3A%5C%2F%5C%2Fjohncarlosbaez.wordpress.com%5C%2F%3Finfinity%3Dscrolling%22%2C%22type%22%3A%22scroll%22%2C%22wrapper%22%3Atrue%2C%22wrapper_class%22%3A%22infinite-wrap%22%2C%22footer%22%3Atrue%2C%22click_handle%22%3A%221%22%2C%22text%22%3A%22Older%20posts%22%2C%22totop%22%3A%22Scroll%20back%20to%20top%22%2C%22currentday%22%3A%2223.08.12%22%2C%22order%22%3A%22DESC%22%2C%22scripts%22%3A%5B%5D%2C%22styles%22%3A%5B%5D%2C%22google_analytics%22%3Afalse%2C%22offset%22%3A6%2C%22history%22%3A%7B%22host%22%3A%22johncarlosbaez.wordpress.com%22%2C%22path%22%3A%22%5C%2Fcategory%5C%2Fchemistry%5C%2Fpage%5C%2F%25d%5C%2F%22%2C%22use_trailing_slashes%22%3Atrue%2C%22parameters%22%3A%22%22%7D%2C%22query_args%22%3A%7B%22paged%22%3A6%2C%22category_name%22%3A%22chemistry%22%2C%22error%22%3A%22%22%2C%22m%22%3A%22%22%2C%22p%22%3A0%2C%22post_parent%22%3A%22%22%2C%22subpost%22%3A%22%22%2C%22subpost_id%22%3A%22%22%2C%22attachment%22%3A%22%22%2C%22attachment_id%22%3A0%2C%22name%22%3A%22%22%2C%22pagename%22%3A%22%22%2C%22page_id%22%3A0%2C%22second%22%3A%22%22%2C%22minute%22%3A%22%22%2C%22hour%22%3A%22%22%2C%22day%22%3A0%2C%22monthnum%22%3A0%2C%22year%22%3A0%2C%22w%22%3A0%2C%22tag%22%3A%22%22%2C%22cat%22%3A5936%2C%22tag_id%22%3A%22%22%2C%22author%22%3A%22%22%2C%22author_name%22%3A%22%22%2C%22feed%22%3A%22%22%2C%22tb%22%3A%22%22%2C%22meta_key%22%3A%22%22%2C%22meta_value%22%3A%22%22%2C%22preview%22%3A%22%22%2C%22s%22%3A%22%22%2C%22sentence%22%3A%22%22%2C%22title%22%3A%22%22%2C%22fields%22%3A%22%22%2C%22menu_order%22%3A%22%22%2C%22embed%22%3A%22%22%2C%22category__in%22%3A%5B%5D%2C%22category__not_in%22%3A%5B%5D%2C%22category__and%22%3A%5B%5D%2C%22post__in%22%3A%5B%5D%2C%22post__not_in%22%3A%5B%5D%2C%22post_name__in%22%3A%5B%5D%2C%22tag__in%22%3A%5B%5D%2C%22tag__not_in%22%3A%5B%5D%2C%22tag__and%22%3A%5B%5D%2C%22tag_slug__in%22%3A%5B%5D%2C%22tag_slug__and%22%3A%5B%5D%2C%22post_parent__in%22%3A%5B%5D%2C%22post_parent__not_in%22%3A%5B%5D%2C%22author__in%22%3A%5B%5D%2C%22author__not_in%22%3A%5B%5D%2C%22lazy_load_term_meta%22%3Afalse%2C%22posts_per_page%22%3A10%2C%22ignore_sticky_posts%22%3Afalse%2C%22suppress_filters%22%3Afalse%2C%22cache_results%22%3Afalse%2C%22update_post_term_cache%22%3Atrue%2C%22update_post_meta_cache%22%3Atrue%2C%22post_type%22%3A%22%22%2C%22nopaging%22%3Afalse%2C%22comments_per_page%22%3A%22100%22%2C%22no_found_rows%22%3Afalse%2C%22order%22%3A%22DESC%22%7D%2C%22query_before%22%3A%222021-09-26%2017%3A23%3A54%22%2C%22last_post_date%22%3A%222012-08-23%2007%3A29%3A40%22%2C%22body_class%22%3A%22infinite-scroll%20neverending%22%2C%22loading_text%22%3A%22Loading%20new%20page%22%2C%22stats%22%3A%22blog%3D12777403%26v%3Dwpcom%26tz%3D0%26user_id%3D0%26subd%3Djohncarlosbaez%26x_pagetype%3Dinfinite%22%7D%7D' ) );
		//]]>
		</script>
		<!--  -->
<script src='//0.gravatar.com/js/gprofiles.js?ver=202138y' id='grofiles-cards-js'></script>
<script id='wpgroho-js-extra'>
var WPGroHo = {"my_hash":""};
</script>
<script crossorigin='anonymous' type='text/javascript' src='https://s1.wp.com/wp-content/mu-plugins/gravatar-hovercards/wpgroho.js?m=1610363240h'></script>

	<script>
		// Initialize and attach hovercards to all gravatars
		( function() {
			function init() {
				if ( typeof Gravatar === 'undefined' ) {
					return;
				}

				if ( typeof Gravatar.init !== 'function' ) {
					return;
				}

				Gravatar.profile_cb = function ( hash, id ) {
					WPGroHo.syncProfileData( hash, id );
				};

				Gravatar.my_hash = WPGroHo.my_hash;
				Gravatar.init( 'body', '#wp-admin-bar-my-account' );
			}

			if ( document.readyState !== 'loading' ) {
				init();
			} else {
				document.addEventListener( 'DOMContentLoaded', init );
			}
		} )();
	</script>

		<div style="display:none">
	<div class="grofile-hash-map-68c7b083965f5073c50bf7c8d2aac358">
	</div>
	<div class="grofile-hash-map-34784534843022b3541c8ddd693718cb">
	</div>
	<div class="grofile-hash-map-7d52fbe20c8ac05886a296e9ee2159b1">
	</div>
	<div class="grofile-hash-map-62b2df0762257e75433ad6f161488c3a">
	</div>
	<div class="grofile-hash-map-ba06491deb8346d20356ac2ae05893ee">
	</div>
	</div>
		<div id="infinite-footer">
			<div class="container">
				<div class="blog-info">
					<a id="infinity-blog-title" href="https://johncarlosbaez.wordpress.com/" rel="home">
						Azimuth					</a>
				</div>
				<div class="blog-credits">
					<a href="https://wordpress.com/?ref=footer_blog" rel="nofollow">Blog at WordPress.com.</a> 				</div>
			</div>
		</div><!-- #infinite-footer -->
		
<script>
window.addEventListener( "load", function( event ) {
	var link = document.createElement( "link" );
	link.href = "https://s0.wp.com/wp-content/mu-plugins/actionbar/actionbar.css?v=20210915";
	link.type = "text/css";
	link.rel = "stylesheet";
	document.head.appendChild( link );

	var script = document.createElement( "script" );
	script.src = "https://s0.wp.com/wp-content/mu-plugins/actionbar/actionbar.js?v=20210920";
	script.defer = true;
	document.body.appendChild( script );
} );
</script>

			<div id="jp-carousel-loading-overlay">
			<div id="jp-carousel-loading-wrapper">
				<span id="jp-carousel-library-loading">&nbsp;</span>
			</div>
		</div>
		<div class="jp-carousel-overlay" style="display: none;">

		<div class="jp-carousel-container">
			<!-- The Carousel Swiper -->
			<div
				class="jp-carousel-wrap swiper-container jp-carousel-swiper-container jp-carousel-transitions"
				itemscope
				itemtype="https://schema.org/ImageGallery">
				<div class="jp-carousel swiper-wrapper"></div>
				<div class="jp-swiper-button-prev swiper-button-prev">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskPrev" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="9" height="12">
							<path d="M16.2072 16.59L11.6496 12L16.2072 7.41L14.8041 6L8.8335 12L14.8041 18L16.2072 16.59Z" fill="white"/>
						</mask>
						<g mask="url(#maskPrev)">
							<rect x="0.579102" width="23.8823" height="24" fill="#FFFFFF"/>
						</g>
					</svg>
				</div>
				<div class="jp-swiper-button-next swiper-button-next">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskNext" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="8" height="12">
							<path d="M8.59814 16.59L13.1557 12L8.59814 7.41L10.0012 6L15.9718 12L10.0012 18L8.59814 16.59Z" fill="white"/>
						</mask>
						<g mask="url(#maskNext)">
							<rect x="0.34375" width="23.8822" height="24" fill="#FFFFFF"/>
						</g>
					</svg>
				</div>
			</div>
			<!-- The main close buton -->
			<div class="jp-carousel-close-hint">
				<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
					<mask id="maskClose" mask-type="alpha" maskUnits="userSpaceOnUse" x="5" y="5" width="15" height="14">
						<path d="M19.3166 6.41L17.9135 5L12.3509 10.59L6.78834 5L5.38525 6.41L10.9478 12L5.38525 17.59L6.78834 19L12.3509 13.41L17.9135 19L19.3166 17.59L13.754 12L19.3166 6.41Z" fill="white"/>
					</mask>
					<g mask="url(#maskClose)">
						<rect x="0.409668" width="23.8823" height="24" fill="#FFFFFF"/>
					</g>
				</svg>
			</div>
			<!-- Image info, comments and meta -->
			<div class="jp-carousel-info">
				<div class="jp-carousel-info-footer">
					<div class="jp-carousel-pagination-container">
						<div class="jp-swiper-pagination swiper-pagination"></div>
						<div class="jp-carousel-pagination"></div>
					</div>
					<div class="jp-carousel-photo-title-container">
						<h2 class="jp-carousel-photo-caption"></h2>
					</div>
					<div class="jp-carousel-photo-icons-container">
						<a href="#" class="jp-carousel-icon-btn jp-carousel-icon-info" aria-label="Toggle photo metadata visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskInfo" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M12.7537 2C7.26076 2 2.80273 6.48 2.80273 12C2.80273 17.52 7.26076 22 12.7537 22C18.2466 22 22.7046 17.52 22.7046 12C22.7046 6.48 18.2466 2 12.7537 2ZM11.7586 7V9H13.7488V7H11.7586ZM11.7586 11V17H13.7488V11H11.7586ZM4.79292 12C4.79292 16.41 8.36531 20 12.7537 20C17.142 20 20.7144 16.41 20.7144 12C20.7144 7.59 17.142 4 12.7537 4C8.36531 4 4.79292 7.59 4.79292 12Z" fill="white"/>
									</mask>
									<g mask="url(#maskInfo)">
										<rect x="0.8125" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>
							</span>
						</a>
												<a href="#" class="jp-carousel-icon-btn jp-carousel-icon-comments" aria-label="Toggle photo comments visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskComments" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M4.3271 2H20.2486C21.3432 2 22.2388 2.9 22.2388 4V16C22.2388 17.1 21.3432 18 20.2486 18H6.31729L2.33691 22V4C2.33691 2.9 3.2325 2 4.3271 2ZM6.31729 16H20.2486V4H4.3271V18L6.31729 16Z" fill="white"/>
									</mask>
									<g mask="url(#maskComments)">
										<rect x="0.34668" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>

								<span class="jp-carousel-has-comments-indicator" aria-label="This image has comments."></span>
							</span>
						</a>
											</div>
				</div>
				<div class="jp-carousel-info-extra">
					<div class="jp-carousel-info-content-wrapper">
						<div class="jp-carousel-photo-title-container">
							<h2 class="jp-carousel-photo-title"></h2>
						</div>
						<div class="jp-carousel-comments-wrapper">
															<div id="jp-carousel-comments-loading">
									<span>Loading Comments...</span>
								</div>
								<div class="jp-carousel-comments"></div>
								<div id="jp-carousel-comment-form-container">
									<span id="jp-carousel-comment-form-spinner">&nbsp;</span>
									<div id="jp-carousel-comment-post-results"></div>
																														<form id="jp-carousel-comment-form">
												<label for="jp-carousel-comment-form-comment-field" class="screen-reader-text">Write a Comment...</label>
												<textarea
													name="comment"
													class="jp-carousel-comment-form-field jp-carousel-comment-form-textarea"
													id="jp-carousel-comment-form-comment-field"
													placeholder="Write a Comment..."
												></textarea>
												<div id="jp-carousel-comment-form-submit-and-info-wrapper">
													<div id="jp-carousel-comment-form-commenting-as">
																													<fieldset>
																<label for="jp-carousel-comment-form-email-field">Email (Required)</label>
																<input type="text" name="email" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-email-field" />
															</fieldset>
															<fieldset>
																<label for="jp-carousel-comment-form-author-field">Name (Required)</label>
																<input type="text" name="author" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-author-field" />
															</fieldset>
															<fieldset>
																<label for="jp-carousel-comment-form-url-field">Website</label>
																<input type="text" name="url" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-url-field" />
															</fieldset>
																											</div>
													<input
														type="submit"
														name="submit"
														class="jp-carousel-comment-form-button"
														id="jp-carousel-comment-form-button-submit"
														value="Post Comment" />
												</div>
											</form>
																											</div>
													</div>
						<div class="jp-carousel-image-meta">
							<div class="jp-carousel-title-and-caption">
								<div class="jp-carousel-photo-info">
									<h3 class="jp-carousel-caption" itemprop="caption description"></h3>
								</div>

								<div class="jp-carousel-photo-description"></div>
							</div>
							<ul class="jp-carousel-image-exif" style="display: none;"></ul>
							<a class="jp-carousel-image-download" target="_blank" style="display: none;">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="mask0" mask-type="alpha" maskUnits="userSpaceOnUse" x="3" y="3" width="19" height="18">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M5.84615 5V19H19.7775V12H21.7677V19C21.7677 20.1 20.8721 21 19.7775 21H5.84615C4.74159 21 3.85596 20.1 3.85596 19V5C3.85596 3.9 4.74159 3 5.84615 3H12.8118V5H5.84615ZM14.802 5V3H21.7677V10H19.7775V6.41L9.99569 16.24L8.59261 14.83L18.3744 5H14.802Z" fill="white"/>
									</mask>
									<g mask="url(#mask0)">
										<rect x="0.870605" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>
								<span class="jp-carousel-download-text"></span>
							</a>
							<div class="jp-carousel-image-map" style="display: none;"></div>
						</div>
					</div>
				</div>
			</div>
		</div>

		</div>
		<link rel='stylesheet' id='all-css-0-2' href='https://s1.wp.com/_static/??-eJyFy00OQDAQQOELGUP8xUKcpWoiZVTTadO4vVhY2LB8L/kwOdCHDWQD7hEcx8VYQa38EYUYJRlHHqZoZ6Zci2T4I1YKTukNnvGFgmGaYVHM5M933Wzch7Ktir5p+rpbL+lvP34=?cssminify=yes' type='text/css' media='all' />
<script id='jetpack-carousel-js-extra'>
var jetpackSwiperLibraryPath = {"url":"\/wp-content\/mu-plugins\/carousel\/swiper-bundle.js"};
var jetpackCarouselStrings = {"widths":[370,700,1000,1200,1400,2000],"is_logged_in":"","lang":"en","ajaxurl":"https:\/\/johncarlosbaez.wordpress.com\/wp-admin\/admin-ajax.php","nonce":"805b669379","display_exif":"1","display_comments":"1","display_geo":"1","single_image_gallery":"1","single_image_gallery_media_file":"","background_color":"black","comment":"Comment","post_comment":"Post Comment","write_comment":"Write a Comment...","loading_comments":"Loading Comments...","download_original":"View full size <span class=\"photo-size\">{0}<span class=\"photo-size-times\">\u00d7<\/span>{1}<\/span>","no_comment_text":"Please be sure to submit some text with your comment.","no_comment_email":"Please provide an email address to comment.","no_comment_author":"Please provide your name to comment.","comment_post_error":"Sorry, but there was an error posting your comment. Please try again later.","comment_approved":"Your comment was approved.","comment_unapproved":"Your comment is in moderation.","camera":"Camera","aperture":"Aperture","shutter_speed":"Shutter Speed","focal_length":"Focal Length","copyright":"Copyright","comment_registration":"0","require_name_email":"1","login_url":"https:\/\/johncarlosbaez.wordpress.com\/wp-login.php?redirect_to=https%3A%2F%2Fjohncarlosbaez.wordpress.com%2F2012%2F08%2F23%2Fnetwork-theory-part-24%2F","blog_id":"12777403","meta_data":["camera","aperture","shutter_speed","focal_length","copyright"],"stats_query_args":"blog=12777403&v=wpcom&tz=0&user_id=0&subd=johncarlosbaez","is_public":"1"};
</script>
<script crossorigin='anonymous' type='text/javascript' src='https://s0.wp.com/_static/??-eJyNkN1uwyAMhV9oDkouKvVi2rMQcCNT/oZN07z9yNRMbTZFu8LH8J2DreYMJkXBKMqxsngjg/neOX5TT1ehQvZ1osiK4oUiyfJTHLzVNlCEURcVNAuWVoEUba68h1q2+6xYlsfRzdmkALmk+wIFW49lYygaXy3yCjWJYUTbtaCDj8xkJxRWXEc2hbJQivyXH8+XNDo0sjfbnG5kMSnNvNq5h84F+ddIT/FGl1QZvXIouY0PW+OAEfJoYdLer1t5Uf9Igu/97WTjPsJ7fxrO534YTr37Ai2cwB8='></script>
<script type="text/javascript">
// <![CDATA[
(function() {
try{
  if ( window.external &&'msIsSiteMode' in window.external) {
    if (window.external.msIsSiteMode()) {
      var jl = document.createElement('script');
      jl.type='text/javascript';
      jl.async=true;
      jl.src='/wp-content/plugins/ie-sitemode/custom-jumplist.php';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jl, s);
    }
  }
}catch(e){}
})();
// ]]>
</script><script type="text/javascript">
			(function() {
				var extend = function(out) {
					out = out || {};

					for (var i = 1; i < arguments.length; i++) {
						if (!arguments[i])
						continue;

						for (var key in arguments[i]) {
						if (arguments[i].hasOwnProperty(key))
							out[key] = arguments[i][key];
						}
					}

					return out;
				};
				extend( window.infiniteScroll.settings.scripts, ["postmessage","mobile-useragent-info","rlt-proxy","jquery-core","jquery-migrate","jquery","wpcom-actionbar-placeholder","grofiles-cards","wpgroho","devicepx","the-neverending-homepage","wpcom-masterbar-tracks-js","jquery.wpcom-proxy-request","wp-embed","jetpack-subscriptions-js","swfobject","videopress","jetpack-carousel","tiled-gallery","carousel-wpcom"] );
				extend( window.infiniteScroll.settings.styles, ["the-neverending-homepage","infinity-contempt","wp-block-library","mediaelement","wp-mediaelement","jetpack-layout-grid","jetpack-ratings","coblocks-frontend","wpcom-core-compat-playlist-styles","wpcom-text-widget-styles","wpcom-bbpress2-staff-css","contempt","geo-location-flair","reblogging","a8c-global-print","h4-global","global-styles","jetpack-global-styles-frontend-style","jetpack-carousel-swiper-css","jetpack-carousel","tiled-gallery"] );
			})();
		</script>
				<span id="infinite-aria" aria-live="polite"></span>
		<script src="//stats.wp.com/w.js?62" defer></script> <script type="text/javascript">
_tkq = window._tkq || [];
_stq = window._stq || [];
_tkq.push(['storeContext', {'blog_id':'12777403','blog_tz':'0','user_lang':'en','blog_lang':'en','user_id':'0'}]);
_stq.push(['view', {'blog':'12777403','v':'wpcom','tz':'0','user_id':'0','subd':'johncarlosbaez'}]);
_stq.push(['extra', {'crypt':'UE40eW5QN0p8M2Y/RE1TaVhzUzFMbjdWNHpwZGhTayxPSUFCMGNrd29+Smw0TDhnZmRTK0hlRi9QSGh6bi9GXVhBJWIlZlR5U1JMLU8/MkNtblkvY1d6eVImTEouL2UleTBRZmlNdkp0aWJaNFJhPS0uTVpHa1hIc25EbVJyQmw/SkZ+Q3lLcjU/NDBvQTY5JWlCdmFjdjg1VU9zMXpVcXg4b1hYYW01dmVwWTBkQnpHOC98M1EmQW5pdlkrJUNnZVY5LXRwbFhjUFRqWlhCeHNmMi1qQWVNLlpwb0Q9YmhOL1hUej9+Ui1aU0VDdHVYQjNEbEcwSzZwblA1P3FtSXd5LUJBTVh4QXRkVDlSYV1oN0N4aFA5Lnh5QVJ3T2g9NDJtYngsVGRjcS1lXz02NFZlOW40aGhBW0dFZEpRMWVDQ0Fzcy5qNWdzbXZlUElNOHVLVHBj'}]);
_stq.push([ 'clickTrackerInit', '12777403', '0' ]);
	</script>
<noscript><img src="https://pixel.wp.com/b.gif?v=noscript" style="height:1px;width:1px;overflow:hidden;position:absolute;bottom:1px;" alt="" /></noscript>
<script>
if ( 'object' === typeof wpcom_mobile_user_agent_info ) {

	wpcom_mobile_user_agent_info.init();
	var mobileStatsQueryString = "";
	
	if( false !== wpcom_mobile_user_agent_info.matchedPlatformName )
		mobileStatsQueryString += "&x_" + 'mobile_platforms' + '=' + wpcom_mobile_user_agent_info.matchedPlatformName;
	
	if( false !== wpcom_mobile_user_agent_info.matchedUserAgentName )
		mobileStatsQueryString += "&x_" + 'mobile_devices' + '=' + wpcom_mobile_user_agent_info.matchedUserAgentName;
	
	if( wpcom_mobile_user_agent_info.isIPad() )
		mobileStatsQueryString += "&x_" + 'ipad_views' + '=' + 'views';

	if( "" != mobileStatsQueryString ) {
		new Image().src = document.location.protocol + '//pixel.wp.com/g.gif?v=wpcom-no-pv' + mobileStatsQueryString + '&baba=' + Math.random();
	}
	
}
</script>
</body>
</html>