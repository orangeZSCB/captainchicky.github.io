<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>chemistry | Azimuth | Page 7</title>
<link rel="profile" href="http://gmpg.org/xfn/11" />
<link rel="pingback" href="https://johncarlosbaez.wordpress.com/xmlrpc.php" />
<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s1.wp.com' />
<link rel='dns-prefetch' href='//s2.wp.com' />
<link rel='dns-prefetch' href='//s0.wp.com' />
<link rel='dns-prefetch' href='//s.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Azimuth &raquo; Feed" href="https://johncarlosbaez.wordpress.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Azimuth &raquo; Comments Feed" href="https://johncarlosbaez.wordpress.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Azimuth &raquo; chemistry Category Feed" href="https://johncarlosbaez.wordpress.com/category/chemistry/feed/" />
	<script type="text/javascript">
		/* <![CDATA[ */
		function addLoadEvent(func) {
			var oldonload = window.onload;
			if (typeof window.onload != 'function') {
				window.onload = func;
			} else {
				window.onload = function () {
					oldonload();
					func();
				}
			}
		}
		/* ]]> */
	</script>
			<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/s1.wp.com\/wp-includes\/js\/wp-emoji-release.min.js?m=1625065786h&ver=5.8.1"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([10084,65039,8205,55357,56613],[10084,65039,8203,55357,56613])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='all-css-0-1' href='https://s2.wp.com/_static/??-eJyNkttSAyEMhl9IlqVOdbxwfBYOEVOBZSBYeXuz1e6sVrveMDl9yU9AHrOwUyJIJGMTOTSPqUpMz5iQ+mIMttYbuVFMLxChytyMPJXFTBfcGfKNXQPFc6aAfFNq2A9KmobBSRMm+yoCmqJLl5V6gKURJhua4zGHKiM41BB46qxo5eSgOxQRwGvbh4hpG+fc2v8G/S3+pJSbAWU9S9Z9aiR8QfdD9r9bFE2YfN3A7fSF7QY18t4cVlqC4nd29WTzzjkes768+BXsiM4DMV7PtiB4v45kHiOMyQVqFXxGbFF8/pSZe4qP6u5W3T/sx3F3+ACgX/YH?cssminify=yes' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify {
	text-align:justify;
}
</style>
<style id='global-styles-inline-css'>
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--normal: 16px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--huge: 42px;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-normal-font-size{font-size: var(--wp--preset--font-size--normal) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-huge-font-size{font-size: var(--wp--preset--font-size--huge) !important;}
</style>
<link rel='stylesheet' id='all-css-2-1' href='https://s0.wp.com/_static/??-eJx9i0EKgCAQAD+ULYJRHaK3qJhY666o0fezW126zcAMGNR09LaUDq4kLFN1VCGeIuHpAxXwjgWy1TUwfURsqEP+W7MzyL6hh1a99JnWuEg1zEpNo1T7DZLtMYQ=?cssminify=yes' type='text/css' media='all' />
<link rel='stylesheet' id='print-css-3-1' href='https://s2.wp.com/wp-content/mu-plugins/global-print/global-print.css?m=1465851035h&cssminify=yes' type='text/css' media='print' />
<style id='jetpack-global-styles-frontend-style-inline-css'>
:root { --font-headings: unset; --font-base: unset; --font-headings-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif; --font-base-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif;}
</style>
<link rel='stylesheet' id='all-css-6-1' href='https://s0.wp.com/wp-content/themes/h4/global.css?m=1420737423h&cssminify=yes' type='text/css' media='all' />
<script id='wpcom-actionbar-placeholder-js-extra'>
var actionbardata = {"siteID":"12777403","siteName":"Azimuth","siteURL":"http:\/\/johncarlosbaez.wordpress.com","siteHost":"johncarlosbaez.wordpress.com","icon":"<img alt='' src='https:\/\/s2.wp.com\/i\/logo\/wpcom-gray-white.png' class='avatar avatar-50' height='50' width='50' \/>","canManageOptions":"","canCustomizeSite":"","isFollowing":"","themeSlug":"pub\/contempt","signupURL":"https:\/\/wordpress.com\/start\/","loginURL":"https:\/\/wordpress.com\/log-in?redirect_to=https%3A%2F%2Fjohncarlosbaez.wordpress.com%2F2012%2F08%2F21%2Fnetwork-theory-part-23%2F&signup_flow=account","themeURL":"","xhrURL":"https:\/\/johncarlosbaez.wordpress.com\/wp-admin\/admin-ajax.php","nonce":"e6f6fdfb46","isSingular":"","isFolded":"","isLoggedIn":"","isMobile":"","subscribeNonce":"<input type=\"hidden\" id=\"_wpnonce\" name=\"_wpnonce\" value=\"ffcb185558\" \/>","referer":"https:\/\/johncarlosbaez.wordpress.com\/category\/chemistry\/page\/7\/","canFollow":"1","feedID":"62242","statusMessage":"","subsEmailDefault":"instantly","customizeLink":"https:\/\/johncarlosbaez.wordpress.com\/wp-admin\/customize.php?url=https%3A%2F%2Fjohncarlosbaez.wordpress.com%2Fcategory%2Fchemistry%2Fpage%2F7%2F","i18n":{"view":"View site","follow":"Follow","following":"Following","edit":"Edit","login":"Log in","signup":"Sign up","customize":"Customize","report":"Report this content","themeInfo":"Get theme: Contempt","shortlink":"Copy shortlink","copied":"Copied","followedText":"New posts from this site will now appear in your <a href=\"https:\/\/wordpress.com\/read\">Reader<\/a>","foldBar":"Collapse this bar","unfoldBar":"Expand this bar","editSubs":"Manage subscriptions","viewReader":"View site in Reader","viewReadPost":"View post in Reader","subscribe":"Sign me up","enterEmail":"Enter your email address","followers":"Join 5,228 other followers","alreadyUser":"Already have a WordPress.com account? <a href=\"https:\/\/wordpress.com\/log-in?redirect_to=https%3A%2F%2Fjohncarlosbaez.wordpress.com%2F2012%2F08%2F21%2Fnetwork-theory-part-23%2F&signup_flow=account\">Log in now.<\/a>","stats":"Stats","notifyNewPosts":"Notify me of new posts","notifyNewPostsDetails":"Receive web and mobile notifications for new posts from this site.","emailNewPosts":"Email me new posts","emailNewPostsDetails":"You can customize your notification settings further <a href=\"https:\/\/wordpress.com\/following\/manage?s=johncarlosbaez.wordpress.com\">here<\/a>.","emailNewComments":"Email me new comments","instantly":"Instantly","daily":"Daily","weekly":"Weekly"}};
</script>
<script crossorigin='anonymous' type='text/javascript' src='https://s2.wp.com/_static/??-eJyFykEKwkAMQNELmQ4qtboQz1LbWDJMknGSQXt7K9SFILj6i//CI8Og4igeooWs5oxm/YRNtE34vqxXSgjVsCxAHEhu+sOV5JCLPufPIxlSHdHeM94rlnlNwyR/ETBNpXdc8YXP28OuOx3brt3HF3swRvU='></script>
<script type='text/javascript'>
	window.addEventListener( 'DOMContentLoaded', function() {
		rltInitialize( {"token":null,"iframeOrigins":["https:\/\/widgets.wp.com"]} );
	} );
</script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://johncarlosbaez.wordpress.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://s1.wp.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress.com" />

<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="website" />
<meta property="og:title" content="chemistry &#8211; Page 7 &#8211; Azimuth" />
<meta property="og:url" content="https://johncarlosbaez.wordpress.com/category/chemistry/" />
<meta property="og:site_name" content="Azimuth" />
<meta property="og:image" content="https://s0.wp.com/i/blank.jpg" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:site" content="@wordpressdotcom" />
<meta property="fb:app_id" content="249643311490" />

<!-- End Jetpack Open Graph Tags -->
<link rel="shortcut icon" type="image/x-icon" href="https://s1.wp.com/i/favicon.ico" sizes="16x16 24x24 32x32 48x48" />
<link rel="icon" type="image/x-icon" href="https://s1.wp.com/i/favicon.ico" sizes="16x16 24x24 32x32 48x48" />
<link rel="apple-touch-icon" href="https://s2.wp.com/i/webclip.png" />
<link rel='openid.server' href='https://johncarlosbaez.wordpress.com/?openidserver=1' />
<link rel='openid.delegate' href='https://johncarlosbaez.wordpress.com/' />
<link rel="search" type="application/opensearchdescription+xml" href="https://johncarlosbaez.wordpress.com/osd.xml" title="Azimuth" />
<link rel="search" type="application/opensearchdescription+xml" href="https://s1.wp.com/opensearch.xml" title="WordPress.com" />
<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>		<style type="text/css">
			.recentcomments a {
				display: inline !important;
				padding: 0 !important;
				margin: 0 !important;
			}

			table.recentcommentsavatartop img.avatar, table.recentcommentsavatarend img.avatar {
				border: 0px;
				margin: 0;
			}

			table.recentcommentsavatartop a, table.recentcommentsavatarend a {
				border: 0px !important;
				background-color: transparent !important;
			}

			td.recentcommentsavatarend, td.recentcommentsavatartop {
				padding: 0px 0px 1px 0px;
				margin: 0px;
			}

			td.recentcommentstextend {
				border: none !important;
				padding: 0px 0px 2px 10px;
			}

			.rtl td.recentcommentstextend {
				padding: 0px 10px 2px 0px;
			}

			td.recentcommentstexttop {
				border: none;
				padding: 0px 0px 0px 10px;
			}

			.rtl td.recentcommentstexttop {
				padding: 0px 10px 0px 0px;
			}
		</style>
		<meta name="application-name" content="Azimuth" /><meta name="msapplication-window" content="width=device-width;height=device-height" /><meta name="msapplication-task" content="name=Subscribe;action-uri=https://johncarlosbaez.wordpress.com/feed/;icon-uri=https://s1.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=Sign up for a free blog;action-uri=http://wordpress.com/signup/;icon-uri=https://s1.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=WordPress.com Support;action-uri=http://support.wordpress.com/;icon-uri=https://s1.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=WordPress.com Forums;action-uri=http://forums.wordpress.com/;icon-uri=https://s1.wp.com/i/favicon.ico" /><meta name="description" content="Posts about chemistry written by John Baez" />
<style type="text/css">
#headerimg{
	background: url(https://johncarlosbaez.files.wordpress.com/2010/08/azimuth_header.jpg) no-repeat;
}
#header h1 a, .description {
	color:#E5F2E9;
}
</style>
<!-- There is no amphtml version available for this URL. -->		<link rel="stylesheet" id="custom-css-css" type="text/css" href="https://s0.wp.com/?custom-css=1&#038;csblog=RBZ9&#038;cscache=6&#038;csrev=7" />
		</head>
<body class="archive paged category category-chemistry category-5936 paged-7 category-paged-7 customizer-styles-applied highlander-enabled highlander-light">

<div id="page">

<div id="header">
	<div id="headerimg" onclick="location.href='https://johncarlosbaez.wordpress.com';" style="cursor: pointer;">
		<h1><a href="https://johncarlosbaez.wordpress.com/">Azimuth</a></h1>
		<div class="description"></div>
	</div>
</div>

<ul id="pagebar" class="menu pagebar"><li ><a href="https://johncarlosbaez.wordpress.com/">Home</a></li><li class="page_item page-item-2"><a href="https://johncarlosbaez.wordpress.com/about/">About</a></li>
</ul>

<div id="grad" style="height: 65px; width: 100%; background: url(https://s2.wp.com/wp-content/themes/pub/contempt/images/blue_flower/topgrad.jpg);">&nbsp;</div>

	<div id="content">

	
		
			<div class="post-11611 post type-post status-publish format-standard hentry category-chemistry category-mathematics category-networks category-probability" id="post-11611">
				<h2><a href="https://johncarlosbaez.wordpress.com/2012/08/21/network-theory-part-23/" rel="bookmark">Network Theory (Part&nbsp;23)</a></h2>
				<small>21 August, 2012</small><br />


				<div class="entry">
					<p>We&#8217;ve been looking at reaction networks, and we&#8217;re getting ready to find equilibrium solutions of the equations they give.  To do this, we&#8217;ll need to connect them to another kind of network we&#8217;ve studied.   A reaction network is something like this:</p>
<div align="center"><img width="200" src="https://i0.wp.com/math.ucr.edu/home/baez/networks/chemical_reaction_network_part_20_III.png" alt="" /></div>
<p>It&#8217;s a bunch of <b>complexes</b>, which are sums of basic building-blocks called <b>species</b>, together with arrows called <b>transitions</b> going between the complexes.  If we know a number  for each transition describing the rate at which it occurs, we get an equation called the &#8216;rate equation&#8217;.  This describes how the amount of each species changes with time.   We&#8217;ve been talking about this equation ever since the start of this series!   <a href="http://math.ucr.edu/home/baez/networks/networks_22.html">Last time</a>, we wrote it down in a new very compact form:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bd+x%7D%7Bd+t%7D+%3D+Y+H+x%5EY++%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{d x}{d t} = Y H x^Y  } " class="latex" /></p>
<p>Here <img src="https://s0.wp.com/latex.php?latex=x&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x" class="latex" /> is a vector whose components are the amounts of each species, while <img src="https://s0.wp.com/latex.php?latex=H&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=Y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y" class="latex" /> are certain matrices.</p>
<p>But now suppose we forget how each complex is made of species!  Suppose we just think of them as abstract things in their own right, like numbered boxes:</p>
<div align="center"><img width="200" src="https://i0.wp.com/math.ucr.edu/home/baez/networks/markov_process_vs_reaction_network_1.png" alt="" /></div>
<p>We can use these boxes to describe <b>states</b> of some system.  The arrows still describe <b>transitions</b>, but now we think of these as ways for the system to hop from one state to another.   Say we know a number for each transition describing the probability per time at which it occurs:</p>
<div align="center"><img width="200" src="https://i0.wp.com/math.ucr.edu/home/baez/networks/markov_process_vs_reaction_network_2.png" alt="" /></div>
<p>Then we get a &#8216;Markov process&#8217;&#8212;or in other words, a random walk where our system hops from one state to another.  If <img src="https://s0.wp.com/latex.php?latex=%5Cpsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi" class="latex" /> is the probability distribution saying how likely the system is to be in each state, this Markov process is described by this equation:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bd+%5Cpsi%7D%7Bd+t%7D+%3D+H+%5Cpsi++%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{d &#92;psi}{d t} = H &#92;psi  } " class="latex" /></p>
<p>This is simpler than the rate equation, because it&#8217;s linear.  But the matrix <img src="https://s0.wp.com/latex.php?latex=H&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H" class="latex" /> is the same&mdash;we&#8217;ll see that explicitly later on today.</p>
<p>What&#8217;s the point?  Well, our ultimate goal is to prove the deficiency zero theorem, which gives equilibrium solutions of the rate equation.  That means finding <img src="https://s0.wp.com/latex.php?latex=x&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x" class="latex" /> with </p>
<p><img src="https://s0.wp.com/latex.php?latex=Y+H+x%5EY+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y H x^Y = 0 " class="latex" /></p>
<p>Today we&#8217;ll find all equilibria for the Markov process, meaning all <img src="https://s0.wp.com/latex.php?latex=%5Cpsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi" class="latex" /> with</p>
<p><img src="https://s0.wp.com/latex.php?latex=H+%5Cpsi+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H &#92;psi = 0 " class="latex" /></p>
<p>Then next time we&#8217;ll show some of these have the form</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cpsi+%3D+x%5EY+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi = x^Y " class="latex" /></p>
<p>So, we&#8217;ll get </p>
<p><img src="https://s0.wp.com/latex.php?latex=H+x%5EY+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H x^Y = 0 " class="latex" /></p>
<p>and thus</p>
<p><img src="https://s0.wp.com/latex.php?latex=Y+H+x%5EY+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y H x^Y = 0 " class="latex" /></p>
<p>as desired!</p>
<p>So, let&#8217;s get to to work.</p>
<h3> The Markov process of a graph with rates </h3>
<p>We&#8217;ve been looking at stochastic reaction networks, which are things like this:</p>
<div align="center">
<img src="https://i2.wp.com/math.ucr.edu/home/baez/networks/reaction_network_diagram_1.png" alt="" />
</div>
<p>However, we can build a Markov process starting from just part of this information:</p>
<div align="center">
<img src="https://i1.wp.com/math.ucr.edu/home/baez/networks/markov_process_diagram_1.png" alt="" />
</div>
<p>Let&#8217;s call this thing a &#8216;graph with rates&#8217;, for lack of a better name.  We&#8217;ve been calling the things in <img src="https://s0.wp.com/latex.php?latex=K&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="K" class="latex" /> &#8216;complexes&#8217;, but now we&#8217;ll think of them as &#8216;states&#8217;.  So:</p>
<p><b>Definition.</b>  A <b>graph with rates</b> consists of:</p>
<p>&bull; a finite set of <b>states</b> <img src="https://s0.wp.com/latex.php?latex=K%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="K," class="latex" /></p>
<p>&bull; a finite set of <b>transitions</b> <img src="https://s0.wp.com/latex.php?latex=T%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T," class="latex" /></p>
<p>&bull; a map <img src="https://s0.wp.com/latex.php?latex=r%3A+T+%5Cto+%280%2C%5Cinfty%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="r: T &#92;to (0,&#92;infty)" class="latex" /> giving a <b>rate constant</b> for each transition,</p>
<p>&bull; <b>source</b> and <b>target</b> maps <img src="https://s0.wp.com/latex.php?latex=s%2Ct+%3A+T+%5Cto+K&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s,t : T &#92;to K" class="latex" /> saying where each transition starts and ends.</p>
<p>Starting from this, we can get a <a href="http://math.ucr.edu/home/baez/networks/networks_11.html">Markov process</a> describing how a probability distribution <img src="https://s0.wp.com/latex.php?latex=%5Cpsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi" class="latex" /> on our set of states will change with time.  As usual, this Markov process is described by a master equation:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bd+%5Cpsi%7D%7Bd+t%7D+%3D+H+%5Cpsi+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{d &#92;psi}{d t} = H &#92;psi } " class="latex" /></p>
<p>for some Hamiltonian:</p>
<p><img src="https://s0.wp.com/latex.php?latex=H+%3A+%5Cmathbb%7BR%7D%5EK+%5Cto+%5Cmathbb%7BR%7D%5EK+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H : &#92;mathbb{R}^K &#92;to &#92;mathbb{R}^K " class="latex" /></p>
<p>What is this Hamiltonian, exactly?  Let&#8217;s think of it as a matrix where <img src="https://s0.wp.com/latex.php?latex=H_%7Bi+j%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H_{i j}" class="latex" /> is the probability per time for our system to hop from the state <img src="https://s0.wp.com/latex.php?latex=j&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="j" class="latex" /> to the state <img src="https://s0.wp.com/latex.php?latex=i.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i." class="latex" />   This looks backwards, but don&#8217;t blame me&mdash;blame the guys who invented the usual conventions for matrix algebra.  Clearly if <img src="https://s0.wp.com/latex.php?latex=i+%5Cne+j&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i &#92;ne j" class="latex" /> this probability per time should be the sum of the rate constants of all transitions going from <img src="https://s0.wp.com/latex.php?latex=j&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="j" class="latex" /> to <img src="https://s0.wp.com/latex.php?latex=i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i" class="latex" />:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+i+%5Cne+j+%5Cquad+%5CRightarrow+%5Cquad+H_%7Bi+j%7D+%3D++%5Csum_%7B%5Ctau%3A+j+%5Cto+i%7D+r%28%5Ctau%29+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ i &#92;ne j &#92;quad &#92;Rightarrow &#92;quad H_{i j} =  &#92;sum_{&#92;tau: j &#92;to i} r(&#92;tau) } " class="latex" /></p>
<p>where we write <img src="https://s0.wp.com/latex.php?latex=%5Ctau%3A+j+%5Cto+i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau: j &#92;to i" class="latex" /> when <img src="https://s0.wp.com/latex.php?latex=%5Ctau&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau" class="latex" /> is a transition with source <img src="https://s0.wp.com/latex.php?latex=j&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="j" class="latex" /> and target <img src="https://s0.wp.com/latex.php?latex=i.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i." class="latex" /></p>
<p>Now, we saw in <a href="http://math.ucr.edu/home/baez/networks/networks_11.html">Part 11</a> that for a probability distribution to remain a probability distribution as it evolves in time according to the master equation, we need <img src="https://s0.wp.com/latex.php?latex=H&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H" class="latex" /> to be <b>infinitesimal stochastic</b>: its off-diagonal entries must be nonnegative, and the sum of the entries in each column must be zero.  </p>
<p>The first condition holds already, and the second one tells us what the diagonal entries must be.  So, we&#8217;re basically done describing <img src="https://s0.wp.com/latex.php?latex=H.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H." class="latex" />  But we can summarize it this way:</p>
<p><b>Puzzle 1.</b>  Think of <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5EK&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^K" class="latex" /> as the vector space consisting of finite linear combinations of elements <img src="https://s0.wp.com/latex.php?latex=%5Ckappa+%5Cin+K.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;kappa &#92;in K." class="latex" />  Then show</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B++H+%5Ckappa+%3D+%5Csum_%7Bs%28%5Ctau%29+%3D+%5Ckappa%7D+r%28%5Ctau%29+%28t%28%5Ctau%29+-+s%28%5Ctau%29%29+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{  H &#92;kappa = &#92;sum_{s(&#92;tau) = &#92;kappa} r(&#92;tau) (t(&#92;tau) - s(&#92;tau)) } " class="latex" /> </p>
<h3>  Equilibrium solutions of the master equation </h3>
<p>Now we&#8217;ll classify <b>equilibrium solutions</b> of the master equation, meaning <img src="https://s0.wp.com/latex.php?latex=%5Cpsi+%5Cin+%5Cmathbb%7BR%7D%5EK&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi &#92;in &#92;mathbb{R}^K" class="latex" /> with </p>
<p><img src="https://s0.wp.com/latex.php?latex=H+%5Cpsi+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H &#92;psi = 0 " class="latex" /></p>
<p>We&#8217;ll do only do this when our graph with rates is &#8216;weakly reversible&#8217;.  This concept doesn&#8217;t actually depend on the rates, so let&#8217;s be general and say:</p>
<p><b>Definition.</b> A graph is <b>weakly reversible</b> if for every edge <img src="https://s0.wp.com/latex.php?latex=%5Ctau+%3A+i+%5Cto+j%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau : i &#92;to j," class="latex" /> there is <b>directed path</b> going back from <img src="https://s0.wp.com/latex.php?latex=j&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="j" class="latex" /> to <img src="https://s0.wp.com/latex.php?latex=i%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i," class="latex" /> meaning that we have edges</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Ctau_1+%3A+j+%5Cto+j_1+%2C+%5Cquad+%5Ctau_2+%3A+j_1+%5Cto+j_2+%2C+%5Cquad+%5Cdots%2C+%5Cquad+%5Ctau_n%3A+j_%7Bn-1%7D+%5Cto+i+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau_1 : j &#92;to j_1 , &#92;quad &#92;tau_2 : j_1 &#92;to j_2 , &#92;quad &#92;dots, &#92;quad &#92;tau_n: j_{n-1} &#92;to i " class="latex" /></p>
<p>This graph with rates is <i>not</i> weakly reversible:</p>
<div align="center"><img width="200" src="https://i0.wp.com/math.ucr.edu/home/baez/networks/markov_process_vs_reaction_network_2.png" alt="" /></div>
<p>but this one is:</p>
<div align="center"><img width="200" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/markov_process_vs_reaction_network_3.png" alt="" /></div>
<p>The good thing about the weakly reversible case is that we get one equilibrium solution of the master equation for each component of our graph, and all equilibrium solutions are linear combinations of these.   This is <i>not</i> true in general!  For example, this guy is not weakly reversible:</p>
<div align="center"><img width="240" src="https://i0.wp.com/math.ucr.edu/home/baez/networks/markov_process_not_weakly_reversible.png" alt="" /></div>
<p>It has only one component, but the master equation has two linearly independent equilibrium solutions: one that vanishes except at the state 0, and one that vanishes except at the state 2.  </p>
<p>The idea of a &#8216;component&#8217; is supposed to be fairly intuitive&#8212;our graph falls apart into pieces called components&#8212;but we should make it precise.  As explained in <a href="http://math.ucr.edu/home/baez/networks/networks_21.html">Part 21</a>, the graphs we&#8217;re using here are directed multigraphs, meaning things like</p>
<p><img src="https://s0.wp.com/latex.php?latex=s%2C+t+%3A+E+%5Cto+V++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s, t : E &#92;to V  " class="latex" /></p>
<p>where <img src="https://s0.wp.com/latex.php?latex=E&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="E" class="latex" /> is the set of <b>edges</b> (our transitions) and <img src="https://s0.wp.com/latex.php?latex=V&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="V" class="latex" /> is the set of <b>vertices</b> (our states).    There are actually two famous concepts of &#8216;component&#8217; for graphs of this sort: &#8216;strongly connected&#8217; components and &#8216;connected&#8217; components.   We only need connected components, but let me explain both concepts, in a futile attempt to slake your insatiable thirst for knowledge.</p>
<p>Two vertices <img src="https://s0.wp.com/latex.php?latex=i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=j&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="j" class="latex" /> of a graph lie in the same <b>strongly connected component</b> iff you can find a directed path of edges from <img src="https://s0.wp.com/latex.php?latex=i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i" class="latex" /> to <img src="https://s0.wp.com/latex.php?latex=j&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="j" class="latex" /> and also one from <img src="https://s0.wp.com/latex.php?latex=j&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="j" class="latex" /> back to <img src="https://s0.wp.com/latex.php?latex=i.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i." class="latex" />  </p>
<p>Remember, a directed path from <img src="https://s0.wp.com/latex.php?latex=i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i" class="latex" /> to <img src="https://s0.wp.com/latex.php?latex=j&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="j" class="latex" /> looks like this:</p>
<p><img src="https://s0.wp.com/latex.php?latex=i+%5Cto+a+%5Cto+b+%5Cto+c+%5Cto+j+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i &#92;to a &#92;to b &#92;to c &#92;to j " class="latex" /></p>
<p>Here&#8217;s a path from <img src="https://s0.wp.com/latex.php?latex=x&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x" class="latex" /> to <img src="https://s0.wp.com/latex.php?latex=y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="y" class="latex" /> that is not directed:</p>
<p><img src="https://s0.wp.com/latex.php?latex=i+%5Cto+a+%5Cleftarrow+b+%5Cto+c+%5Cto+j+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i &#92;to a &#92;leftarrow b &#92;to c &#92;to j " class="latex" /></p>
<p>and I hope you can write down the obvious but tedious definition of an &#8216;undirected path&#8217;, meaning a path made of edges that don&#8217;t necessarily point in the correct direction.   Given that, we say two vertices <img src="https://s0.wp.com/latex.php?latex=i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=j&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="j" class="latex" /> lie in the same <b>connected component</b> iff you can find an <i>undirected</i> path going from <img src="https://s0.wp.com/latex.php?latex=i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i" class="latex" /> to <img src="https://s0.wp.com/latex.php?latex=j.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="j." class="latex" />  In this case, there will automatically also be an undirected path going from <img src="https://s0.wp.com/latex.php?latex=j&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="j" class="latex" /> to <img src="https://s0.wp.com/latex.php?latex=i.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i." class="latex" /></p>
<p>For example, <img src="https://s0.wp.com/latex.php?latex=i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=j&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="j" class="latex" /> lie in the same connected component here, but not the same strongly connected component:</p>
<p><img src="https://s0.wp.com/latex.php?latex=i+%5Cto+a+%5Cleftarrow+b+%5Cto+c+%5Cto+j+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i &#92;to a &#92;leftarrow b &#92;to c &#92;to j " class="latex" /></p>
<p>Here&#8217;s a graph with one connected component and 3 strongly connected components, which are marked in blue:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Strongly_connected_component"><img src="https://i2.wp.com/math.ucr.edu/home/baez/networks/strongly_connected_component.png" /></a></div>
<p>For the theory we&#8217;re looking at now, <i>we only care about connected components, not strongly connected components!</i>   However:</p>
<p><b>Puzzle 2.</b>  Show that for weakly reversible graph, the connected components are the same as the strongly connected components.  </p>
<p>With these definitions out of way, we can state today&#8217;s big theorem:</p>
<p><b>Theorem.</b>  Suppose <img src="https://s0.wp.com/latex.php?latex=H&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H" class="latex" /> is the Hamiltonian of a weakly reversible graph with rates:</p>
<div align="center">
<img src="https://i1.wp.com/math.ucr.edu/home/baez/networks/markov_process_diagram_1.png" alt="" />
</div>
<p>Then for each connected component <img src="https://s0.wp.com/latex.php?latex=C+%5Csubseteq+K%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="C &#92;subseteq K," class="latex" /> there exists a unique probability distribution <img src="https://s0.wp.com/latex.php?latex=%5Cpsi_C+%5Cin+%5Cmathbb%7BR%7D%5EK&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi_C &#92;in &#92;mathbb{R}^K" class="latex" /> that is positive on that component, zero elsewhere, and is an equilibrium solution of the master equation:</p>
<p><img src="https://s0.wp.com/latex.php?latex=H+%5Cpsi_C+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H &#92;psi_C = 0 " class="latex" /></p>
<p>Moreover, these probability distributions <img src="https://s0.wp.com/latex.php?latex=%5Cpsi_C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi_C" class="latex" /> form a basis for the space of equilibrium solutions of the master equation.  So, the dimension of this space is the number of components of <img src="https://s0.wp.com/latex.php?latex=K.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="K." class="latex" /></p>
<p><i>Proof.</i>   We start by assuming our graph has one connected component.  We use the Perron&ndash;Frobenius theorem, as explained in <a href="http://math.ucr.edu/home/baez/networks/networks_20.html">Part 20</a>.  This applies to &#8216;nonnegative&#8217; matrices, meaning those whose entries are all nonnegative.  That is not true of <img src="https://s0.wp.com/latex.php?latex=H&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H" class="latex" /> itself, but only its diagonal entries can be negative, so if we choose a large enough number <img src="https://s0.wp.com/latex.php?latex=c+%3E+0%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="c &gt; 0," class="latex" /> <img src="https://s0.wp.com/latex.php?latex=H+%2B+c+I&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H + c I" class="latex" /> will be nonnegative.  </p>
<p>Since our graph is weakly reversible and has one connected component, it follows straight from the definitions that the operator <img src="https://s0.wp.com/latex.php?latex=H+%2B+c+I&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H + c I" class="latex" /> will also be &#8216;irreducible&#8217; in the sense of <a href="http://math.ucr.edu/home/baez/networks/networks_20.html">Part 20</a>.  The Perron&ndash;Frobenius theorem then swings into action, and we instantly conclude several things.</p>
<p>First, <img src="https://s0.wp.com/latex.php?latex=H+%2B+c+I&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H + c I" class="latex" /> has a positive real eigenvalue <img src="https://s0.wp.com/latex.php?latex=r&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="r" class="latex" /> such that any other eigenvalue, possibly complex, has absolute value <img src="https://s0.wp.com/latex.php?latex=%5Cle+r.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;le r." class="latex" />  Second, there is an eigenvector <img src="https://s0.wp.com/latex.php?latex=%5Cpsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi" class="latex" /> with eigenvalue <img src="https://s0.wp.com/latex.php?latex=r&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="r" class="latex" /> and all positive components.  Third, any other eigenvector with eigenvalue <img src="https://s0.wp.com/latex.php?latex=r&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="r" class="latex" /> is a scalar multiple of <img src="https://s0.wp.com/latex.php?latex=%5Cpsi.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi." class="latex" />  </p>
<p>Subtracting <img src="https://s0.wp.com/latex.php?latex=c%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="c," class="latex" /> it follows that <img src="https://s0.wp.com/latex.php?latex=%5Clambda+%3D+r+-+c&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;lambda = r - c" class="latex" /> is the eigenvalue of <img src="https://s0.wp.com/latex.php?latex=H&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H" class="latex" /> with the largest real part.  We have <img src="https://s0.wp.com/latex.php?latex=H+%5Cpsi+%3D+%5Clambda+%5Cpsi%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H &#92;psi = &#92;lambda &#92;psi," class="latex" /> and any other vector with this property is a scalar multiple of <img src="https://s0.wp.com/latex.php?latex=%5Cpsi.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi." class="latex" />   </p>
<p>We can show that in fact <img src="https://s0.wp.com/latex.php?latex=%5Clambda+%3D+0.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;lambda = 0." class="latex" />  To do this we copy an argument from <a href="http://math.ucr.edu/home/baez/networks/networks_20.html">Part 20</a>.   First, since <img src="https://s0.wp.com/latex.php?latex=%5Cpsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi" class="latex" /> is positive we can normalize it to be a probability distribution:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Csum_%7Bi+%5Cin+K%7D+%5Cpsi_i+%3D+1+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;sum_{i &#92;in K} &#92;psi_i = 1 } " class="latex" /></p>
<p>Since <img src="https://s0.wp.com/latex.php?latex=H&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H" class="latex" /> is infinitesimal stochastic, <img src="https://s0.wp.com/latex.php?latex=%5Cexp%28t+H%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;exp(t H)" class="latex" /> sends probability distributions to probability distributions:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Csum_%7Bi+%5Cin+K%7D+%28%5Cexp%28t+H%29+%5Cpsi%29_i+%3D+1+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;sum_{i &#92;in K} (&#92;exp(t H) &#92;psi)_i = 1 } " class="latex" /></p>
<p>for all <img src="https://s0.wp.com/latex.php?latex=t+%5Cge+0.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="t &#92;ge 0." class="latex" />  On the other hand,</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Csum_%7Bi+%5Cin+K%7D+%28%5Cexp%28t+H%29%5Cpsi%29_i+%3D+%5Csum_%7Bi+%5Cin+K%7D+e%5E%7Bt+%5Clambda%7D+%5Cpsi_i+%3D+e%5E%7Bt+%5Clambda%7D+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;sum_{i &#92;in K} (&#92;exp(t H)&#92;psi)_i = &#92;sum_{i &#92;in K} e^{t &#92;lambda} &#92;psi_i = e^{t &#92;lambda} } " class="latex" /></p>
<p>so we must have <img src="https://s0.wp.com/latex.php?latex=%5Clambda+%3D+0.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;lambda = 0." class="latex" />  </p>
<p>We conclude that when our graph has one connected component, there is a probability distribution <img src="https://s0.wp.com/latex.php?latex=%5Cpsi+%5Cin+%5Cmathbb%7BR%7D%5EK&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi &#92;in &#92;mathbb{R}^K" class="latex" /> that is positive everywhere and has <img src="https://s0.wp.com/latex.php?latex=H+%5Cpsi+%3D+0.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H &#92;psi = 0." class="latex" />  Moreover, any <img src="https://s0.wp.com/latex.php?latex=%5Cphi+%5Cin+%5Cmathbb%7BR%7D%5EK&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;phi &#92;in &#92;mathbb{R}^K" class="latex" /> with <img src="https://s0.wp.com/latex.php?latex=H+%5Cphi+%3D+0&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H &#92;phi = 0" class="latex" /> is a scalar multiple of <img src="https://s0.wp.com/latex.php?latex=%5Cpsi.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi." class="latex" /></p>
<p>When <img src="https://s0.wp.com/latex.php?latex=K&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="K" class="latex" /> has several components, the matrix <img src="https://s0.wp.com/latex.php?latex=H&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H" class="latex" /> is block diagonal, with one block for each component.  So, we can run the above argument on each component <img src="https://s0.wp.com/latex.php?latex=C+%5Csubseteq+K&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="C &#92;subseteq K" class="latex" /> and get a probability distribution <img src="https://s0.wp.com/latex.php?latex=%5Cpsi_C+%5Cin+%5Cmathbb%7BR%7D%5EK&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi_C &#92;in &#92;mathbb{R}^K" class="latex" /> that is positive on <img src="https://s0.wp.com/latex.php?latex=C.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="C." class="latex" />  We can then check that <img src="https://s0.wp.com/latex.php?latex=H+%5Cpsi_C+%3D+0&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H &#92;psi_C = 0" class="latex" /> and that every <img src="https://s0.wp.com/latex.php?latex=%5Cphi+%5Cin+%5Cmathbb%7BR%7D%5EK&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;phi &#92;in &#92;mathbb{R}^K" class="latex" /> with <img src="https://s0.wp.com/latex.php?latex=H+%5Cphi+%3D+0&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H &#92;phi = 0" class="latex" /> can be expressed as a linear combination of these probability distributions <img src="https://s0.wp.com/latex.php?latex=%5Cpsi_C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi_C" class="latex" /> in a unique way.   &nbsp;  &#9608;</p>
<p>This result must be absurdly familiar to people who study Markov processes, but I haven&#8217;t bothered to look up a reference yet.  Do you happen to know a good one?  I&#8217;d like to see one that generalizes this theorem to graphs that aren&#8217;t weakly reversible.  I think I see how it goes.  We don&#8217;t need that generalization right now, but it would be good to have around.</p>
<h3> The Hamiltonian, revisited </h3>
<p>One last small piece of business: <a href="http://math.ucr.edu/home/baez/networks/networks_22.html">last time</a> I showed you a very slick formula for the Hamiltonian <img src="https://s0.wp.com/latex.php?latex=H.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H." class="latex" />  I&#8217;d like to prove it agrees with the formula I gave this time.</p>
<p>We start with any graph with rates:</p>
<div align="center">
<img src="https://i1.wp.com/math.ucr.edu/home/baez/networks/markov_process_diagram_1.png" alt="" />
</div>
<p>We extend <img src="https://s0.wp.com/latex.php?latex=s&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=t&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="t" class="latex" /> to linear maps between vector spaces:</p>
<div align="center">
<img src="https://i0.wp.com/math.ucr.edu/home/baez/networks/markov_process_diagram_4.png" /></div>
<p>We define the <b>boundary operator</b> just as we did last time:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cpartial+%3D+t+-+s+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;partial = t - s " class="latex" /></p>
<p>Then we put an inner product on the vector spaces <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5ET&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^T" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5EK.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^K." class="latex" />  So, for <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5EK&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^K" class="latex" /> we let the elements of <img src="https://s0.wp.com/latex.php?latex=K&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="K" class="latex" /> be an orthonormal basis, but for <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5ET&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^T" class="latex" /> we define the inner product in a more clever way involving the rate constants:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Clangle+%5Ctau%2C+%5Ctau%27+%5Crangle+%3D+%5Cfrac%7B1%7D%7Br%28%5Ctau%29%7D+%5Cdelta_%7B%5Ctau%2C+%5Ctau%27%7D+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;langle &#92;tau, &#92;tau&#039; &#92;rangle = &#92;frac{1}{r(&#92;tau)} &#92;delta_{&#92;tau, &#92;tau&#039;} } " class="latex" /></p>
<p>where <img src="https://s0.wp.com/latex.php?latex=%5Ctau%2C+%5Ctau%27+%5Cin+T.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau, &#92;tau&#039; &#92;in T." class="latex" />  This lets us define adjoints of the maps <img src="https://s0.wp.com/latex.php?latex=s%2C+t&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s, t" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=%5Cpartial%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;partial," class="latex" /> via formulas like this:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Clangle+s%5E%5Cdagger+%5Cphi%2C+%5Cpsi+%5Crangle+%3D+%5Clangle+%5Cphi%2C+s+%5Cpsi+%5Crangle+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;langle s^&#92;dagger &#92;phi, &#92;psi &#92;rangle = &#92;langle &#92;phi, s &#92;psi &#92;rangle " class="latex" /></p>
<p>Then:</p>
<p><b>Theorem.</b>  The Hamiltonian for a graph with rates is given by </p>
<p><img src="https://s0.wp.com/latex.php?latex=H+%3D+%5Cpartial+s%5E%5Cdagger+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H = &#92;partial s^&#92;dagger " class="latex" /></p>
<p><i>Proof.</i>  It suffices to check that this formula agrees with the formula for <img src="https://s0.wp.com/latex.php?latex=H&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H" class="latex" /> given in Puzzle 1:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+++H+%5Ckappa+%3D+%5Csum_%7Bs%28%5Ctau%29+%3D+%5Ckappa%7D+r%28%5Ctau%29+%28t%28%5Ctau%29+-+s%28%5Ctau%29%29+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{   H &#92;kappa = &#92;sum_{s(&#92;tau) = &#92;kappa} r(&#92;tau) (t(&#92;tau) - s(&#92;tau)) } " class="latex" /> </p>
<p>Here we are using the complex <img src="https://s0.wp.com/latex.php?latex=%5Ckappa+%5Cin+K&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;kappa &#92;in K" class="latex" /> as a name for one of the standard basis vectors of <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5EK.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^K." class="latex" />   Similarly shall we write things like <img src="https://s0.wp.com/latex.php?latex=%5Ctau&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau" class="latex" /> or <img src="https://s0.wp.com/latex.php?latex=%5Ctau%27&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau&#039;" class="latex" /> for basis vectors of <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5ET.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^T." class="latex" /></p>
<p>First, we claim that</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+s%5E%5Cdagger+%5Ckappa+%3D+%5Csum_%7B%5Ctau%3A+%5C%3B+s%28%5Ctau%29+%3D+%5Ckappa%7D+r%28%5Ctau%29+%5C%2C+%5Ctau+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ s^&#92;dagger &#92;kappa = &#92;sum_{&#92;tau: &#92;; s(&#92;tau) = &#92;kappa} r(&#92;tau) &#92;, &#92;tau } " class="latex" /></p>
<p>To prove this it&#8217;s enough to check that taking the inner products of either sides with any basis vector <img src="https://s0.wp.com/latex.php?latex=%5Ctau%27%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau&#039;," class="latex" /> we get results that agree.  On the one hand:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Barray%7D%7Bccl%7D++%5Clangle+%5Ctau%27+%2C+s%5E%5Cdagger+%5Ckappa+%5Crangle+%26%3D%26+++%5Clangle+s+%5Ctau%27%2C+%5Ckappa+%5Crangle+%5C%5C++%5C%5C++%26%3D%26+%5Cdelta_%7Bs%28%5Ctau%27%29%2C+%5Ckappa%7D++++%5Cend%7Barray%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;begin{array}{ccl}  &#92;langle &#92;tau&#039; , s^&#92;dagger &#92;kappa &#92;rangle &amp;=&amp;   &#92;langle s &#92;tau&#039;, &#92;kappa &#92;rangle &#92;&#92;  &#92;&#92;  &amp;=&amp; &#92;delta_{s(&#92;tau&#039;), &#92;kappa}    &#92;end{array} " class="latex" /></p>
<p>On the other hand:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Barray%7D%7Bccl%7D+%5Cdisplaystyle%7B+%5Clangle+%5Ctau%27%2C+%5Csum_%7B%5Ctau%3A+%5C%3B+s%28%5Ctau%29+%3D+%5Ckappa%7D+r%28%5Ctau%29+%5C%2C+%5Ctau+%5Crangle+%7D+%26%3D%26++%5Csum_%7B%5Ctau%3A+%5C%3B+s%28%5Ctau%29+%3D+%5Ckappa%7D+r%28%5Ctau%29+%5C%2C+%5Clangle+%5Ctau%27%2C+%5Ctau+%5Crangle+++%5C%5C++%5C%5C++%26%3D%26+%5Cdisplaystyle%7B+%5Csum_%7B%5Ctau%3A+%5C%3B+s%28%5Ctau%29+%3D+%5Ckappa%7D+%5Cdelta_%7B%5Ctau%27%2C+%5Ctau%7D+%7D+++%5C%5C++%5C%5C++%26%3D%26+++%5Cdelta_%7Bs%28%5Ctau%27%29%2C+%5Ckappa%7D+++%5Cend%7Barray%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;begin{array}{ccl} &#92;displaystyle{ &#92;langle &#92;tau&#039;, &#92;sum_{&#92;tau: &#92;; s(&#92;tau) = &#92;kappa} r(&#92;tau) &#92;, &#92;tau &#92;rangle } &amp;=&amp;  &#92;sum_{&#92;tau: &#92;; s(&#92;tau) = &#92;kappa} r(&#92;tau) &#92;, &#92;langle &#92;tau&#039;, &#92;tau &#92;rangle   &#92;&#92;  &#92;&#92;  &amp;=&amp; &#92;displaystyle{ &#92;sum_{&#92;tau: &#92;; s(&#92;tau) = &#92;kappa} &#92;delta_{&#92;tau&#039;, &#92;tau} }   &#92;&#92;  &#92;&#92;  &amp;=&amp;   &#92;delta_{s(&#92;tau&#039;), &#92;kappa}   &#92;end{array} " class="latex" /></p>
<p>where the factor of <img src="https://s0.wp.com/latex.php?latex=1%2Fr%28%5Ctau%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="1/r(&#92;tau)" class="latex" /> in the inner product on <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5ET&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^T" class="latex" /> cancels the visible factor of <img src="https://s0.wp.com/latex.php?latex=r%28%5Ctau%29.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="r(&#92;tau)." class="latex" />    So indeed the results match.</p>
<p>Using this formula for <img src="https://s0.wp.com/latex.php?latex=s%5E%5Cdagger+%5Ckappa&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s^&#92;dagger &#92;kappa" class="latex" />  we now see that</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Barray%7D%7Bccl%7D++H+%5Ckappa+%26%3D%26+%5Cpartial+s%5E%5Cdagger+%5Ckappa+++%5C%5C++%5C%5C++%26%3D%26+%5Cpartial+%5Cdisplaystyle%7B+%5Csum_%7B%5Ctau%3A+%5C%3B+s%28%5Ctau%29+%3D+%5Ckappa%7D+r%28%5Ctau%29+%5C%2C+%5Ctau+%7D++++%5C%5C++%5C%5C++%26%3D%26+%5Cdisplaystyle%7B+%5Csum_%7B%5Ctau%3A+%5C%3B+s%28%5Ctau%29+%3D+%5Ckappa%7D+r%28%5Ctau%29+%5C%2C+%28t%28%5Ctau%29+-+s%28%5Ctau%29%29+%7D++%5Cend%7Barray%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;begin{array}{ccl}  H &#92;kappa &amp;=&amp; &#92;partial s^&#92;dagger &#92;kappa   &#92;&#92;  &#92;&#92;  &amp;=&amp; &#92;partial &#92;displaystyle{ &#92;sum_{&#92;tau: &#92;; s(&#92;tau) = &#92;kappa} r(&#92;tau) &#92;, &#92;tau }    &#92;&#92;  &#92;&#92;  &amp;=&amp; &#92;displaystyle{ &#92;sum_{&#92;tau: &#92;; s(&#92;tau) = &#92;kappa} r(&#92;tau) &#92;, (t(&#92;tau) - s(&#92;tau)) }  &#92;end{array} " class="latex" /></p>
<p>which is precisely what we want.  &nbsp;  &#9608;</p>
<p>I hope you see through the formulas to their intuitive meaning.  As usual, the formulas are just a way of precisely saying something that makes plenty of sense.  If <img src="https://s0.wp.com/latex.php?latex=%5Ckappa&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;kappa" class="latex" /> is some state of our Markov process, <img src="https://s0.wp.com/latex.php?latex=s%5E%5Cdagger+%5Ckappa&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s^&#92;dagger &#92;kappa" class="latex" /> is the sum of all transitions starting at this state, weighted by their rates.  Applying <img src="https://s0.wp.com/latex.php?latex=%5Cpartial&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;partial" class="latex" /> to a transition tells us what change in state it causes.  So <img src="https://s0.wp.com/latex.php?latex=%5Cpartial+s%5E%5Cdagger+%5Ckappa&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;partial s^&#92;dagger &#92;kappa" class="latex" /> tells us the rate at which things change when we start in the state <img src="https://s0.wp.com/latex.php?latex=%5Ckappa.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;kappa." class="latex" /> That&#8217;s why <img src="https://s0.wp.com/latex.php?latex=%5Cpartial+s%5E%5Cdagger&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;partial s^&#92;dagger" class="latex" /> is the Hamiltonian for our Markov process.  After all, the Hamiltonian tells us how things change:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bd+%5Cpsi%7D%7Bd+t%7D+%3D+H+%5Cpsi+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{d &#92;psi}{d t} = H &#92;psi } " class="latex" /></p>
<p>Okay, we&#8217;ve got all the machinery in place.  Next time we&#8217;ll prove the deficiency zero theorem!</p>
									</div>

				<p class="postmetadata">
				<img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/speech_bubble.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2012/08/21/network-theory-part-23/#comments">9 Comments</a>				| <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/documents.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/category/chemistry/" rel="category tag">chemistry</a>, <a href="https://johncarlosbaez.wordpress.com/category/mathematics/" rel="category tag">mathematics</a>, <a href="https://johncarlosbaez.wordpress.com/category/networks/" rel="category tag">networks</a>, <a href="https://johncarlosbaez.wordpress.com/category/probability/" rel="category tag">probability</a>								 | <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/permalink.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2012/08/21/network-theory-part-23/" rel="bookmark" title="Permanent Link to Network Theory (Part&nbsp;23)">Permalink</a>
<br /><img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/figure_ver1.gif" alt="" /> Posted by John Baez				</p>
			</div>
			<hr />
		
			<div class="post-11586 post type-post status-publish format-standard hentry category-chemistry category-mathematics category-networks" id="post-11586">
				<h2><a href="https://johncarlosbaez.wordpress.com/2012/08/16/network-theory-part-22/" rel="bookmark">Network Theory (Part&nbsp;22)</a></h2>
				<small>16 August, 2012</small><br />


				<div class="entry">
					<p>Okay, now let&#8217;s dig deeper into the proof of the deficiency zero theorem.  We&#8217;re only going to prove a baby version, at first.  Later we can enhance it:</p>
<p><b>Deficiency Zero Theorem (Baby Version).</b>   Suppose we have a weakly reversible reaction network with deficiency zero.  Then for any choice of rate constants there exists an equilibrium solution of the rate equation where all species are present in nonzero amounts.</p>
<p>The first step is to write down the rate equation in a new, more conceptual way.  It&#8217;s incredibly cool.   You&#8217;ve probably seen Schr&ouml;dinger&#8217;s equation, which describes the motion of a quantum particle:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle+%7B+%5Cfrac%7Bd+%5Cpsi%7D%7Bd+t%7D+%3D+-i+H+%5Cpsi+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle { &#92;frac{d &#92;psi}{d t} = -i H &#92;psi } " class="latex" /></p>
<p>If you&#8217;ve been following this series, you&#8217;ve probably also seen the master equation, which describes the motion of a &#8216;stochastic&#8217; particle:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle+%7B+%5Cfrac%7Bd+%5Cpsi%7D%7Bd+t%7D+%3D+H+%5Cpsi+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle { &#92;frac{d &#92;psi}{d t} = H &#92;psi } " class="latex" /></p>
<p>A &#8216;stochastic&#8217; particle is one that&#8217;s carrying out a random walk, and now <img src="https://s0.wp.com/latex.php?latex=%5Cpsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi" class="latex" /> describes its probability to be somewhere, instead of its amplitude.</p>
<p>Today we&#8217;ll see that the rate equation for a reaction network looks somewhat similar:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle+%7B+%5Cfrac%7Bd+x%7D%7Bd+t%7D+%3D++Y+H+x%5EY+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle { &#92;frac{d x}{d t} =  Y H x^Y } " class="latex" /></p>
<p>where <img src="https://s0.wp.com/latex.php?latex=Y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y" class="latex" /> is some matrix, and <img src="https://s0.wp.com/latex.php?latex=x%5EY&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x^Y" class="latex" /> is defined using a new thing called &#8216;matrix exponentiation&#8217;, which makes the equation <i>nonlinear!</i> </p>
<p>If you&#8217;re reading this you probably know how to multiply a vector by a matrix.  But if you&#8217;re like me, you&#8217;ve never seen anyone take a vector and raise to the power of some matrix!   I&#8217;ll explain it, don&#8217;t worry&#8230; right now I&#8217;m just trying to get you intrigued.  It&#8217;s not complicated, but it&#8217;s exciting how this unusual operation shows up naturally in chemistry.  That&#8217;s just what I&#8217;m looking for these days: new math ideas that show up in practical subjects like chemistry, and new ways that math can help people in these subjects.</p>
<p>Since we&#8217;re looking for an <i>equilibrium</i> solution of the rate equation, we actually want to solve</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle+%7B+%5Cfrac%7Bd+x%7D%7Bd+t%7D+%3D++0+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle { &#92;frac{d x}{d t} =  0 } " class="latex" /></p>
<p>or in other words</p>
<p><img src="https://s0.wp.com/latex.php?latex=Y+H+x%5EY+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y H x^Y = 0 " class="latex" /></p>
<p>In fact we will do better: we will find a solution of</p>
<p><img src="https://s0.wp.com/latex.php?latex=H+x%5EY+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H x^Y = 0 " class="latex" /></p>
<p>And we&#8217;ll do this in two stages:</p>
<p>&bull; First we&#8217;ll find all solutions of</p>
<p><img src="https://s0.wp.com/latex.php?latex=H+%5Cpsi+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H &#92;psi = 0 " class="latex" /></p>
<p>This equation is <i>linear</i>, so it&#8217;s easy to understand.</p>
<p>&bull; Then, among these solutions <img src="https://s0.wp.com/latex.php?latex=%5Cpsi%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi," class="latex" /> we&#8217;ll find one that also obeys</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cpsi+%3D+x%5EY+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi = x^Y " class="latex" /></p>
<p>This is a <i>nonlinear</i> problem involving matrix exponentiation, but still, we can do it, using a clever trick called &#8216;logarithms&#8217;.</p>
<p>Putting the pieces together, we get our solution of </p>
<p><img src="https://s0.wp.com/latex.php?latex=H+x%5EY+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H x^Y = 0 " class="latex" /></p>
<p>and thus our equilibrium solution of the rate equation:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle+%7B+%5Cfrac%7Bd+x%7D%7Bd+t%7D+%3D+Y+H+x%5EY+%3D+0+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle { &#92;frac{d x}{d t} = Y H x^Y = 0 } " class="latex" /></p>
<p>That&#8217;s a rough outline of the plan.  But now let&#8217;s get started, because the details are actually fascinating.  Today I&#8217;ll just show you how to rewrite the rate equation in this new way.</p>
<h3> The rate equation </h3>
<p>Remember how the rate equation goes.  We start with a <b>stochastic reaction network</b>, meaning a little diagram like this:</p>
<div align="center">
<img src="https://i2.wp.com/math.ucr.edu/home/baez/networks/reaction_network_diagram_1.png" alt="" />
</div>
<p>This contains quite a bit of information:</p>
<p>&bull; a finite set <img src="https://s0.wp.com/latex.php?latex=T&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T" class="latex" /> of <b>transitions</b>,</p>
<p>&bull; a finite set <img src="https://s0.wp.com/latex.php?latex=K&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="K" class="latex" /> of <b>complexes</b>,</p>
<p>&bull; a finite set <img src="https://s0.wp.com/latex.php?latex=S&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S" class="latex" /> of <b>species</b>, </p>
<p>&bull; a map <img src="https://s0.wp.com/latex.php?latex=r%3A+T+%5Cto+%280%2C%5Cinfty%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="r: T &#92;to (0,&#92;infty)" class="latex" /> giving a <b>rate constant</b> for each transition,</p>
<p>&bull; <b>source</b> and <b>target</b> maps <img src="https://s0.wp.com/latex.php?latex=s%2Ct+%3A+T+%5Cto+K&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s,t : T &#92;to K" class="latex" /> saying where each transition starts and ends,</p>
<p>&bull; a one-to-one map <img src="https://s0.wp.com/latex.php?latex=Y+%3A+K+%5Cto+%5Cmathbb%7BN%7D%5ES&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y : K &#92;to &#92;mathbb{N}^S" class="latex" /> saying how each complex is made of species.</p>
<p>Given all this, the rate equation says how the amount of each species changes with time.  We describe these amounts with a vector <img src="https://s0.wp.com/latex.php?latex=x+%5Cin+%5B0%2C%5Cinfty%29%5ES.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x &#92;in [0,&#92;infty)^S." class="latex" />  So, we want a differential equation filling in the question marks here:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bd+x%7D%7Bd+t%7D+%3D+%3F%3F%3F+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{d x}{d t} = ??? } " class="latex" /></p>
<p>Now <a href="https://johncarlosbaez.wordpress.com/2012/08/14/network-theory-part-21/">last time</a>, we started by thinking of <img src="https://s0.wp.com/latex.php?latex=K&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="K" class="latex" /> as a subset of <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BN%7D%5ES%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{N}^S," class="latex" /> and thus of the vector space <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5ES.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^S." class="latex" />  Back then, we wrote the rate equation as follows:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bd+x%7D%7Bd+t%7D+%3D+%5Csum_%7B%5Ctau+%5Cin+T%7D+r%28%5Ctau%29+%5C%3B+%5Cleft%28t%28%5Ctau%29+-+s%28%5Ctau%29%5Cright%29+%5C%3B+x%5E%7Bs%28%5Ctau%29%7D+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{d x}{d t} = &#92;sum_{&#92;tau &#92;in T} r(&#92;tau) &#92;; &#92;left(t(&#92;tau) - s(&#92;tau)&#92;right) &#92;; x^{s(&#92;tau)} } " class="latex" /></p>
<p>where vector exponentiation is defined by</p>
<p><img src="https://s0.wp.com/latex.php?latex=x%5Es+%3D+x_1%5E%7Bs_1%7D+%5Ccdots+x_k%5E%7Bs_k%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x^s = x_1^{s_1} &#92;cdots x_k^{s_k} " class="latex" /></p>
<p>when <img src="https://s0.wp.com/latex.php?latex=x&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=s&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s" class="latex" /> are vectors in <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5ES.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^S." class="latex" /></p>
<p>However, we&#8217;ve now switched to thinking of our set of complexes <img src="https://s0.wp.com/latex.php?latex=K&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="K" class="latex" /> as a set in its own right that is mapped into <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BN%7D%5ES&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{N}^S" class="latex" /> by <img src="https://s0.wp.com/latex.php?latex=Y.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y." class="latex" />  This is good for lots of reasons, like defining the concept of &#8216;deficiency&#8217;, which we did last time.   But it means the rate equation above doesn&#8217;t quite parse anymore!   Things like <img src="https://s0.wp.com/latex.php?latex=s%28%5Ctau%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s(&#92;tau)" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=t%28%5Ctau%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="t(&#92;tau)" class="latex" /> live in <img src="https://s0.wp.com/latex.php?latex=K&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="K" class="latex" />; we need to explicitly convert them into elements of <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5ES&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^S" class="latex" /> using <img src="https://s0.wp.com/latex.php?latex=Y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y" class="latex" /> for our equation to make sense!</p>
<p>So now we have to write the <b>rate equation</b> like this:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bd+x%7D%7Bd+t%7D+%3D+Y+%5Csum_%7B%5Ctau+%5Cin+T%7D+r%28%5Ctau%29+%5C%3B++%5Cleft%28t%28%5Ctau%29+-+s%28%5Ctau%29%5Cright%29+%5C%3B+x%5E%7BY+s%28%5Ctau%29%7D+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{d x}{d t} = Y &#92;sum_{&#92;tau &#92;in T} r(&#92;tau) &#92;;  &#92;left(t(&#92;tau) - s(&#92;tau)&#92;right) &#92;; x^{Y s(&#92;tau)} } " class="latex" /></p>
<p>This looks more ugly, but if you&#8217;ve got even one mathematical bone in your body, you can already see vague glimmerings of how we&#8217;ll rewrite this the way we want:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle+%7B+%5Cfrac%7Bd+x%7D%7Bd+t%7D+%3D++Y+H+x%5EY+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle { &#92;frac{d x}{d t} =  Y H x^Y } " class="latex" /></p>
<p>Here&#8217;s how.</p>
<p>First, we extend our maps <img src="https://s0.wp.com/latex.php?latex=s%2C+t&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s, t" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=Y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y" class="latex" /> to linear maps between vector spaces:</p>
<div align="center">
<img src="https://i0.wp.com/math.ucr.edu/home/baez/networks/reaction_network_diagram_6.png" /></div>
<p>Then, we put an inner product on the vector spaces <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5ET%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^T," class="latex" /> <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5EK&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^K" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5ES.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^S." class="latex" />  For <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5EK&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^K" class="latex" /> we do this in the most obvious way, by letting the complexes be an orthonormal basis.  So, given two complexes <img src="https://s0.wp.com/latex.php?latex=%5Ckappa%2C+%5Ckappa%27%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;kappa, &#92;kappa&#039;," class="latex" /> we define their inner product by</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Clangle+%5Ckappa%2C+%5Ckappa%27+%5Crangle+%3D+%5Cdelta_%7B%5Ckappa%2C+%5Ckappa%27%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;langle &#92;kappa, &#92;kappa&#039; &#92;rangle = &#92;delta_{&#92;kappa, &#92;kappa&#039;} " class="latex" /></p>
<p>We do the same for <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5ES.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^S." class="latex" />  But for <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5ET&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^T" class="latex" /> we define the inner product in a more clever way involving the rate constants.  If <img src="https://s0.wp.com/latex.php?latex=%5Ctau%2C+%5Ctau%27+%5Cin+T&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau, &#92;tau&#039; &#92;in T" class="latex" /> are two transitions, we define their inner product by:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Clangle+%5Ctau%2C+%5Ctau%27+%5Crangle+%3D+%5Cfrac%7B1%7D%7Br%28%5Ctau%29%7D+%5Cdelta_%7B%5Ctau%2C+%5Ctau%27%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;langle &#92;tau, &#92;tau&#039; &#92;rangle = &#92;frac{1}{r(&#92;tau)} &#92;delta_{&#92;tau, &#92;tau&#039;} " class="latex" /></p>
<p>This will seem perfectly natural when we continue our study of circuits made of electrical resistors, and if you&#8217;re very clever you can already see it lurking in <a href="http://math.ucr.edu/home/baez/networks/networks_16.html">Part 16</a>.  But never mind.</p>
<p>Having put inner products on these three vector spaces, we can take the adjoints of the linear maps between them, to get linear maps going back the other way:</p>
<div align="center">
<img src="https://i1.wp.com/math.ucr.edu/home/baez/networks/reaction_network_diagram_3.png" /></div>
<p>These are defined in the usual way&#8212;though we&#8217;re using daggers here they way physicists do, where mathematicians would prefer to see stars!   For example, <img src="https://s0.wp.com/latex.php?latex=s%5E%5Cdagger+%3A+%5Cmathbb%7BR%7D%5EK+%5Cto+%5Cmathbb%7BR%7D%5ET&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s^&#92;dagger : &#92;mathbb{R}^K &#92;to &#92;mathbb{R}^T" class="latex" /> is defined by the relation</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Clangle+s%5E%5Cdagger+%5Cphi%2C+%5Cpsi+%5Crangle+%3D+%5Clangle+%5Cphi%2C+s+%5Cpsi+%5Crangle+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;langle s^&#92;dagger &#92;phi, &#92;psi &#92;rangle = &#92;langle &#92;phi, s &#92;psi &#92;rangle " class="latex" /></p>
<p>and so on.</p>
<p>Next, we set up a random walk on the set of complexes.  Remember, our reaction network is a graph with complexes as vertices and transitions as edges, like this:</p>
<div align="center">
<img width="200" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/chemical_reaction_network_part_20_V.png" alt="" />
</div>
<p>Each transition <img src="https://s0.wp.com/latex.php?latex=%5Ctau&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau" class="latex" /> has a number attached to it: the rate constant <img src="https://s0.wp.com/latex.php?latex=r%28%5Ctau%29.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="r(&#92;tau)." class="latex" />  So, we can randomly hop from complex to complex along these transitions, with probabilities per unit time described by these numbers.  The probability of being at some particular complex will then be described by a function </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cpsi+%3A+K+%5Cto+%5Cmathbb%7BR%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi : K &#92;to &#92;mathbb{R} " class="latex" /></p>
<p>which also depends on time, and changes according to the equation</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle+%7B+%5Cfrac%7Bd+%5Cpsi%7D%7Bd+t%7D+%3D+H+%5Cpsi+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle { &#92;frac{d &#92;psi}{d t} = H &#92;psi } " class="latex" /></p>
<p>for some <b>Hamiltonian</b> </p>
<p><img src="https://s0.wp.com/latex.php?latex=H+%3A+%5Cmathbb%7BR%7D%5EK+%5Cto+%5Cmathbb%7BR%7D%5EK+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H : &#92;mathbb{R}^K &#92;to &#92;mathbb{R}^K " class="latex" /></p>
<p>I defined this Hamiltonian back in <a href="https://johncarlosbaez.wordpress.com/2011/10/26/network-theory-part-15/">Part 15</a>, but now I see a slicker way to write it:</p>
<p><img src="https://s0.wp.com/latex.php?latex=H+%3D+%28t+-+s%29+s%5E%5Cdagger+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H = (t - s) s^&#92;dagger " class="latex" /></p>
<p>I&#8217;ll justify this next time.  For now, the main point is that with this Hamiltonian, the rate equation is equivalent to this:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bd+x%7D%7Bd+t%7D+%3D+Y+H+x%5EY+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{d x}{d t} = Y H x^Y } " class="latex" /></p>
<p>The only thing I haven&#8217;t defined yet is the funny exponential <img src="https://s0.wp.com/latex.php?latex=x%5EY.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x^Y." class="latex" />  That&#8217;s what makes the equation nonlinear.  We&#8217;re taking a <i>vector</i> to the power of a <i>matrix</i> and getting a <i>vector</i>.  This sounds weird&#8212;but it actually makes sense!</p>
<p>It only makes sense because we have chosen bases for our vector spaces. To understand it, let&#8217;s number our species <img src="https://s0.wp.com/latex.php?latex=1%2C+%5Cdots%2C+k&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="1, &#92;dots, k" class="latex" /> as we&#8217;ve been doing all along, and number our complexes <img src="https://s0.wp.com/latex.php?latex=1%2C+%5Cdots%2C+%5Cell.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="1, &#92;dots, &#92;ell." class="latex" />   Our linear map <img src="https://s0.wp.com/latex.php?latex=Y+%3A+%5Cmathbb%7BR%7D%5EK+%5Cto+%5Cmathbb%7BR%7D%5ES&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y : &#92;mathbb{R}^K &#92;to &#92;mathbb{R}^S" class="latex" /> then becomes a <img src="https://s0.wp.com/latex.php?latex=k+%5Ctimes+%5Cell&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="k &#92;times &#92;ell" class="latex" /> matrix of natural numbers.  Its entries say how many times each species shows up in each complex:</p>
<p><img src="https://s0.wp.com/latex.php?latex=Y+%3D+%5Cleft%28+%5Cbegin%7Barray%7D%7Bcccc%7D+++Y_%7B11%7D+%26+Y_%7B12%7D++%26+%5Ccdots+%26+Y_%7B1+%5Cell%7D+%5C%5C++Y_%7B21%7D+%26+Y_%7B22%7D++%26+%5Ccdots+%26+Y_%7B2+%5Cell%7D+%5C%5C++%5Cvdots++%26+%5Cvdots+++%26+%5Cddots+%26+%5Cvdots+%5C%5C++Y_%7Bk1%7D+%26+Y_%7Bk2%7D++%26+%5Ccdots+%26+Y_%7Bk+%5Cell%7D+%5Cend%7Barray%7D+%5Cright%29+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y = &#92;left( &#92;begin{array}{cccc}   Y_{11} &amp; Y_{12}  &amp; &#92;cdots &amp; Y_{1 &#92;ell} &#92;&#92;  Y_{21} &amp; Y_{22}  &amp; &#92;cdots &amp; Y_{2 &#92;ell} &#92;&#92;  &#92;vdots  &amp; &#92;vdots   &amp; &#92;ddots &amp; &#92;vdots &#92;&#92;  Y_{k1} &amp; Y_{k2}  &amp; &#92;cdots &amp; Y_{k &#92;ell} &#92;end{array} &#92;right) " class="latex" /></p>
<p>The entry <img src="https://s0.wp.com/latex.php?latex=Y_%7Bi+j%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y_{i j}" class="latex" /> says how many times the <img src="https://s0.wp.com/latex.php?latex=i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i" class="latex" />th species shows up in the <img src="https://s0.wp.com/latex.php?latex=j&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="j" class="latex" />th complex.  </p>
<p>Now, let&#8217;s be a bit daring and think of the vector <img src="https://s0.wp.com/latex.php?latex=x+%5Cin+%5Cmathbb%7BR%7D%5ES&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x &#92;in &#92;mathbb{R}^S" class="latex" /> as a row vector with <img src="https://s0.wp.com/latex.php?latex=k&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="k" class="latex" /> entries:</p>
<p><img src="https://s0.wp.com/latex.php?latex=x+%3D+%5Cleft%28x_1+%2C+x_2+%2C++%5Cdots+%2C++x_k+%5Cright%29+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x = &#92;left(x_1 , x_2 ,  &#92;dots ,  x_k &#92;right) " class="latex" /></p>
<p>Then we can multiply <img src="https://s0.wp.com/latex.php?latex=x&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x" class="latex" /> on the <i>right</i> by the matrix <img src="https://s0.wp.com/latex.php?latex=Y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y" class="latex" /> and get a vector in <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5EK&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^K" class="latex" />:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Barray%7D%7Bccl%7D+x+Y+%26%3D%26+%28+x_1+%2C+x_2%2C+%5Cdots%2C+x_k%29+%5C%3B+++%5Cleft%28+%5Cbegin%7Barray%7D%7Bcccc%7D+++Y_%7B11%7D+%26+Y_%7B12%7D++%26+%5Ccdots+%26+Y_%7B1+%5Cell%7D+%5C%5C++Y_%7B21%7D+%26+Y_%7B22%7D++%26+%5Ccdots+%26+Y_%7B2+%5Cell%7D+%5C%5C++%5Cvdots++%26+%5Cvdots+++%26+%5Cddots+%26+%5Cvdots+%5C%5C++Y_%7Bk1%7D+%26+Y_%7Bk2%7D++%26+%5Ccdots+%26+Y_%7Bk+%5Cell%7D+%5Cend%7Barray%7D+%5Cright%29+++%5C%5C++%5C%5C++%26%3D%26+%5Cleft%28+x_1+Y_%7B11%7D+%2B+%5Ccdots+%2B+x_k+Y_%7Bk1%7D%2C+%5C%3B+%5Cdots%2C+%5C%3B+x_1+Y_%7B1+%5Cell%7D+%2B+%5Ccdots+%2B+x_k+Y_%7Bk+%5Cell%7D+%5Cright%29+++%5Cend%7Barray%7D++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;begin{array}{ccl} x Y &amp;=&amp; ( x_1 , x_2, &#92;dots, x_k) &#92;;   &#92;left( &#92;begin{array}{cccc}   Y_{11} &amp; Y_{12}  &amp; &#92;cdots &amp; Y_{1 &#92;ell} &#92;&#92;  Y_{21} &amp; Y_{22}  &amp; &#92;cdots &amp; Y_{2 &#92;ell} &#92;&#92;  &#92;vdots  &amp; &#92;vdots   &amp; &#92;ddots &amp; &#92;vdots &#92;&#92;  Y_{k1} &amp; Y_{k2}  &amp; &#92;cdots &amp; Y_{k &#92;ell} &#92;end{array} &#92;right)   &#92;&#92;  &#92;&#92;  &amp;=&amp; &#92;left( x_1 Y_{11} + &#92;cdots + x_k Y_{k1}, &#92;; &#92;dots, &#92;; x_1 Y_{1 &#92;ell} + &#92;cdots + x_k Y_{k &#92;ell} &#92;right)   &#92;end{array}  " class="latex" /></p>
<p>So far, no big deal.  But now you&#8217;re ready to see the definition of <img src="https://s0.wp.com/latex.php?latex=x%5EY%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x^Y," class="latex" /> which is very similar:</p>
<p><img src="https://i1.wp.com/math.ucr.edu/home/baez/networks/matrix_exponential.png" /></p>
<p>It&#8217;s exactly the same, but with <i>multiplication</i> replacing <i>addition</i>, and <i>exponentiation</i> replacing <i>multiplication!</i>   Apparently my class on matrices stopped too soon: we learned about matrix multiplication, but matrix exponentiation is also worthwhile. </p>
<p>What&#8217;s the point of it?  Well, suppose you have a certain number of hydrogen molecules, a certain number of oxygen molecules, a certain number of water molecules, and so on&#8212;a certain number of things of each species.  You can list these numbers and get a vector <img src="https://s0.wp.com/latex.php?latex=x+%5Cin+%5Cmathbb%7BR%7D%5ES.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x &#92;in &#92;mathbb{R}^S." class="latex" />  Then the components of <img src="https://s0.wp.com/latex.php?latex=x%5EY&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x^Y" class="latex" /> describe how many ways you can build up each complex from the things you have.  For example, </p>
<p><img src="https://s0.wp.com/latex.php?latex=x_1%5E%7BY_%7B11%7D%7D+x_2%5E%7BY_%7B21%7D%7D+%5Ccdots++x_k%5E%7BY_%7Bk1%7D%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x_1^{Y_{11}} x_2^{Y_{21}} &#92;cdots  x_k^{Y_{k1}} " class="latex" /></p>
<p>say roughly how many ways you can build complex 1 by picking <img src="https://s0.wp.com/latex.php?latex=Y_%7B11%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y_{11}" class="latex" /> things of species 1, <img src="https://s0.wp.com/latex.php?latex=Y_%7B21%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y_{21}" class="latex" /> things of species 2, and so on.  </p>
<p>Why &#8216;roughly&#8217;?   Well, we&#8217;re pretending we can pick the same thing twice.  So if we have 4 water molecules and we need to pick 3, this formula gives <img src="https://s0.wp.com/latex.php?latex=4%5E3.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="4^3." class="latex" />  The right answer is <img src="https://s0.wp.com/latex.php?latex=4+%5Ctimes+3+%5Ctimes+2.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="4 &#92;times 3 &#92;times 2." class="latex" />   To get this answer we&#8217;d need to use the &#8216;falling power&#8217; <img src="https://s0.wp.com/latex.php?latex=4%5E%7B%5Cunderline%7B3%7D%7D+%3D+4+%5Ctimes+3+%5Ctimes+2%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="4^{&#92;underline{3}} = 4 &#92;times 3 &#92;times 2," class="latex" /> as explained in <a href="http://math.ucr.edu/home/baez/networks/networks_4.html">Part 4</a>.  But the rate equation describes chemistry in the limit where we have lots of things of each species.  In this limit, the ordinary power becomes a good approximation.</p>
<p><b>Puzzle.</b> In this post we&#8217;ve seen a vector raised to a matrix power, which is a vector, and also a vector raised to a vector power, which is a number.  How are they related?</p>
<p>There&#8217;s more to say about this, which I&#8217;d be glad to explain if you&#8217;re interested.  But let&#8217;s get to the punchline:</p>
<p><b>Theorem.</b>  The rate equation:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bd+x%7D%7Bd+t%7D+%3D+Y+%5Csum_%7B%5Ctau+%5Cin+T%7D+r%28%5Ctau%29+%5C%3B+%5Cleft%28t%28%5Ctau%29+-+s%28%5Ctau%29%5Cright%29+%5C%3B+x%5E%7BY+s%28%5Ctau%29%7D+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{d x}{d t} = Y &#92;sum_{&#92;tau &#92;in T} r(&#92;tau) &#92;; &#92;left(t(&#92;tau) - s(&#92;tau)&#92;right) &#92;; x^{Y s(&#92;tau)} } " class="latex" /></p>
<p>is equivalent to this equation:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bd+x%7D%7Bd+t%7D+%3D+Y+%28t+-+s%29+s%5E%5Cdagger+x%5EY+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{d x}{d t} = Y (t - s) s^&#92;dagger x^Y } " class="latex" /></p>
<p>or in other words:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bd+x%7D%7Bd+t%7D+%3D+Y+H+x%5EY+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{d x}{d t} = Y H x^Y } " class="latex" /></p>
<p><i>Proof.</i>  It&#8217;s enough to show </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%28t+-+s%29+s%5E%5Cdagger+x%5EY+%3D+%5Csum_%7B%5Ctau+%5Cin+T%7D+r%28%5Ctau%29+%5C%3B+%5Cleft%28t%28%5Ctau%29+-+s%28%5Ctau%29%5Cright%29+%5C%3B+x%5E%7BY+s%28%5Ctau%29%7D+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ (t - s) s^&#92;dagger x^Y = &#92;sum_{&#92;tau &#92;in T} r(&#92;tau) &#92;; &#92;left(t(&#92;tau) - s(&#92;tau)&#92;right) &#92;; x^{Y s(&#92;tau)} } " class="latex" /></p>
<p>So, we&#8217;ll compute <img src="https://s0.wp.com/latex.php?latex=%28t+-+s%29+s%5E%5Cdagger+x%5EY%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(t - s) s^&#92;dagger x^Y," class="latex" /> and think about the meaning of each quantity we get <i>en route</i>.  </p>
<p>We start with <img src="https://s0.wp.com/latex.php?latex=x+%5Cin+%5Cmathbb%7BR%7D%5ES.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x &#92;in &#92;mathbb{R}^S." class="latex" />  This is a list of numbers saying how many things of each species we have: our raw ingredients, as it were.  Then we compute</p>
<p><img src="https://s0.wp.com/latex.php?latex=x%5EY+%3D+%28x_1%5E%7BY_%7B11%7D%7D+%5Ccdots++x_k%5E%7BY_%7Bk1%7D%7D+%2C++%5Cdots%2C++x_1%5E%7BY_%7B1+%5Cell%7D%7D+%5Ccdots+x_k%5E%7BY_%7Bk+%5Cell%7D%7D+%29+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x^Y = (x_1^{Y_{11}} &#92;cdots  x_k^{Y_{k1}} ,  &#92;dots,  x_1^{Y_{1 &#92;ell}} &#92;cdots x_k^{Y_{k &#92;ell}} ) " class="latex" /></p>
<p>This is a vector in <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5EK.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^K." class="latex" />  It&#8217;s a list of numbers saying how many ways we can build each complex starting from our raw ingredients.  </p>
<p>Alternatively, we can write this vector <img src="https://s0.wp.com/latex.php?latex=x%5EY&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x^Y" class="latex" /> as a sum over basis vectors:</p>
<p><img src="https://s0.wp.com/latex.php?latex=x%5EY+%3D+%5Csum_%7B%5Ckappa+%5Cin+K%7D+x_1%5E%7BY_%7B1%5Ckappa%7D%7D+%5Ccdots++x_k%5E%7BY_%7Bk%5Ckappa%7D%7D+%5C%3B+%5Ckappa+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x^Y = &#92;sum_{&#92;kappa &#92;in K} x_1^{Y_{1&#92;kappa}} &#92;cdots  x_k^{Y_{k&#92;kappa}} &#92;; &#92;kappa " class="latex" /></p>
<p>Next let&#8217;s apply <img src="https://s0.wp.com/latex.php?latex=s%5E%5Cdagger&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s^&#92;dagger" class="latex" /> to this.  We claim that</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+s%5E%5Cdagger+%5Ckappa+%3D+%5Csum_%7B%5Ctau+%5C%3B+%3A+%5C%3B+s%28%5Ctau%29+%3D+%5Ckappa%7D+r%28%5Ctau%29+%5C%3B+%5Ctau+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ s^&#92;dagger &#92;kappa = &#92;sum_{&#92;tau &#92;; : &#92;; s(&#92;tau) = &#92;kappa} r(&#92;tau) &#92;; &#92;tau } " class="latex" /></p>
<p>In other words, we claim <img src="https://s0.wp.com/latex.php?latex=s%5E%5Cdagger+%5Ckappa&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s^&#92;dagger &#92;kappa" class="latex" /> is the sum of all the transitions having <img src="https://s0.wp.com/latex.php?latex=%5Ckappa&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;kappa" class="latex" /> as their source, <i>weighted by their rate constants!</i>   To prove this claim, it&#8217;s enough to take the inner product of each side with any transition <img src="https://s0.wp.com/latex.php?latex=%5Ctau%27%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau&#039;," class="latex" /> and check that we get the same answer.  For the left side we get</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Clangle+s%5E%5Cdagger+%5Ckappa%2C+%5Ctau%27+%5Crangle+%3D+%5Clangle+%5Ckappa%2C+s%28%5Ctau%27%29+%5Crangle+%3D+%5Cdelta_%7B%5Ckappa%2C+s+%28%5Ctau%27%29+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;langle s^&#92;dagger &#92;kappa, &#92;tau&#039; &#92;rangle = &#92;langle &#92;kappa, s(&#92;tau&#039;) &#92;rangle = &#92;delta_{&#92;kappa, s (&#92;tau&#039;) } " class="latex" /></p>
<p>To compute the right side, we need to use the cleverly chosen inner product on <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5ET.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^T." class="latex" />  Here we get</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cleft%5Clangle+%5Csum_%7B%5Ctau+%5C%3B+%3A+%5C%3B+s%28%5Ctau%29+%3D+%5Ckappa%7D+r%28%5Ctau%29+%5Ctau%2C+%5C%3B+%5Ctau%27+%5Cright%5Crangle+%3D++%5Csum_%7B%5Ctau+%5C%3B+%3A+%5C%3B+s%28%5Ctau%29+%3D+%5Ckappa%7D+%5Cdelta_%7B%5Ctau%2C+%5Ctau%27%7D+%3D+%5Cdelta_%7B%5Ckappa%2C+s%28%5Ctau%27%29%7D++%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;left&#92;langle &#92;sum_{&#92;tau &#92;; : &#92;; s(&#92;tau) = &#92;kappa} r(&#92;tau) &#92;tau, &#92;; &#92;tau&#039; &#92;right&#92;rangle =  &#92;sum_{&#92;tau &#92;; : &#92;; s(&#92;tau) = &#92;kappa} &#92;delta_{&#92;tau, &#92;tau&#039;} = &#92;delta_{&#92;kappa, s(&#92;tau&#039;)}  } " class="latex" /></p>
<p>In the first step here, the factor of <img src="https://s0.wp.com/latex.php?latex=1+%2Fr%28%5Ctau%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="1 /r(&#92;tau)" class="latex" /> in the cleverly chosen inner product canceled the visible factor of <img src="https://s0.wp.com/latex.php?latex=r%28%5Ctau%29.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="r(&#92;tau)." class="latex" />  For the second step, you just need to think for half a minute&mdash;or ten, depending on how much coffee you&#8217;ve had.   </p>
<p>Either way, we we conclude that indeed</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+s%5E%5Cdagger+%5Ckappa+%3D+%5Csum_%7B%5Ctau+%5C%3B+%3A+%5C%3B+s%28%5Ctau%29+%3D+%5Ckappa%7D+r%28%5Ctau%29+%5Ctau+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ s^&#92;dagger &#92;kappa = &#92;sum_{&#92;tau &#92;; : &#92;; s(&#92;tau) = &#92;kappa} r(&#92;tau) &#92;tau } " class="latex" /></p>
<p>Next let&#8217;s combine this with our formula for <img src="https://s0.wp.com/latex.php?latex=x%5EY&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x^Y" class="latex" />:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle+%7B+x%5EY+%3D+%5Csum_%7B%5Ckappa+%5Cin+K%7D+x_1%5E%7BY_%7B1%5Ckappa%7D%7D+%5Ccdots++x_k%5E%7BY_%7Bk%5Ckappa%7D%7D+%5C%3B+%5Ckappa+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle { x^Y = &#92;sum_{&#92;kappa &#92;in K} x_1^{Y_{1&#92;kappa}} &#92;cdots  x_k^{Y_{k&#92;kappa}} &#92;; &#92;kappa } " class="latex" /></p>
<p>We get this:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle+%7B+s%5E%5Cdagger+x%5EY+%3D+%5Csum_%7B%5Ckappa%2C+%5Ctau+%5C%3B+%3A+%5C%3B+s%28%5Ctau%29+%3D+%5Ckappa%7D+r%28%5Ctau%29+%5C%3B+x_1%5E%7BY_%7B1%5Ckappa%7D%7D+%5Ccdots++x_k%5E%7BY_%7Bk%5Ckappa%7D%7D+%5C%3B+%5Ctau+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle { s^&#92;dagger x^Y = &#92;sum_{&#92;kappa, &#92;tau &#92;; : &#92;; s(&#92;tau) = &#92;kappa} r(&#92;tau) &#92;; x_1^{Y_{1&#92;kappa}} &#92;cdots  x_k^{Y_{k&#92;kappa}} &#92;; &#92;tau } " class="latex" /></p>
<p>In other words, <img src="https://s0.wp.com/latex.php?latex=s%5E%5Cdagger+x%5EY&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s^&#92;dagger x^Y" class="latex" /> is a linear combination of transitions, where each one is weighted both by <i>the rate it happens</i> and <i>how many ways it can happen</i> starting with our raw ingredients.</p>
<p>Our goal is to compute <img src="https://s0.wp.com/latex.php?latex=%28t+-+s%29s%5E%5Cdagger+x%5EY.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(t - s)s^&#92;dagger x^Y." class="latex" />  We&#8217;re almost there.  Remember, <img src="https://s0.wp.com/latex.php?latex=s&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s" class="latex" /> says which complex is the input of a given transition, and <img src="https://s0.wp.com/latex.php?latex=t&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="t" class="latex" /> says which complex is the output.  So, <img src="https://s0.wp.com/latex.php?latex=%28t+-+s%29+s%5E%5Cdagger+x%5EY&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(t - s) s^&#92;dagger x^Y" class="latex" /> says the total rate at which complexes are created and/or destroyed starting with the species in <img src="https://s0.wp.com/latex.php?latex=x&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x" class="latex" /> as our raw ingredients.  </p>
<p>That sounds good.   But let&#8217;s just pedantically check that everything works.  Applying <img src="https://s0.wp.com/latex.php?latex=t+-+s&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="t - s" class="latex" /> to both sides of our last equation, we get</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%28t+-+s%29+s%5E%5Cdagger+x%5EY+%3D+%5Csum_%7B%5Ckappa%2C+%5Ctau+%5C%3B+%3A+%5C%3B+s%28%5Ctau%29+%3D+%5Ckappa%7D+r%28%5Ctau%29+%5C%3B+x_1%5E%7BY_%7B1%5Ckappa%7D%7D+%5Ccdots++x_k%5E%7BY_%7Bk%5Ckappa%7D%7D+%5C%3B+%5Cleft%28+t%28%5Ctau%29+-+s%28%5Ctau%29%5Cright%29+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ (t - s) s^&#92;dagger x^Y = &#92;sum_{&#92;kappa, &#92;tau &#92;; : &#92;; s(&#92;tau) = &#92;kappa} r(&#92;tau) &#92;; x_1^{Y_{1&#92;kappa}} &#92;cdots  x_k^{Y_{k&#92;kappa}} &#92;; &#92;left( t(&#92;tau) - s(&#92;tau)&#92;right) } " class="latex" /></p>
<p>Remember, our goal was to prove that this equals</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Csum_%7B%5Ctau+%5Cin+T%7D+r%28%5Ctau%29+%5C%3B+%5Cleft%28t%28%5Ctau%29+-+s%28%5Ctau%29%5Cright%29+%5C%3B+x%5E%7BY+s%28%5Ctau%29%7D+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;sum_{&#92;tau &#92;in T} r(&#92;tau) &#92;; &#92;left(t(&#92;tau) - s(&#92;tau)&#92;right) &#92;; x^{Y s(&#92;tau)} } " class="latex" /></p>
<p>But if you stare at these a while and think, you&#8217;ll see they&#8217;re equal.     &nbsp;  &#9608;</p>
<p>It took me a couple of weeks to really understand this, so I&#8217;ll be happy if it takes you just a few days.  It seems peculiar at first but ultimately it all makes sense.  The interesting subtlety is that we use the linear map called &#8216;multiplying by <img src="https://s0.wp.com/latex.php?latex=Y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y" class="latex" />:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Barray%7D%7Bccc%7D+%5Cmathbb%7BR%7D%5EK+%26%5Cto%26+%5Cmathbb%7BR%7D%5ES+%5C%5C+++++++++++++++++++++++++++++++%5Cpsi+++++%26%5Cmapsto%26+++Y+%5Cpsi+%5Cend%7Barray%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;begin{array}{ccc} &#92;mathbb{R}^K &amp;&#92;to&amp; &#92;mathbb{R}^S &#92;&#92;                               &#92;psi     &amp;&#92;mapsto&amp;   Y &#92;psi &#92;end{array} " class="latex" /></p>
<p>to take a bunch of complexes and work out the species they contain, while we use the <i>nonlinear</i> map called &#8216;raising to the <img src="https://s0.wp.com/latex.php?latex=Y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y" class="latex" />th power:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Barray%7D%7Bccc%7D+%5Cmathbb%7BR%7D%5ES+%26%5Cto%26+%5Cmathbb%7BR%7D%5EK+%5C%5C+++++++++++++++++++++++++++++++x+++++%26%5Cmapsto%26+++x%5EY+%5Cend%7Barray%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;begin{array}{ccc} &#92;mathbb{R}^S &amp;&#92;to&amp; &#92;mathbb{R}^K &#92;&#92;                               x     &amp;&#92;mapsto&amp;   x^Y &#92;end{array} " class="latex" /></p>
<p>to take a bunch of species and work out how many ways we can build each complex from them.  There is much more to say about this: for example, these maps arise from a pair of what category theorists call &#8216;adjoint functors&#8217;.  But I&#8217;m worn out and you probably are too, if you&#8217;re still here at all.</p>
<h3> References </h3>
<p>I found this thesis to be the most helpful reference when I was trying to understand the proof of the deficiency zero theorem:</p>
<p>&bull; Jonathan M. Guberman, <i><a href="http://www4.utsouthwestern.edu/altschulerwulab/theses/GubermanJ_Thesis.pdf">Mass Action Reaction Networks and the Deficiency Zero Theorem</a></i>, B.A. thesis, Department of Mathematics, Harvard University, 2003.</p>
<p>I urge you to check it out.  In particular, Section 3 and Appendix A discuss matrix exponentiation.  Has anyone discussed this before?</p>
<p>Here&#8217;s another good modern treatment of the deficiency zero theorem:</p>
<p>&bull; Jeremy Gunawardena, <a href="http://vcp.med.harvard.edu/papers/crnt.pdf">Chemical reaction network theory for <i>in silico</i> biologists</a>, 2003.</p>
<p>The theorem was first proved here:</p>
<p>&bull; Martin Feinberg, <a href="http://www.seas.upenn.edu/~jadbabai/ESE680/Fei87a.pdf">Chemical reaction network structure and the stability of complex isothermal reactors: I. The deficiency zero and deficiency one theorems</a>, <i>Chemical Engineering Science</i> <b>42</b> (1987), 2229-2268. </p>
<p>However, Feinberg&#8217;s treatment here relies heavily on this paper:</p>
<p>&bull; F. Horn and R. Jackson, General mass action kinetics, <a href="http://www.springerlink.com/content/p345k578348107tj/"><i>Archive for Rational Mechanics and Analysis</i></a> <b>47</b> (1972), 81-116.</p>
<p>(Does anyone work on &#8216;irrational mechanics&#8217;?)  These lectures are also very helpful:</p>
<p>&bull; Martin Feinberg, <a href="http://www.che.eng.ohio-state.edu/~FEINBERG/LecturesOnReactionNetworks/">Lectures on reaction networks</a>, 1979.</p>
<p>If you&#8217;ve seen other proofs, let us know.</p>
									</div>

				<p class="postmetadata">
				<img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/speech_bubble.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2012/08/16/network-theory-part-22/#comments">17 Comments</a>				| <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/documents.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/category/chemistry/" rel="category tag">chemistry</a>, <a href="https://johncarlosbaez.wordpress.com/category/mathematics/" rel="category tag">mathematics</a>, <a href="https://johncarlosbaez.wordpress.com/category/networks/" rel="category tag">networks</a>								 | <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/permalink.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2012/08/16/network-theory-part-22/" rel="bookmark" title="Permanent Link to Network Theory (Part&nbsp;22)">Permalink</a>
<br /><img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/figure_ver1.gif" alt="" /> Posted by John Baez				</p>
			</div>
			<hr />
		
			<div class="post-11472 post type-post status-publish format-standard hentry category-chemistry category-mathematics category-networks" id="post-11472">
				<h2><a href="https://johncarlosbaez.wordpress.com/2012/08/14/network-theory-part-21/" rel="bookmark">Network Theory (Part&nbsp;21)</a></h2>
				<small>14 August, 2012</small><br />


				<div class="entry">
					<p>Recently we&#8217;ve been talking about &#8216;reaction networks&#8217;, like this:</p>
<div align="center">
<img width="230" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/chemical_reaction_network_part_20_V.png" alt="" />
</div>
<p>The letters are names of chemicals, and the arrows are chemical reactions.   If we know how fast each reaction goes, we can write down a &#8216;rate equation&#8217; describing how the amount of each chemical changes with time.   </p>
<p>In <a href="http://math.ucr.edu/home/baez/networks/networks_17.html">Part 17</a> we met the deficiency zero theorem.  This is a powerful tool for finding <i>equilibrium solutions</i> of the rate equation: in other words, solutions where the amounts of the various chemicals don&#8217;t change at all.   To apply this theorem, two conditions must hold.   Both are quite easy to check:</p>
<p>&bull; Your reaction network needs to be &#8216;weakly reversible&#8217;: if you have a reaction that takes one bunch of chemicals to another, there&#8217;s a series of reactions that takes that other bunch back to the one you started with.  </p>
<p>&bull; A number called the &#8216;deficiency&#8217; that you can compute from your reaction network needs to be zero.</p>
<p>The first condition makes a lot of sense, intuitively: you won&#8217;t get an equilibrium with all the different chemicals present if some chemicals can turn into others but not the other way around.   But the second condition, and indeed the concept of &#8216;deficiency&#8217;, seems mysterious.</p>
<p>Luckily, when you work through the proof of the deficiency zero theorem, the mystery evaporates.   It turns out that there are two equivalent ways to define the deficiency of a reaction network.  One makes it easy to compute, and that&#8217;s the definition people usually give.  But the other explains why it&#8217;s important.</p>
<p>In fact the whole proof of the deficiency zero theorem is full of great insights, so I want to show it to you.  This will be the most intense part of the network theory series so far, but also the climax of its first phase.  After a little wrapping up, we will then turn to another kind of network: <i>electrical circuits!</i>  </p>
<p>Today I&#8217;ll just unfold the concept of &#8216;deficiency&#8217; so we see what it means.  Next time I&#8217;ll show you a slick way to write the rate equation, which is crucial to proving the deficiency zero theorem.  Then we&#8217;ll start the proof.</p>
<h3> Reaction networks </h3>
<p>Let&#8217;s recall what a reaction network is, and set up our notation.  In chemistry we consider a finite set of &#8216;species&#8217; like C, O<sub>2</sub>, H<sub>2</sub>O and so on&#8230; and then consider reactions like</p>
<p>CH<sub>4</sub> + 2O<sub>2</sub> <img src="https://s0.wp.com/latex.php?latex=%5Clongrightarrow&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;longrightarrow" class="latex" /> CO<sub>2</sub> + 2H<sub>2</sub>O </p>
<p>On each side of this reaction we have a finite linear combination of species, with natural numbers as coefficients.  Chemists call such a thing a <b>complex</b>.</p>
<p>So, given any finite collection of species, say <img src="https://s0.wp.com/latex.php?latex=S%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S," class="latex" /> let&#8217;s write <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BN%7D%5ES&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{N}^S" class="latex" /> to mean the set of finite linear combinations of elements of <img src="https://s0.wp.com/latex.php?latex=S%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S," class="latex" /> with natural numbers as coefficients.   The complexes appearing in our reactions will form a subset of this, say <img src="https://s0.wp.com/latex.php?latex=K.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="K." class="latex" />   </p>
<p>We&#8217;ll also consider a finite collection of reactions&#8212;or in the language of <a href="http://math.ucr.edu/home/baez/networks/networks_2.html">Petri nets</a>, &#8216;transitions&#8217;.  Let&#8217;s call this <img src="https://s0.wp.com/latex.php?latex=T&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T" class="latex" />.  Each transition goes from some complex to some other complex: if we want a reaction to be reversible we&#8217;ll explicitly include another reaction going the other way.  So, given a transition <img src="https://s0.wp.com/latex.php?latex=%5Ctau+%5Cin+T&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau &#92;in T" class="latex" /> it will always go from some complex called its <b>source</b> <img src="https://s0.wp.com/latex.php?latex=s%28%5Ctau%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s(&#92;tau)" class="latex" /> to some complex called its <b>target</b> <img src="https://s0.wp.com/latex.php?latex=t%28%5Ctau%29.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="t(&#92;tau)." class="latex" /></p>
<p>All this data, put together, is a reaction network:</p>
<p><b> Definition.</b> A <b>reaction network</b> <img src="https://s0.wp.com/latex.php?latex=%28S%2C%5C%3B+s%2Ct+%3A+T+%5Cto+K%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(S,&#92;; s,t : T &#92;to K)" class="latex" /> consists of:</p>
<p>&bull; a finite set <img src="https://s0.wp.com/latex.php?latex=S&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S" class="latex" /> of <b>species</b>, </p>
<p>&bull; a finite set <img src="https://s0.wp.com/latex.php?latex=T&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T" class="latex" /> of <b>transitions</b>,</p>
<p>&bull; a finite set <img src="https://s0.wp.com/latex.php?latex=K+%5Csubset+%5Cmathbb%7BN%7D%5ES&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="K &#92;subset &#92;mathbb{N}^S" class="latex" /> of <b>complexes</b>,</p>
<p>&bull; <b>source</b> and <b>target</b> maps <img src="https://s0.wp.com/latex.php?latex=s%2Ct+%3A+T+%5Cto+K.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s,t : T &#92;to K." class="latex" /></p>
<p>We can draw a reaction network as a graph with complexes as vertices and transitions as edges:</p>
<div align="center">
<img width="200" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/chemical_reaction_network_part_20_I.png" alt="" />
</div>
<p>The set of species here is <img src="https://s0.wp.com/latex.php?latex=S+%3D+%5C%7BA%2CB%2CC%2CD%2CE%5C%7D%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S = &#92;{A,B,C,D,E&#92;}," class="latex" /> and the set of complexes is <img src="https://s0.wp.com/latex.php?latex=K+%3D+%5C%7BA%2CB%2CD%2CA%2BC%2CB%2BE%5C%7D.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="K = &#92;{A,B,D,A+C,B+E&#92;}." class="latex" /></p>
<p>But to write down the &#8216;rate equation&#8217; describing our chemical reactions, we need a bit more information: constants <img src="https://s0.wp.com/latex.php?latex=r%28%5Ctau%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="r(&#92;tau)" class="latex" /> saying the rate at which each transition <img src="https://s0.wp.com/latex.php?latex=%5Ctau&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau" class="latex" /> occurs.   So, we define:</p>
<p><b> Definition.</b> A <b>stochastic reaction network</b> is a reaction network together with a map <img src="https://s0.wp.com/latex.php?latex=r%3A+T+%5Cto+%280%2C%5Cinfty%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="r: T &#92;to (0,&#92;infty)" class="latex" /> assigning a <b>rate constant</b> to each transition.</p>
<p>Let me remind you how the rate equation works.  At any time we have some amount <img src="https://s0.wp.com/latex.php?latex=x_i+%5Cin+%5B0%2C%5Cinfty%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x_i &#92;in [0,&#92;infty)" class="latex" /> of each species <img src="https://s0.wp.com/latex.php?latex=i.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i." class="latex" />  These numbers are the components of a vector <img src="https://s0.wp.com/latex.php?latex=x+%5Cin+%5Cmathbb%7BR%7D%5ES%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x &#92;in &#92;mathbb{R}^S," class="latex" /> which of course depends on time.  The <b>rate equation</b> says how this vector changes:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bd+x_i%7D%7Bd+t%7D+%3D+%5Csum_%7B%5Ctau+%5Cin+T%7D+r%28%5Ctau%29+%5Cleft%28t_i%28%5Ctau%29+-+s_i%28%5Ctau%29%5Cright%29++x%5E%7Bs%28%5Ctau%29%7D+%7D++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{d x_i}{d t} = &#92;sum_{&#92;tau &#92;in T} r(&#92;tau) &#92;left(t_i(&#92;tau) - s_i(&#92;tau)&#92;right)  x^{s(&#92;tau)} }  " class="latex" /> </p>
<p>Here I&#8217;m writing <img src="https://s0.wp.com/latex.php?latex=s_i%28%5Ctau%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s_i(&#92;tau)" class="latex" /> for the <img src="https://s0.wp.com/latex.php?latex=i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i" class="latex" />th component of the vector <img src="https://s0.wp.com/latex.php?latex=s%28%5Ctau%29%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s(&#92;tau)," class="latex" /> and similarly for <img src="https://s0.wp.com/latex.php?latex=t_i%28%5Ctau%29.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="t_i(&#92;tau)." class="latex" />   I should remind you what <img src="https://s0.wp.com/latex.php?latex=x%5E%7Bs%28%5Ctau%29%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x^{s(&#92;tau)}" class="latex" /> means, since here we are raising a vector to a vector power, which is a bit unusual.   So, suppose we have any vector </p>
<p><img src="https://s0.wp.com/latex.php?latex=x+%3D+%28x_1%2C+%5Cdots%2C+x_k%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x = (x_1, &#92;dots, x_k)" class="latex" /> </p>
<p>and we raise it to the power of </p>
<p><img src="https://s0.wp.com/latex.php?latex=s+%3D+%28s_1%2C+%5Cdots%2C+s_k%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s = (s_1, &#92;dots, s_k)" class="latex" />  </p>
<p>Then by definition we get</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+x%5Es+%3D+x_1%5E%7Bs_1%7D+%5Ccdots+x_k%5E%7Bs_k%7D+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ x^s = x_1^{s_1} &#92;cdots x_k^{s_k} } " class="latex" /></p>
<p>Given this, I hope the rate equation makes intuitive sense!  There&#8217;s one term for each transition <img src="https://s0.wp.com/latex.php?latex=%5Ctau.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau." class="latex" />   The factor of <img src="https://s0.wp.com/latex.php?latex=t_i%28%5Ctau%29+-+s_i%28%5Ctau%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="t_i(&#92;tau) - s_i(&#92;tau)" class="latex" /> shows up because our transition destroys <img src="https://s0.wp.com/latex.php?latex=s_i%28%5Ctau%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s_i(&#92;tau)" class="latex" /> things of the <img src="https://s0.wp.com/latex.php?latex=i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i" class="latex" />th species and creates <img src="https://s0.wp.com/latex.php?latex=t_i%28%5Ctau%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="t_i(&#92;tau)" class="latex" /> of them. The big product </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+x%5E%7Bs%28%5Ctau%29%7D+%3D+x_1%5E%7Bs_1%28%5Ctau%29%7D+%5Ccdots+x_k%5E%7Bs_k%28%5Ctau%29%7D+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ x^{s(&#92;tau)} = x_1^{s_1(&#92;tau)} &#92;cdots x_k^{s_k(&#92;tau)} } " class="latex" /></p>
<p>shows up because our transition occurs at a rate proportional to the product of the numbers of things it takes as inputs.  The constant of proportionality is the reaction rate <img src="https://s0.wp.com/latex.php?latex=r%28%5Ctau%29.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="r(&#92;tau)." class="latex" />  </p>
<p>The deficiency zero theorem says lots of things, but in the next few episodes we&#8217;ll prove a weak version, like this:</p>
<p><b> Deficiency Zero Theorem (Baby Version).</b>   Suppose we have a weakly reversible reaction network with deficiency zero.  Then for any choice of rate constants there exists an equilibrium solution <img src="https://s0.wp.com/latex.php?latex=x+%5Cin+%280%2C%5Cinfty%29%5ES&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x &#92;in (0,&#92;infty)^S" class="latex" /> of the rate equation.  In other words:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Csum_%7B%5Ctau+%5Cin+T%7D+r%28%5Ctau%29+%5Cleft%28t_i%28%5Ctau%29+-+s_i%28%5Ctau%29%5Cright%29++x%5E%7Bs%28%5Ctau%29%7D+%3D+0%7D++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;sum_{&#92;tau &#92;in T} r(&#92;tau) &#92;left(t_i(&#92;tau) - s_i(&#92;tau)&#92;right)  x^{s(&#92;tau)} = 0}  " class="latex" /> </p>
<p>An important feature of this result is that all the components of the vector <img src="https://s0.wp.com/latex.php?latex=x&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x" class="latex" /> are <i>positive</i>.  In other words, there&#8217;s actually some chemical of each species present!  </p>
<p>But what do the hypotheses in this theorem mean?</p>
<p>A reaction network is <b>weakly reversible</b> if for any transition <img src="https://s0.wp.com/latex.php?latex=%5Ctau+%5Cin+T&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau &#92;in T" class="latex" /> going from a complex <img src="https://s0.wp.com/latex.php?latex=%5Ckappa&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;kappa" class="latex" /> to a complex <img src="https://s0.wp.com/latex.php?latex=%5Ckappa%27%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;kappa&#039;," class="latex" /> there is a sequence of transitions going from <img src="https://s0.wp.com/latex.php?latex=%5Ckappa%27&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;kappa&#039;" class="latex" /> back to <img src="https://s0.wp.com/latex.php?latex=%5Ckappa.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;kappa." class="latex" />  But what about &#8216;deficiency zero&#8217;?  As I mentioned, this requires more work to understand.  </p>
<p>So, let&#8217;s dive in!  </p>
<h3> Deficiency </h3>
<p>In modern math, we like to take all the stuff we&#8217;re thinking about and compress it into a diagram with a few objects and maps going between these objects.   So, to understand the deficiency zero theorem, I wanted to isolate the crucial maps.  For starters, there&#8217;s an obvious map</p>
<p><img src="https://s0.wp.com/latex.php?latex=Y+%3A+K+%5Cto+%5Cmathbb%7BN%7D%5ES++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y : K &#92;to &#92;mathbb{N}^S  " class="latex" /> </p>
<p>sending each complex to the linear combination of species that it is.  </p>
<p>Indeed, we can change viewpoints a bit and think of <img src="https://s0.wp.com/latex.php?latex=K&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="K" class="latex" /> as an abstract set equipped with this map saying how each complex is made of species.  From now on this is what we&#8217;ll do.  Then all the information in a stochastic reaction network sits in this diagram:</p>
<div align="center">
<img src="https://i2.wp.com/math.ucr.edu/home/baez/networks/reaction_network_diagram_1.png" alt="" />
</div>
<p>This is fundamental to everything we&#8217;ll do for the next few episodes, so take a minute to lock it into your brain.</p>
<p>We&#8217;ll do lots of different things with this diagram.  For example, we often want to use ideas from linear algebra, and then we want our maps to be linear.   For example, <img src="https://s0.wp.com/latex.php?latex=Y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y" class="latex" /> extends uniquely to a linear map</p>
<p><img src="https://s0.wp.com/latex.php?latex=Y+%3A+%5Cmathbb%7BR%7D%5EK+%5Cto+%5Cmathbb%7BR%7D%5ES++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y : &#92;mathbb{R}^K &#92;to &#92;mathbb{R}^S  " class="latex" /> </p>
<p>sending real linear combinations of complexes to real linear combinations of species.   Reusing the name <img src="https://s0.wp.com/latex.php?latex=Y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y" class="latex" /> here won&#8217;t cause confusion.  We can also extend <img src="https://s0.wp.com/latex.php?latex=r%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="r," class="latex" /> <img src="https://s0.wp.com/latex.php?latex=s%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s," class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=t&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="t" class="latex" /> to linear maps in a unique way, getting a little diagram like this:</p>
<div align="center">
<img src="https://i1.wp.com/math.ucr.edu/home/baez/networks/reaction_network_diagram_2.png" alt="" />
</div>
<p>Linear algebra lets us talk about <i>differences</i> of complexes.  Each transition <img src="https://s0.wp.com/latex.php?latex=%5Ctau&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau" class="latex" /> gives a vector</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cpartial%28%5Ctau%29+%3D+t%28%5Ctau%29+-+s%28%5Ctau%29+%5Cin+%5Cmathbb%7BR%7D%5EK++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;partial(&#92;tau) = t(&#92;tau) - s(&#92;tau) &#92;in &#92;mathbb{R}^K  " class="latex" /> </p>
<p>saying the change in complexes that it causes.  And we can extend <img src="https://s0.wp.com/latex.php?latex=%5Cpartial&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;partial" class="latex" /> uniquely to a linear map</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cpartial+%3A+%5Cmathbb%7BR%7D%5ET+%5Cto+%5Cmathbb%7BR%7D%5EK++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;partial : &#92;mathbb{R}^T &#92;to &#92;mathbb{R}^K  " class="latex" /> </p>
<p>defined on linear combinations of transitions.  Mathematicians would call <img src="https://s0.wp.com/latex.php?latex=%5Cpartial&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;partial" class="latex" /> a <b>boundary operator</b>.</p>
<p>So, we have a little sequence of linear maps</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5ET+%5Cstackrel%7B%5Cpartial%7D%7B%5Cto%7D+%5Cmathbb%7BR%7D%5EK+%5Cstackrel%7BY%7D%7B%5Cto%7D+%5Cmathbb%7BR%7D%5ES+++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^T &#92;stackrel{&#92;partial}{&#92;to} &#92;mathbb{R}^K &#92;stackrel{Y}{&#92;to} &#92;mathbb{R}^S   " class="latex" /> </p>
<p>This turns a transition into a change in complexes, and then a change in species.   </p>
<p>If you know fancy math you&#8217;ll be wondering if this sequence is a &#8216;chain complex&#8217;, which is a fancy way of saying that <img src="https://s0.wp.com/latex.php?latex=Y+%5Cpartial+%3D+0.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y &#92;partial = 0." class="latex" />  The answer is no.   This equation means that every linear combination of reactions leaves the amount of all species unchanged.   Or equivalently: every reaction leaves the amount of all species unchanged.   This only happens in very silly examples.</p>
<p>Nonetheless, it&#8217;s <i>possible</i> for a linear combination of reactions to leave the amount of all species unchanged.</p>
<p>For example, this will happen if we have a linear combination of reactions that leaves the amount of all <i>complexes</i> unchanged.   But this sufficient condition is not necessary.  And this leads us to the concept of &#8216;deficiency zero&#8217;:</p>
<p><b> Definition.</b>  A reaction network has <b>deficiency zero</b> if any linear combination of reactions that leaves the amount of every species unchanged also leaves the amount of every complex unchanged.</p>
<p>In short, a reaction network has deficiency zero iff</p>
<p><img src="https://s0.wp.com/latex.php?latex=Y+%28%5Cpartial+%5Crho%29+%3D+0+%5Cimplies+%5Cpartial+%5Crho+%3D+0+++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y (&#92;partial &#92;rho) = 0 &#92;implies &#92;partial &#92;rho = 0   " class="latex" /> </p>
<p>for every <img src="https://s0.wp.com/latex.php?latex=%5Crho+%5Cin+%5Cmathbb%7BR%7D%5ET.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;rho &#92;in &#92;mathbb{R}^T." class="latex" />  In other words&#8212;using some basic concepts from linear algebra&#8212;a reaction network has deficiency zero iff <img src="https://s0.wp.com/latex.php?latex=Y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y" class="latex" /> is one-to-one when restricted to the image of <img src="https://s0.wp.com/latex.php?latex=%5Cpartial.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;partial." class="latex" />  Remember, the <a href="http://en.wikipedia.org/wiki/Image_%28mathematics%29">image</a> of <img src="https://s0.wp.com/latex.php?latex=%5Cpartial&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;partial" class="latex" /> is </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bim%7D+%5Cpartial+%3D+%5C%7B+%5Cpartial+%5Crho+%5C%3B+%3A+%5C%3B+%5Crho+%5Cin+%5Cmathbb%7BR%7D%5ET+%5C%7D+++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{im} &#92;partial = &#92;{ &#92;partial &#92;rho &#92;; : &#92;; &#92;rho &#92;in &#92;mathbb{R}^T &#92;}   " class="latex" /> </p>
<p>Roughly speaking, this consists of all changes in complexes that can occur due to reactions. </p>
<p>In still other words, a reaction network has deficiency zero if 0 is the only vector in both the image of <img src="https://s0.wp.com/latex.php?latex=%5Cpartial&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;partial" class="latex" /> and the kernel of <img src="https://s0.wp.com/latex.php?latex=Y%3A&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y:" class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bim%7D+%5Cpartial+%5Ccap+%5Cmathrm%7Bker%7D+Y+%3D+%5C%7B+0+%5C%7D+++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{im} &#92;partial &#92;cap &#92;mathrm{ker} Y = &#92;{ 0 &#92;}   " class="latex" /> </p>
<p>Remember, the <a href="http://en.wikipedia.org/wiki/Kernel_%28mathematics%29">kernel</a> of <img src="https://s0.wp.com/latex.php?latex=Y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y" class="latex" /> is</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bker%7D+Y+%3D+%5C%7B+%5Cphi+%5Cin+%5Cmathbb%7BR%7D%5EK+%3A+Y+%5Cphi+%3D+0+%5C%7D++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{ker} Y = &#92;{ &#92;phi &#92;in &#92;mathbb{R}^K : Y &#92;phi = 0 &#92;}  " class="latex" /> </p>
<p>Roughly speaking, this consists of all changes in complexes that don&#8217;t cause changes in species.  So, &#8216;deficiency zero&#8217; roughly says that if a reaction causes a change in complexes, it causes a change in species.  </p>
<p>(All this &#8216;roughly speaking&#8217; stuff is because in reality I should be talking about <i>linear combinations</i> of transitions, complexes and species.  But it&#8217;s a bit distracting to keep saying that when I&#8217;m trying to get across the basic ideas!)</p>
<p>Now we&#8217;re ready to understand deficiencies other than zero, at least a little.  They&#8217;re defined like this:</p>
<p><b> Definition.</b>  The <b>deficiency</b> of a reaction network is the dimension of <img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bim%7D+%5Cpartial+%5Ccap+%5Cmathrm%7Bker%7D+Y.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{im} &#92;partial &#92;cap &#92;mathrm{ker} Y." class="latex" />  </p>
<h3>  How to compute the deficiency </h3>
<p>You can compute the deficiency of a reaction network just by looking at it.  However, it takes a little training.  First, remember that a reaction network can be drawn as a graph with complexes as vertices and transitions as edges, like this:</p>
<div align="center">
<img width="200" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/chemical_reaction_network_part_20_I.png" alt="" />
</div>
<p>There are three important numbers we can extract from this graph:</p>
<p>&bull; We can count the number of vertices in this graph; let&#8217;s call that <img src="https://s0.wp.com/latex.php?latex=%7CK%7C%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="|K|," class="latex" /> since it&#8217;s just the number of complexes.  </p>
<p>&bull; We can count the number of pieces or &#8216;components&#8217; of this graph; let&#8217;s call that <img src="https://s0.wp.com/latex.php?latex=%5C%23+%5Cmathrm%7Bcomponents%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;# &#92;mathrm{components}" class="latex" /> for now.  </p>
<p>&bull; We can also count the dimension of the image of <img src="https://s0.wp.com/latex.php?latex=Y+%5Cpartial.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y &#92;partial." class="latex" />  This space, <img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bim%7D+Y+%5Cpartial%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{im} Y &#92;partial," class="latex" /> is called the <b>stochiometric subspace</b>: vectors in here are changes in species that can be accomplished by transitions in our reaction network, or linear combinations of transitions.  </p>
<p>These three numbers, all rather easy to compute, let us calculate the deficiency:</p>
<p><b> Theorem.</b> The deficiency of a reaction network equals </p>
<p><img src="https://s0.wp.com/latex.php?latex=%7CK%7C+-+%5C%23+%5Cmathrm%7Bcomponents%7D+-+%5Cmathrm%7Bdim%7D+%5Cleft%28+%5Cmathrm%7Bim%7D+Y+%5Cpartial+%5Cright%29++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="|K| - &#92;# &#92;mathrm{components} - &#92;mathrm{dim} &#92;left( &#92;mathrm{im} Y &#92;partial &#92;right)  " class="latex" /> </p>
<p><i>Proof.</i>   By definition we have</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bdeficiency%7D+%3D+%5Cdim+%5Cleft%28+%5Cmathrm%7Bim%7D+%5Cpartial+%5Ccap+%5Cmathrm%7Bker%7D+Y+%5Cright%29++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{deficiency} = &#92;dim &#92;left( &#92;mathrm{im} &#92;partial &#92;cap &#92;mathrm{ker} Y &#92;right)  " class="latex" /> </p>
<p>but another way to say this is</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bdeficiency%7D+%3D+%5Cmathrm%7Bdim%7D+%28%5Cmathrm%7Bker%7D+Y%7C_%7B%5Cmathrm%7Bim%7D+%5Cpartial%7D%29++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{deficiency} = &#92;mathrm{dim} (&#92;mathrm{ker} Y|_{&#92;mathrm{im} &#92;partial})  " class="latex" /> </p>
<p>where we are restricting <img src="https://s0.wp.com/latex.php?latex=Y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y" class="latex" /> to the subspace <img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bim%7D+%5Cpartial%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{im} &#92;partial," class="latex" /> and taking the dimension of the kernel of that.</p>
<p>The <a href="http://en.wikipedia.org/wiki/Rank%E2%80%93nullity_theorem"><b>rank-nullity theorem</b></a> says that whenever you have a linear map <img src="https://s0.wp.com/latex.php?latex=T%3A+V+%5Cto+W&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T: V &#92;to W" class="latex" /> between finite-dimensional vector spaces, then</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bdim%7D+%5Cleft%28%5Cmathrm%7Bker%7D+T+%5Cright%29+%5C%3B+%3D+%5C%3B+%5Cmathrm%7Bdim%7D%5Cleft%28%5Cmathrm%7Bdom%7D+T%5Cright%29+%5C%3B+-+%5C%3B+%5Cmathrm%7Bdim%7D+%5Cleft%28%5Cmathrm%7Bim%7D+T%5Cright%29++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{dim} &#92;left(&#92;mathrm{ker} T &#92;right) &#92;; = &#92;; &#92;mathrm{dim}&#92;left(&#92;mathrm{dom} T&#92;right) &#92;; - &#92;; &#92;mathrm{dim} &#92;left(&#92;mathrm{im} T&#92;right)  " class="latex" /> </p>
<p>where <img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bdom%7D+T&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{dom} T" class="latex" /> is the <a href="http://en.wikipedia.org/wiki/Domain_of_a_function">domain</a> of <img src="https://s0.wp.com/latex.php?latex=T%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T," class="latex" /> namely the vector space <img src="https://s0.wp.com/latex.php?latex=V.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="V." class="latex" />  It follows that</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bdim%7D%28%5Cmathrm%7Bker%7D+Y%7C_%7B%5Cmathrm%7Bim%7D+%5Cpartial%7D%29+%3D+%5Cmathrm%7Bdim%7D%28%5Cmathrm%7Bdom%7D++Y%7C_%7B%5Cmathrm%7Bim%7D+%5Cpartial%7D%29+-+%5Cmathrm%7Bdim%7D%28%5Cmathrm%7Bim%7D++Y%7C_%7B%5Cmathrm%7Bim%7D+%5Cpartial%7D%29++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{dim}(&#92;mathrm{ker} Y|_{&#92;mathrm{im} &#92;partial}) = &#92;mathrm{dim}(&#92;mathrm{dom}  Y|_{&#92;mathrm{im} &#92;partial}) - &#92;mathrm{dim}(&#92;mathrm{im}  Y|_{&#92;mathrm{im} &#92;partial})  " class="latex" /> </p>
<p>The domain of <img src="https://s0.wp.com/latex.php?latex=Y%7C_%7B%5Cmathrm%7Bim%7D+%5Cpartial%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y|_{&#92;mathrm{im} &#92;partial}" class="latex" /> is just <img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bim%7D+%5Cpartial%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{im} &#92;partial," class="latex" /> while its image equals <img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bim%7D+Y+%5Cpartial%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{im} Y &#92;partial," class="latex" /> so</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bdeficiency%7D+%3D+%5Cmathrm%7Bdim%7D%28%5Cmathrm%7Bim%7D+%5Cpartial%29+-+%5Cmathrm%7Bdim%7D%28%5Cmathrm%7Bim%7D+Y+%5Cpartial%29+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{deficiency} = &#92;mathrm{dim}(&#92;mathrm{im} &#92;partial) - &#92;mathrm{dim}(&#92;mathrm{im} Y &#92;partial) " class="latex" /></p>
<p>The theorem then follows from this:</p>
<p><b> Lemma.</b>  <img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bdim%7D+%28%5Cmathrm%7Bim%7D+%5Cpartial%29+%3D+%7CK%7C+-+%5C%23+%5Cmathrm%7Bcomponents%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{dim} (&#92;mathrm{im} &#92;partial) = |K| - &#92;# &#92;mathrm{components} " class="latex" /></p>
<p><i>Proof.</i>  In fact this holds whenever we have a finite set of complexes and a finite set of transitions going between them.  We get a diagram</p>
<div align="center">
<img src="https://i2.wp.com/math.ucr.edu/home/baez/networks/markov_process_diagram_3.png" alt="" />
</div>
<p>We can extend the source and target functions to linear maps as usual:</p>
<div align="center">
<img src="https://i0.wp.com/math.ucr.edu/home/baez/networks/markov_process_diagram_4.png" alt="" />
</div>
<p>and then we can define <img src="https://s0.wp.com/latex.php?latex=%5Cpartial+%3D+t+-+s.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;partial = t - s." class="latex" />  We claim that </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bdim%7D+%28%5Cmathrm%7Bim%7D+%5Cpartial%29+%3D+%7CK%7C+-+%5C%23+%5Cmathrm%7Bcomponents%7D++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{dim} (&#92;mathrm{im} &#92;partial) = |K| - &#92;# &#92;mathrm{components}  " class="latex" /> </p>
<p>where <img src="https://s0.wp.com/latex.php?latex=%5C%23+%5Cmathrm%7Bcomponents%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;# &#92;mathrm{components}" class="latex" /> is the number of connected components of the graph with <img src="https://s0.wp.com/latex.php?latex=K&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="K" class="latex" /> as vertices and <img src="https://s0.wp.com/latex.php?latex=T&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T" class="latex" /> as edges.  </p>
<p>This is easiest to see using an inductive argument where we start by throwing out all the edges of our graph and then put them back in one at a time.  When our graph has no edges, <img src="https://s0.wp.com/latex.php?latex=%5Cpartial+%3D+0&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;partial = 0" class="latex" /> and the number of components is <img src="https://s0.wp.com/latex.php?latex=%7CK%7C%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="|K|," class="latex" /> so our claim holds: both sides of the equation above are zero.  Then, each time we put in an edge, there are two choices: either it goes between two different components of the graph we have built so far, or it doesn&#8217;t.  If goes between two different components, it increases <img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bdim%7D+%28%5Cmathrm%7Bim%7D+%5Cpartial%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{dim} (&#92;mathrm{im} &#92;partial)" class="latex" /> by 1 and decreases the number of components by 1, so our equation continues to hold.   If it doesn&#8217;t, neither of these quantities change, so our equation again continues to hold.   &nbsp;  &#9608;</p>
<h3> Examples </h3>
<div align="center">
<img width="200" src="https://i2.wp.com/math.ucr.edu/home/baez/networks/chemical_reaction_network_part_17_I.png" alt="" />
</div>
<p>This reaction network is not weakly reversible, since we can get from <img src="https://s0.wp.com/latex.php?latex=B+%2B+E&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="B + E" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=A+%2B+C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A + C" class="latex" /> to <img src="https://s0.wp.com/latex.php?latex=D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="D" class="latex" /> but not back.   It becomes weakly reversible if we throw in another transition:</p>
<div align="center">
<img width="200" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/chemical_reaction_network_part_17_II.png" alt="" />
</div>
<p>Taking a reaction network and throwing in the reverse of an existing transition never changes the number of complexes, the number of components, or the dimension of the stoichiometric subspace.  So, the deficiency of the reaction network remains unchanged.  We computed it back in <a href="http://math.ucr.edu/home/baez/networks/networks_17.html">Part 17</a>.  For either reaction network above:</p>
<p>&bull; the number of complexes is 5:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%7CK%7C+%3D+%7C%5C%7BA%2CB%2CD%2C+A%2BC%2C+B%2BE%5C%7D%7C+%3D+5++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="|K| = |&#92;{A,B,D, A+C, B+E&#92;}| = 5  " class="latex" /> </p>
<p>&bull; the number of components is 2:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5C%23+%5Cmathrm%7Bcomponents%7D+%3D+2++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;# &#92;mathrm{components} = 2  " class="latex" /> </p>
<p>&bull; the dimension of the stoichiometric subspace is 3.  For this we go through each transition, see what change in species it causes, and take the vector space spanned by these changes.  Then we find a basis for this space and count it:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bim%7D+Y+%5Cpartial+%3D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{im} Y &#92;partial = " class="latex" /> </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Clangle+B+-+A%2C+A+-+B%2C+D+-+A+-+C%2C+D+-+%28B%2BE%29+%2C++%28B%2BE%29-%28A%2BC%29+%5Crangle++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;langle B - A, A - B, D - A - C, D - (B+E) ,  (B+E)-(A+C) &#92;rangle  " class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=%3D+%5Clangle+B+-A%2C+D+-+A+-+C%2C+D+-+A+-+E+%5Crangle++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="= &#92;langle B -A, D - A - C, D - A - E &#92;rangle  " class="latex" /></p>
<p>so </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bdim%7D+%5Cleft%28%5Cmathrm%7Bim%7D+Y+%5Cpartial+%5Cright%29+%3D+3++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{dim} &#92;left(&#92;mathrm{im} Y &#92;partial &#92;right) = 3  " class="latex" /> </p>
<p>As a result, the deficiency is zero:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Barray%7D%7Bccl%7D+%5Cmathrm%7Bdeficiency%7D+++%26%3D%26+%7CK%7C+-+%5C%23+%5Cmathrm%7Bcomponents%7D+-+%5Cmathrm%7Bdim%7D+%5Cleft%28+%5Cmathrm%7Bim%7D+Y+%5Cpartial+%5Cright%29+%5C%5C++%26%3D%26+5+-+2+-+3+%5C%5C++%26%3D%26++0+%5Cend%7Barray%7D++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;begin{array}{ccl} &#92;mathrm{deficiency}   &amp;=&amp; |K| - &#92;# &#92;mathrm{components} - &#92;mathrm{dim} &#92;left( &#92;mathrm{im} Y &#92;partial &#92;right) &#92;&#92;  &amp;=&amp; 5 - 2 - 3 &#92;&#92;  &amp;=&amp;  0 &#92;end{array}  " class="latex" /> </p>
<p>Now let&#8217;s throw in another complex and some more transitions:</p>
<div align="center">
<img width="200" src="https://i0.wp.com/math.ucr.edu/home/baez/networks/chemical_reaction_network_part_20_II.png" alt="" />
</div>
<p>Now:</p>
<p>&bull; the number of complexes increases by 1:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%7CK%7C+%3D+%7C%5C%7BA%2CB%2CD%2CE%2C+A%2BC%2C+B%2BE%5C%7D%7C+%3D+6++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="|K| = |&#92;{A,B,D,E, A+C, B+E&#92;}| = 6  " class="latex" /> </p>
<p>&bull; the number of components is unchanged:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5C%23+%5Cmathrm%7Bcomponents%7D+%3D+2++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;# &#92;mathrm{components} = 2  " class="latex" /> </p>
<p>&bull; the dimension of the stoichiometric subspace increases by 1.  We never need to include reverses of transitions when computing this:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bim%7D+Y+%5Cpartial+%3D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{im} Y &#92;partial = " class="latex" /> </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Clangle+B-A%2C+E-B%2C++D+-+%28A%2BC%29%2C+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;langle B-A, E-B,  D - (A+C), " class="latex" /><br />
<img src="https://s0.wp.com/latex.php?latex=D+-+%28B%2BE%29+%2C+%28B%2BE%29-%28A%2BC%29+%5Crangle++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="D - (B+E) , (B+E)-(A+C) &#92;rangle  " class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=%3D+%5Clangle+B+-A%2C+E-B%2C+D+-+A+-+C%2C+D+-+B+-+E+%5Crangle++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="= &#92;langle B -A, E-B, D - A - C, D - B - E &#92;rangle  " class="latex" /></p>
<p>so </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bdim%7D+%5Cleft%28%5Cmathrm%7Bim%7D+Y+%5Cpartial+%5Cright%29+%3D+4++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{dim} &#92;left(&#92;mathrm{im} Y &#92;partial &#92;right) = 4  " class="latex" /> </p>
<p>As a result, the deficiency is still zero:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Barray%7D%7Bccl%7D+%5Cmathrm%7Bdeficiency%7D+++%26%3D%26+%7CK%7C+-+%5C%23+%5Cmathrm%7Bcomponents%7D+-+%5Cmathrm%7Bdim%7D+%5Cleft%28+%5Cmathrm%7Bim%7D+Y+%5Cpartial+%5Cright%29+%5C%5C++%26%3D%26+6+-+2+-+4+%5C%5C++%26%3D%26++0+%5Cend%7Barray%7D++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;begin{array}{ccl} &#92;mathrm{deficiency}   &amp;=&amp; |K| - &#92;# &#92;mathrm{components} - &#92;mathrm{dim} &#92;left( &#92;mathrm{im} Y &#92;partial &#92;right) &#92;&#92;  &amp;=&amp; 6 - 2 - 4 &#92;&#92;  &amp;=&amp;  0 &#92;end{array}  " class="latex" /> </p>
<p>Do <i>all</i> reaction networks have deficiency zero?   That would be nice. Let&#8217;s try one more example:</p>
<div align="center">
<img width="200" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/chemical_reaction_network_part_20_V.png" alt="" />
</div>
<p>&bull; the number of complexes is the same as in our last example:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%7CK%7C+%3D+%7C%5C%7BA%2CB%2CD%2CE%2C+A%2BC%2C+B%2BE%5C%7D%7C+%3D+6++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="|K| = |&#92;{A,B,D,E, A+C, B+E&#92;}| = 6  " class="latex" /> </p>
<p>&bull; the number of components is also the same:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5C%23+%5Cmathrm%7Bcomponents%7D+%3D+2++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;# &#92;mathrm{components} = 2  " class="latex" /> </p>
<p>&bull; the dimension of the stoichiometric subspace is also the same:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bim%7D+Y+%5Cpartial+%3D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{im} Y &#92;partial = " class="latex" /> </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Clangle+B-A%2C++D+-+%28A%2BC%29%2C+D+-+%28B%2BE%29+%2C+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;langle B-A,  D - (A+C), D - (B+E) , " class="latex" /><br />
<img src="https://s0.wp.com/latex.php?latex=%28B%2BE%29-%28A%2BC%29%2C+%28B%2BE%29+-+B+%5Crangle+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(B+E)-(A+C), (B+E) - B &#92;rangle " class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=%3D+%5Clangle+B+-A%2C+D+-+A+-+C%2C+D+-+B+%2C+E%5Crangle+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="= &#92;langle B -A, D - A - C, D - B , E&#92;rangle " class="latex" /> </p>
<p>so </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bdim%7D+%5Cleft%28%5Cmathrm%7Bim%7D+Y+%5Cpartial+%5Cright%29+%3D+4++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{dim} &#92;left(&#92;mathrm{im} Y &#92;partial &#92;right) = 4  " class="latex" /> </p>
<p>So the deficiency is still zero:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Barray%7D%7Bccl%7D+%5Cmathrm%7Bdeficiency%7D+++%26%3D%26+%7CK%7C+-+%5C%23+%5Cmathrm%7Bcomponents%7D+-+%5Cmathrm%7Bdim%7D+%5Cleft%28+%5Cmathrm%7Bim%7D+Y+%5Cpartial+%5Cright%29+%5C%5C++%26%3D%26+6+-+2+-+4+%5C%5C++%26%3D%26++0+%5Cend%7Barray%7D++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;begin{array}{ccl} &#92;mathrm{deficiency}   &amp;=&amp; |K| - &#92;# &#92;mathrm{components} - &#92;mathrm{dim} &#92;left( &#92;mathrm{im} Y &#92;partial &#92;right) &#92;&#92;  &amp;=&amp; 6 - 2 - 4 &#92;&#92;  &amp;=&amp;  0 &#92;end{array}  " class="latex" /> </p>
<p>It&#8217;s sure easy to find examples with deficiency zero!  </p>
<p><b> Puzzle 1.</b> Can you find an example where the deficiency is <i>not</i> zero?</p>
<p><b>Puzzle 2.</b>  If you can&#8217;t find an example, prove the deficiency is always zero. If you can, find 1) the smallest example and 2) the smallest example that actually arises in chemistry.  </p>
<p>Note that not all reaction networks can actually arise in chemistry.  For example, the transition $A \to A + A$ would violate conservation of mass.  Nonetheless a reaction network like this might be useful in a very simple model of amoeba reproduction, one that doesn&#8217;t take limited resources into account.</p>
<h3> Different kinds of graphs </h3>
<p>I&#8217;ll conclude with some technical remarks that only a mathematician could love; feel free to skip them if you&#8217;re not in the mood.  As you&#8217;ve already seen, it&#8217;s important that a reaction network can be drawn as a graph:</p>
<div align="center">
<img width="200" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/chemical_reaction_network_part_17_II.png" alt="" />
</div>
<p>But there are many <i>kinds</i> of graph.  What kind of graph is this, exactly?  </p>
<p>As I mentioned in <a href="http://math.ucr.edu/home/baez/networks/networks_17.html">Part 17</a>, it&#8217;s a <b>directed multigraph</b>, meaning that the edges have arrows on them, more than one edge can go from one vertex to another, and we can have any number of edges going from a vertex to itself.  Not all those features are present in this example, but they&#8217;re certainly allowed by our definition of reaction network!  </p>
<p>After all, we&#8217;ve seen that a stochastic reaction network amounts to a little diagram like this:</p>
<div align="center">
<img src="https://i2.wp.com/math.ucr.edu/home/baez/networks/reaction_network_diagram_1.png" alt="" />
</div>
<p>If we throw out the rate constants, we&#8217;re left with a reaction network.  So, a reaction network is just a diagram like this:</p>
<div align="center">
<img src="https://i2.wp.com/math.ucr.edu/home/baez/networks/reaction_network_diagram_4.png" alt="" />
</div>
<p>If we throw out the information about how complexes are made of species, we&#8217;re left with an even smaller diagram:</p>
<div align="center">
<img src="https://i2.wp.com/math.ucr.edu/home/baez/networks/markov_process_diagram_3.png" alt="" />
</div>
<p>And this precisely matches the slick definition of a <b>directed multigraph</b>: it&#8217;s a set <img src="https://s0.wp.com/latex.php?latex=E&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="E" class="latex" /> of <b>edges</b>, a set <img src="https://s0.wp.com/latex.php?latex=V&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="V" class="latex" /> of <b>vertices</b>, and functions <img src="https://s0.wp.com/latex.php?latex=s%2Ct+%3A+E+%5Cto+V&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s,t : E &#92;to V" class="latex" /> saying where each edge starts and where it ends: its <b>source</b> and <b>target</b>.  </p>
<p>Since this series is about networks, we should expect to run into many kinds of graphs.  While their diversity is a bit annoying at first, we must learn to love it, at least if we&#8217;re mathematicians and want everything to be completely precise.   </p>
<p>There are at least 2<sup>3</sup> = 8 kinds of graphs, depending on our answers to three questions:</p>
<p>&bull; Do the edges have arrows on them?</p>
<p>&bull; Can more than one edge can go between a specific pair of vertices?</p>
<p>and</p>
<p>&bull; Can an edge can go from a vertex to itself?</p>
<p>We get directed multigraphs if we answer YES, YES and YES to these questions.  Since they allow all three features, directed multigraphs are very important.  For example, a <i>category</i> is a directed multigraph equipped with some extra structure.  Also, what mathematicians call a <i>quiver</i> is just another name for a directed multigraph.</p>
<p>We&#8217;ve met two other kinds of graph so far:</p>
<p>&bull; In <a href="http://math.ucr.edu/home/baez/networks/networks_15.html">Part 15</a> and <a href="http://math.ucr.edu/home/baez/networks/networks_16.html">Part 16</a> we described circuits made of resistors&mdash;or, in other words, Dirichlet operators&mdash;using &#8216;simple graphs&#8217;.  We get simple graphs when we answer NO, NO and NO to the three questions above.   The slick definition of a <b>simple graph</b> is that it&#8217;s a set <img src="https://s0.wp.com/latex.php?latex=V&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="V" class="latex" /> of vertices together with a subset <img src="https://s0.wp.com/latex.php?latex=E&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="E" class="latex" /> of the collection of 2-element subsets of <img src="https://s0.wp.com/latex.php?latex=V&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="V" class="latex" />.</p>
<p>&bull;  In <a href="http://math.ucr.edu/home/baez/networks/networks_20.html">Part 20</a> we described Markov processes on finite sets&mdash;or, in other words, infinitesimal stochastic operators&mdash;using &#8216;directed graphs&#8217;.  We get directed graphs when we answer YES, NO and YES to the three questions.  The slick definition of a <b>directed graph</b> is that it&#8217;s a set <img src="https://s0.wp.com/latex.php?latex=V&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="V" class="latex" /> of vertices together with a subset <img src="https://s0.wp.com/latex.php?latex=E&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="E" class="latex" /> of the ordered pairs of <img src="https://s0.wp.com/latex.php?latex=V&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="V" class="latex" />:  <img src="https://s0.wp.com/latex.php?latex=E+%5Csubseteq+V+%5Ctimes+V&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="E &#92;subseteq V &#92;times V" class="latex" />.  </p>
<p>There is a lot to say about this business, but for now I&#8217;ll just note that you can use directed multigraphs with edges labelled by positive numbers to describe Markov processes, just as we used directed graphs.  You don&#8217;t get anything more general, though!  After all, if we have multiple edges from one vertex to another, we can replace them by a single edge as long as we add up their rate constants.  And an edge from a vertex to itself has no effect at all.</p>
<p>In short, both for Markov processes and reaction networks, we can take &#8216;graph&#8217; to mean either &#8216;directed graph&#8217; or &#8216;directed multigraph&#8217;, as long as we make some minor adjustments. In what follows, we&#8217;ll use directed multigraphs for <i>both</i> Markov processes and reaction networks.  It will work a bit better if we ever get around to explaining how category theory fits into this story.</p>
									</div>

				<p class="postmetadata">
				<img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/speech_bubble.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2012/08/14/network-theory-part-21/#comments">35 Comments</a>				| <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/documents.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/category/chemistry/" rel="category tag">chemistry</a>, <a href="https://johncarlosbaez.wordpress.com/category/mathematics/" rel="category tag">mathematics</a>, <a href="https://johncarlosbaez.wordpress.com/category/networks/" rel="category tag">networks</a>								 | <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/permalink.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2012/08/14/network-theory-part-21/" rel="bookmark" title="Permanent Link to Network Theory (Part&nbsp;21)">Permalink</a>
<br /><img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/figure_ver1.gif" alt="" /> Posted by John Baez				</p>
			</div>
			<hr />
		
			<div class="post-10710 post type-post status-publish format-standard hentry category-chemistry category-mathematics category-networks category-physics" id="post-10710">
				<h2><a href="https://johncarlosbaez.wordpress.com/2012/07/18/network-theory-part-19/" rel="bookmark">Network Theory (Part&nbsp;19)</a></h2>
				<small>18 July, 2012</small><br />


				<div class="entry">
					<p><i>joint with <b><a href="http://www.azimuthproject.org/azimuth/show/Jacob+Biamonte">Jacob Biamonte</a></b></i></p>
<p>It&#8217;s time to resume the <a href="http://math.ucr.edu/home/baez/networks/">network theory</a> series!  We&#8217;re writing a little book based on some of these posts, so we want to finish up our discussion of stochastic Petri nets and chemical reaction networks.  But it&#8217;s been a long time, so we&#8217;ll assume you forgot everything we&#8217;ve said before, and make this post as self-contained as possible.  </p>
<p><a href="https://johncarlosbaez.wordpress.com/2011/11/21/network-theory-part-18/">Last time</a> we started looking at a simple example: a diatomic gas.  </p>
<div align="center"><img src="https://i1.wp.com/math.ucr.edu/home/baez/networks/nitrogen.png" alt="" /></div>
<p>A diatomic molecule of this gas can break apart into two atoms:</p>
<p><img src="https://s0.wp.com/latex.php?latex=A_2+%5Cto+A+%2B+A+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A_2 &#92;to A + A " class="latex" /></p>
<p>and conversely, two atoms can combine to form a diatomic molecule:</p>
<p><img src="https://s0.wp.com/latex.php?latex=A+%2B+A+%5Cto+A_2+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A + A &#92;to A_2 " class="latex" /></p>
<p>We can draw both these reactions using a chemical reaction network:</p>
<div align="center">
<img width="170" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/chemical_reaction_network_part_18.png" alt="" />
</div>
<p>where we&#8217;re writing <img src="https://s0.wp.com/latex.php?latex=B&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="B" class="latex" /> instead of <img src="https://s0.wp.com/latex.php?latex=A_2&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A_2" class="latex" /> to abstract away some detail that&#8217;s just distracting here. </p>
<p>Last time we looked at the <a href="http://math.ucr.edu/home/baez/networks/networks_3.html">rate equation</a> for this chemical reaction network, and found equilibrium solutions of that equation.  Now let&#8217;s look at the <a href="http://math.ucr.edu/home/baez/networks/networks_8.html">master equation</a>, and find equilibrium solutions of that.  This will serve as a review of three big theorems.</p>
<h3> The master equation </h3>
<p>We&#8217;ll start from scratch.  The master equation is all about how atoms or molecules or rabbits or wolves or other things interact randomly and turn into other things.  So, let&#8217;s write <img src="https://s0.wp.com/latex.php?latex=%5Cpsi_%7Bm%2Cn%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi_{m,n}" class="latex" /> for the probability that we have <img src="https://s0.wp.com/latex.php?latex=m&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="m" class="latex" /> atoms of <img src="https://s0.wp.com/latex.php?latex=A&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=n&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="n" class="latex" /> molecule of <img src="https://s0.wp.com/latex.php?latex=B&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="B" class="latex" /> in our container.  These probabilities are functions of time, and master equation will say how they change.</p>
<p>First we need to pick a <b>rate constant</b> for each reaction.  Let&#8217;s say the rate constant for this reaction is some number <img src="https://s0.wp.com/latex.php?latex=%5Calpha+%3E+0&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;alpha &gt; 0" class="latex" />:</p>
<p><img src="https://s0.wp.com/latex.php?latex=B+%5Cto+A+%2B+A+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="B &#92;to A + A " class="latex" /></p>
<p>while the rate constant for the reverse reaction is some number <img src="https://s0.wp.com/latex.php?latex=%5Cbeta+%3E+0&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;beta &gt; 0" class="latex" />:</p>
<p><img src="https://s0.wp.com/latex.php?latex=A+%2B+A+%5Cto+B+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A + A &#92;to B " class="latex" /></p>
<p>Before we make it pretty using the ideas we&#8217;ve been explaining all along, the master equation says</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Barray%7D%7Bccr%7D+%5Cdisplaystyle%7B+%5Cfrac%7Bd%7D%7Bd+t%7D+%5Cpsi_%7Bm%2Cn%7D+%28t%29%7D+%26%3D%26++%5Calpha+%28n%2B1%29+%5C%2C+%5Cpsi_%7Bm-2%2Cn%2B1%7D%28t%29+%5C%5C+%5C%5C+++%26%26-+%5C%3B+%5Calpha+n+%5C%2C+%5Cpsi_%7Bm%2Cn%7D%28t%29+%5C%5C++%5C%5C++%26%26+%2B+%5Cbeta+%28m%2B2%29%28m%2B1%29+%5C%2C+%5Cpsi_%7Bm%2B2%2Cn-1%7D%28t%29+%5C%5C+%5C%5C+%26%26+-+%5C%3B%5Cbeta+m%28m-1%29+%5C%2C+%5Cpsi_%7Bm%2Cn%7D%28t%29+%5C%5C+%5C%5C+++%5Cend%7Barray%7D++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;begin{array}{ccr} &#92;displaystyle{ &#92;frac{d}{d t} &#92;psi_{m,n} (t)} &amp;=&amp;  &#92;alpha (n+1) &#92;, &#92;psi_{m-2,n+1}(t) &#92;&#92; &#92;&#92;   &amp;&amp;- &#92;; &#92;alpha n &#92;, &#92;psi_{m,n}(t) &#92;&#92;  &#92;&#92;  &amp;&amp; + &#92;beta (m+2)(m+1) &#92;, &#92;psi_{m+2,n-1}(t) &#92;&#92; &#92;&#92; &amp;&amp; - &#92;;&#92;beta m(m-1) &#92;, &#92;psi_{m,n}(t) &#92;&#92; &#92;&#92;   &#92;end{array}  " class="latex" /></p>
<p>where we define <img src="https://s0.wp.com/latex.php?latex=%5Cpsi_%7Bi%2Cj%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi_{i,j}" class="latex" /> to be zero if either <img src="https://s0.wp.com/latex.php?latex=i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i" class="latex" /> or <img src="https://s0.wp.com/latex.php?latex=j&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="j" class="latex" /> is negative. </p>
<p>Yuck!  <img src="https://i2.wp.com/math.ucr.edu/home/baez/emoticons/yuck.gif" alt="" />  </p>
<p>Normally we don&#8217;t show you such nasty equations.  Indeed the whole point of our work has been to demonstrate that by packaging the equations in a better way, we can understand them using high-level concepts instead of mucking around with millions of scribbled symbols.  But we thought we&#8217;d show you what&#8217;s secretly lying behind our beautiful abstract formalism, just once. </p>
<p>Each term has a meaning.  For example, the third one:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cbeta+%28m%2B2%29%28m%2B1%29%5Cpsi_%7Bm%2B2%2Cn-1%7D%28t%29+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;beta (m+2)(m+1)&#92;psi_{m+2,n-1}(t) " class="latex" /></p>
<p>means that the reaction <img src="https://s0.wp.com/latex.php?latex=A+%2B+A+%5Cto+B&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A + A &#92;to B" class="latex" /> will tend to increase the probability of there being <img src="https://s0.wp.com/latex.php?latex=m&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="m" class="latex" /> atoms of <img src="https://s0.wp.com/latex.php?latex=A&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=n&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="n" class="latex" /> molecules of <img src="https://s0.wp.com/latex.php?latex=B&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="B" class="latex" /> if we start with <img src="https://s0.wp.com/latex.php?latex=m%2B2&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="m+2" class="latex" /> atoms of <img src="https://s0.wp.com/latex.php?latex=A&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=n-1&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="n-1" class="latex" /> molecules of <img src="https://s0.wp.com/latex.php?latex=B.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="B." class="latex" />  This reaction can happen in <img src="https://s0.wp.com/latex.php?latex=%28m%2B2%29%28m%2B1%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(m+2)(m+1)" class="latex" /> ways.   And it happens at a probabilistic rate proportional to the rate constant for this reaction, <img src="https://s0.wp.com/latex.php?latex=%5Cbeta.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;beta." class="latex" />  </p>
<p>We won&#8217;t go through the rest of the terms.  It&#8217;s a good exercise to do so, but there could easily be a typo in the formula, since it&#8217;s so long and messy.  So let us know if you find one!</p>
<p>To simplify this mess, the key trick is to introduce a <b>generating function</b> that summarizes all the probabilities in a single power series:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5CPsi+%3D+%5Csum_%7Bm%2Cn+%5Cge+0%7D+%5Cpsi_%7Bm%2Cn%7D+y%5Em+%5C%2C+z%5En+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Psi = &#92;sum_{m,n &#92;ge 0} &#92;psi_{m,n} y^m &#92;, z^n " class="latex" /></p>
<p>It&#8217;s a power series in two variables, <img src="https://s0.wp.com/latex.php?latex=y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="y" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=z%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="z," class="latex" /> since we have two chemical species: <img src="https://s0.wp.com/latex.php?latex=A&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A" class="latex" />s and <img src="https://s0.wp.com/latex.php?latex=B&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="B" class="latex" />s.  </p>
<p>Using this trick, the master equation looks like</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bd%7D%7Bd+t%7D+%5CPsi%28t%29+%3D+H+%5CPsi%28t%29+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{d}{d t} &#92;Psi(t) = H &#92;Psi(t) } " class="latex" /></p>
<p>where the <b>Hamiltonian</b> <img src="https://s0.wp.com/latex.php?latex=H&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H" class="latex" /> is a sum of terms, one for each reaction.  This Hamiltonian is built from operators that annihilate and create <img src="https://s0.wp.com/latex.php?latex=A&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A" class="latex" />s and <img src="https://s0.wp.com/latex.php?latex=B&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="B" class="latex" />s.  The annihilation and creation operators for <img src="https://s0.wp.com/latex.php?latex=A&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A" class="latex" /> atoms are:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+a+%3D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+y%7D+%2C+%5Cqquad+a%5E%5Cdagger+%3D+y+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ a = &#92;frac{&#92;partial}{&#92;partial y} , &#92;qquad a^&#92;dagger = y } " class="latex" /></p>
<p>The annihilation operator differentiates our power series with respect to the variable <img src="https://s0.wp.com/latex.php?latex=y.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="y." class="latex" />  The creation operator multiplies it by that variable.  Similarly, the annihilation and creation operators for <img src="https://s0.wp.com/latex.php?latex=B&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="B" class="latex" /> molecules are:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+b+%3D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+z%7D+%2C+%5Cqquad+b%5E%5Cdagger+%3D+z+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ b = &#92;frac{&#92;partial}{&#92;partial z} , &#92;qquad b^&#92;dagger = z } " class="latex" /></p>
<p>In <a href="http://math.ucr.edu/home/baez/networks/networks_8.html">Part 8</a> we explained a recipe that lets us stare at our chemical reaction network and write down this Hamiltonian:</p>
<p><img src="https://s0.wp.com/latex.php?latex=H+%3D+%5Calpha+%28%7Ba%5E%5Cdagger%7D%5E2+b+-+b%5E%5Cdagger+b%29+%2B+%5Cbeta+%28b%5E%5Cdagger+a%5E2+-+%7Ba%5E%5Cdagger%7D%5E2+a%5E2%29+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H = &#92;alpha ({a^&#92;dagger}^2 b - b^&#92;dagger b) + &#92;beta (b^&#92;dagger a^2 - {a^&#92;dagger}^2 a^2) " class="latex" /></p>
<p>As promised, there&#8217;s one term for each reaction.  But each term is itself a sum of two: one that increases the probability that our container of chemicals will be in a new state, and another that decreases the probability that it&#8217;s in its original state.  We get a total of four terms, which correspond to the four terms in our previous way of writing the master equation.</p>
<p><b>Puzzle 1.</b> Show that this new way of writing the master equation is equivalent to the previous one. </p>
<h3> Equilibrium solutions </h3>
<p>Now we will look for all <b>equilibrium</b> solutions of the master equation: in other words, solutions that don&#8217;t change with time.  So, we&#8217;re trying to solve</p>
<p><img src="https://s0.wp.com/latex.php?latex=H+%5CPsi+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H &#92;Psi = 0 " class="latex" /></p>
<p>Given the rather complicated form of the Hamiltonian, this seems tough.  The challenge looks more concrete but even more scary if we go back to our original formulation.  We&#8217;re looking for probabilities <img src="https://s0.wp.com/latex.php?latex=%5Cpsi_%7Bm%2Cn%7D%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi_{m,n}," class="latex" /> nonnegative numbers that sum to one, such that</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Barray%7D%7Bccr%7D+0+%26%3D%26++%5Calpha+%28n%2B1%29+%5C%2C+%5Cpsi_%7Bm-2%2Cn%2B1%7D+%5C%5C+%5C%5C+++%26%26-+%5C%3B+%5Calpha+n+%5C%2C+%5Cpsi_%7Bm%2Cn%7D+%5C%5C++%5C%5C++%26%26+%2B+%5Cbeta+%28m%2B2%29%28m%2B1%29+%5C%2C+%5Cpsi_%7Bm%2B2%2Cn-1%7D+%5C%5C+%5C%5C+%26%26+-+%5C%3B%5Cbeta+m%28m-1%29+%5C%2C+%5Cpsi_%7Bm%2Cn%7D+%5C%5C+%5C%5C+++%5Cend%7Barray%7D++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;begin{array}{ccr} 0 &amp;=&amp;  &#92;alpha (n+1) &#92;, &#92;psi_{m-2,n+1} &#92;&#92; &#92;&#92;   &amp;&amp;- &#92;; &#92;alpha n &#92;, &#92;psi_{m,n} &#92;&#92;  &#92;&#92;  &amp;&amp; + &#92;beta (m+2)(m+1) &#92;, &#92;psi_{m+2,n-1} &#92;&#92; &#92;&#92; &amp;&amp; - &#92;;&#92;beta m(m-1) &#92;, &#92;psi_{m,n} &#92;&#92; &#92;&#92;   &#92;end{array}  " class="latex" /></p>
<p>for all <img src="https://s0.wp.com/latex.php?latex=m&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="m" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=n.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="n." class="latex" /> </p>
<p>This equation is horrid!  But the good news is that it&#8217;s <i>linear</i>, so a linear combination of solutions is again a solution.  This lets us simplify the problem using a conserved quantity.</p>
<p>Clearly, there&#8217;s a quantity that the reactions here don&#8217;t change:</p>
<div align="center">
<img width="170" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/chemical_reaction_network_part_18.png" alt="" />
</div>
<p>What&#8217;s that?  It&#8217;s the number of <img src="https://s0.wp.com/latex.php?latex=A&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A" class="latex" />s plus <i>twice</i> the number of <img src="https://s0.wp.com/latex.php?latex=B&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="B" class="latex" />s.  After all, a <img src="https://s0.wp.com/latex.php?latex=B&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="B" class="latex" /> can turn into two <img src="https://s0.wp.com/latex.php?latex=A&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A" class="latex" />s, or vice versa.  </p>
<p>(Of course the secret reason is that <img src="https://s0.wp.com/latex.php?latex=B&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="B" class="latex" /> is a diatomic molecule made of two <img src="https://s0.wp.com/latex.php?latex=A&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A" class="latex" />s.  But you&#8217;d be able to follow the logic here even if you didn&#8217;t know that, just by looking at the chemical reaction network&#8230; and sometimes this more abstract approach is handy!  Indeed, the way chemists first discovered that certain molecules are made of certain atoms is by seeing which reactions were possible and which weren&#8217;t.)</p>
<p>Suppose we start in a situation where we know <i>for sure</i> that the number of <img src="https://s0.wp.com/latex.php?latex=B&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="B" class="latex" />s plus twice the number of <img src="https://s0.wp.com/latex.php?latex=A&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A" class="latex" />s equals some number <img src="https://s0.wp.com/latex.php?latex=k&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="k" class="latex" />:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cpsi_%7Bm%2Cn%7D+%3D+0++%5C%3B++%5Ctextrm%7Bunless%7D+%5C%3B+m%2B2n+%3D+k+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi_{m,n} = 0  &#92;;  &#92;textrm{unless} &#92;; m+2n = k " class="latex" /></p>
<p>Then we know <img src="https://s0.wp.com/latex.php?latex=%5CPsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Psi" class="latex" /> is initially of the form</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5CPsi+%3D+%5Csum_%7Bm%2B2n+%3D+k%7D+%5Cpsi_%7Bm%2Cn%7D+%5C%2C+y%5Em+z%5En++%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;Psi = &#92;sum_{m+2n = k} &#92;psi_{m,n} &#92;, y^m z^n  } " class="latex" /></p>
<p>But since the number of <img src="https://s0.wp.com/latex.php?latex=A&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A" class="latex" />s plus twice the number of <img src="https://s0.wp.com/latex.php?latex=B&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="B" class="latex" />s is conserved, if <img src="https://s0.wp.com/latex.php?latex=%5CPsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Psi" class="latex" /> obeys the master equation it will <i>continue</i> to be of this form!</p>
<p>Put a fancier way, we know that if a solution of the master equation starts in this subspace:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+L_k+%3D++%5C%7B+%5CPsi%3A+%5C%3B+%5CPsi+%3D+%5Csum_%7Bm%2B2n+%3D+k%7D+%5Cpsi_%7Bm%2Cn%7D+y%5Em+z%5En+%5C%3B+%5Ctextrm%7Bfor+some%7D+%5C%3B+%5Cpsi_%7Bm%2Cn%7D+%5C%7D++%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ L_k =  &#92;{ &#92;Psi: &#92;; &#92;Psi = &#92;sum_{m+2n = k} &#92;psi_{m,n} y^m z^n &#92;; &#92;textrm{for some} &#92;; &#92;psi_{m,n} &#92;}  } " class="latex" /></p>
<p>it will <i>stay</i> in this subspace.  So, because the master equation is linear, we can take any solution <img src="https://s0.wp.com/latex.php?latex=%5CPsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Psi" class="latex" /> and write it as a linear combination of solutions <img src="https://s0.wp.com/latex.php?latex=%5CPsi_k%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Psi_k," class="latex" /> one in each subspace <img src="https://s0.wp.com/latex.php?latex=L_k.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="L_k." class="latex" /></p>
<p>In particular, we can do this for an equilibrium solution <img src="https://s0.wp.com/latex.php?latex=%5CPsi.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Psi." class="latex" />  And then all the solutions <img src="https://s0.wp.com/latex.php?latex=%5CPsi_k&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Psi_k" class="latex" /> are also equilibrium solutions: they&#8217;re linearly independent, so if one of them changed with time, <img src="https://s0.wp.com/latex.php?latex=%5CPsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Psi" class="latex" /> would too.</p>
<p>This means we can just look for equilibrium solutions in the subspaces <img src="https://s0.wp.com/latex.php?latex=L_k.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="L_k." class="latex" /> If we find these, we can get <i>all</i> equilibrium solutions by taking linear combinations.</p>
<p>Once we&#8217;ve noticed that, our horrid equation makes a bit more sense:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Barray%7D%7Bccr%7D+0+%26%3D%26++%5Calpha+%28n%2B1%29+%5C%2C+%5Cpsi_%7Bm-2%2Cn%2B1%7D+%5C%5C+%5C%5C+++%26%26-+%5C%3B+%5Calpha+n+%5C%2C+%5Cpsi_%7Bm%2Cn%7D+%5C%5C++%5C%5C++%26%26+%2B+%5Cbeta+%28m%2B2%29%28m%2B1%29+%5C%2C+%5Cpsi_%7Bm%2B2%2Cn-1%7D+%5C%5C+%5C%5C+%26%26+-+%5C%3B%5Cbeta+m%28m-1%29+%5C%2C+%5Cpsi_%7Bm%2Cn%7D+%5C%5C+%5C%5C+++%5Cend%7Barray%7D++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;begin{array}{ccr} 0 &amp;=&amp;  &#92;alpha (n+1) &#92;, &#92;psi_{m-2,n+1} &#92;&#92; &#92;&#92;   &amp;&amp;- &#92;; &#92;alpha n &#92;, &#92;psi_{m,n} &#92;&#92;  &#92;&#92;  &amp;&amp; + &#92;beta (m+2)(m+1) &#92;, &#92;psi_{m+2,n-1} &#92;&#92; &#92;&#92; &amp;&amp; - &#92;;&#92;beta m(m-1) &#92;, &#92;psi_{m,n} &#92;&#92; &#92;&#92;   &#92;end{array}  " class="latex" /></p>
<p>Note that if the pair of subscripts <img src="https://s0.wp.com/latex.php?latex=m%2C+n&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="m, n" class="latex" /> obey <img src="https://s0.wp.com/latex.php?latex=m+%2B+2n+%3D+k%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="m + 2n = k," class="latex" /> the same is true for the other pairs of subscripts here!  So our equation relates the values of <img src="https://s0.wp.com/latex.php?latex=%5Cpsi_%7Bm%2Cn%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi_{m,n}" class="latex" /> for all the points <img src="https://s0.wp.com/latex.php?latex=%28m%2Cn%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(m,n)" class="latex" /> with integer coordinates lying on this line segment:</p>
<p><img src="https://s0.wp.com/latex.php?latex=m%2B2n+%3D+k+%2C+%5Cqquad+m+%2Cn+%5Cge+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="m+2n = k , &#92;qquad m ,n &#92;ge 0 " class="latex" /></p>
<p>You should be visualizing something like this:</p>
<div align="center"><img width="250" src="https://i0.wp.com/math.ucr.edu/home/baez/networks/diatomic_gas_subspace.png" /></div>
<p>If you think about it a minute, you&#8217;ll see that if we know <img src="https://s0.wp.com/latex.php?latex=%5Cpsi_%7Bm%2Cn%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi_{m,n}" class="latex" /> at two points on such a line, we can keep using our equation to recursively work out all the rest.  So, there are <i>at most two</i> linearly independent equilibrium solutions of the master equation in each subspace <img src="https://s0.wp.com/latex.php?latex=L_k.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="L_k." class="latex" /></p>
<p>Why <i>at most</i> two?  Why not two?   Well, we have to be a bit careful about what happens at the ends of the line segment: remember that <img src="https://s0.wp.com/latex.php?latex=%5Cpsi_%7Bm%2Cn%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi_{m,n}" class="latex" /> is defined to be zero when <img src="https://s0.wp.com/latex.php?latex=m&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="m" class="latex" /> or <img src="https://s0.wp.com/latex.php?latex=n&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="n" class="latex" /> becomes negative.   If we think very hard about this, we&#8217;ll see there&#8217;s just <i>one</i> linearly independent equilibrium solution of the master equation in each subspace <img src="https://s0.wp.com/latex.php?latex=L_k.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="L_k." class="latex" /> But this is the sort of nitty-gritty calculation that&#8217;s not fun to watch someone else do, so we won&#8217;t bore you with that.</p>
<p>Soon we&#8217;ll move on to a more high-level approach to this problem.  But first, one remark.  Our horrid equation is like a fancy version of the usual discretized form of the equation</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle+%7B%5Cfrac%7Bd%5E2+%5Cpsi%7D%7Bd+x%5E2%7D+%3D+0+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle {&#92;frac{d^2 &#92;psi}{d x^2} = 0 } " class="latex" /></p>
<p>namely:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cpsi_%7Bn-1%7D+-+2+%5Cpsi_%7Bn%7D+%2B+%5Cpsi_%7Bn%2B1%7D+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi_{n-1} - 2 &#92;psi_{n} + &#92;psi_{n+1} = 0 " class="latex" /></p>
<p>And this makes sense, since we get</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle+%7B%5Cfrac%7Bd%5E2+%5Cpsi%7D%7Bd+x%5E2%7D+%3D+0+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle {&#92;frac{d^2 &#92;psi}{d x^2} = 0 } " class="latex" /></p>
<p>by taking the <a href="http://en.wikipedia.org/wiki/Heat_equation"><b>heat equation</b></a>:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle+%5Cfrac%7B%5Cpartial+%5Cpsi%7D%7B%5Cpartial+t%7D+%3D+%7B%5Cfrac%7B%5Cpartial%5E2+%5Cpsi%7D%7B%5Cpartial+x%5E2%7D+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle &#92;frac{&#92;partial &#92;psi}{&#92;partial t} = {&#92;frac{&#92;partial^2 &#92;psi}{&#92;partial x^2} } " class="latex" /></p>
<p>and assuming <img src="https://s0.wp.com/latex.php?latex=%5Cpsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi" class="latex" /> doesn&#8217;t depend on time.  So what we&#8217;re doing is a lot like looking for equilibrium solutions of the heat equation.  </p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Heat_equation"><img src="https://i2.wp.com/math.ucr.edu/home/baez/networks/heat_equation.gif" alt="" /></a></div>
<p>The heat equation describes how heat smears out as little particles of heat randomly move around.  True, there don&#8217;t really exist &#8216;little particles of heat&#8217;, but this equation also describes the diffusion of any other kind of particles as they randomly move around undergoing Brownian motion.   Similarly, our master equation describes a random walk on this line segment:</p>
<p><img src="https://s0.wp.com/latex.php?latex=m%2B2n+%3D+k+%2C+%5Cqquad+m+%2C+n+%5Cge+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="m+2n = k , &#92;qquad m , n &#92;ge 0 " class="latex" /></p>
<p>or more precisely, the points on this segment with integer coordinates.  The equilibrium solutions arise when the probabilities <img src="https://s0.wp.com/latex.php?latex=%5Cpsi_%7Bm%2Cn%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi_{m,n}" class="latex" /> have diffused as much as possible.  </p>
<p>If you think about it this way, it should be physically obvious that there&#8217;s just <i>one</i> linearly independent equilibrium solution of the master equation for each value of <img src="https://s0.wp.com/latex.php?latex=k.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="k." class="latex" /> </p>
<p>There&#8217;s a general moral here, too, which we&#8217;re seeing in a special case: the master equation for a chemical reaction network really describes a bunch of random walks, one for each allowed value of the conserved quantities that can be built as linear combinations of number operators.  In our case we have one such conserved quantity, but in general there may be more (or none).  </p>
<p>Furthermore, these &#8216;random walks&#8217; are what we&#8217;ve been calling <a href="http://math.ucr.edu/home/baez/networks/networks_11.html">Markov processes</a>.</p>
<h3> Noether&#8217;s theorem </h3>
<p>We simplified our task of finding equilibrium solutions of the master equation by finding a conserved quantity.  The idea of simplifying problems using conserved quantities is fundamental to physics: this is why physicists are so enamored with quantities like energy, momentum, angular momentum and so on.  </p>
<p>Nowadays physicists often use &#8216;Noether&#8217;s theorem&#8217; to get conserved quantities from symmetries.  There&#8217;s a very simple version of Noether&#8217;s theorem for quantum mechanics, but in <a href="http://math.ucr.edu/home/baez/networks/networks_11.html">Part 11</a> we saw a version for stochastic mechanics, and it&#8217;s that version that is relevant now.  Here&#8217;s a paper which explains it in detail:</p>
<p>&bull; John Baez and Brendan Fong, <a href="http://arxiv.org/abs/1203.2035">Noether&#8217;s theorem for Markov processes</a>.</p>
<p>We don&#8217;t really need Noether&#8217;s theorem now, since we found the conserved quantity and exploited it without even noticing the symmetry.  Nonetheless it&#8217;s interesting to see how it relates to what we&#8217;re doing.  </p>
<p>For the reaction we&#8217;re looking at now, the idea is that the subspaces <img src="https://s0.wp.com/latex.php?latex=L_k&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="L_k" class="latex" /> are eigenspaces of an operator that commutes with the Hamiltonian <img src="https://s0.wp.com/latex.php?latex=H.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H." class="latex" />  It follows from standard math that a solution of the master equation that starts in one of these subspaces, stays in that subspace.</p>
<p>What is this operator?  It&#8217;s built from &#8216;number operators&#8217;.  The <b>number operator</b> for <img src="https://s0.wp.com/latex.php?latex=A&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A" class="latex" />s is</p>
<p><img src="https://s0.wp.com/latex.php?latex=N_A+%3D+a%5E%5Cdagger+a+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="N_A = a^&#92;dagger a " class="latex" /></p>
<p>and the number operator for <img src="https://s0.wp.com/latex.php?latex=B&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="B" class="latex" />s is </p>
<p><img src="https://s0.wp.com/latex.php?latex=N_B+%3D+b%5E%5Cdagger+b+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="N_B = b^&#92;dagger b " class="latex" /></p>
<p>A little calculation shows</p>
<p><img src="https://s0.wp.com/latex.php?latex=N_A+%5C%2Cy%5Em+z%5En+%3D+m+%5C%2C+y%5Em+z%5En%2C+%5Cquad+%5Cqquad++N_B%5C%2C+y%5Em+z%5En+%3D+n+%5C%2Cy%5Em+z%5En+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="N_A &#92;,y^m z^n = m &#92;, y^m z^n, &#92;quad &#92;qquad  N_B&#92;, y^m z^n = n &#92;,y^m z^n " class="latex" /></p>
<p>so the eigenvalue of <img src="https://s0.wp.com/latex.php?latex=N_A&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="N_A" class="latex" /> is the number of <img src="https://s0.wp.com/latex.php?latex=A&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A" class="latex" />s, while the eigenvalue of <img src="https://s0.wp.com/latex.php?latex=N_B&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="N_B" class="latex" /> is the number of <img src="https://s0.wp.com/latex.php?latex=B&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="B" class="latex" />s.  This is why they&#8217;re called number operators. </p>
<p>As a consequence, the eigenvalue of the operator <img src="https://s0.wp.com/latex.php?latex=N_A+%2B+2N_B&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="N_A + 2N_B" class="latex" /> is the number of <img src="https://s0.wp.com/latex.php?latex=A&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A" class="latex" />s plus twice the number of <img src="https://s0.wp.com/latex.php?latex=B&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="B" class="latex" />s:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%28N_A+%2B+2N_B%29+%5C%2C+y%5Em+z%5En+%3D+%28m+%2B+2n%29+%5C%2C+y%5Em+z%5En+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(N_A + 2N_B) &#92;, y^m z^n = (m + 2n) &#92;, y^m z^n " class="latex" /></p>
<p>Let&#8217;s call this operator <img src="https://s0.wp.com/latex.php?latex=O%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="O," class="latex" /> since it&#8217;s so important:</p>
<p><img src="https://s0.wp.com/latex.php?latex=O+%3D+N_A+%2B+2N_B+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="O = N_A + 2N_B " class="latex" /></p>
<p>If you think about it, the spaces <img src="https://s0.wp.com/latex.php?latex=L_k&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="L_k" class="latex" /> we saw a minute ago are precisely the eigenspaces of this operator:</p>
<p><img src="https://s0.wp.com/latex.php?latex=L_k+%3D+%5C%7B+%5CPsi+%3A+%5C%3B+O+%5CPsi+%3D+k+%5CPsi+%5C%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="L_k = &#92;{ &#92;Psi : &#92;; O &#92;Psi = k &#92;Psi &#92;} " class="latex" /></p>
<p>As we&#8217;ve seen, solutions of the master equation that start in one of these eigenspaces will stay there.  This lets take some techniques that are very familiar in quantum mechanics, and apply them to this stochastic situation.  </p>
<p>First of all, time evolution as described by the master equation is given by the operators <img src="https://s0.wp.com/latex.php?latex=%5Cexp%28t+H%29.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;exp(t H)." class="latex" />  In other words, </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bd%7D%7Bd+t%7D+%5CPsi%28t%29+%7D+%3D+H+%5CPsi%28t%29+%5C%3B+%5Ctextrm%7Band%7D+%5C%3B++%5CPsi%280%29+%3D+%5CPhi+%5Cquad++%5CRightarrow+%5Cquad+%5CPsi%28t%29+%3D+%5Cexp%28t+H%29+%5CPhi+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{d}{d t} &#92;Psi(t) } = H &#92;Psi(t) &#92;; &#92;textrm{and} &#92;;  &#92;Psi(0) = &#92;Phi &#92;quad  &#92;Rightarrow &#92;quad &#92;Psi(t) = &#92;exp(t H) &#92;Phi " class="latex" /></p>
<p>But if you start in some eigenspace of <img src="https://s0.wp.com/latex.php?latex=O%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="O," class="latex" /> you stay there.  Thus if <img src="https://s0.wp.com/latex.php?latex=%5CPhi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Phi" class="latex" /> is an eigenvector of <img src="https://s0.wp.com/latex.php?latex=O%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="O," class="latex" /> so is <img src="https://s0.wp.com/latex.php?latex=%5Cexp%28t+H%29+%5CPhi%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;exp(t H) &#92;Phi," class="latex" /> with the same eigenvalue.  In other words,</p>
<p><img src="https://s0.wp.com/latex.php?latex=O+%5CPhi+%3D+k+%5CPhi++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="O &#92;Phi = k &#92;Phi  " class="latex" /></p>
<p>implies</p>
<p><img src="https://s0.wp.com/latex.php?latex=O+%5Cexp%28t+H%29+%5CPhi+%3D+k+%5Cexp%28t+H%29+%5CPhi+%3D+%5Cexp%28t+H%29+O+%5CPhi+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="O &#92;exp(t H) &#92;Phi = k &#92;exp(t H) &#92;Phi = &#92;exp(t H) O &#92;Phi " class="latex" /></p>
<p>But since we can choose a basis consisting of eigenvectors of <img src="https://s0.wp.com/latex.php?latex=O%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="O," class="latex" /> we must have</p>
<p><img src="https://s0.wp.com/latex.php?latex=O+%5Cexp%28t+H%29+%3D+%5Cexp%28t+H%29+O+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="O &#92;exp(t H) = &#92;exp(t H) O " class="latex" /></p>
<p>or, throwing caution to the winds and differentiating:</p>
<p><img src="https://s0.wp.com/latex.php?latex=O+H+%3D+H+O+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="O H = H O " class="latex" /></p>
<p>So, as we&#8217;d expect from Noether&#8217;s theorem, our conserved quantity commutes with the Hamiltonian!   This in turn implies that <img src="https://s0.wp.com/latex.php?latex=H&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H" class="latex" /> commutes with any polynomial in <img src="https://s0.wp.com/latex.php?latex=O%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="O," class="latex" /> which in turn suggests that</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cexp%28s+O%29+H+%3D+H+%5Cexp%28s+O%29+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;exp(s O) H = H &#92;exp(s O) " class="latex" /></p>
<p>and also</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cexp%28s+O%29+%5Cexp%28t+H%29+%3D+%5Cexp%28t+H%29+%5Cexp%28s+O%29+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;exp(s O) &#92;exp(t H) = &#92;exp(t H) &#92;exp(s O) " class="latex" /></p>
<p>The last equation says that <img src="https://s0.wp.com/latex.php?latex=O&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="O" class="latex" /> generates a 1-parameter family of &#8216;symmetries&#8217;: operators <img src="https://s0.wp.com/latex.php?latex=%5Cexp%28s+O%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;exp(s O)" class="latex" /> that commute with time evolution.  But what do these symmetries actually do?  Since</p>
<p><img src="https://s0.wp.com/latex.php?latex=O+y%5Em+z%5En+%3D+%28m+%2B+2n%29+y%5Em+z%5En+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="O y^m z^n = (m + 2n) y^m z^n " class="latex" /></p>
<p>we have</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cexp%28s+O%29+y%5Em+z%5En+%3D+e%5E%7Bs%28m+%2B+2n%29%7D%5C%2C+y%5Em+z%5En+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;exp(s O) y^m z^n = e^{s(m + 2n)}&#92;, y^m z^n " class="latex" /></p>
<p>So, this symmetry takes any probability distribution <img src="https://s0.wp.com/latex.php?latex=%5Cpsi_%7Bm%2Cn%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi_{m,n}" class="latex" /> and multiplies it by <img src="https://s0.wp.com/latex.php?latex=e%5E%7Bs%28m+%2B+2n%29%7D.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="e^{s(m + 2n)}." class="latex" /></p>
<p>In other words, our symmetry multiplies the relative probability of finding our container of gas in a given state by a factor of <img src="https://s0.wp.com/latex.php?latex=e%5Es&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="e^s" class="latex" /> for each <img src="https://s0.wp.com/latex.php?latex=A&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A" class="latex" /> atom, and by a factor of <img src="https://s0.wp.com/latex.php?latex=e%5E%7B2s%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="e^{2s}" class="latex" /> for each <img src="https://s0.wp.com/latex.php?latex=B&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="B" class="latex" /> molecule.   It might not seem obvious that this operation commutes with time evolution!  However, experts on chemical reaction theory are familiar with this fact.</p>
<p>Finally, a couple of technical points.  Starting where we said &#8220;throwing caution to the winds&#8221;, our treatment has not been rigorous, since <img src="https://s0.wp.com/latex.php?latex=O&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="O" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=H&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H" class="latex" /> are unbounded operators, and these must be handled with caution.  Nonetheless, all the commutation relations we wrote down are true.</p>
<p>The operators <img src="https://s0.wp.com/latex.php?latex=%5Cexp%28s+O%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;exp(s O)" class="latex" /> are unbounded for positive <img src="https://s0.wp.com/latex.php?latex=s.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s." class="latex" />  They&#8217;re bounded for negative <img src="https://s0.wp.com/latex.php?latex=s%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s," class="latex" /> so they give a one-parameter <i>semi</i>group of bounded operators.  But they&#8217;re not stochastic operators: even for <img src="https://s0.wp.com/latex.php?latex=s&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s" class="latex" /> negative, they don&#8217;t map probability distributions to probability distributions.  However, they do map any nonzero vector <img src="https://s0.wp.com/latex.php?latex=%5CPsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Psi" class="latex" /> with <img src="https://s0.wp.com/latex.php?latex=%5Cpsi_%7Bm%2Cn%7D+%5Cge+0&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi_{m,n} &#92;ge 0" class="latex" /> to a vector <img src="https://s0.wp.com/latex.php?latex=%5Cexp%28s+O%29+%5CPsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;exp(s O) &#92;Psi" class="latex" /> with the same properties.  So, we can just normalize this vector and get a probability distribution.  The need for this normalization is why we spoke of <i>relative</i> probabilities.   </p>
<h3> The Anderson&#8211;Craciun&#8211;Kurtz theorem</h3>
<p>Now we&#8217;ll actually find all equilibrium solutions of the master equation in closed form.  To understand this final section, you really do need to remember some things we&#8217;ve discussed earlier.  <a href="https://johncarlosbaez.wordpress.com/2011/11/21/network-theory-part-18/">Last time</a> we considered the same chemical reaction network we&#8217;re studying today, but we looked at its rate equation, which looks like this:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bd%7D%7Bd+t%7D+x_1+%3D++2+%5Calpha+x_2+-+2+%5Cbeta+x_1%5E2%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{d}{d t} x_1 =  2 &#92;alpha x_2 - 2 &#92;beta x_1^2} " class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bd%7D%7Bd+t%7D+x_2+%3D+-+%5Calpha+x_2+%2B+%5Cbeta+x_1%5E2+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{d}{d t} x_2 = - &#92;alpha x_2 + &#92;beta x_1^2 } " class="latex" /></p>
<p>This describes how the number of <img src="https://s0.wp.com/latex.php?latex=A&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A" class="latex" />s and <img src="https://s0.wp.com/latex.php?latex=B&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="B" class="latex" />s changes in the limit where there are lots of them and we can treat them as varying continuously, in a deterministic way.  The number of <img src="https://s0.wp.com/latex.php?latex=A&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A" class="latex" />s is <img src="https://s0.wp.com/latex.php?latex=x_1%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x_1," class="latex" /> and the number of <img src="https://s0.wp.com/latex.php?latex=B&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="B" class="latex" />s is <img src="https://s0.wp.com/latex.php?latex=x_2.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x_2." class="latex" /> </p>
<p>We saw that the quantity</p>
<p><img src="https://s0.wp.com/latex.php?latex=x_1+%2B+2+x_2+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x_1 + 2 x_2 " class="latex" /></p>
<p>is conserved, just as today we&#8217;ve seen that <img src="https://s0.wp.com/latex.php?latex=N_A+%2B+2+N_B&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="N_A + 2 N_B" class="latex" /> is conserved.  We saw that the rate equation has one equilibrium solution for each choice of <img src="https://s0.wp.com/latex.php?latex=x_1+%2B+2+x_2.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x_1 + 2 x_2." class="latex" /> And we saw that these equilibrium solutions obey</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bx_1%5E2%7D%7Bx_2%7D+%3D+%5Cfrac%7B%5Calpha%7D%7B%5Cbeta%7D+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{x_1^2}{x_2} = &#92;frac{&#92;alpha}{&#92;beta} } " class="latex" /></p>
<p>The Anderson&#8211;Craciun&#8211;Kurtz theorem, introduced in <a href="http://math.ucr.edu/home/baez/networks/networks_9.html">Part 9</a>, is a powerful result that gets equilibrium solution of the master equation from equilibrium solutions of the rate equation.  It only applies to equilibrium solutions that are &#8216;complex balanced&#8217;, but that&#8217;s okay:</p>
<p><b>Puzzle 2.</b>  Show that the equilibrium solutions of the rate equation for the chemical reaction network </p>
<div align="center">
<img width="170" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/chemical_reaction_network_part_18.png" alt="" />
</div>
<p>are complex balanced.</p>
<p>So, given any equilibrium solution <img src="https://s0.wp.com/latex.php?latex=%28x_1%2Cx_2%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(x_1,x_2)" class="latex" /> of our rate equation, we can hit it with the Anderson-Craciun-Kurtz theorem and get an equilibrium solution of the master equation!  And it looks like this:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B++%5CPsi+%3D+e%5E%7B-%28x_1+%2B+x_2%29%7D+%5C%2C+%5Csum_%7Bm%2Cn+%5Cge+0%7D+%5Cfrac%7Bx_1%5Em+x_2%5En%7D+%7Bm%21+n%21+%7D+%5C%2C+y%5Em+z%5En+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{  &#92;Psi = e^{-(x_1 + x_2)} &#92;, &#92;sum_{m,n &#92;ge 0} &#92;frac{x_1^m x_2^n} {m! n! } &#92;, y^m z^n } " class="latex" /></p>
<p>In this solution, the probability distribution</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cpsi_%7Bm%2Cn%7D+%3D+e%5E%7B-%28x_1+%2B+x_2%29%7D+%5C%2C++%5Cfrac%7Bx_1%5Em+x_2%5En%7D+%7Bm%21+n%21+%7D+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;psi_{m,n} = e^{-(x_1 + x_2)} &#92;,  &#92;frac{x_1^m x_2^n} {m! n! } } " class="latex" /></p>
<p>is a product of Poisson distributions.  The factor in front is there to make the numbers <img src="https://s0.wp.com/latex.php?latex=%5Cpsi_%7Bm%2Cn%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi_{m,n}" class="latex" /> add up to one.   And remember, <img src="https://s0.wp.com/latex.php?latex=x_1%2C+x_2&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x_1, x_2" class="latex" /> are any nonnegative numbers with </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bx_1%5E2%7D%7Bx_2%7D+%3D+%5Cfrac%7B%5Calpha%7D%7B%5Cbeta%7D+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{x_1^2}{x_2} = &#92;frac{&#92;alpha}{&#92;beta} } " class="latex" /></p>
<p>So from all we&#8217;ve said, the above formula is an explicit closed-form solution of the horrid equation </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Barray%7D%7Bccr%7D+0+%26%3D%26++%5Calpha+%28n%2B1%29+%5C%2C+%5Cpsi_%7Bm-2%2Cn%2B1%7D+%5C%5C+%5C%5C+++%26%26-+%5C%3B+%5Calpha+n+%5C%2C+%5Cpsi_%7Bm%2Cn%7D+%5C%5C++%5C%5C++%26%26+%2B+%5Cbeta+%28m%2B2%29%28m%2B1%29+%5C%2C+%5Cpsi_%7Bm%2B2%2Cn-1%7D+%5C%5C+%5C%5C+%26%26+-+%5C%3B%5Cbeta+m%28m-1%29+%5C%2C+%5Cpsi_%7Bm%2Cn%7D+%5C%5C+%5C%5C+++%5Cend%7Barray%7D++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;begin{array}{ccr} 0 &amp;=&amp;  &#92;alpha (n+1) &#92;, &#92;psi_{m-2,n+1} &#92;&#92; &#92;&#92;   &amp;&amp;- &#92;; &#92;alpha n &#92;, &#92;psi_{m,n} &#92;&#92;  &#92;&#92;  &amp;&amp; + &#92;beta (m+2)(m+1) &#92;, &#92;psi_{m+2,n-1} &#92;&#92; &#92;&#92; &amp;&amp; - &#92;;&#92;beta m(m-1) &#92;, &#92;psi_{m,n} &#92;&#92; &#92;&#92;   &#92;end{array}  " class="latex" /></p>
<p>That&#8217;s pretty nice.  We found some solutions without ever doing any nasty calculations.</p>
<p>But we&#8217;ve really done better than getting <i>some</i> equilibrium solutions of the master equation.  By restricting attention to <img src="https://s0.wp.com/latex.php?latex=n%2Cm&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="n,m" class="latex" /> with <img src="https://s0.wp.com/latex.php?latex=m%2B2n+%3D+k%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="m+2n = k," class="latex" /> our formula for <img src="https://s0.wp.com/latex.php?latex=%5Cpsi_%7Bm%2Cn%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi_{m,n}" class="latex" /> gives an equilibrium solution that lives in the eigenspace <img src="https://s0.wp.com/latex.php?latex=L_k&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="L_k" class="latex" />:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B++%5CPsi_k+%3D+e%5E%7B-%28x_1+%2B+x_2%29%7D+%5C%2C+%5Csum_%7Bm%2B2n+%3Dk%7D+%5Cfrac%7Bx_1%5Em+x_2%5En%7D+%7Bm%21+n%21+%7D+%5C%2C+y%5Em+z%5En+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{  &#92;Psi_k = e^{-(x_1 + x_2)} &#92;, &#92;sum_{m+2n =k} &#92;frac{x_1^m x_2^n} {m! n! } &#92;, y^m z^n } " class="latex" /></p>
<p>And by what we&#8217;ve said, linear combinations of these give <i>all</i> equilibrium solutions of the master equation.   </p>
<p>And we got them with very little work!  Despite all the fancy talk in today&#8217;s post, we essentially just took the equilibrium solutions of the rate equation and plugged them into a straightforward formula to get equilibrium solutions of the master equation.  This is why the Anderson&#8211;Craciun&#8211;Kurtz theorem is so nice.  And of course we&#8217;re looking at a very simple reaction network: for more complicated ones it becomes even better to use this theorem to avoid painful calculations.</p>
<p>We could go further.  For example, we could study nonequilibrium solutions using Feynman diagrams like this:</p>
<div align="center">
<img width="350" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/feynman_diagram_hydrogen.png" alt="" />
</div>
<p>But instead, we will leave off with two more puzzles.  We introduced some symmetries, but we haven&#8217;t really explored them yet:</p>
<p><b>Puzzle 3.</b>  What do the symmetries associated to the conserved quantity <img src="https://s0.wp.com/latex.php?latex=O&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="O" class="latex" /> do to the equilibrium solutions of the master equation given by</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B++%5CPsi+%3D+e%5E%7B-%28x_1+%2B+x_2%29%7D+%5C%2C+%5Csum_%7Bm%2Cn+%5Cge+0%7D+%5Cfrac%7Bx_1%5Em+x_2%5En%7D+%7Bm%21+n%21+%7D+%5C%2C+y%5Em+z%5En+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{  &#92;Psi = e^{-(x_1 + x_2)} &#92;, &#92;sum_{m,n &#92;ge 0} &#92;frac{x_1^m x_2^n} {m! n! } &#92;, y^m z^n } " class="latex" /></p>
<p>where <img src="https://s0.wp.com/latex.php?latex=%28x_1%2Cx_2%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(x_1,x_2)" class="latex" /> is an equilibrium solution of the rate equation?  In other words, what is the significance of the one-parameter family of solutions</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cexp%28s+O%29+%5CPsi+%3F+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;exp(s O) &#92;Psi ? " class="latex" /></p>
<p>Also, we used a conceptual argument to check that <img src="https://s0.wp.com/latex.php?latex=H&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H" class="latex" /> commutes with <img src="https://s0.wp.com/latex.php?latex=O%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="O," class="latex" /> but it&#8217;s good to know that we can check this sort of thing directly:</p>
<p><b>Puzzle 4.</b>  Compute the commutator </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5BH%2C+O%5D+%3D+H+O+-+O+H+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="[H, O] = H O - O H " class="latex" /></p>
<p>and show it vanishes.</p>
									</div>

				<p class="postmetadata">
				<img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/speech_bubble.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2012/07/18/network-theory-part-19/#comments">41 Comments</a>				| <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/documents.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/category/chemistry/" rel="category tag">chemistry</a>, <a href="https://johncarlosbaez.wordpress.com/category/mathematics/" rel="category tag">mathematics</a>, <a href="https://johncarlosbaez.wordpress.com/category/networks/" rel="category tag">networks</a>, <a href="https://johncarlosbaez.wordpress.com/category/physics/" rel="category tag">physics</a>								 | <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/permalink.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2012/07/18/network-theory-part-19/" rel="bookmark" title="Permanent Link to Network Theory (Part&nbsp;19)">Permalink</a>
<br /><img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/figure_ver1.gif" alt="" /> Posted by John Baez				</p>
			</div>
			<hr />
		
			<div class="post-8947 post type-post status-publish format-standard hentry category-astronomy category-chemistry" id="post-8947">
				<h2><a href="https://johncarlosbaez.wordpress.com/2012/05/07/metallic-hydrogen/" rel="bookmark">Metallic Hydrogen</a></h2>
				<small>7 May, 2012</small><br />


				<div class="entry">
					<p>&nbsp; </p>
<div align="center">
<img width="450" src="https://i0.wp.com/math.ucr.edu/home/baez/astronomical/Jupiter_interior.png" /></div>
<p>See that gray stuff inside Jupiter? It&#8217;s metallic hydrogen&#8212;according to theory, anyway. </p>
<p>But how much do you need to squeeze hydrogen before the H<sub>2</sub> molecules break down, the individual atoms form a crystal, and electrons start roaming freely so the stuff starts conducting electricity and becomes shiny&#8212;in short, becomes a metal? </p>
<p>In 1935 the famous physicist Eugene Wigner and a coauthor predicted that 250,000 times normal Earth atmospheric pressure would do the job.  But now they&#8217;ve squeezed it to 3.6 million atmospheres and it&#8217;s still not conducting electricity!  Here&#8217;s a news report:</p>
<p>&bull; <a href="http://phys.org/news/2012-04-probing-hydrogen-extreme-conditions.html">Probing hydrogen under extreme conditions</a>, <i>PhysOrg</i>, 13 April 2012.</p>
<p>and here&#8217;s the original article, which unfortunately ain&#8217;t free:</p>
<p>&bull; Chang-Sheng Zha, Zhenxian Liu, and Russell J. Hemley, Synchrotron infrared measurements of dense hydrogen to 360 GPa, <i><a href="http://prl.aps.org/abstract/PRL/v108/i14/e146402">Phys. Rev. Lett.</a></i> <b>108</b> (2012), 146402.</p>
<p>Three phases of highly compressed solid hydrogen are known, with phase I starting at 1 million atmospheres and phase III kicking in around 1.5 million. I would love to know more about these!    Do you know where to find out?  Some people also think there&#8217;s a liquid metallic phase, and a <i>superconducting</i> liquid metallic phase.  In fact there are claims that liquid metallic hydrogen has already been seen:</p>
<p>&bull; W.J. Nellis, S.T. Weir and A.C. Mitchell, Metallization of fluid hydrogen at 140 GPa (1.4 Mbar) by shock compression, <a href="http://www.springerlink.com/content/5m5qnj0780xrhmra/"><i>Shock Waves</i></a> <b>9</b> (1999), 301&#8211;305.</p>
<p>1.4 Mbar, or megabar, is about 1.4 million atmospheres of pressure.  Here&#8217;s the abstract:</p>
<blockquote><p>
<b>Abstract.</b>  Shock compression was used to produce the first observation of a metallic state of condensed hydrogen. The conditions of metallization are a pressure of 140 GPa (1.4 Mbar), 0.6 g/cm (ninefold compression of initial liquid-H density), and 3000 K. The relatively modest temperature generated by a reverberating shock wave produced the metallic state in a warm fluid at a lower pressure than expected previously for the crystallographically ordered solid at low temperatures. The relatively large sample diameter of 25 mm permitted measurement of electrical conductivity. The experimental technique and data analysis are described.
</p></blockquote>
<p>Apprently the electric resistivity of fluid metallic hydrogen is about the same as the fluid alkali metals cesium and rubidium at 2000 kelvin, right when they undergo the same sort of nonmetal-metal transition.  Wow!  So does that mean that at 2000 kelvin but at lower pressures, these elements don&#8217;t act like metals?  I hadn&#8217;t known that!</p>
<p>Another reason this is interesting is that if you look at hydrogen on the periodic table, you&#8217;ll see it can&#8217;t make up its mind whether it&#8217;s an alkali metal&#8212;since its outer shell has just one electron in it&#8212;or a halogen&#8212;since its outer shell is just one electron short from being full!  You could say compressing hydrogen until it becomes metallic is like trying to get it to break down and admit its an alkali metal.</p>
<p>Apparently the metal-nonmetal transition for for liquid cesium, rubidium and hydrogen all happen when the stuff gets squashed so much that the distance between atoms goes down to about 0.3 times the size of these atoms in vacuum&#8230; where by &#8216;size&#8217; I mean the Bohr radius of the outermost shell.</p>
<p>How did Huntington and Wigner get their original calculation so wrong?  I don&#8217;t know!  Their original paper is here:</p>
<p>&bull; Eugene Wigner and Hillard Bell Huntington, On the possibility of a metallic modification of hydrogen <a href="jcp.aip.org/resource/1/jcpsa6/v3/i12/p764_s1"><i>J. Chem. Phys.</i></a> <b>3</b> (1935), 764-771.  </p>
<p>It&#8217;s not free; I guess the American Institute of Physics is still trying to milk it for all it&#8217;s worth.  One interesting thing is that they assumed the crystal stucture of metallic hydogen would be a &#8216;body-centered cubic&#8217;&#8230; it&#8217;s rather hard to compute these things from scratch without computers.  But this more recent paper claims that a diamond cubic is energetically favored at 3 million atmospheres:</p>
<p>&bull; <a href="http://people.physics.illinois.edu/Ceperley/papers/074.pdf">Crystal structure of atomic hydrogen</a>, <i>Phys. Rev. Lett.</i> <b>70</b> (1993), 1952-1955.</p>
<p>I explained the <a href="http://en.wikipedia.org/wiki/Diamond_cubic">diamond cubic</a> crystal structure in my recent post about <a href="https://johncarlosbaez.wordpress.com/2012/04/15/ice/">ice</a>.  Remember, it looks like this:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Diamond_cubic"><img src="https://i2.wp.com/math.ucr.edu/home/baez/chemical/250px_diamond_cubic_animation.gif" /></a></div>
<p>Since the body-centered cubic is one of the crystal lattices I <i>didn&#8217;t</i> talk about in that post, let me tell you about it now.  It&#8217;s built of cells that look like this:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Cubic_crystal_system"><img src="https://i1.wp.com/math.ucr.edu/home/baez/mathematical/lattice_body_centered_cubic.jpg" /></a></div>
<p>&#8230; which explains its name.  In the same style of drawing, the face-centered cubic looks like this:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Cubic_crystal_system"><img src="https://i2.wp.com/math.ucr.edu/home/baez/mathematical/lattice_face_centered_cubic.jpg" /></a></div>
<p>In my post about ice, I mentioned that if you pack equal-sized spheres with centers at points in the face-centered cubic lattice, you get the maximum density possible, namely about 74%.  The body-centered cubic does slightly worse, about 68%. </p>
<p>So, I always thought of it as a kind of a second-best thing.  But apparently it&#8217;s the best in some &#8216;sampling&#8217; problems where you&#8217;re trying to estimate a function on space by measuring it only at points in your lattice!  That&#8217;s because its <i>dual</i> is the face-centered cubic.  </p>
<p>Eh?   Well, the <b>dual</b> <img src="https://s0.wp.com/latex.php?latex=L%5E%2A&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="L^*" class="latex" /> of a lattice <img src="https://s0.wp.com/latex.php?latex=L&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="L" class="latex" /> in a vector space <img src="https://s0.wp.com/latex.php?latex=V&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="V" class="latex" /> consists of all vectors <img src="https://s0.wp.com/latex.php?latex=k&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="k" class="latex" /> in the dual vector space <img src="https://s0.wp.com/latex.php?latex=V%5E%2A&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="V^*" class="latex" /> such that <img src="https://s0.wp.com/latex.php?latex=k%28x%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="k(x)" class="latex" /> is an integer for all points <img src="https://s0.wp.com/latex.php?latex=x&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x" class="latex" /> in <img src="https://s0.wp.com/latex.php?latex=L.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="L." class="latex" />  The dual of a lattice is again a lattice, and taking the dual twice gets you back where you started.  Since the Fourier transform of a function on a vector space is a function on the dual vector space, I don&#8217;t find it surprising that this is related to sampling problems.  I don&#8217;t understand the details, but I bet I could find them here:</p>
<p>&bull; Alireza Entezari, Ramsay Dyer and Torsten Mller, <a href="http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.150.7878">From sphere packing to the theory of optimal lattice sampling</a>.</p>
<p>So: from the core of Jupiter to Fourier transforms!   Yet again, everything seems to be related.</p>
									</div>

				<p class="postmetadata">
				<img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/speech_bubble.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2012/05/07/metallic-hydrogen/#comments">13 Comments</a>				| <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/documents.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/category/astronomy/" rel="category tag">astronomy</a>, <a href="https://johncarlosbaez.wordpress.com/category/chemistry/" rel="category tag">chemistry</a>								 | <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/permalink.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2012/05/07/metallic-hydrogen/" rel="bookmark" title="Permanent Link to Metallic Hydrogen">Permalink</a>
<br /><img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/figure_ver1.gif" alt="" /> Posted by John Baez				</p>
			</div>
			<hr />
		
			<div class="post-8945 post type-post status-publish format-standard hentry category-astronomy category-chemistry" id="post-8945">
				<h2><a href="https://johncarlosbaez.wordpress.com/2012/04/15/ice/" rel="bookmark">Ice</a></h2>
				<small>15 April, 2012</small><br />


				<div class="entry">
					<p>Water is complicated and fascinating stuff! There are at least sixteen known crystal phases of ice, many shown in this diagram based on the work of <a href="http://www1.lsbu.ac.uk/water/water_phase_diagram.html">Martin Chaplin</a>:</p>
<div align="center"><a href="https://commons.wikimedia.org/wiki/File:Phase_diagram_of_water.svg"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/08/Phase_diagram_of_water.svg/1000px-Phase_diagram_of_water.svg.png" width="450" /></a></div>
<p>(Click for a larger version.)</p>
<p>For example, ordinary ice is called <a href="http://en.wikipedia.org/wiki/Ice_Ih">ice I<sub>h</sub></a>, because it has hexagonal crystals.   But if you cool it below -37 C, scientists believe it will gradually turn into a cubic form, called <a href="http://en.wikipedia.org/wiki/Ice_Ic">ice I<sub>c</sub></a>. In this form of ice the water molecules are arranged like carbons in a diamond! And apparently some of it can be found in ice crystals in the stratosphere.</p>
<p>But if you wait longer, ice below -37 C will turn into ice <a href="http://en.wikipedia.org/wiki/Ice_XI">XI</a>. The transformation process is slow, but ice XI has been found in Antarctic ice that&#8217;s 100 to 10,000 years old. This ice is ferroelectric, meaning that it spontaneously become electrically polarized, just like a ferromagnet spontaneously magnetizes.</p>
<p>That&#8217;s the usual textbook story, anyway.  The true story may be even more complicated:</p>
<p> Simon Hadlington, <a href="http://www.rsc.org/chemistryworld/News/2012/January/supercooled-cubic-ice-existence-questioned.asp">A question mark over cubic ice&#8217;s existence</a>, <i>Phys.org</i>, 9 January 2012.</p>
<blockquote><p>
But now a team led by Benjamin Murray at the University of Leeds has carried out work that suggests that cubic ice may not in fact exist. The researchers searched for cubic ice by suspending water droplets in oil and gradually cooling them to -40 C while observing the X-ray diffraction pattern of the resulting crystals. &#8220;We modelled the diffraction pattern we obtained and compared it to perfect cubic and perfect hexagonal ice, and it was clearly neither of them,&#8221; Murray says. &#8220;Nor is it merely a mixture of the two. Rather it is something quite distinct.&#8221;</p>
<p>Analysis of the diffraction data shows that in the ice crystals the stacking of the atomic layers is disordered. &#8220;The crystals that form have randomly stacked layers of cubic and hexagonal sequences,&#8221; Murray says. &#8220;As each new layer is added, there is a 50% probability of it being either hexagonal or cubic.&#8221; The result is a novel, metastable form of ice with a stacking-disordered structure.</p>
<p>Re-examination of what had previously been identified as cubic ice suggests that this was stacking-disordered structures too, Murray says. &#8220;Cubic ice may not exist.&#8221;</p></blockquote>
<p>Even plain old ice I<sub>h</sub> is surprisingly tricky stuff. The crystal structure is subtle, first worked out by Linus Pauling in 1935. Here&#8217;s a nice picture by <a href="http://www.chem1.com/acad/webtext/states/water.html">Steve Lower</a>:</p>
<div align="center"><a href="http://www.chem1.com/acad/webtext/states/water.html"><img src="https://i2.wp.com/math.ucr.edu/home/baez/chemical/icecrystruct.png" width="450" /></a></div>
<p>There&#8217;s a lot of fun math here.  First focus on the oxygen atoms, in red.  What sort of pattern do they form?</p>
<h3> Close-packings</h3>
<p>To warm up for that question, it really helps to start by watching this video:</p>
<span class="embed-youtube" style="text-align:center; display: block;"><iframe class="youtube-player" width="420" height="315" src="https://www.youtube.com/embed/Rm-i1c7zr6Q?version=3&#038;rel=1&#038;showsearch=0&#038;showinfo=1&#038;iv_load_policy=1&#038;fs=1&#038;hl=en&#038;autohide=2&#038;wmode=transparent" allowfullscreen="true" style="border:0;" sandbox="allow-scripts allow-same-origin allow-popups allow-presentation"></iframe></span>
<p>It&#8217;s not flashy, but it helped me understand something that had been bothering me for <i>decades!</i>   This is truly beautiful stuff: part of the geometry of nature.</p>
<p>But I&#8217;ll explain ice I<sub>h</sub> from scratch&#8212;and while I&#8217;m at it, ice I<sub>c</sub>.</p>
<p>First we need to think about packing balls.  Say you&#8217;re trying to pack equal-sized balls as densely as possible.  You put down a layer in a hexagonal way, like the balls labelled &#8216;a&#8217; here:</p>
<div align="center"><a href="http://glossary.periodni.com/glossary.php?en=hexagonal+close-packed+structure"><img src="https://i1.wp.com/math.ucr.edu/home/baez/mathematical/hexagonal_close-packed_structure.gif" /></a></div>
<p>Then you put down a second hexagonal layer of balls.  You might as well put them in the spots labelled &#8216;b&#8217;.  There&#8217;s another choice, but the symmetry of the situation means it doesn&#8217;t matter which you pick!</p>
<p>The fun starts at the third layer.  If you want, you can put these balls in the positions labelled &#8216;a&#8217;, directly over the balls in the first layer.  And you can go on like this forever, like this:</p>
<div align="center">
-a-b-a-b-a-b-a-b-a-b-a-</div>
<p>This gives you the <b><a href="http://math.ucr.edu/home/baez/mathematical/hexagonal_close-packed_structure.gif">hexagonal close packing</a></b>.</p>
<p>But there&#8217;s another choice for where to put the balls in the third layer&#8230; and now it <i>does matter which choice you pick!</i>  The other choice is to put these balls in the spots labelled &#8216;c&#8217;:</p>
<div align="center"><a href="http://glossary.periodni.com/glossary.php?en=cubic+close-packed+structure"><img src="https://i1.wp.com/math.ucr.edu/home/baez/mathematical/cubic_close-packed_structure.gif" /></a></div>
<p>And then you can go on forever like this:</p>
<div align="center">
-a-b-c-a-b-c-a-b-c-a-b-c-</div>
<p>This gives you the <b><a href="http://glossary.periodni.com/glossary.php?en=cubic+close-packed+structure">cubic close packing</a></b>.</p>
<p>There&#8217;s also an uncountable infinity of other patterns that all give you equally dense packings.  For example:</p>
<div align="center">
-a-b-a-c-b-a-c-b-c-b-a-c-</div>
<p>You just can&#8217;t repeat the same letter twice in a row!</p>
<p>To review, here&#8217;s the difference between the hexagonal and cubic close packings:</p>
<div align="center"><a href="http://www.ndt-ed.org/EducationResources/CommunityCollege/Materials/Structure/fcc_hcp.htm"><img src="https://i1.wp.com/math.ucr.edu/home/baez/mathematical/close_packings.jpg" /></a></div>
<p>But what&#8217;s &#8216;cubic&#8217; about the cubic close packing?  Well, look at this.  At left we see a bit of a hexagonal close packing, while at right we see a bit of a cubic close packing:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Close-packing_of_equal_spheres"><img src="https://i1.wp.com/math.ucr.edu/home/baez/mathematical/399px-close_packings.png" /></a></div>
<p>The dashed white circle at right shows what you <i>shouldn&#8217;t</i> do for a cubic close packing.  But the red lines at right show why it&#8217;s called &#8216;cubic&#8217;!   If you grab that cube and pull it out, it looks like this:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Close-packing_of_equal_spheres"><img src="https://i1.wp.com/math.ucr.edu/home/baez/mathematical/face_centered_cubic_2.jpg" /></a></div>
<p>As you can see, there&#8217;s a ball at each corner of a cube, but also one at the middle of each face.  That&#8217;s why this pattern is also called a <b>face-centered cubic</b>.</p>
<p>If we shrink the balls a bit, the face-centered cubic looks like this:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Close-packing_of_equal_spheres"><img src="https://i2.wp.com/math.ucr.edu/home/baez/mathematical/face_centered_cubic.jpg" width="300" /></a></div>
<p>What used to confuse me so much is that the cubic close packing looks very different from different angles.  For example, when you see it like this, the cubical symmetry is hard to spot:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Close-packing_of_equal_spheres"><img src="https://i1.wp.com/math.ucr.edu/home/baez/mathematical/cubic_close_packing.jpg" width="400" /></a></div>
<p>But it&#8217;s there!  If you stack some balls in the hexagonal close packing, they look different:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Close-packing_of_equal_spheres"><img src="https://i1.wp.com/math.ucr.edu/home/baez/mathematical/hexagonal_close_packing.jpg" width="250" /></a></div>
<p>And to my eye, they look uglier&#8212;they&#8217;re less symmetrical.</p>
<p>Anyway, perhaps now we&#8217;re in a better position to understand what Benjamin Murray meant when he said:</p>
<blockquote><p>
As each new layer is added, there is a 50% probability of it being either hexagonal or cubic.</p></blockquote>
<p>I&#8217;m guessing that means that at each layer we <i>randomly</i> make either of the two choices I mentioned.  I&#8217;m not completely sure.  My guess makes the most sense if the ice is growing by accretion one layer at a time.</p>
<h3> Diamonds</h3>
<p>But there&#8217;s more to ice than close-packed spheres.  If we ignore the hydrogen atoms and focus only on the oxygens, the two kinds of ice we&#8217;re talking about&#8212;the hexagonal ice I<sub>h</sub> and the cubic ice I<sub>c</sub>, assuming it exists&#8212;are just like two kinds of diamond!</p>
<p>The oxygens in ice I<sub>c</sub> are arranged in the same pattern as carbons in an ordinary diamond:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Diamond_cubic"><img src="https://i2.wp.com/math.ucr.edu/home/baez/chemical/250px_diamond_cubic_animation.gif" /></a></div>
<p>This pattern is called a <b><a href="http://en.wikipedia.org/wiki/Diamond_cubic">diamond cubic</a></b>.  We can get it by taking the cubic close packing, making the balls smaller, and then putting in new ones, each at the center of a tetrahedron formed by the old ones.  I hope you can see this.  There&#8217;s a ball at each corner of the cube and one at the center of each face, just as we want for a face-centered cubic.  But then there are are 4 more!</p>
<p>But what about good old ice I<sub>h</sub>?  Here the oxygens are arranged in the same pattern as carbons in a <i>hexagonal</i> diamond.</p>
<p>You&#8217;ve heard about diamonds, but you might not have heard about hexagonal diamond, also known as <a href="http://en.wikipedia.org/wiki/Lonsdaleite">lonsdaelite</a>.  It forms when graphite is crushed&#8230; typically by a meteor impact!  It&#8217;s also been made in the lab.</p>
<p>Its crystal structure looks like this:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Lonsdaleite"><img src="https://i0.wp.com/math.ucr.edu/home/baez/chemical/588px-lonsdaelite.png" width="400" /></a></div>
<p>We get this pattern by taking a hexagonal close packing, making the balls smaller, and then putting in new ones, each at the center of a tetrahedron formed by the old ones.  Again, I hope you can see this!</p>
<h3> Entropy</h3>
<p>Now we understand how the oxygens are arranged in good old ice I<sub>h</sub>.  They&#8217;re the red balls here, and the pattern is exactly like lonsdaelite, though viewed from a confusingly different angle:</p>
<div align="center"><a href="http://www.chem1.com/acad/webtext/states/water.html"><img src="https://i2.wp.com/math.ucr.edu/home/baez/chemical/icecrystruct.png" width="450" /></a></div>
<p>But what about the hydrogens?  They&#8217;re very interesting: they&#8217;re arranged in a somewhat <i>random</i> way!</p>
<p>Pick any oxygen near the middle of the picture above.  It has 4 bonds to other oxygens, shown in green.  But only 2 of these bonds have a hydrogen <i>near</i> your oxygen! The other 2 bonds have hydrogens <i>far away</i>, at the other end.</p>
<p>There are many ways for this to happen, and they&#8217;re all allowed&#8212;so ice is like a jigsaw puzzle that you can put together in lots of ways!</p>
<p>So, even though ice is a crystal, it&#8217;s disordered.  This gives it entropy. Figuring out how much entropy is a nice math puzzle: it&#8217;s about 3/2 times Boltzmann&#8217;s constant per water molecule. Why?</p>
<p>Rahul Siddharthan explained this to me over on Google+.  Here&#8217;s the story.</p>
<p>The oxygen atoms form a bipartite lattice: in other words, they can be divided into two sets, with all the neighbors of an oxygen atom from <i>one</i> set lying in the <i>other</i> set.  You can see this if you look.</p>
<p>Focus attention on the oxygen atoms in one set: there are <img src="https://s0.wp.com/latex.php?latex=N%2F2&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="N/2" class="latex" /> of them. Each has 4 hydrogen bonds, with two hydrogens close to it and two far away. This means there are</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cbinom%7B4%7D%7B2%7D+%3D+6&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;binom{4}{2} = 6" class="latex" /></p>
<p>allowed configurations of hydrogens for this oxygen atom. Thus there are <img src="https://s0.wp.com/latex.php?latex=6%5E%7BN%2F2%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="6^{N/2}" class="latex" /> configurations that satisfy these <img src="https://s0.wp.com/latex.php?latex=N%2F2&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="N/2" class="latex" /> atoms.</p>
<p>But now consider the remaining <img src="https://s0.wp.com/latex.php?latex=N%2F2&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="N/2" class="latex" /> oxygen atoms: in general they won&#8217;t be satisfied: they won&#8217;t have precisely two hydrogen atoms near them). For each of those, there are</p>
<p><img src="https://s0.wp.com/latex.php?latex=2%5E4+%3D+16&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="2^4 = 16" class="latex" /></p>
<p>possible placements of the hydrogen atoms along their hydrogen bonds, of which 6 are allowed. So, naively, we would expect the total number of configurations to be</p>
<p><img src="https://s0.wp.com/latex.php?latex=6%5E%7BN%2F2%7D+%286%2F16%29%5E%7BN%2F2%7D+%3D+%283%2F2%29%5EN&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="6^{N/2} (6/16)^{N/2} = (3/2)^N" class="latex" /></p>
<p>Using Boltzmann&#8217;s ideas on entropy, we conclude that</p>
<p><img src="https://s0.wp.com/latex.php?latex=S+%3D+Nk%5Cln%283%2F2%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S = Nk&#92;ln(3/2)" class="latex" /></p>
<p>where <img src="https://s0.wp.com/latex.php?latex=k&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="k" class="latex" /> is Boltzmann&#8217;s constant.  This gives an entropy of 3.37 joules per mole per kelvin, a value close to the measured value. But this estimate is &#8216;naive&#8217; because it assumes the 6 out of 16 hydrogen configurations for oxygen atoms in the second set can be independently chosen, which is false. More complex methods can be employed to better approximate the exact number of possible configurations, and achieve results closer to measured values.</p>
<p>By the way: I&#8217;ve been trying to avoid unnecessary jargon, but this randomness in ice I<sub>h</sub> has such a cool name I can&#8217;t resist mentioning it.  It&#8217;s called <b>proton disorder</b>, since the hydrogens I&#8217;ve been talking about are really just hydrogen nuclei, or protons.  The electrons, which form the bonds, are smeared all over thanks to the wonders of quantum mechanics.</p>
<h3> Higher pressures</h3>
<p>If I were going to live forever, I&#8217;d <i>definitely</i> enjoy studying and explaining all sixteen known forms of ice.  For example, I&#8217;d tell you the story of what happens to ordinary ice as we slowly increase the pressure, moving up this diagram until we hit ice XI:</p>
<div align="center"><a href="https://commons.wikimedia.org/wiki/File:Phase_diagram_of_water.svg"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/08/Phase_diagram_of_water.svg/1000px-Phase_diagram_of_water.svg.png" width="450" /></a></div>
<p>Heck, I&#8217;d like to know what happens at every stage as we crush water down to neutronium!  Unfortunately I&#8217;m mortal, with lots to do.  So I recommend these:</p>
<p> Martin Chaplin, <a href="http://www1.lsbu.ac.uk/water/water_phase_diagram.html">Water phase diagram</a>.</p>
<p> Norman Anderson, <a href="http://www.docstoc.com/docs/80350447/The-Many-Phases-of-Ice">The many phases of ice</a>.</p>
<p>But there&#8217;s a bit of news I can&#8217;t resist mentioning&#8230;</p>
<p>Researchers at Sandia Labs in Albuquerque, New Mexico have been using the <a href="http://en.wikipedia.org/wiki/Z_machine">Z Machine</a> to study ice.  Here it is in operation, shooting out sparks:</p>
<div align="center"><a href="http://www.sandia.gov/news-center/news-releases/2006/images/z-machine.jpg"><img src="https://i0.wp.com/math.ucr.edu/home/baez/chemical/z-machine.jpg" /></a></div>
<p>Click for an even more impressive image of the whole thing.</p>
<p>How does it work?  It fires a very powerful electrical current&#8212;about 20 million amps&#8212;into an array of thin, parallel tungsten wires.  For a very short time, it uses a power of 290 terawatts.  That&#8217;s 80 times the world&#8217;s total electrical power output!  The current vaporizes the wires, and they turn into tubes of plasma. At the same time, the current creates a powerful magnetic field.  This radially compresses the plasma tubes at speeds of nearly 100,000 kilometers per hour.  And this lets the mad scientists who run this machine study materials at <i>extremely</i> high pressures.</p>
<p><a href="https://share.sandia.gov/news/resources/releases/2007/z-ice.html">Back in 2007</a>, the Z Machine made <a href="http://www.lsbu.ac.uk/water/ice_vii.html">ice VII</a>, a cubic crystalline form of ice that coexists with liquid water and <a href="http://www.lsbu.ac.uk/water/ice_vi.html">ice VI</a> at 82 Celsius and about 20,000 atmospheres.  Its crystal structure is theorized to look like this:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Ice_VII"><br />
<img src="https://i2.wp.com/math.ucr.edu/home/baez/chemical/220px-Iceviistructure.gif" /></a></div>
<p>But now the Z Machine is making far more compressed forms of ice.  Above 1 million atmospheres, <a href="http://www.lsbu.ac.uk/water/ice_x.html">ice X</a> is stable&#8230; and above 8 million atmospheres, a hexagonal ferroelectric form called <a href="http://www.lsbu.ac.uk/water/ice_xi.html">ice XI</a> comes into play.   This has a density over 2.5 times that of ordinary water!</p>
<p>Recent experiments with the Z Machine seem to show water is 30% less compressible than had been thought under conditions like those at the center of Neptune.  These experiments seem to match new theoretical calculations, too:</p>
<p> <a href="http://www.sciencedaily.com/releases/2012/03/120319151155.htm">Experiments may force revision of astrophysical models: ice giant planets have more water volume than believed</a>, <i>Science Daily</i>, 19 March 2012.</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Neptune"><br />
<img src="https://i1.wp.com/math.ucr.edu/home/baez/neptune.jpg" width="400" /></a></div>
<p>While it&#8217;s named after the Roman god of the seas, and it&#8217;s nice and blue, Neptune&#8217;s upper atmosphere is very dry.  However, there seems to be water down below, and it has a heart of ice.  A mix of water, ammonia and methane ice surrounding a rocky core, to be precise!   But the pressure down there is about 8 million atmospheres, so there&#8217;s probably ice X and ice XI.  And if that ice is less compressible than people thought, it&#8217;ll force some changes in our understanding of this planet.</p>
<p>Not that this matters much for most purposes.  But it&#8217;s cool.</p>
<p>And if you don&#8217;t love math, this might be a good place to stop reading.</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Cuboctahedron"><img src="https://i2.wp.com/math.ucr.edu/home/baez/mathematical/220px-cuboctahedron.jpg" /></a></div>
<div align="center"><a href="http://en.wikipedia.org/wiki/Triangular_orthobicupola"><img src="https://i1.wp.com/math.ucr.edu/home/baez/mathematical/220px-triangular_orthobicupola.png" /></a></div>
<h3> A little more math</h3>
<p>Okay&#8230; if you&#8217;re still reading, you must want more!   And having wasted the day on this post, I might as well explain a bit of the math of the crystal structures I described.  I&#8217;ll want to someday; it might as well be now.</p>
<p>A <b>lattice</b> in n-dimensional Euclidean space is a subset consisting of all linear combinations of <img src="https://s0.wp.com/latex.php?latex=n&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="n" class="latex" /> basis vectors.  The centers of the balls in the cubic close packing form a lattice called the face-centered cubic or A<sub>3</sub> lattice.  It&#8217;s most elegant to think of these as the vectors <img src="https://s0.wp.com/latex.php?latex=%28a%2Cb%2Cc%2Cd%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(a,b,c,d)" class="latex" /> in 4-dimensional space having integer components and lying in the hyperplane</p>
<p><img src="https://s0.wp.com/latex.php?latex=a+%2B+b+%2B+c+%2B+d+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="a + b + c + d = 0 " class="latex" /></p>
<p>That way, you can see this lattice has the group of permutations of 4 letters as symmetries.  Not coincidentally, this is the symmetry group of the cube.</p>
<p>In this description, you can take the three basis vectors to be</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%281%2C-1%2C0%2C0%29%2C+%5Cquad+%280%2C1%2C-1%2C0%29%2C+%5Cquad+%280%2C0%2C1%2C-1%29+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ (1,-1,0,0), &#92;quad (0,1,-1,0), &#92;quad (0,0,1,-1) }" class="latex" /></p>
<p>Note that they all have the same length and each lies at a 120 angle from the previous one, while the first and last are at right angles.</p>
<p>We can also get the A<sub>3</sub> lattice by taking the center of each red cube in a 3d red-and-black checkerboard.  That means taking all vectors <img src="https://s0.wp.com/latex.php?latex=%28a%2Cb%2Cc%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(a,b,c)" class="latex" /> in 3-dimensional space with integer coefficients that sum to an even number.  In this description, you can take the three basis vectors to be</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%281%2C-1%2C0%29%2C+%5Cquad+%280%2C1%2C-1%29%2C+%5Cquad+%28-1%2C-1%2C0%29+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ (1,-1,0), &#92;quad (0,1,-1), &#92;quad (-1,-1,0) }" class="latex" /></p>
<p>This seems like an ugly choice, but note: they all have the same length and each lies at a 120 angle from the previous one, while the first and last are at right angles.  So, we know it&#8217;s the A<sub>3</sub> lattice!</p>
<p>We see more symmetry if we look at <i>all</i> the shortest nonzero vectors in this description of the lattice:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%28%5Cpm+1%2C+%5Cpm+1%2C0%29%2C+%5Cquad+%280%2C%5Cpm+1%2C%5Cpm+1%29%2C+%5Cquad+%28%5Cpm+1%2C%5Cpm+1%2C0%29+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ (&#92;pm 1, &#92;pm 1,0), &#92;quad (0,&#92;pm 1,&#92;pm 1), &#92;quad (&#92;pm 1,&#92;pm 1,0) }" class="latex" /></p>
<p>These form the 12 midpoints of the edges of a cube, and thus the corners of a cuboctahedron:</p>
<div align="center"><img src="https://i1.wp.com/math.ucr.edu/home/baez/mathematical/cuboctahedron_in_cube.png" width="200" /></div>
<p>So, in the cubic close packing each ball touches 12 others, centered at the vertices of a cuboctahedron, as shown here:</p>
<div align="center"><a href="https://hexnet.org/content/cuboctahedron"><br />
</a><a href="https://johncarlosbaez.files.wordpress.com/2012/04/content_cuboctahedron-sphere-packing.png"><img src="https://johncarlosbaez.files.wordpress.com/2012/04/content_cuboctahedron-sphere-packing.png?w=300" alt="" width="300" /></a>
</div>
<p>In the hexagonal close packing each ball also touches twelve others, but centered at the vertices of a mutant cuboctahedron whose top has been <i>twisted</i> relative to its bottom.  This shape is called a <a href="http://en.wikipedia.org/wiki/Triangular_orthobicupola">triangular orthobicupola</a>.</p>
<p>I should talk more about the lattice associated to the hexagonal close packing, but I don&#8217;t understand it well enough.  Instead I&#8217;ll wrap up by explaining the math of the diamond cubic:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Diamond_cubic"><img src="https://i2.wp.com/math.ucr.edu/home/baez/chemical/250px_diamond_cubic_animation.gif" /></a></div>
<p>The diamond cubic is <i>not</i> a lattice.  We can get it by taking the union of two copies of the A<sub>3</sub> lattice: the original lattice and a translated copy.  For example, we can start with all vectors <img src="https://s0.wp.com/latex.php?latex=%28a%2Cb%2Cc%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(a,b,c)" class="latex" /> with integer coefficients summing to an even number, and then throw in all vectors <img src="https://s0.wp.com/latex.php?latex=%28a+%2B+%5Cfrac%7B1%7D%7B2%7D%2C+b+%2B+%5Cfrac%7B1%7D%7B2%7D%2C+c+%2B+%5Cfrac%7B1%7D%7B2%7D%29.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(a + &#92;frac{1}{2}, b + &#92;frac{1}{2}, c + &#92;frac{1}{2})." class="latex" />   This is called the  D<sub>3</sub><sup>+</sup> pattern.</p>
<p>The A<sub>3</sub> lattice gives a dense-as-possible packing of balls, the cubic close packing, with density</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7B%5Cpi%7D%7B3+%5Csqrt%7B2%7D%7D+%5Csim+0.74+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{&#92;pi}{3 &#92;sqrt{2}} &#92;sim 0.74 }" class="latex" /></p>
<p>The  D<sub>3</sub><sup>+</sup> pattern, on the other hand, gives a way to pack spheres with a density of merely</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7B%5Cpi+%5Csqrt%7B3%7D%7D+%7B16%7D+%5Csim+0.34+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{&#92;pi &#92;sqrt{3}} {16} &#92;sim 0.34 } " class="latex" /></p>
<p>This is why ordinary ice actually becomes denser when it melts.   It&#8217;s not packed in the diamond cubic pattern: that would be ice I<sub>c</sub>.  Ordinary ice is packed in a similar pattern built starting from the hexagonal close packing!  But the hexagonal close packing looks just like the cubic close packing if you only look at two layers&#8230; so this similar pattern gives a packing of balls with the same density as the diamond cubic.</p>
<p>Finally, for a tiny taste of some more abstract math: in any dimension you can define a checkerboard lattice called D<sub>n</sub>, consisting of all n-tuples of integers that sum to an even integer.  Then you can define a set called  D<sub>n</sub><sup>+</sup> by taking the union of two copies of the D<sub>n</sub> lattice: the original and another shifted by the vector <img src="https://s0.wp.com/latex.php?latex=%28%5Cfrac%7B1%7D%7B2%7D%2C+%5Cdots%2C+%5Cfrac%7B1%7D%7B2%7D%29.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(&#92;frac{1}{2}, &#92;dots, &#92;frac{1}{2})." class="latex" /></p>
<p>D<sub>n</sub><sup>+</sup> is only a lattice when the dimension n is even!  When the dimension is a multiple of 4, it&#8217;s an <b>integral</b> lattice, meaning that the dot product of any two vectors in the lattice is an integer.  It&#8217;s also <b>unimodular</b>, meaning that the volume of the unit cell is 1. And when the dimension is a multiple of 8, it&#8217;s also <b>even</b>, meaning that the dot product of any vector with itself is even.</p>
<p>Now, D<sub>8</sub><sup>+</sup> is very famous: it&#8217;s the only even unimodular lattice in 8 dimensions, and it&#8217;s usually called <a href="http://en.wikipedia.org/wiki/E8_lattice">E<sub>8</sub></a>.  In <a href="http://math.ucr.edu/home/baez/week193.html">week193</a>, I showed you that in the packing of balls based on this lattice, each ball touches 240 others.  It&#8217;s extremely beautiful.</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/E8_(mathematics)"><img src="https://i2.wp.com/math.ucr.edu/home/baez/mathematical/500px-E8PetrieFull.svg.png" width="450" /></a></div>
<p>But these days I&#8217;m trying to stay more focused on the so-called &#8216;real world&#8217; of chemistry, biology, ecology and the like.  This has a beauty of its own.  In 3 dimensions, D<sub>3</sub> = A<sub>3</sub> is the face-centered cubic.  D<sub>3</sub><sup>+</sup> is the diamond lattice.  So, in a way, diamonds come as close to E<sub>8</sub> as possible in our 3-dimensional world.</p>
<p>The diamond cubic may seem mathematically less thrilling than E<sub>8</sub>: not even a lattice.  Ordinary ice is even more messy.  But it has a different charm&#8212;the charm of lying at the bordeline of simplicity and complexity&#8212;and the advantage of manifesting itself in the universe we easily see around us, with a rich network of relationships to everything else we see.</p>
<div align="center"><a href="http://www.its.caltech.edu/~atomic/snowcrystals/photos/photos.htm"><img src="https://i1.wp.com/www.its.caltech.edu/~atomic/snowcrystals/photos/w041219b055.jpg" width="450" /></a></div>
									</div>

				<p class="postmetadata">
				<img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/speech_bubble.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2012/04/15/ice/#comments">36 Comments</a>				| <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/documents.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/category/astronomy/" rel="category tag">astronomy</a>, <a href="https://johncarlosbaez.wordpress.com/category/chemistry/" rel="category tag">chemistry</a>								 | <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/permalink.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2012/04/15/ice/" rel="bookmark" title="Permanent Link to Ice">Permalink</a>
<br /><img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/figure_ver1.gif" alt="" /> Posted by John Baez				</p>
			</div>
			<hr />
		
			<div class="post-8767 post type-post status-publish format-standard hentry category-astronomy category-biology category-chemistry" id="post-8767">
				<h2><a href="https://johncarlosbaez.wordpress.com/2012/03/24/dysnomia/" rel="bookmark">Dysnomia</a></h2>
				<small>24 March, 2012</small><br />


				<div class="entry">
					<p>This morning I was looking at a nice website that lets you zoom in or out and see objects of different sizes, ranging from the Planck length to the entire observable Universe:</p>
<p>&bull; Cary Huang, <a href="http://www.htwins.net/scale2/">The Scale of the Universe</a>.</p>
<p>When I zoomed out to a size somewhat larger than Rhode Island, I saw something strange:</p>
<div align="center"><a href="http://www.htwins.net/scale2"><img src="https://i1.wp.com/math.ucr.edu/home/baez/dysnomia.jpg" /></a></div>
<p>Huh?  I recently saw a movie called <i><a href="http://en.wikipedia.org/wiki/Melancholia_%282011_film%29">Melancholia</a></i>, about a pair of sisters struggling with fear and depression, and a blue planet of that name that&#8217;s headed for Earth.  And indeed, <a href="http://en.wikipedia.org/wiki/Dysnomia_%28disorder%29">dysnomia</a> is another mental disorder: a difficulty in remembering words, names or numbers.  Are astronomical bodies named for mental disorders catching on?</p>
<p>I don&#8217;t know&#8212;but unlike Melancholia, Dysnomia is real!   It&#8217;s the speck at left here:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Eris_%28dwarf_planet%29"><img src="http://upload.wikimedia.org/wikipedia/commons/5/5b/Eris_and_dysnomia2.jpg" /></a></div>
<p>The larger blob of light is the dwarf planet <a href="http://en.wikipedia.org/wiki/Eris_%28dwarf_planet%29">Eris</a>. <a href="http://en.wikipedia.org/wiki/Dysnomia_%28moon%29">Dysnomia</a> is its moon.  Both were discovered in 2005 by a team at Palomar led by Mike Brown.</p>
<p>Why the funny name? In Greek mythology, <a href="http://en.wikipedia.org/wiki/Dysnomia_%28mythology%29">Dysnomia</a> (), meaning &#8216;lawlessness&#8217;, was the daughter of <a href="http://en.wikipedia.org/wiki/Eris_%28mythology%29">Eris</a>, the goddess of strife and discord.  You may remember the dwarf planet Eris under its tentative early name &#8216;Xena&#8217;, from the TV character.  That was deemed too silly to stand.</p>
<p>Eris is 30% more massive than Pluto, and thus it helped lead to a redefinition of &#8216;planet&#8217;: both are now called <a href="http://en.wikipedia.org/wiki/Dwarf_planet">dwarf planets</a>, because they aren&#8217;t big enough to clear their neighborhood of debris.</p>
<p>Eris has a highly eccentric orbit, and it takes 580 years to go around the Sun.  Right now it&#8217;s at its farthest from the Sun: three times as far as Pluto.   So it&#8217;s very cold, about 30 kelvin (-243 C), and its surface is covered with methane ice.  But in about 290 years its temperature will nearly <i>double</i>, soaring to a balmy 56 kelvin (-217 C). Its methane ice will melt and then evaporate away, giving this world a new atmosphere!  That&#8217;s pretty amazing: an annual atmosphere.</p>
<p>The surface of Eris is light gray. So, it&#8217;s quite different than <a href="http://en.wikipedia.org/wiki/Pluto">Pluto</a> and Neptune&#8217;s moon <a href="http://en.wikipedia.org/wiki/Triton_%28moon%29">Triton</a>, which are reddish due to deposits of <a href="http://en.wikipedia.org/wiki/Tholin">tholins</a>&#8212;complex compounds formed by bombarding hydrocarbons and nitrogen with sunlight.</p>
<p>Remember the smoggy orange surface of <a href="http://en.wikipedia.org/wiki/Titan_%28moon%29">Titan</a>?</p>
<div align="center">
<a href="http://en.wikipedia.org/wiki/Titan_%28moon%29"><img height="500" src="https://i1.wp.com/math.ucr.edu/home/baez/huyghens.1.jpg" /></a>
</div>
<p>That&#8217;s due to tholins! It&#8217;s possible that on Eris the tholins are currently covered by methane ice.</p>
<p>I wish I knew more about what tholins actually are&#8212;their actual chemical structures.  But they&#8217;re a complicated mess of stuff, and they vary from place to place: people talk about Titan tholins, Triton tholins and ice tholins.</p>
<p>Indeed, the term &#8220;tholin&#8221; comes from the Greek word <i>thols</i> (), meaning &#8220;not clear&#8221;.   It was coined by Carl Sagan to describe the mysterious mix of substances he created in experiments on the gas mixtures found in Titan&#8217;s atmosphere&#8230; experiments a bit like the old <a href="http://en.wikipedia.org/wiki/Miller%E2%80%93Urey_experiment">Urey-Miller</a> experiment which created amino acids from stuff that was present on the early Earth&#8212;water, methane, ammonia, hydrogen&#8212;together with lots of electrical discharges.</p>
<p>Might tholins become complicated enough to lead to life in the outer Solar System, at least on relatively peppy worlds like Titan?  There&#8217;s a complex cycle going on there:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Tholin"><img src="http://upload.wikimedia.org/wikipedia/commons/thumb/1/15/Formation_of_tholins_in_Titan%27s_upper_atmosphere.svg/450px-Formation_of_tholins_in_Titan%27s_upper_atmosphere.svg.png" /></a></div>
<p>Here &#8216;Da&#8217; means <a href="http://en.wikipedia.org/wiki/Atomic_mass_unit">daltons</a>: a dalton is a unit of mass equal to about one hydrogen atom, so a molecule that&#8217;s 2000 Da could be made of 2000 hydrogens or, more reasonably, 2000/12  166 carbons, or various other things.  The point is: that&#8217;s a pretty big complicated molecule&#8212;big enough to be very interesting!</p>
<p>On Earth, many soil bacteria are able to use tholins as their sole source of carbon.  Some think that tholins may have been the first food for microbes!  In fact, some scientists have speculated that Earth may have been seeded by tholins from comets early in its development, providing the raw material necessary for life. But ever since the <a href="http://en.wikipedia.org/wiki/Great_Oxygenation_Event">Great Oxygenation Event</a>, the Earth&#8217;s surface has been too oxidizing for tholins to exist here.</p>
<p>Tholins have also been found outside our Solar System:</p>
<p>&bull; <a href="http://www.spaceflightnow.com/news/n0801/05disk/">Red dust in disk may harbor precursors to life</a>, Carnegie Institute news release, 5 January 2008.</p>
<p>I bet tholins often go hand-in-hand with <a href="http://en.wikipedia.org/wiki/Polycyclic_aromatic_hydrocarbon">PAHs</a>, or polycyclic aromatic hydrocarbons.  PAHs are also common in outer space.   In Earth you can find them in soot, or the tarry stuff that forms in a barbecue grill.  Wherever carbon-containing materials suffer incomplete combustion, you&#8217;ll find PAHs.</p>
<p>PAHs are made of hexagonal rings of carbon atoms, with some hydrogens along the edges:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Polycyclic_aromatic_hydrocarbon"><img src="https://i2.wp.com/math.ucr.edu/home/baez/PAH_molecules.jpg" /></a>
</div>
<p>Benzene has a single hexagonal ring, with 6 carbons and 6 hydrogens. You&#8217;ve probably heard about naphthalene, which is used for mothballs: this consists of two hexagonal rings stuck together.  True PAHs have more.  With three rings you can make anthracene:</p>
<div align="center">
<a href="http://en.wikipedia.org/wiki/Anthracene"><img src="https://i0.wp.com/math.ucr.edu/home/baez/80px-Anthracene_acsv.svg.png" /></a></div>
<p>and phenanthrene:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Phenanthrene"><img src="https://i2.wp.com/math.ucr.edu/home/baez/80px-Phenanthrenec1.png" /></a></div>
<p>With four, you can make napthacene:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Tetracene"><img src="https://i1.wp.com/math.ucr.edu/home/baez/100px-Tetracene.png" /></a></div>
<p>pyrene:</p>
<div align="center">
<a href="http://en.wikipedia.org/wiki/Pyrene"><img src="https://i2.wp.com/math.ucr.edu/home/baez/100px-Pyrene.png" /></a></div>
<p>triphenylene:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Triphenylene"><img src="https://i2.wp.com/math.ucr.edu/home/baez/100px-Triphenylene_chemical_structure.png" /></a></div>
<p>and chrysene:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Chrysene"><img src="https://i2.wp.com/math.ucr.edu/home/baez/100px-Chrysene.png" /></a></div>
<p>And so on!  The game just gets more complicated as you get to use more puzzle pieces.</p>
<p>In 2004, a team of scientists discovered anthracene and pyrene in an amazing structure called the <a href="http://en.wikipedia.org/wiki/Red_Rectangle_Nebula">Red Rectangle</a>!</p>
<div align="center"><a href="http://apod.nasa.gov/apod/ap040513.html"><img width="450" src="https://i1.wp.com/math.ucr.edu/home/baez/red_rectangle.jpg" /></a></div>
<p>Here two stars 2300 light years from us are spinning around each other while pumping out a huge torus of icy dust grains and hydrocarbon molecules.  It&#8217;s not really shaped like a rectangle or X&#8212;it just looks that way from here. The whole scene is about 1/3 of a light year across.</p>
<p>This was first time such complex molecules had been found in space:</p>
<p>&bull; Uma P. Vijh, Adolf N. Witt, and Karl D. Gordon, <a href="http://arXiv.org/abs/astro-ph/0410130">Small polycyclic aromatic hydrocarbons in the Red Rectangle</a>, <i>The Astrophysical Journal</i> <b>619</b> (2005), 368-378.</p>
<p>By now, lots of organic molecules have been found in interstellar or circumstellar space.  There&#8217;s a whole &quot;ecology&quot; of organic chemicals out there, engaged in complex reactions.  Life on planets might someday be seen as just an aspect of this larger ecology.  PAHs and tholins are probably among the dominant players in this ecology, at least at this stage.</p>
<p>Indeed, I&#8217;ve read that about 10% of the interstellar carbon is in the form of PAHs&#8212;big ones, with about 50 carbons per molecule.  They&#8217;re  common because they&#8217;re incredibly stable.  They&#8217;ve even been found riding the shock wave of a supernova explosion!</p>
<p>PAHs are also found in meteorites called &quot;carbonaceous chondrites&quot;.  These space rocks contain just a little carbon: about 3% by weight.  But 80% of this carbon is in the form of PAHs.</p>
<p>Here&#8217;s an interview with a scientist who thinks PAHs were important precursors of life on Earth:</p>
<p>&bull; <a href="http://www.astrobio.net/news/modules.php?op=modload&amp;name=News&amp;file=article&amp;sid=1992">Aromatic world</a>, interview with Pascale Ehrenfreund, <i>Astrobiology Magazine</i>.</p>
<p>Also try this:</p>
<p>&bull; <a href="http://en.wikipedia.org/wiki/PAH_world_hypothesis">PAH world hypothesis</a>, Wikipedia.</p>
<p>This speculative hypothesis says that PAHs were abundant in the primordial soup of the early Earth and played a major role in the origin of life by mediating the synthesis of RNA molecules, leading to the (also speculative) <a href="http://en.wikipedia.org/wiki/RNA_world">RNA world</a>.</p>
<p>Another radical theory has been proposed by Prof. Sun Kwok, author of <i>Organic Matter in the Universe</i>.  He claims that instead of PAHs, complex molecules like this would do better at explaining the spectra of interstellar clouds:</p>
<div align="center"><a href="http://www.nature.com/nature/journal/vaop/ncurrent/full/nature10542.html"><img width="450" src="https://i2.wp.com/math.ucr.edu/home/baez/PAH_alternative.jpg" /></a></div>
<p>Would this molecule count as a tholin?  Maybe so: I don&#8217;t know.  He says:</p>
<blockquote><p> Our work has shown that stars have no problem making complex organic compounds under near-vacuum conditions.  Theoretically, this is impossible, but observationally we can see it happening.
</p></blockquote>
<p>For more see:</p>
<p>&bull; Sun Kwok and Yong Zhang, Mixed aromaticaliphatic organic nanoparticles as carriers of unidentified infrared emission features, <a href="http://www.nature.com/nature/journal/vaop/ncurrent/full/nature10542.html"><i>Nature</i></a> <b>479</b> (2011), 8083.</p>
<p>This paper isn&#8217;t free, but here&#8217;s a summary that is:</p>
<p>&bull; <a href="http://www.sciencedaily.com/releases/2011/10/111026143721.htm">Astronomers discover complex organic matter exists throughout the Universe</a>, <i>ScienceDaily</i>, 26 October 2011.</p>
<p>However, I&#8217;d take this with a grain of salt until more confirmation comes along!  They&#8217;re matching very complicated spectra to hypothetical chemicals, without yet any understanding of how these chemicals could be formed in space.  It would be very cool if true.</p>
<p>Regardless of how the details play out, I think we&#8217;ll eventually see that organic life across the universe is a natural outgrowth of the organic chemistry of PAHs, tholins and related chemicals.  It will be great to see the whole story: how much in common life has in different locations, and how much variation there is.  It may be rare, but the universe is very large, so there must be statistical patterns in how life works.</p>
<p>It goes to show how everything is connected.  Starting from a chance encounter with Dysnomia, we&#8217;ve been led to ponder another planet whose atmosphere liquifies and then freezes every year&#8230; and then wonder about why so many objects in the outer solar system are red&#8230; and why the same chemicals you find in the tarry buildup on a barbecue grill are also seen in outer space&#8230; and whether life on Earth could have been started by complex compounds from comets&#8230; and whether life on planets is just part of a larger interstellar chemical &#8216;ecology&#8217;.  Not bad for a Saturday morning!</p>
									</div>

				<p class="postmetadata">
				<img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/speech_bubble.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2012/03/24/dysnomia/#comments">8 Comments</a>				| <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/documents.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/category/astronomy/" rel="category tag">astronomy</a>, <a href="https://johncarlosbaez.wordpress.com/category/biology/" rel="category tag">biology</a>, <a href="https://johncarlosbaez.wordpress.com/category/chemistry/" rel="category tag">chemistry</a>								 | <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/permalink.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2012/03/24/dysnomia/" rel="bookmark" title="Permanent Link to Dysnomia">Permalink</a>
<br /><img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/figure_ver1.gif" alt="" /> Posted by John Baez				</p>
			</div>
			<hr />
		
			<div class="post-6340 post type-post status-publish format-standard hentry category-chemistry category-mathematics category-networks category-physics" id="post-6340">
				<h2><a href="https://johncarlosbaez.wordpress.com/2011/11/21/network-theory-part-18/" rel="bookmark">Network Theory (Part&nbsp;18)</a></h2>
				<small>21 November, 2011</small><br />


				<div class="entry">
					<p><i>joint with <b><a href="http://www.azimuthproject.org/azimuth/show/Jacob+Biamonte">Jacob Biamonte</a></b></i></p>
<p><a href="https://johncarlosbaez.wordpress.com/2011/11/12/network-theory-part-17/">Last time</a> we explained how &#8216;reaction networks&#8217;, as used in chemistry, are just another way of talking about Petri nets.  We stated an amazing result, the deficiency zero theorem, which settles quite a number of questions about chemical reactions.  Now let&#8217;s illustrate it with an example.</p>
<p>Our example won&#8217;t show how <i>powerful</i> this theorem is: it&#8217;s too simple.  But it&#8217;ll help explain the ideas involved.</p>
<h4> Diatomic molecules </h4>
<p>A diatomic molecule consists of two atoms of the same kind, stuck together:</p>
<div align="center"><img src="https://i1.wp.com/math.ucr.edu/home/baez/networks/nitrogen.png" alt="" /></div>
<p>At room temperature there are 5 elements that are diatomic gases: hydrogen, nitrogen, oxygen, fluorine, chlorine.  Bromine is a diatomic liquid, but easily evaporates into a diatomic gas:</p>
<div align="center"><img border="2" width="230" src="https://i2.wp.com/math.ucr.edu/home/baez/networks/bromine.jpg" alt="" /></div>
<p>Iodine is a crystal at room temperatures:</p>
<div align="center"><img src="https://i2.wp.com/math.ucr.edu/home/baez/networks/iodine_crystal.png" alt="" /></div>
<p>but if you heat it a bit, it becomes a diatomic liquid and then a gas:</p>
<div align="center"><img border="2" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/iodine.jpg" alt="" /></div>
<p>so people often list it as a seventh member of the diatomic club.  </p>
<p>When you heat any diatomic gas enough, it starts becoming a &#8216;monatomic&#8217; gas as molecules break down into individual atoms.  However, just as a diatomic molecule can break apart into two  atoms:</p>
<p><img src="https://s0.wp.com/latex.php?latex=A_2+%5Cto+A+%2B+A+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A_2 &#92;to A + A " class="latex" /></p>
<p>two atoms can recombine to form a diatomic molecule:</p>
<p><img src="https://s0.wp.com/latex.php?latex=A+%2B+A+%5Cto+A_2+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A + A &#92;to A_2 " class="latex" /></p>
<p>So in equilibrium, the gas will be a mixture of diatomic and monatomic forms.   The exact amount of each will depend on the temperature and pressure, since these affect the likelihood that two colliding atoms stick together, or a diatomic molecule splits apart.   The detailed nature of our gas also matters, of course.</p>
<p>But we don&#8217;t need to get into these details here!  Instead, we can just write down the &#8216;rate equation&#8217; for the reactions we&#8217;re talking about. All the details we&#8217;re ignoring will be hiding in some constants called &#8216;rate constants&#8217;.  We won&#8217;t try to compute these; we&#8217;ll leave that to our chemist friends.</p>
<h4> A reaction network </h4>
<p>To write down our rate equation, we start by drawing a &#8216;reaction network&#8217;.    For this, we can be a bit abstract and call the diatomic molecule <img src="https://s0.wp.com/latex.php?latex=B&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="B" class="latex" /> instead of <img src="https://s0.wp.com/latex.php?latex=A_2&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A_2" class="latex" />.  Then it looks like this:</p>
<div align="center">
<img width="200" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/chemical_reaction_network_part_18.png" alt="" />
</div>
<p>We could write down the same information using a Petri net:</p>
<div align="center">
<img width="400" src="https://i2.wp.com/math.ucr.edu/home/baez/networks/petri_net_part_18.png" alt="" />
</div>
<p>But today let&#8217;s focus on the reaction network!  Staring at this picture, we can read off various things: </p>
<p>&bull; <b>Species.</b>  The species are the different kinds of atoms, molecules, etc.  In our example the set of species is <img src="https://s0.wp.com/latex.php?latex=S+%3D+%5C%7BA%2C+B%5C%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S = &#92;{A, B&#92;}" class="latex" />.  </p>
<p>&bull; <b>Complexes.</b> A complex is a finite sum of species, like <img src="https://s0.wp.com/latex.php?latex=A%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A," class="latex" /> or <img src="https://s0.wp.com/latex.php?latex=A+%2B+A%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A + A," class="latex" /> or for a fancier example using more efficient notation, <img src="https://s0.wp.com/latex.php?latex=2+A+%2B+3+B.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="2 A + 3 B." class="latex" />    So, we can think of a complex as a vector <img src="https://s0.wp.com/latex.php?latex=v+%5Cin+%5Cmathbb%7BR%7D%5ES.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="v &#92;in &#92;mathbb{R}^S." class="latex" />  The complexes that actually show up in our reaction network form a set <img src="https://s0.wp.com/latex.php?latex=C+%5Csubseteq+%5Cmathbb%7BR%7D%5ES.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="C &#92;subseteq &#92;mathbb{R}^S." class="latex" />  In our example, <img src="https://s0.wp.com/latex.php?latex=C+%3D+%5C%7BA%2BA%2C+B%5C%7D.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="C = &#92;{A+A, B&#92;}." class="latex" /> </p>
<p>&bull; <b>Reactions.</b> A reaction is an arrow going from one complex to another.  In our example we have two reactions: <img src="https://s0.wp.com/latex.php?latex=A+%2B+A+%5Cto+B&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A + A &#92;to B" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=B+%5Cto+A+%2B+A.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="B &#92;to A + A." class="latex" />   </p>
<p>Chemists define a <b>reaction network</b> to be a triple <img src="https://s0.wp.com/latex.php?latex=%28S%2C+C%2C+T%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(S, C, T)" class="latex" /> where <img src="https://s0.wp.com/latex.php?latex=S&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S" class="latex" /> is a set of species, <img src="https://s0.wp.com/latex.php?latex=C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="C" class="latex" /> is the set of complexes that appear in the reactions, and <img src="https://s0.wp.com/latex.php?latex=T&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T" class="latex" /> is the set of reactions <img src="https://s0.wp.com/latex.php?latex=v+%5Cto+w&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="v &#92;to w" class="latex" /> where <img src="https://s0.wp.com/latex.php?latex=v%2C+w+%5Cin+C.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="v, w &#92;in C." class="latex" />  (Stochastic Petri net people call reactions <b>transitions</b>, hence the letter <img src="https://s0.wp.com/latex.php?latex=T.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T." class="latex" />)</p>
<p>So, in our example we have:</p>
<p>&bull; Species <img src="https://s0.wp.com/latex.php?latex=S+%3D+%5C%7BA%2CB%5C%7D.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S = &#92;{A,B&#92;}." class="latex" />  </p>
<p>&bull; Complexes: <img src="https://s0.wp.com/latex.php?latex=C%3D+%5C%7BA%2BA%2C+B%5C%7D.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="C= &#92;{A+A, B&#92;}." class="latex" />  </p>
<p>&bull; Reactions: <img src="https://s0.wp.com/latex.php?latex=T+%3D++%5C%7BA%2BA%5Cto+B%2C+B%5Cto+A%2BA%5C%7D.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T =  &#92;{A+A&#92;to B, B&#92;to A+A&#92;}." class="latex" /></p>
<p>To get the rate equation, we also need one more piece of information: a <b>rate constant</b> <img src="https://s0.wp.com/latex.php?latex=r%28%5Ctau%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="r(&#92;tau)" class="latex" /> for each reaction <img src="https://s0.wp.com/latex.php?latex=%5Ctau+%5Cin+T.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau &#92;in T." class="latex" />  This is a nonnegative real number that affects how fast the reaction goes.  All the details of how our particular diatomic gas behaves at a given temperature and pressure are packed into these constants!  </p>
<h4> The rate equation </h4>
<p>The rate equation says how the expected numbers of the various species&mdash;atoms, molecules and the like&mdash;changes with time.  This equation is deterministic.   It&#8217;s a good approximation when the numbers are large and any fluctuations in these numbers are negligible by comparison.</p>
<p>Here&#8217;s the general form of the <b><a href="https://johncarlosbaez.wordpress.com/2011/09/09/network-theory-part-8/">rate equation</a></b>:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bd%7D%7Bd+t%7D+x_i+%3D++%5Csum_%7B%5Ctau%5Cin+T%7D+r%28%5Ctau%29+%5C%2C+%28n_i%28%5Ctau%29-m_i%28%5Ctau%29%29+%5C%2C+x%5E%7Bm%28%5Ctau%29%7D++%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{d}{d t} x_i =  &#92;sum_{&#92;tau&#92;in T} r(&#92;tau) &#92;, (n_i(&#92;tau)-m_i(&#92;tau)) &#92;, x^{m(&#92;tau)}  } " class="latex" /> </p>
<p>Let&#8217;s take a closer look.  The quantity <img src="https://s0.wp.com/latex.php?latex=x_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x_i" class="latex" /> is the expected population of the <img src="https://s0.wp.com/latex.php?latex=i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i" class="latex" />th species.  So, this equation tells us how that changes.   But what about the right hand side?  As you might expect, it&#8217;s a sum over reactions.  And:</p>
<p>&bull; The term for the reaction <img src="https://s0.wp.com/latex.php?latex=%5Ctau&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau" class="latex" /> is proportional to the rate constant <img src="https://s0.wp.com/latex.php?latex=r%28%5Ctau%29.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="r(&#92;tau)." class="latex" /> </p>
<p>&bull; Each reaction <img src="https://s0.wp.com/latex.php?latex=%5Ctau&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau" class="latex" /> goes between two complexes, so we can write it as <img src="https://s0.wp.com/latex.php?latex=m%28%5Ctau%29+%5Cto+n%28%5Ctau%29.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="m(&#92;tau) &#92;to n(&#92;tau)." class="latex" />  Among chemists the input <img src="https://s0.wp.com/latex.php?latex=m%28%5Ctau%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="m(&#92;tau)" class="latex" /> is called the <b>reactant complex</b>, and the output is called the <b>product complex</b>.  The difference <img src="https://s0.wp.com/latex.php?latex=n_i%28%5Ctau%29-m_i%28%5Ctau%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="n_i(&#92;tau)-m_i(&#92;tau)" class="latex" /> tells us how many items of species <img src="https://s0.wp.com/latex.php?latex=i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i" class="latex" /> get created, minus how many get destroyed.  So, it&#8217;s the net amount of this species that gets produced by the reaction <img src="https://s0.wp.com/latex.php?latex=%5Ctau.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau." class="latex" />  The term for the reaction <img src="https://s0.wp.com/latex.php?latex=%5Ctau&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau" class="latex" /> is proportional to this, too.</p>
<p>&bull; Finally, the <b><a href="http://en.wikipedia.org/wiki/Law_of_mass_action">law of mass action</a></b> says that the rate of a reaction is proportional to the product of the concentrations of the species that enter as inputs.  More precisely, if we have a reaction <img src="https://s0.wp.com/latex.php?latex=%5Ctau&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau" class="latex" /> with input is the complex <img src="https://s0.wp.com/latex.php?latex=m%28%5Ctau%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="m(&#92;tau)" class="latex" />, we define <img src="https://s0.wp.com/latex.php?latex=x%5E%7Bm%28%5Ctau%29%7D+%3D+x_1%5E%7Bm_1%28%5Ctau%29%7D+%5Ccdots+x_k%5E%7Bm_k%28%5Ctau%29%7D.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x^{m(&#92;tau)} = x_1^{m_1(&#92;tau)} &#92;cdots x_k^{m_k(&#92;tau)}." class="latex" />  The law of mass action says the term for the reaction <img src="https://s0.wp.com/latex.php?latex=%5Ctau&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau" class="latex" /> is proportional to this, too!</p>
<p>Let&#8217;s see what this says for the reaction network we&#8217;re studying:</p>
<div align="center">
<img width="200" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/chemical_reaction_network_part_18.png" alt="" />
</div>
<p>Let&#8217;s write <img src="https://s0.wp.com/latex.php?latex=x_1%28t%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x_1(t)" class="latex" /> for the number of <img src="https://s0.wp.com/latex.php?latex=A&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A" class="latex" /> atoms and <img src="https://s0.wp.com/latex.php?latex=x_2%28t%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x_2(t)" class="latex" /> for the number of <img src="https://s0.wp.com/latex.php?latex=B&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="B" class="latex" /> molecules.   Let the rate constant for the reaction <img src="https://s0.wp.com/latex.php?latex=B+%5Cto+A+%2B+A&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="B &#92;to A + A" class="latex" /> be <img src="https://s0.wp.com/latex.php?latex=%5Calpha%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;alpha," class="latex" /> and let the rate constant for <img src="https://s0.wp.com/latex.php?latex=A+%2B+A+%5Cto+B&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A + A &#92;to B" class="latex" /> be <img src="https://s0.wp.com/latex.php?latex=%5Cbeta%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;beta," class="latex" />   Then the rate equation is this:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B%5Cfrac%7Bd%7D%7Bd+t%7D+x_1+%3D++2+%5Calpha+x_2+-+2+%5Cbeta+x_1%5E2+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{&#92;frac{d}{d t} x_1 =  2 &#92;alpha x_2 - 2 &#92;beta x_1^2 }" class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B%5Cfrac%7Bd%7D%7Bd+t%7D+x_2+%3D+-%5Calpha+x_2+%2B+%5Cbeta+x_1%5E2+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{&#92;frac{d}{d t} x_2 = -&#92;alpha x_2 + &#92;beta x_1^2 }" class="latex" /></p>
<p>This is a bit intimidating.  However, we can solve it in closed form thanks to something very precious: a <i>conserved quantity</i>.  </p>
<p>We&#8217;ve got two species, <img src="https://s0.wp.com/latex.php?latex=A&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=B&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="B" class="latex" />.  But remember, <img src="https://s0.wp.com/latex.php?latex=B&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="B" class="latex" /> is just an abbreviation for a molecule made of two <img src="https://s0.wp.com/latex.php?latex=A&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A" class="latex" /> atoms.   So, the total number of <img src="https://s0.wp.com/latex.php?latex=A&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A" class="latex" /> atoms is conserved by the reactions in our network.  This is the number of <i>A</i>&#8216;s plus twice the number of <i>B</i>&#8216;s: <img src="https://s0.wp.com/latex.php?latex=x_1+%2B+2x_2.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x_1 + 2x_2." class="latex" />  So, this should be a <b>conserved quantity</b>: it should not change with time.  Indeed, by adding the first equation above to twice the second, we see:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B%5Cfrac%7Bd%7D%7Bd+t%7D+%5Cleft%28+x_1+%2B+2x_2+%5Cright%29+%3D+0+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{&#92;frac{d}{d t} &#92;left( x_1 + 2x_2 &#92;right) = 0 }" class="latex" /></p>
<p>As a consequence, any solution will stay on a line </p>
<p><img src="https://s0.wp.com/latex.php?latex=x_1+%2B+2+x_2+%3D+c+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x_1 + 2 x_2 = c " class="latex" /></p>
<p>for some constant <img src="https://s0.wp.com/latex.php?latex=c&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="c" class="latex" />.  We can use this fact to rewrite the rate equation just in terms of <img src="https://s0.wp.com/latex.php?latex=x_1&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x_1" class="latex" />:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bd%7D%7Bd+t%7D+x_1+%3D+%5Calpha+%282c+-+x_1%29+-+2+%5Cbeta+x_1%5E2+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{d}{d t} x_1 = &#92;alpha (2c - x_1) - 2 &#92;beta x_1^2 } " class="latex" /></p>
<p>This is a separable differential equation, so we can solve it if we can figure out how to do this integral </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+t+%3D+%5Cint+%5Cfrac%7Bd+x_1%7D%7B%5Calpha+%282c+-+x_1%29+-+2+%5Cbeta+x_1%5E2+%7D++%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ t = &#92;int &#92;frac{d x_1}{&#92;alpha (2c - x_1) - 2 &#92;beta x_1^2 }  } " class="latex" /></p>
<p>and then solve for <img src="https://s0.wp.com/latex.php?latex=x_1.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x_1." class="latex" /></p>
<p>This sort of trick won&#8217;t work for more complicated examples.<br />
But the idea remains important: the numbers of atoms of various kinds&mdash;hydrogen, helium, lithium, and so on&mdash;are conserved by chemical reactions, so a solution of the rate equation can&#8217;t roam freely in <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5ES.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^S." class="latex" />  It will be trapped on some hypersurface, which is called a &#8216;stoichiometric compatibility class&#8217;.  And this is very important.</p>
<p>We don&#8217;t feel like doing the integral required to solve our rate equation in closed form, because this idea doesn&#8217;t generalize too much.  On the other hand, we can always solve the rate equation numerically.  So let&#8217;s try that!</p>
<p>For example, suppose we set <img src="https://s0.wp.com/latex.php?latex=%5Calpha+%3D+%5Cbeta+%3D+1.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;alpha = &#92;beta = 1." class="latex" />  We can plot the solutions for three different choices of initial conditions, say <img src="https://s0.wp.com/latex.php?latex=%28x_1%2Cx_2%29+%3D+%280%2C3%29%2C+%284%2C0%29%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(x_1,x_2) = (0,3), (4,0)," class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=%283%2C3%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(3,3)" class="latex" />.  We get these graphs:</p>
<div align="center">
<img src="https://i0.wp.com/math.ucr.edu/home/baez/networks/part-18-concentration-plots.png" alt="" /></div>
<p>It looks like the solution always approaches an equilibrium.   We seem to be getting different equilibria for different initial conditions, and the pattern is a bit mysterious.   However, something nice happens when we plot the ratio <img src="https://s0.wp.com/latex.php?latex=x_1%5E2+%2F+x_2&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x_1^2 / x_2" class="latex" />: </p>
<div align="center">
<img src="https://i2.wp.com/math.ucr.edu/home/baez/networks/part-18-ratio-plots.png" alt="" />
</div>
<p>Apparently it always converges to 1.   Why should that be?  It&#8217;s not terribly surprising.  With both rate constants equal to 1, the reaction <img src="https://s0.wp.com/latex.php?latex=A+%2B+A+%5Cto+B&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A + A &#92;to B" class="latex" /> proceeds at a rate equal to the square of the number of <img src="https://s0.wp.com/latex.php?latex=A&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A" class="latex" />&#8216;s, namely <img src="https://s0.wp.com/latex.php?latex=x_1%5E2&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x_1^2" class="latex" />.  The reverse reaction proceeds at a rate equal to the number of <img src="https://s0.wp.com/latex.php?latex=B&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="B" class="latex" />&#8216;s, namely <img src="https://s0.wp.com/latex.php?latex=x_2.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x_2." class="latex" />  So in equilibrium, we should have <img src="https://s0.wp.com/latex.php?latex=x_1%5E2+%3D+x_2.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x_1^2 = x_2." class="latex" /></p>
<p>But why is the equilibrium <i>stable</i>?  In this example we could see that using the closed-form solution, or maybe just common sense.   But it also follows from a powerful theorem that handles a <i>lot</i> of reaction networks.</p>
<h4> The deficiency zero theorem </h4>
<p>It&#8217;s called Feinberg&#8217;s deficiency zero theorem, and we saw it <a href="https://johncarlosbaez.wordpress.com/2011/11/12/network-theory-part-17/">last time</a>.  Very roughly, it says that if our reaction network is &#8216;weakly reversible&#8217; and has &#8216;deficiency zero&#8217;, the rate equation will have equilibrium solutions that behave about as nicely as you could want.  </p>
<p>Let&#8217;s see how this works.   We need to remember some jargon:</p>
<p>&bull; <b>Weakly reversible.</b> A reaction network is <b>weakly reversible</b> if for every reaction <img src="https://s0.wp.com/latex.php?latex=v+%5Cto+w&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="v &#92;to w" class="latex" /> in the network, there exists a path of reactions in the network starting at <img src="https://s0.wp.com/latex.php?latex=w&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="w" class="latex" /> and leading back to <img src="https://s0.wp.com/latex.php?latex=v.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="v." class="latex" /></p>
<p>&bull; <b>Reversible.</b>   A reaction network is <b>reversible</b> if for every reaction <img src="https://s0.wp.com/latex.php?latex=v+%5Cto+w&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="v &#92;to w" class="latex" /> in the network, <img src="https://s0.wp.com/latex.php?latex=w+%5Cto+v&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="w &#92;to v" class="latex" /> is also a reaction in the network.    Any reversible reaction network is weakly reversible.   Our example is reversible, since it consists of reactions <img src="https://s0.wp.com/latex.php?latex=A+%2B+A+%5Cto+B%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A + A &#92;to B," class="latex" /> <img src="https://s0.wp.com/latex.php?latex=B+%5Cto+A+%2B+A.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="B &#92;to A + A." class="latex" /> </p>
<p>But what about &#8216;deficiency zero&#8217;?  We defined that concept <a href="https://johncarlosbaez.wordpress.com/2011/11/12/network-theory-part-17/">last time</a>, but let&#8217;s review:</p>
<p>&bull; <b>Connected component.</b>  A reaction network gives a kind of graph with complexes as vertices and reactions as edges.  Two complexes lie in the same  <b>connected component</b> if we can get from one to the other by a path of reactions, where at each step we&#8217;re allowed to go either forward <i>or backward</i> along a reaction.  Chemists call a connected component a <b>linkage class</b>.  In our example there&#8217;s just one:</p>
<div align="center"><img width="200" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/chemical_reaction_network_part_18.png" alt="" /></div>
<p>&bull; <b>Stoichiometric subspace.</b>  The <b>stoichiometric subspace</b> is the subspace <img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7BStoch%7D+%5Csubseteq+%5Cmathbb%7BR%7D%5ES&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{Stoch} &#92;subseteq &#92;mathbb{R}^S" class="latex" /> spanned by the vectors of the form <img src="https://s0.wp.com/latex.php?latex=w+-+v&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="w - v" class="latex" /> for all reactions <img src="https://s0.wp.com/latex.php?latex=v+%5Cto+w&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="v &#92;to w" class="latex" /> in our reaction network.    This subspace describes the directions in which a solution of the rate equation can move.  In our example, it&#8217;s spanned by <img src="https://s0.wp.com/latex.php?latex=B+-+2+A&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="B - 2 A" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=2+A+-+B&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="2 A - B" class="latex" />, or if you prefer, <img src="https://s0.wp.com/latex.php?latex=%28-2%2C1%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(-2,1)" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=%282%2C-1%29.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(2,-1)." class="latex" />  These vectors are linearly dependent, so the stoichiometric subspace has dimension 1.  </p>
<p>&bull; <b>Deficiency.</b>  The <b>deficiency</b> of a reaction network is the number of complexes, minus the number of connected components, minus the dimension of the stoichiometric subspace.  In our example there are 2 complexes, 1 connected component, and the dimension of the stoichiometric subspace is 1.  So, our reaction network has deficiency 2 &#8211; 1 &#8211; 1 = 0.  </p>
<p>So, the deficiency zero theorem applies!  What does it say?  To understand it, we need a bit more jargon.  First of all, a vector <img src="https://s0.wp.com/latex.php?latex=x+%5Cin+%5Cmathbb%7BR%7D%5ES&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x &#92;in &#92;mathbb{R}^S" class="latex" /> tells us how much we&#8217;ve got of each species: the amount of species <img src="https://s0.wp.com/latex.php?latex=i+%5Cin+S&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i &#92;in S" class="latex" /> is the number <img src="https://s0.wp.com/latex.php?latex=x_i.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x_i." class="latex" />  And then:</p>
<p>&bull; <b>Stoichiometric compatibility class.</b>  Given a vector <img src="https://s0.wp.com/latex.php?latex=v%5Cin+%5Cmathbb%7BR%7D%5ES&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="v&#92;in &#92;mathbb{R}^S" class="latex" />, its <b>stoichiometric compatibility class</b> is the subset of all vectors that we could reach using the reactions in our reaction network:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5C%7B+v+%2B+w+%5C%3B+%3A+%5C%3B+w+%5Cin+%5Cmathrm%7BStoch%7D+%5C%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;{ v + w &#92;; : &#92;; w &#92;in &#92;mathrm{Stoch} &#92;} " class="latex" /></p>
<p>In our example, where the stoichiometric subspace is spanned by <img src="https://s0.wp.com/latex.php?latex=%282%2C-1%29%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(2,-1)," class="latex" /> the stoichiometric compatibility class of the vector <img src="https://s0.wp.com/latex.php?latex=%28v_1%2Cv_2%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(v_1,v_2)" class="latex" /> is the line consisting of points</p>
<p><img src="https://s0.wp.com/latex.php?latex=%28x_1%2C+x_2%29+%3D+%28v_1%2Cv_2%29+%2B+s%282%2C-1%29+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(x_1, x_2) = (v_1,v_2) + s(2,-1) " class="latex" /></p>
<p>where the parameter <img src="https://s0.wp.com/latex.php?latex=s&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s" class="latex" /> ranges over all real numbers.  Notice that this line can also be written as</p>
<p><img src="https://s0.wp.com/latex.php?latex=x_1+%2B+2x_2+%3D+c+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x_1 + 2x_2 = c " class="latex" /></p>
<p>We&#8217;ve already seen that if we start with initial conditions on such a line, the solution will stay on this line.  And that&#8217;s how it always works: as time passes, any solution of the rate equation stays in the same stoichiometric compatibility class!  </p>
<p>In other words: <i>the stoichiometric subspace is defined by a bunch of linear equations, one for each linear conservation law that all the reactions in our network obey.</i>   </p>
<p>Here a <b>linear conservation law</b> is a law saying that some linear combination of the numbers of species does not change.</p>
<p>Next: </p>
<p>&bull; <b>Positivity.</b>  A vector in <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5ES&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^S" class="latex" /> is <b>positive</b> if all its components are positive; this describes a a container of chemicals where all the species are actually present.  The <b>positive stoichiometric compatibility class</b> of <img src="https://s0.wp.com/latex.php?latex=x%5Cin+%5Cmathbb%7BR%7D%5ES&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x&#92;in &#92;mathbb{R}^S" class="latex" /> consists of all positive vectors in its stoichiometric compatibility class.</p>
<p>We finally have enough jargon in our arsenal to state the zero deficiency theorem.  We&#8217;ll only state the part we need today:</p>
<p><b>Zero Deficiency Theorem (Feinberg).</b>  If a reaction network has deficiency zero and is weakly reversible, and the rate constants are positive, the rate equation has exactly one equilibrium solution in each positive stoichiometric compatibility class.  Any sufficiently nearby solution that starts in the same class will approach this equilibrium as <img src="https://s0.wp.com/latex.php?latex=t+%5Cto+%2B%5Cinfty.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="t &#92;to +&#92;infty." class="latex" /></p>
<p>In our example, this theorem says there&#8217;s just one positive<br />
equilibrium <img src="https://s0.wp.com/latex.php?latex=%28x_1%2Cx_2%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(x_1,x_2)" class="latex" /> in each line</p>
<p><img src="https://s0.wp.com/latex.php?latex=x_1+%2B+2x_2+%3D+c+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x_1 + 2x_2 = c " class="latex" /></p>
<p>We can find it by setting the time derivatives to zero:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bd%7D%7Bd+t%7Dx_1+%3D++2+%5Calpha+x_2+-+2+%5Cbeta+x_1%5E2+%3D+0+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{d}{d t}x_1 =  2 &#92;alpha x_2 - 2 &#92;beta x_1^2 = 0 } " class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bd%7D%7Bd+t%7D+x_2+%3D+-%5Calpha+x_2+%2B+%5Cbeta+x_1%5E2+%3D+0+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{d}{d t} x_2 = -&#92;alpha x_2 + &#92;beta x_1^2 = 0 }" class="latex" /></p>
<p>Solving these, we get</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bx_1%5E2%7D%7Bx_2%7D+%3D+%5Cfrac%7B%5Calpha%7D%7B%5Cbeta%7D+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{x_1^2}{x_2} = &#92;frac{&#92;alpha}{&#92;beta} }" class="latex" /> </p>
<p>So, these are our equilibrium solutions.  It&#8217;s easy to verify that indeed, there&#8217;s one of these in each stoichiometric compatibility class <img src="https://s0.wp.com/latex.php?latex=x_1+%2B+2x_2+%3D+c.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x_1 + 2x_2 = c." class="latex" />  And the zero deficiency theorem also tells us that any sufficiently nearby solution that starts in the same class will approach this equilibrium as <img src="https://s0.wp.com/latex.php?latex=t+%5Cto+%5Cinfty&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="t &#92;to &#92;infty" class="latex" />.</p>
<p>This partially explains what we saw before in our graphs.  It shows that in the case <img src="https://s0.wp.com/latex.php?latex=%5Calpha+%3D+%5Cbeta+%3D+1%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;alpha = &#92;beta = 1," class="latex" /> any solution that starts by <i>nearly</i> having</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B%5Cfrac%7Bx_1%5E2%7D%7Bx_2%7D+%3D+1%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{&#92;frac{x_1^2}{x_2} = 1} " class="latex" /></p>
<p>will actually have</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B%5Clim_%7Bt+%5Cto+%2B%5Cinfty%7D+%5Cfrac%7Bx_1%5E2%7D%7Bx_2%7D+%3D+1+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{&#92;lim_{t &#92;to +&#92;infty} &#92;frac{x_1^2}{x_2} = 1 }" class="latex" /></p>
<p>But in fact, in this example we don&#8217;t even need to start <i>near</i> the equilibrium for our solution to approach the equilibrium!  What about in general?  We don&#8217;t know, but just to get the ball rolling, we&#8217;ll risk the following wild guess:</p>
<p><b>Conjecture.</b>  If a reaction network has deficiency zero and is weakly reversible, and the rate constants are positive, the rate equation has exactly one equilibrium solution in each positive stoichiometric compatibility class, and <i>any</i> positive solution that starts in the same class will approach this equilibrium as <img src="https://s0.wp.com/latex.php?latex=t+%5Cto+%2B%5Cinfty&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="t &#92;to +&#92;infty" class="latex" />. </p>
<p>If anyone knows a proof or counterexample, we&#8217;d be interested.  If this result were true, it would really clarify the dynamics of reaction networks in the zero deficiency case.</p>
<p>Next time we&#8217;ll talk about this same reaction network from a stochastic point of view, where we think of the atoms and molecules as reacting in a <i>probabilistic</i> way.  And we&#8217;ll see how the conservation laws we&#8217;ve been talking about today are related to <a href="http://math.ucr.edu/home/baez/networks/networks_11.html">Noether&#8217;s theorem for Markov processes</a>! </p>
									</div>

				<p class="postmetadata">
				<img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/speech_bubble.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2011/11/21/network-theory-part-18/#comments">27 Comments</a>				| <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/documents.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/category/chemistry/" rel="category tag">chemistry</a>, <a href="https://johncarlosbaez.wordpress.com/category/mathematics/" rel="category tag">mathematics</a>, <a href="https://johncarlosbaez.wordpress.com/category/networks/" rel="category tag">networks</a>, <a href="https://johncarlosbaez.wordpress.com/category/physics/" rel="category tag">physics</a>								 | <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/permalink.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2011/11/21/network-theory-part-18/" rel="bookmark" title="Permanent Link to Network Theory (Part&nbsp;18)">Permalink</a>
<br /><img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/figure_ver1.gif" alt="" /> Posted by John Baez				</p>
			</div>
			<hr />
		
			<div class="post-5876 post type-post status-publish format-standard hentry category-chemistry category-mathematics category-puzzles" id="post-5876">
				<h2><a href="https://johncarlosbaez.wordpress.com/2011/10/23/a-math-puzzle-coming-from-chemistry/" rel="bookmark">A Math Puzzle Coming From&nbsp;Chemistry</a></h2>
				<small>23 October, 2011</small><br />


				<div class="entry">
					<p>I posed this puzzle a while back, and nobody solved it.  That&#8217;s okay&#8212;now that I think about it, I&#8217;m not sure how to solve it either!  <img src="https://i1.wp.com/math.ucr.edu/home/baez/emoticons/redface.gif" alt="" /> </p>
<p>It seems to involve group theory.   But instead of working on it, solving it and telling you the answer, I&#8217;d rather dump all the clues in your lap, so we can figure it out together.  </p>
<p>Suppose we have an ethyl cation.  We&#8217;ll pretend it looks like this:</p>
<div align="center"><a href="http://comporgchem.com/blog/?p=60"><img border="none" src="https://i2.wp.com/math.ucr.edu/home/baez/networks/ethyl_cation_classical.jpg" alt="" /></a></div>
<p><a href="https://johncarlosbaez.wordpress.com/2011/10/15/network-theory-part-14/">As I explained before</a>, it actually doesn&#8217;t&#8212;not in real life.  But never mind!  Realism should never stand in the way of a good puzzle.</p>
<p>Continuing on in this unrealistic vein, we&#8217;ll pretend that the two black carbon atoms are distinguishable, and so are the five white hydrogen atoms.  As you can see, 2 of the hydrogens are bonded to one carbon, and 3 to the other.  We don&#8217;t care how the hydrogens are arranged, apart from which carbon each hydrogen is attached to.  Given this, there are</p>
<p><img src="https://s0.wp.com/latex.php?latex=2+%5Ctimes+%5Cdisplaystyle%7B+%5Cbinom%7B5%7D%7B2%7D+%3D+20+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="2 &#92;times &#92;displaystyle{ &#92;binom{5}{2} = 20 } " class="latex" /></p>
<p>ways to arrange the hydrogens. Let&#8217;s call these arrangements <b>states</b>.</p>
<p>Now draw a dot for each of these 20 states.  Draw an edge connecting two dots whenever you can get from one state to another by having a hydrogen hop from the carbon with 2 hydrogens to the carbon with 3.  You&#8217;ll get this picture, called the <a href="http://en.wikipedia.org/wiki/Desargues_graph">Desargues graph</a>:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Desargues_graph"><img border="none" src="https://i2.wp.com/math.ucr.edu/home/baez/networks/300px-Desargues_graph_2COL.svg.png" alt="" /></a>
</div>
<p>The red dots are states where the <i>first</i> carbon has 2 hydrogens attached to it; the blue ones are states where the <i>second</i> carbon has 2 hydrogens attached to it.  So, each edge goes between a red and a blue dot.  And there are 3 edges coming out of each dot, since there are 3 hydrogens that can make the jump!  </p>
<p>Now, the puzzle is to show that you can also get the Desargues graph from a different kind of molecule.  Any molecule shaped like this will do:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Trigonal_bipyramidal_molecular_geometry"><img border="none" src="https://i2.wp.com/math.ucr.edu/home/baez/networks/200px-Trigonal-bipyramidal-3D-balls-ax-eq.png" alt="" /></a>
</div>
<p>The 2 balls on top and bottom are called <b>axial</b>, while the 3 around the middle are called <b>equatorial</b>. </p>
<p>There are various molecules like this.  For example, <a href="http://en.wikipedia.org/wiki/Phosphorus_pentachloride">phosphorus pentachloride</a>.  Let&#8217;s use that.</p>
<p>Like the ethyl cation, phosphorus pentachloride also has 20 states&#8230; but only if count them a certain way!  We have to treat all 5 chlorines as distinguishable, but think of two arrangements of them as the same if we can rotate one to get the other.  Again, I&#8217;m not claiming this is physically realistic: it&#8217;s just for the sake of the puzzle.</p>
<p>Phosphorus pentachloride has 6 rotational symmetries, since you can turn it around its axis 3 ways, but also flip it over.  So, it has</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7B5%21%7D%7B6%7D++%3D+20%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{5!}{6}  = 20} " class="latex" /></p>
<p>states.  </p>
<p>That&#8217;s good: exactly the number of dots in the Desargues graph!  But how about the edges?   We get these from certain transitions between states.  These transitions are called <b><a href="http://en.wikipedia.org/wiki/Berry_mechanism">pseudorotations</a></b>, and they look like this:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Berry_mechanism"><img border="none" width="450" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/700px-Iron-pentacarbonyl-Berry-mechanism.png" alt="" /></a></div>
<p>Phosphorus pentachloride really does this!  First the 2 axial guys move towards each other to become equatorial.   Beware: now the equatorial ones are no longer in the horizontal plane: they&#8217;re in the plane facing us.   Then 2 of the 3 equatorial guys swing out to become axial.    </p>
<p>To get from one state to another this way, we have to pick 2 of the 3 equatorial guys to swing out and become axial.  There are 3 choices here.   So, we again get a graph with 20 vertices and 3 edges coming out of each vertex.</p>
<p><b>Puzzle.</b> Is this graph the Desargues graph?  If so, show it is.</p>
<p>I read in some chemistry papers that it is.  But is it really?  And if so, why?  David Corfield <a href="https://johncarlosbaez.wordpress.com/2011/10/15/network-theory-part-14/#comment-8443">suggested a promising strategy</a>.   He pointed out that we just need to get a 1-1 correspondence between</p>
<p>&bull; <i>states</i> of the ethyl cation and <i>states</i> of phosphorus pentachloride, </p>
<p>together with a compatible 1-1 correspondence between</p>
<p>&bull; <i>transitions</i> of the ethyl cation and <i>transitions</i> of phosphorus pentachloride.</p>
<p>And he suggested that to do this, we should think of the split of hydrogens into a bunch of 2 and a bunch of 3 as analogous to the split of chlorines into a bunch of 2 (the &#8216;axial&#8217; ones) and a bunch of 3 (the &#8216;equatorial&#8217; ones).  </p>
<p>It&#8217;s a promising idea.  There&#8217;s a problem, though!  In the ethyl cation, a <i>single</i> hydrogen hops from the bunch of 3 to the bunch of 2.  But in a pseudorotation, <i>two</i> chlorines go from the bunch of 2 to the bunch of 3&#8230; and meanwhile, two go back from the bunch of 3 to bunch of 2.</p>
<p>And if you think about it, there&#8217;s another problem too.  In the ethyl cation, there are 2 distinguishable carbons.  One of them has 3 hydrogens attached, and one doesn&#8217;t.  But in phosphorus pentachloride it&#8217;s not like that.  The 3 equatorial chlorines are just that: equatorial.  They don&#8217;t have 2 choices about how to be that way.  Or do they?</p>
<p>Well, there&#8217;s more to say, but this should already make it clear that getting &#8216;natural&#8217; one-to-one correspondences is a bit tricky&#8230; if it&#8217;s even possible at all!  </p>
<p>If you know some group theory, we could try solving the problem using the ideas behind Felix Klein&#8217;s <a href="http://en.wikipedia.org/wiki/Erlangen_program">&#8216;Erlangen program&#8217;</a>.  The group of permutations of 5 things, say <img src="https://s0.wp.com/latex.php?latex=S_5%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S_5," class="latex" /> acts as symmetries of either molecule.  For the ethyl cation the set of states will be <img src="https://s0.wp.com/latex.php?latex=X++%3D+S_5%2FG&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="X  = S_5/G" class="latex" /> for some subgroup <img src="https://s0.wp.com/latex.php?latex=G.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="G." class="latex" />   You can think of <img src="https://s0.wp.com/latex.php?latex=X&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="X" class="latex" /> as a set of structures of some sort on a 5-element set. The group <img src="https://s0.wp.com/latex.php?latex=S_5&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S_5" class="latex" /> acts on <img src="https://s0.wp.com/latex.php?latex=X%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="X," class="latex" /> and the transitions will give an invariant binary relation on <img src="https://s0.wp.com/latex.php?latex=X%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="X," class="latex" />   For phosphorus pentachloride we&#8217;ll have some set of states <img src="https://s0.wp.com/latex.php?latex=X%27+%3D+S_5%2FG%27&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="X&#039; = S_5/G&#039;" class="latex" /> for some other subgroup <img src="https://s0.wp.com/latex.php?latex=G%27&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="G&#039;" class="latex" />, and the transitions will give an invariant relation on <img src="https://s0.wp.com/latex.php?latex=X%27&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="X&#039;" class="latex" />.</p>
<p>We could start by trying to see if <img src="https://s0.wp.com/latex.php?latex=G&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="G" class="latex" /> is the same as <img src="https://s0.wp.com/latex.php?latex=G%27&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="G&#039;" class="latex" />&#8212;or more precisely, conjugate.  If they are, that&#8217;s a good sign.  If not, it&#8217;s bad: it probably means there&#8217;s no &#8216;natural&#8217; way to show the graph for phosphorus pentachloride is the Desargues graph.</p>
<p>I could say more, but I&#8217;ll stop here.  In case you&#8217;re wondering, all this is just a trick to get more mathematicians interested in chemistry.  A few may then go on to do useful things.</p>
									</div>

				<p class="postmetadata">
				<img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/speech_bubble.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2011/10/23/a-math-puzzle-coming-from-chemistry/#comments">37 Comments</a>				| <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/documents.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/category/chemistry/" rel="category tag">chemistry</a>, <a href="https://johncarlosbaez.wordpress.com/category/mathematics/" rel="category tag">mathematics</a>, <a href="https://johncarlosbaez.wordpress.com/category/puzzles/" rel="category tag">puzzles</a>								 | <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/permalink.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2011/10/23/a-math-puzzle-coming-from-chemistry/" rel="bookmark" title="Permanent Link to A Math Puzzle Coming From&nbsp;Chemistry">Permalink</a>
<br /><img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/figure_ver1.gif" alt="" /> Posted by John Baez				</p>
			</div>
			<hr />
		
			<div class="post-5562 post type-post status-publish format-standard hentry category-chemistry category-mathematics category-networks" id="post-5562">
				<h2><a href="https://johncarlosbaez.wordpress.com/2011/10/15/network-theory-part-14/" rel="bookmark">Network Theory (Part&nbsp;14)</a></h2>
				<small>15 October, 2011</small><br />


				<div class="entry">
					<p>We&#8217;ve been doing a lot of hard work lately.  Let&#8217;s take a break and think about a fun example from chemistry! </p>
<h4> The ethyl cation </h4>
<p>Suppose you start with a molecule of <a href="http://en.wikipedia.org/wiki/Ethane">ethane</a>, which has 2 carbons and 6 hydrogens arranged like this:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Ethane"><img border="none" src="https://i2.wp.com/math.ucr.edu/home/baez/networks/200px-Ethane-A-3D-balls.png" alt="" /></a>
</div>
<p>Then suppose you remove one hydrogen.  The result is a positively charged ion, or <a href="http://en.wikipedia.org/wiki/Ion">&#8216;cation&#8217;</a>.  When I was a kid, I thought the opposite of a cation should be called a &#8216;dogion&#8217;.  Alas, it&#8217;s <a href="http://en.wikipedia.org/wiki/Ion#Anions_and_cations">not</a>.</p>
<p>This particular cation, formed from removing one hydrogen from an ethane molecule, is called an &#8216;ethyl cation&#8217;.  People used to think it looked like this:</p>
<div align="center"><a href="http://comporgchem.com/blog/?p=60"><img border="none" src="https://i2.wp.com/math.ucr.edu/home/baez/networks/ethyl_cation_classical.jpg" alt="" /></a></div>
<p>They also thought a hydrogen could hop from the carbon with 3 hydrogens attached to it to the carbon with 2.  So, they drew a graph with a vertex for each way the hydrogens could be arranged, and an edge for each hop.  It looks really cool:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Desargues_graph"><img border="none" src="https://i2.wp.com/math.ucr.edu/home/baez/networks/300px-Desargues_graph_2COL.svg.png" alt="" /></a>
</div>
<p>The red vertices come from arrangements where the <i>first</i> carbon has 2 hydrogens attached to it, and the blue vertices come from those where the <i>second</i> carbon has 2 hydrogens attached to it.  So, each edge goes between a red vertex and a blue vertex.  </p>
<p>This graph has 20 vertices, which are arrangements or &#8216;states&#8217; of the ethyl cation.  It has 30 edges, which are hops or &#8216;transitions&#8217;.  Let&#8217;s see why those numbers are right.  </p>
<p>First I need to explain the rules of the game.  The rules say that the 2 carbon atoms are distinguishable: there&#8217;s a &#8216;first&#8217; one and a &#8216;second&#8217; one.  The 5 hydrogen atoms are also distinguishable.  But, all we care about is which carbon atom each hydrogen is bonded to: we don&#8217;t care about further details of its location.  And we require that 2 of the hydrogens are bonded to one carbon, and 3 to the other.</p>
<p>If you&#8217;re a physicist, you may wonder why the rules work this way: after all, at a fundamental level, identical particles <i>aren&#8217;t</i> really distinguishable.  I&#8217;m afraid I can&#8217;t give a fully convincing explanation right now: I&#8217;m just reporting the rules as they were told to me!</p>
<p>Given these rules, there are 2 choices of which carbon has two hydrogens attached to it. Then there are </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cbinom%7B5%7D%7B2%7D+%3D+%5Cfrac%7B5+%5Ctimes+4%7D%7B2+%5Ctimes+1%7D+%3D+10%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;binom{5}{2} = &#92;frac{5 &#92;times 4}{2 &#92;times 1} = 10} " class="latex" /> </p>
<p>choices of which two hydrogens are attached to it.  This gives a total of 2 &times; 10 = 20 states.  These are the vertices of our graph: 10 red and 10 blue.</p>
<p>The edges of the graph are transitions between states.  Any hydrogen in the group of 3 can hop over to the group of 2.  There are 3 choices for which hydrogen atom makes the jump.  So, starting from any vertex in the graph there are 3 edges.  This means there are <img src="https://s0.wp.com/latex.php?latex=3+%5Ctimes+20+%2F+2+%3D+30&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="3 &#92;times 20 / 2 = 30" class="latex" /> edges.  </p>
<p>Why divide by 2?  Because each edge touches 2 vertices.  We have to avoid double-counting them.</p>
<h4> The Desargues graph </h4>
<p>The idea of using this graph in chemistry goes back to this paper:</p>
<p>&bull; A. T. Balaban, D. Frcaiu and R. Bnic, Graphs of multiple 1,2-shifts in carbonium ions and related systems, <i>Rev. Roum. Chim.</i> <b>11</b> (1966), 1205.</p>
<p>This paper is famous because it was the first to use graphs in chemistry to describe molecular transitions, as opposed to using them as pictures of molecules!</p>
<p>But this particular graph was already famous for other reasons.  It&#8217;s called the <b>Desargues-Levi graph</b>, or <b>Desargues graph</b> for short:</p>
<p>&bull; <a href="http://en.wikipedia.org/wiki/Desargues_graph">Desargues graph</a>, Wikipedia.</p>
<p>Later I&#8217;ll say why it&#8217;s called this.  </p>
<p>There are lots of nice ways to draw the Desargues graph.  For example:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Desargues_graph"><img border="none" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/300px-DesarguesGraph.svg.png" alt="" /></a>
</div>
<p>The reason why we can draw such pretty pictures is that the Desargues graph is very symmetrical.  Clearly any permutation of the 5 hydrogens acts as a symmetry of the graph, and so does any permutation of the 2 carbons.  This gives a symmetry group <img src="https://s0.wp.com/latex.php?latex=S_5+%5Ctimes+S_2&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S_5 &#92;times S_2" class="latex" />, which has <img src="https://s0.wp.com/latex.php?latex=5%21+%5Ctimes+2%21+%3D+240&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="5! &#92;times 2! = 240" class="latex" /> elements.  And in fact this turns out to be the full symmetry group of the Desargues graph.</p>
<p>The Desargues graph, its symmetry group, and its applications to chemistry are discussed here:</p>
<p>&bull; Milan Randic, Symmetry properties of graphs of interest in chemistry: II: Desargues-Levi graph, <i><a href="http://onlinelibrary.wiley.com/doi/10.1002/qua.560150610/abstract;jsessionid=0FB39FF9D7D985C1B6454CF4E30D9E92.d03t02">Int. Jour. Quantum Chem.</a></i> <b>15</b> (1997), 663-682.</p>
<h4> The ethyl cation, revisited </h4>
<p>We can try to describe the ethyl cation using probability theory.  If at any moment its state corresponds to some vertex of the Desargues graph, and it hops randomly along edges as time goes by, it will trace out a random walk on the Desargues graph.  This is a nice example of a <a href="http://en.wikipedia.org/wiki/Continuous-time_Markov_process">Markov process</a>!  </p>
<p>We could also try to describe the ethyl cation using quantum mechanics.   Then, instead of having a <i>probability</i> of hopping along an edge, it has an <i>amplitude</i> of doing so.   But as we&#8217;ve seen, a lot of similar math will still apply.  </p>
<p>It should be fun to compare the two approaches.  But I bet you&#8217;re wondering which approach is correct.  This is a somewhat tricky question, at least for me.  The answer would seem to depend on how much the ethyl cation is interacting with its environment&mdash;for example, bouncing off other molecules.  When a system is interacting a lot with its environment, a probabilistic approach seems to be more appropriate.  The relevant buzzword is <a href="http://en.wikipedia.org/wiki/Quantum_decoherence">&#8216;environmentally induced decoherence&#8217;</a>.   </p>
<p>However, there&#8217;s something much more basic I have tell you about.</p>
<p>After the paper by Balaban, Frcaiu and Bnic came out, people gradually realized that the ethyl cation <i>doesn&#8217;t really look like the drawing I showed you!</i>  It&#8217;s what chemists call &#8216;nonclassical&#8217; ion.  What they mean is this: its actual structure is not what you get by taking the traditional ball-and-stick model of an ethane molecule and ripping off a hydrogen.  The ethyl cation really looks like this:</p>
<div align="center"><a href="http://comporgchem.com/blog/?p=60"><img border="none" src="https://i0.wp.com/math.ucr.edu/home/baez/networks/ethyl_cation_nonclassical.jpg" alt="" /></a></div>
<p>For more details, and pictures that you can actually rotate, see:</p>
<p>&bull; Stephen Bacharach, Ethyl cation, <a href="http://comporgchem.com/blog/?p=60">Computational Organic Chemistry</a>.</p>
<p>So, if we stubbornly insist on applying the Desargues graph to realistic chemistry, we need to find some other molecule to apply it to.</p>
<h4> Trigonal bipyramidal molecules </h4>
<p>Luckily, there are lots of options!  They&#8217;re called <a href="http://en.wikipedia.org/wiki/Trigonal_bipyramidal_molecular_geometry">trigonal bipyramidal molecules</a>.  They look like this:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Trigonal_bipyramidal_molecular_geometry"><img border="none" src="https://i2.wp.com/math.ucr.edu/home/baez/networks/Trigonal-bipyramidal-3D-balls.png/200px-Trigonal-bipyramidal-3D-balls.png" alt="" /></a>
</div>
<p>The 5 balls on the outside are called &#8216;ligands&#8217;: they could be atoms or bunches of atoms.   In chemistry, &#8216;<a href="http://en.wikipedia.org/wiki/Ligand">ligand</a>&#8216; just means something that&#8217;s stuck onto a central thing.   For example, in <a href="http://en.wikipedia.org/wiki/Phosphorus_pentachloride">phosphorus pentachloride</a> the ligands are chlorine atoms, all attached to a central phosphorus atom:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Phosphorus_pentachloride"><img border="none" src="https://i0.wp.com/math.ucr.edu/home/baez/networks/200px-Phosphorus-pentachloride-3D-balls.png" alt="" /></a>
</div>
<p>It&#8217;s a colorless solid, but as you might expect, it&#8217;s pretty <a href="http://www.cbwinfo.com/Chemical/Precursors/p36.html">nasty stuff</a>: it&#8217;s not flammable, but it reacts with water or heat to produce toxic chemicals like hydrogen chloride.</p>
<p>Another example is <a href="http://en.wikipedia.org/wiki/Iron_pentacarbonyl">iron pentacarbonyl</a>, where 5 carbon-oxygen ligands are attached to a central iron atom:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Iron_pentacarbonyl"><img border="none" src="https://i2.wp.com/math.ucr.edu/home/baez/networks/200px-Iron-pentacarbonyl-from-xtal-3D-balls.png" alt="" /></a>
</div>
<p>You can make this stuff by letting powdered iron react with carbon monoxide.  It&#8217;s a straw-colored liquid with a pungent smell!</p>
<p>Whenever you&#8217;ve got a molecule of this shape, the ligands come in two kinds.  There are the 2 &#8216;axial&#8217; ones, and the 3 &#8216;equatorial&#8217; ones:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Trigonal_bipyramidal_molecular_geometry"><img border="none" src="https://i2.wp.com/math.ucr.edu/home/baez/networks/200px-Trigonal-bipyramidal-3D-balls-ax-eq.png" alt="" /></a>
</div>
<p>And the molecule has 20 states&#8230; but only if count the states a certain way.   We have to treat all 5 ligands as distinguishable, but think of two arrangements of them as the same if we can rotate one to get the other.   The trigonal bipyramid has a rotational symmetry group with 6 elements.  So, there are 5! / 6 = 20 states.  </p>
<p>The transitions between states are devilishly tricky.  They&#8217;re called <b>pseudorotations</b>, and they look like this:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Berry_mechanism"><img border="none" width="450" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/700px-Iron-pentacarbonyl-Berry-mechanism.png" alt="" /></a></div>
<p>If you look very carefully, you&#8217;ll see what&#8217;s going on.  First the 2 axial ligands move towards each other to become equatorial.<br />
Now the equatorial ones are no longer in the horizontal plane: they&#8217;re in the plane facing us!   Then 2 of the 3 equatorial ones swing out to become axial.    This fancy dance is called the <a href="http://en.wikipedia.org/wiki/Berry_mechanism">Berry pseudorotation mechanism</a>.</p>
<p>To get from one state to another this way, we have to pick 2 of the 3 equatorial ligands to swing out and become axial.  There are 3 choices here.   So, if we draw a graph with states as vertices and transitions as edges, it will have 20 vertices and 20 &times; 3 / 2 = 30 edges.  That sounds suspiciously like the Desargues graph!</p>
<p><b>Puzzle 1</b>.  Show that the graph with states of a trigonal bipyramidal molecule as vertices and pseudorotations as edges is indeed the Desargues graph.</p>
<p>I think this fact was first noticed here:</p>
<p>&bull; Paul C. Lauterbur and Fausto Ramirez, Pseudorotation in trigonal-bipyramidal molecules, <a href="http://pubs.acs.org/doi/abs/10.1021/ja01026a029"><i>J. Am. Chem. Soc.</i></a> <b>90</b> (1968), 67226726.</p>
<p>Okay, enough for now!  Next time I&#8217;ll say more about the Markov process or quantum process corresponding to a random walk on the Desargues graph.  But since the Berry pseudorotation mechanism is so hard to visualize, I&#8217;ll <i>pretend</i> that the ethyl cation looks like this:</p>
<div align="center"><a href="http://comporgchem.com/blog/?p=60"><img border="none" src="https://i2.wp.com/math.ucr.edu/home/baez/networks/ethyl_cation_classical.jpg" alt="" /></a></div>
<p>and I&#8217;ll use this picture to help us think about the Desargues graph.</p>
<p>That&#8217;s okay: everything we&#8217;ll figure out can easily be translated to apply to the real-world situation of a trigonal bipyramidal molecule.  The virtue of math is that when two situations are &#8216;mathematically the same&#8217;, or &#8216;isomorphic&#8217;, we can talk about either one, and the results automatically apply to the other.  This is true even if the one we talk about doesn&#8217;t actually exist in the real world!</p>
									</div>

				<p class="postmetadata">
				<img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/speech_bubble.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2011/10/15/network-theory-part-14/#comments">22 Comments</a>				| <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/documents.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/category/chemistry/" rel="category tag">chemistry</a>, <a href="https://johncarlosbaez.wordpress.com/category/mathematics/" rel="category tag">mathematics</a>, <a href="https://johncarlosbaez.wordpress.com/category/networks/" rel="category tag">networks</a>								 | <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/permalink.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2011/10/15/network-theory-part-14/" rel="bookmark" title="Permanent Link to Network Theory (Part&nbsp;14)">Permalink</a>
<br /><img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/figure_ver1.gif" alt="" /> Posted by John Baez				</p>
			</div>
			<hr />
		
		<div class="navigation">
			<div class="alignleft"><a href="https://johncarlosbaez.wordpress.com/category/chemistry/page/8/" >&laquo; Previous Entries</a></div>
			<div class="alignright"><a href="https://johncarlosbaez.wordpress.com/category/chemistry/page/6/" >Next Entries &raquo;</a></div>
		</div>

	
	</div>

	<div id="sidebar">
				<ul>

		 <li>

				<p>You are currently browsing the archives for the chemistry category.</p>

					</li> 
		<li id="recent-posts-3" class="widget widget_recent_entries">
		<h2 class="widgettitle">latest posts:</h2>

		<ul>
											<li>
					<a href="https://johncarlosbaez.wordpress.com/2021/09/26/classical-mechanics-versus-thermodynamics-part-4/">Classical Mechanics versus Thermodynamics (Part&nbsp;4)</a>
									</li>
											<li>
					<a href="https://johncarlosbaez.wordpress.com/2021/09/23/classical-mechanics-versus-thermodynamics-part-3/">Classical Mechanics versus Thermodynamics (Part&nbsp;3)</a>
									</li>
											<li>
					<a href="https://johncarlosbaez.wordpress.com/2021/09/22/maxwells-relations-part-3/">Maxwell&#8217;s Relations (Part&nbsp;3)</a>
									</li>
											<li>
					<a href="https://johncarlosbaez.wordpress.com/2021/09/18/maxwells-relations-part-two/">Maxwell&#8217;s Relations (Part&nbsp;2)</a>
									</li>
											<li>
					<a href="https://johncarlosbaez.wordpress.com/2021/09/17/maxwells-relations-part-1/">Maxwell&#8217;s Relations (Part&nbsp;1)</a>
									</li>
											<li>
					<a href="https://johncarlosbaez.wordpress.com/2021/09/13/the-cyclic-identity-for-partial-derivatives/">The Cyclic Identity for Partial&nbsp;Derivatives</a>
									</li>
											<li>
					<a href="https://johncarlosbaez.wordpress.com/2021/08/17/information-geometry-part-21/">Information Geometry (Part&nbsp;21)</a>
									</li>
											<li>
					<a href="https://johncarlosbaez.wordpress.com/2021/08/14/information-geometry-part-20/">Information Geometry (Part&nbsp;20)</a>
									</li>
											<li>
					<a href="https://johncarlosbaez.wordpress.com/2021/08/08/information-geometry-part-19/">Information Geometry (Part&nbsp;19)</a>
									</li>
											<li>
					<a href="https://johncarlosbaez.wordpress.com/2021/08/05/information-geometry-part-18/">Information Geometry (Part&nbsp;18)</a>
									</li>
					</ul>

		</li>
<li id="recent-comments-2" class="widget widget_recent_comments"><h2 class="widgettitle">latest comments:</h2>
				<table class="recentcommentsavatar" cellspacing="0" cellpadding="0" border="0">
					<tr><td title="Toby Bartels" class="recentcommentsavatartop" style="height:32px; width:32px;"><a href="http://tobybartels.name/" rel="nofollow"><img alt='' src='https://0.gravatar.com/avatar/68c7b083965f5073c50bf7c8d2aac358?s=32&#038;d=identicon&#038;r=G' class='avatar avatar-32' height='32' width='32' /></a></td><td class="recentcommentstexttop" style=""><a href="http://tobybartels.name/" rel="nofollow">Toby Bartels</a> on <a href="https://johncarlosbaez.wordpress.com/2021/09/23/classical-mechanics-versus-thermodynamics-part-3/#comment-172598">Classical Mechanics versus The&hellip;</a></td></tr><tr><td title="David Corfield" class="recentcommentsavatarend" style="height:32px; width:32px;"><img alt='' src='https://0.gravatar.com/avatar/34784534843022b3541c8ddd693718cb?s=32&#038;d=identicon&#038;r=G' class='avatar avatar-32' height='32' width='32' /></td><td class="recentcommentstextend" style="">David Corfield on <a href="https://johncarlosbaez.wordpress.com/2021/09/23/classical-mechanics-versus-thermodynamics-part-3/#comment-172597">Classical Mechanics versus The&hellip;</a></td></tr><tr><td title="Toby Bartels" class="recentcommentsavatarend" style="height:32px; width:32px;"><a href="http://tobybartels.name/" rel="nofollow"><img alt='' src='https://0.gravatar.com/avatar/68c7b083965f5073c50bf7c8d2aac358?s=32&#038;d=identicon&#038;r=G' class='avatar avatar-32' height='32' width='32' /></a></td><td class="recentcommentstextend" style=""><a href="http://tobybartels.name/" rel="nofollow">Toby Bartels</a> on <a href="https://johncarlosbaez.wordpress.com/2021/09/26/classical-mechanics-versus-thermodynamics-part-4/#comment-172596">Classical Mechanics versus The&hellip;</a></td></tr><tr><td title="David Corfield" class="recentcommentsavatarend" style="height:32px; width:32px;"><img alt='' src='https://lh3.googleusercontent.com/a/AATXAJxXcoKzwm_cY3LJp3qldhAQvZVoBimQd4xe5tDl=s96-c' class='avatar avatar-32' height='32' width='32' /></td><td class="recentcommentstextend" style="">David Corfield on <a href="https://johncarlosbaez.wordpress.com/2021/09/23/classical-mechanics-versus-thermodynamics-part-3/#comment-172590">Classical Mechanics versus The&hellip;</a></td></tr><tr><td title="amarashiki" class="recentcommentsavatarend" style="height:32px; width:32px;"><a href="http://gravatar.com/amarashiki" rel="nofollow"><img alt='' src='https://0.gravatar.com/avatar/62b2df0762257e75433ad6f161488c3a?s=32&#038;d=identicon&#038;r=G' class='avatar avatar-32' height='32' width='32' /></a></td><td class="recentcommentstextend" style=""><a href="http://gravatar.com/amarashiki" rel="nofollow">amarashiki</a> on <a href="https://johncarlosbaez.wordpress.com/2012/01/23/classical-mechanics-versus-thermodynamics-part-2/#comment-172566">Classical Mechanics versus The&hellip;</a></td></tr><tr><td title="John Baez" class="recentcommentsavatarend" style="height:32px; width:32px;"><a href="http://math.ucr.edu/home/baez/" rel="nofollow"><img alt='' src='https://0.gravatar.com/avatar/34784534843022b3541c8ddd693718cb?s=32&#038;d=identicon&#038;r=G' class='avatar avatar-32' height='32' width='32' /></a></td><td class="recentcommentstextend" style=""><a href="http://math.ucr.edu/home/baez/" rel="nofollow">John Baez</a> on <a href="https://johncarlosbaez.wordpress.com/2021/09/23/classical-mechanics-versus-thermodynamics-part-3/#comment-172560">Classical Mechanics versus The&hellip;</a></td></tr><tr><td title="domenico" class="recentcommentsavatarend" style="height:32px; width:32px;"><img alt='' src='https://2.gravatar.com/avatar/ba06491deb8346d20356ac2ae05893ee?s=32&#038;d=identicon&#038;r=G' class='avatar avatar-32' height='32' width='32' /></td><td class="recentcommentstextend" style="">domenico on <a href="https://johncarlosbaez.wordpress.com/2021/09/23/classical-mechanics-versus-thermodynamics-part-3/#comment-172559">Classical Mechanics versus The&hellip;</a></td></tr><tr><td title="domenico" class="recentcommentsavatarend" style="height:32px; width:32px;"><img alt='' src='https://2.gravatar.com/avatar/ba06491deb8346d20356ac2ae05893ee?s=32&#038;d=identicon&#038;r=G' class='avatar avatar-32' height='32' width='32' /></td><td class="recentcommentstextend" style="">domenico on <a href="https://johncarlosbaez.wordpress.com/2021/09/23/classical-mechanics-versus-thermodynamics-part-3/#comment-172558">Classical Mechanics versus The&hellip;</a></td></tr><tr><td title="Maxwell Relations | Equivalent eXchange" class="recentcommentsavatarend" style="height:32px; width:32px;"><a href="http://equivalentexchange.blog/2021/09/25/maxwell-relations/" rel="nofollow"></a></td><td class="recentcommentstextend" style=""><a href="http://equivalentexchange.blog/2021/09/25/maxwell-relations/" rel="nofollow">Maxwell Relations |&hellip;</a> on <a href="https://johncarlosbaez.wordpress.com/2021/09/22/maxwells-relations-part-3/#comment-172557">Maxwell&#8217;s Relations (Par&hellip;</a></td></tr><tr><td title="Maxwell Relations | Equivalent eXchange" class="recentcommentsavatarend" style="height:32px; width:32px;"><a href="http://equivalentexchange.blog/2021/09/25/maxwell-relations/" rel="nofollow"></a></td><td class="recentcommentstextend" style=""><a href="http://equivalentexchange.blog/2021/09/25/maxwell-relations/" rel="nofollow">Maxwell Relations |&hellip;</a> on <a href="https://johncarlosbaez.wordpress.com/2021/09/18/maxwells-relations-part-two/#comment-172556">Maxwell&#8217;s Relations (Par&hellip;</a></td></tr>				</table>
				</li>
<li id="text-3" class="widget widget_text"><h2 class="widgettitle">How To Write Math Here:</h2>
			<div class="textwidget"><p>You can <a href="http://en.wikibooks.org/wiki/LaTeX/Mathematics">include math in your comments using LaTeX</a>,  but you need to do it this way:</p>
<p>&#036;latex  E = mc^2&#036;</p>
<p>You need the word 'latex' right after the first dollar sign, and it needs a space after it.  Double dollar signs don't work, and other limitations apply, some described <a href="http://en.support.wordpress.com/latex/">here</a>.  You can't preview comments here, but I'm happy to fix errors.</p>
</div>
		</li>
<li id="categories-2" class="widget widget_categories"><h2 class="widgettitle">Read Posts On:</h2>

			<ul>
					<li class="cat-item cat-item-177"><a href="https://johncarlosbaez.wordpress.com/category/art/">art</a> (3)
</li>
	<li class="cat-item cat-item-4003"><a href="https://johncarlosbaez.wordpress.com/category/astronomy/">astronomy</a> (29)
</li>
	<li class="cat-item cat-item-8262191"><a href="https://johncarlosbaez.wordpress.com/category/azimuth/">azimuth</a> (60)
</li>
	<li class="cat-item cat-item-86856"><a href="https://johncarlosbaez.wordpress.com/category/biodiversity/">biodiversity</a> (38)
</li>
	<li class="cat-item cat-item-4936"><a href="https://johncarlosbaez.wordpress.com/category/biology/">biology</a> (107)
</li>
	<li class="cat-item cat-item-355244"><a href="https://johncarlosbaez.wordpress.com/category/carbon-emissions/">carbon emissions</a> (78)
</li>
	<li class="cat-item cat-item-5936 current-cat"><a aria-current="page" href="https://johncarlosbaez.wordpress.com/category/chemistry/">chemistry</a> (74)
</li>
	<li class="cat-item cat-item-6108"><a href="https://johncarlosbaez.wordpress.com/category/climate/">climate</a> (155)
</li>
	<li class="cat-item cat-item-5043"><a href="https://johncarlosbaez.wordpress.com/category/computer-science/">computer science</a> (57)
</li>
	<li class="cat-item cat-item-9204"><a href="https://johncarlosbaez.wordpress.com/category/conferences/">conferences</a> (81)
</li>
	<li class="cat-item cat-item-1098"><a href="https://johncarlosbaez.wordpress.com/category/culture/">culture</a> (4)
</li>
	<li class="cat-item cat-item-657"><a href="https://johncarlosbaez.wordpress.com/category/economics/">economics</a> (32)
</li>
	<li class="cat-item cat-item-1212"><a href="https://johncarlosbaez.wordpress.com/category/energy/">energy</a> (50)
</li>
	<li class="cat-item cat-item-25393"><a href="https://johncarlosbaez.wordpress.com/category/engineering/">engineering</a> (11)
</li>
	<li class="cat-item cat-item-14852"><a href="https://johncarlosbaez.wordpress.com/category/mathematics/game-theory/">game theory</a> (29)
</li>
	<li class="cat-item cat-item-1215"><a href="https://johncarlosbaez.wordpress.com/category/geography/">geography</a> (4)
</li>
	<li class="cat-item cat-item-337"><a href="https://johncarlosbaez.wordpress.com/category/health/">health</a> (4)
</li>
	<li class="cat-item cat-item-678"><a href="https://johncarlosbaez.wordpress.com/category/history/">history</a> (2)
</li>
	<li class="cat-item cat-item-23375499"><a href="https://johncarlosbaez.wordpress.com/category/information-and-entropy/">information and entropy</a> (92)
</li>
	<li class="cat-item cat-item-3558"><a href="https://johncarlosbaez.wordpress.com/category/jobs/">jobs</a> (11)
</li>
	<li class="cat-item cat-item-5465"><a href="https://johncarlosbaez.wordpress.com/category/journals/">journals</a> (5)
</li>
	<li class="cat-item cat-item-3582"><a href="https://johncarlosbaez.wordpress.com/category/mathematics/">mathematics</a> (479)
</li>
	<li class="cat-item cat-item-18"><a href="https://johncarlosbaez.wordpress.com/category/music/">music</a> (3)
</li>
	<li class="cat-item cat-item-3968"><a href="https://johncarlosbaez.wordpress.com/category/networks/">networks</a> (185)
</li>
	<li class="cat-item cat-item-154934"><a href="https://johncarlosbaez.wordpress.com/category/oceans/">oceans</a> (13)
</li>
	<li class="cat-item cat-item-1211"><a href="https://johncarlosbaez.wordpress.com/category/physics/">physics</a> (205)
</li>
	<li class="cat-item cat-item-10451"><a href="https://johncarlosbaez.wordpress.com/category/probability/">probability</a> (92)
</li>
	<li class="cat-item cat-item-4909"><a href="https://johncarlosbaez.wordpress.com/category/psychology/">psychology</a> (6)
</li>
	<li class="cat-item cat-item-3330"><a href="https://johncarlosbaez.wordpress.com/category/publishing/">publishing</a> (19)
</li>
	<li class="cat-item cat-item-46615"><a href="https://johncarlosbaez.wordpress.com/category/puzzles/">puzzles</a> (14)
</li>
	<li class="cat-item cat-item-4140243"><a href="https://johncarlosbaez.wordpress.com/category/quantum-technologies/">quantum technologies</a> (28)
</li>
	<li class="cat-item cat-item-562"><a href="https://johncarlosbaez.wordpress.com/category/questions/">questions</a> (3)
</li>
	<li class="cat-item cat-item-93974"><a href="https://johncarlosbaez.wordpress.com/category/risks/">risks</a> (48)
</li>
	<li class="cat-item cat-item-37893"><a href="https://johncarlosbaez.wordpress.com/category/seminars/">seminars</a> (21)
</li>
	<li class="cat-item cat-item-581"><a href="https://johncarlosbaez.wordpress.com/category/software/">software</a> (19)
</li>
	<li class="cat-item cat-item-39438"><a href="https://johncarlosbaez.wordpress.com/category/strategies/">strategies</a> (36)
</li>
	<li class="cat-item cat-item-6877"><a href="https://johncarlosbaez.wordpress.com/category/sustainability/">sustainability</a> (71)
</li>
	<li class="cat-item cat-item-66608272"><a href="https://johncarlosbaez.wordpress.com/category/the-practice-of-science/">the practice of science</a> (27)
</li>
	<li class="cat-item cat-item-61590"><a href="https://johncarlosbaez.wordpress.com/category/this-weeks-finds/">this week&#039;s finds</a> (18)
</li>
			</ul>

			</li>
<li id="linkcat-20924250" class="widget widget_links"><h2 class="widgettitle">also visit these:</h2>

	<ul class='xoxo blogroll'>
<li><a href="http://www.azimuthproject.org/azimuth/show/Azimuth+Blog" title="Go here to see whats on this blog, organized by topic or author!">Azimuth Blog Overview</a></li>
<li><a href="http://www.azimuthproject.org/azimuth/show/HomePage" title="for scientists and engineers who want to save the planet">Azimuth Project</a></li>
<li><a href="http://bittooth.blogspot.com/" title="David Summers on energy: oil, gas and more">Bit Tooth Energy</a></li>
<li><a href="http://bravenewclimate.com/" title="Barry Brooks on climate and energy policy">Brave New Climate</a></li>
<li><a href="http://physics.ucsd.edu/do-the-math/" title="UC San Diego prof uses physics and estimation to assess energy, growth, options">Do the Math</a></li>
<li><a href="http://dotearth.blogs.nytimes.com/" title="Andrew Revkins environmental blog on the New York Times">Dot Earth</a></li>
<li><a href="http://e360.yale.edu/" title="News from the Yale School of Forestry &amp; Environmental Studies">Environment 360</a></li>
<li><a href="http://planet3.org/" title="A metablog on sustainability">Planet3.0</a></li>
<li><a href="http://www.realclimate.org/" title="climate science from climate scientists">RealClimate</a></li>
<li><a href="http://www.easterbrook.ca/steve/" title="Steve Easterbrook&#8217;s blog on software engineering and climate modeling">Serendipity</a></li>
<li><a href="http://scienceofdoom.com/" title="climate science in perspective">The Science of Doom</a></li>
<li><a href="http://e360.yale.edu/" title="opinion, analysis, reporting and debate on environmental issues">Yale Environment 360</a></li>

	</ul>
</li>

<li id="rss_links-3" class="widget widget_rss_links"><h2 class="widgettitle">RSS feeds:</h2>
<p class="size-small"><a class="feed-image-link" href="https://johncarlosbaez.wordpress.com/feed/" title="Subscribe to Posts"><img src="https://johncarlosbaez.wordpress.com/i/rss/red-small.png?m=1391188133h" alt="RSS Feed" /></a>&nbsp;<a href="https://johncarlosbaez.wordpress.com/feed/" title="Subscribe to Posts">RSS - Posts</a></p><p class="size-small"><a class="feed-image-link" href="https://johncarlosbaez.wordpress.com/comments/feed/" title="Subscribe to Comments"><img src="https://johncarlosbaez.wordpress.com/i/rss/red-small.png?m=1391188133h" alt="RSS Feed" /></a>&nbsp;<a href="https://johncarlosbaez.wordpress.com/comments/feed/" title="Subscribe to Comments">RSS - Comments</a></p>
</li>
<li id="blog_subscription-3" class="widget widget_blog_subscription jetpack_subscription_widget"><h2 class="widgettitle"><label for="subscribe-field">Email Subscription:</label></h2>

			<form
				action="https://subscribe.wordpress.com"
				method="post"
				accept-charset="utf-8"
				id=""
			>
				<p>Enter your email address to subscribe to this blog and receive notifications of new posts by email.</p>
					<div class="jetpack-subscribe-count">
						<p>
						Join 5,228 other followers						</p>
					</div>
									<p id="subscribe-email">
					<label
						id="subscribe-field-label"
						for="subscribe-field"
						class="screen-reader-text"
					>
						Email Address:					</label>

					<input
							type="email"
							name="email"
							
							style="width: 95%; padding: 1px 10px"
							placeholder="Enter your email address"
							value=""
							id="subscribe-field"
						/>				</p>

				<p id="subscribe-submit"
									>
                    <input type="hidden" name="action" value="subscribe"/>
                    <input type="hidden" name="blog_id" value="12777403"/>
                    <input type="hidden" name="source" value="https://johncarlosbaez.wordpress.com/category/chemistry/page/7/"/>
                    <input type="hidden" name="sub-type" value="widget"/>
                    <input type="hidden" name="redirect_fragment" value="blog_subscription-3"/>
					<input type="hidden" id="_wpnonce" name="_wpnonce" value="ffcb185558" />                    <button type="submit"
	                    	                        class="wp-block-button__link"
	                    		                	                >
	                    Sign me up!                    </button>
                </p>
            </form>
			
</li>
<li id="search-3" class="widget widget_search"><h2 class="widgettitle">SEARCH:</h2>
<form method="get" id="searchform" action="https://johncarlosbaez.wordpress.com/">
<div><label for="s" class="search-label">Search</label><input type="text" value="" name="s" id="s" />
<input type="submit" id="searchsubmit" value="Search" />
</div>
</form></li>
<li id="blog-stats-2" class="widget widget_blog-stats"><h2 class="widgettitle">Blog Stats:</h2>
		<ul>
			<li>4,177,577 hits</li>
		</ul>
		</li>
		</ul>
	</div>



<div id="footer">
	<p>
	<br />
	<a href="https://wordpress.com/?ref=footer_blog" rel="nofollow">Blog at WordPress.com.</a>
	</p>
</div>

</div>

				<script type="text/javascript">
		//<![CDATA[
		var infiniteScroll = JSON.parse( decodeURIComponent( '%7B%22settings%22%3A%7B%22id%22%3A%22content%22%2C%22ajaxurl%22%3A%22https%3A%5C%2F%5C%2Fjohncarlosbaez.wordpress.com%5C%2F%3Finfinity%3Dscrolling%22%2C%22type%22%3A%22scroll%22%2C%22wrapper%22%3Atrue%2C%22wrapper_class%22%3A%22infinite-wrap%22%2C%22footer%22%3Atrue%2C%22click_handle%22%3A%221%22%2C%22text%22%3A%22Older%20posts%22%2C%22totop%22%3A%22Scroll%20back%20to%20top%22%2C%22currentday%22%3A%2215.10.11%22%2C%22order%22%3A%22DESC%22%2C%22scripts%22%3A%5B%5D%2C%22styles%22%3A%5B%5D%2C%22google_analytics%22%3Afalse%2C%22offset%22%3A7%2C%22history%22%3A%7B%22host%22%3A%22johncarlosbaez.wordpress.com%22%2C%22path%22%3A%22%5C%2Fcategory%5C%2Fchemistry%5C%2Fpage%5C%2F%25d%5C%2F%22%2C%22use_trailing_slashes%22%3Atrue%2C%22parameters%22%3A%22%22%7D%2C%22query_args%22%3A%7B%22paged%22%3A7%2C%22category_name%22%3A%22chemistry%22%2C%22error%22%3A%22%22%2C%22m%22%3A%22%22%2C%22p%22%3A0%2C%22post_parent%22%3A%22%22%2C%22subpost%22%3A%22%22%2C%22subpost_id%22%3A%22%22%2C%22attachment%22%3A%22%22%2C%22attachment_id%22%3A0%2C%22name%22%3A%22%22%2C%22pagename%22%3A%22%22%2C%22page_id%22%3A0%2C%22second%22%3A%22%22%2C%22minute%22%3A%22%22%2C%22hour%22%3A%22%22%2C%22day%22%3A0%2C%22monthnum%22%3A0%2C%22year%22%3A0%2C%22w%22%3A0%2C%22tag%22%3A%22%22%2C%22cat%22%3A5936%2C%22tag_id%22%3A%22%22%2C%22author%22%3A%22%22%2C%22author_name%22%3A%22%22%2C%22feed%22%3A%22%22%2C%22tb%22%3A%22%22%2C%22meta_key%22%3A%22%22%2C%22meta_value%22%3A%22%22%2C%22preview%22%3A%22%22%2C%22s%22%3A%22%22%2C%22sentence%22%3A%22%22%2C%22title%22%3A%22%22%2C%22fields%22%3A%22%22%2C%22menu_order%22%3A%22%22%2C%22embed%22%3A%22%22%2C%22category__in%22%3A%5B%5D%2C%22category__not_in%22%3A%5B%5D%2C%22category__and%22%3A%5B%5D%2C%22post__in%22%3A%5B%5D%2C%22post__not_in%22%3A%5B%5D%2C%22post_name__in%22%3A%5B%5D%2C%22tag__in%22%3A%5B%5D%2C%22tag__not_in%22%3A%5B%5D%2C%22tag__and%22%3A%5B%5D%2C%22tag_slug__in%22%3A%5B%5D%2C%22tag_slug__and%22%3A%5B%5D%2C%22post_parent__in%22%3A%5B%5D%2C%22post_parent__not_in%22%3A%5B%5D%2C%22author__in%22%3A%5B%5D%2C%22author__not_in%22%3A%5B%5D%2C%22lazy_load_term_meta%22%3Afalse%2C%22posts_per_page%22%3A10%2C%22ignore_sticky_posts%22%3Afalse%2C%22suppress_filters%22%3Afalse%2C%22cache_results%22%3Afalse%2C%22update_post_term_cache%22%3Atrue%2C%22update_post_meta_cache%22%3Atrue%2C%22post_type%22%3A%22%22%2C%22nopaging%22%3Afalse%2C%22comments_per_page%22%3A%22100%22%2C%22no_found_rows%22%3Afalse%2C%22order%22%3A%22DESC%22%7D%2C%22query_before%22%3A%222021-09-26%2017%3A25%3A45%22%2C%22last_post_date%22%3A%222011-10-15%2003%3A12%3A52%22%2C%22body_class%22%3A%22infinite-scroll%20neverending%22%2C%22loading_text%22%3A%22Loading%20new%20page%22%2C%22stats%22%3A%22blog%3D12777403%26v%3Dwpcom%26tz%3D0%26user_id%3D0%26subd%3Djohncarlosbaez%26x_pagetype%3Dinfinite%22%7D%7D' ) );
		//]]>
		</script>
		<!--  -->
<script src='//0.gravatar.com/js/gprofiles.js?ver=202138y' id='grofiles-cards-js'></script>
<script id='wpgroho-js-extra'>
var WPGroHo = {"my_hash":""};
</script>
<script crossorigin='anonymous' type='text/javascript' src='https://s1.wp.com/wp-content/mu-plugins/gravatar-hovercards/wpgroho.js?m=1610363240h'></script>

	<script>
		// Initialize and attach hovercards to all gravatars
		( function() {
			function init() {
				if ( typeof Gravatar === 'undefined' ) {
					return;
				}

				if ( typeof Gravatar.init !== 'function' ) {
					return;
				}

				Gravatar.profile_cb = function ( hash, id ) {
					WPGroHo.syncProfileData( hash, id );
				};

				Gravatar.my_hash = WPGroHo.my_hash;
				Gravatar.init( 'body', '#wp-admin-bar-my-account' );
			}

			if ( document.readyState !== 'loading' ) {
				init();
			} else {
				document.addEventListener( 'DOMContentLoaded', init );
			}
		} )();
	</script>

		<div style="display:none">
	<div class="grofile-hash-map-68c7b083965f5073c50bf7c8d2aac358">
	</div>
	<div class="grofile-hash-map-34784534843022b3541c8ddd693718cb">
	</div>
	<div class="grofile-hash-map-7d52fbe20c8ac05886a296e9ee2159b1">
	</div>
	<div class="grofile-hash-map-62b2df0762257e75433ad6f161488c3a">
	</div>
	<div class="grofile-hash-map-ba06491deb8346d20356ac2ae05893ee">
	</div>
	</div>
		<div id="infinite-footer">
			<div class="container">
				<div class="blog-info">
					<a id="infinity-blog-title" href="https://johncarlosbaez.wordpress.com/" rel="home">
						Azimuth					</a>
				</div>
				<div class="blog-credits">
					<a href="https://wordpress.com/?ref=footer_blog" rel="nofollow">Blog at WordPress.com.</a> 				</div>
			</div>
		</div><!-- #infinite-footer -->
		
<script>
window.addEventListener( "load", function( event ) {
	var link = document.createElement( "link" );
	link.href = "https://s0.wp.com/wp-content/mu-plugins/actionbar/actionbar.css?v=20210915";
	link.type = "text/css";
	link.rel = "stylesheet";
	document.head.appendChild( link );

	var script = document.createElement( "script" );
	script.src = "https://s0.wp.com/wp-content/mu-plugins/actionbar/actionbar.js?v=20210920";
	script.defer = true;
	document.body.appendChild( script );
} );
</script>

			<div id="jp-carousel-loading-overlay">
			<div id="jp-carousel-loading-wrapper">
				<span id="jp-carousel-library-loading">&nbsp;</span>
			</div>
		</div>
		<div class="jp-carousel-overlay" style="display: none;">

		<div class="jp-carousel-container">
			<!-- The Carousel Swiper -->
			<div
				class="jp-carousel-wrap swiper-container jp-carousel-swiper-container jp-carousel-transitions"
				itemscope
				itemtype="https://schema.org/ImageGallery">
				<div class="jp-carousel swiper-wrapper"></div>
				<div class="jp-swiper-button-prev swiper-button-prev">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskPrev" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="9" height="12">
							<path d="M16.2072 16.59L11.6496 12L16.2072 7.41L14.8041 6L8.8335 12L14.8041 18L16.2072 16.59Z" fill="white"/>
						</mask>
						<g mask="url(#maskPrev)">
							<rect x="0.579102" width="23.8823" height="24" fill="#FFFFFF"/>
						</g>
					</svg>
				</div>
				<div class="jp-swiper-button-next swiper-button-next">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskNext" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="8" height="12">
							<path d="M8.59814 16.59L13.1557 12L8.59814 7.41L10.0012 6L15.9718 12L10.0012 18L8.59814 16.59Z" fill="white"/>
						</mask>
						<g mask="url(#maskNext)">
							<rect x="0.34375" width="23.8822" height="24" fill="#FFFFFF"/>
						</g>
					</svg>
				</div>
			</div>
			<!-- The main close buton -->
			<div class="jp-carousel-close-hint">
				<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
					<mask id="maskClose" mask-type="alpha" maskUnits="userSpaceOnUse" x="5" y="5" width="15" height="14">
						<path d="M19.3166 6.41L17.9135 5L12.3509 10.59L6.78834 5L5.38525 6.41L10.9478 12L5.38525 17.59L6.78834 19L12.3509 13.41L17.9135 19L19.3166 17.59L13.754 12L19.3166 6.41Z" fill="white"/>
					</mask>
					<g mask="url(#maskClose)">
						<rect x="0.409668" width="23.8823" height="24" fill="#FFFFFF"/>
					</g>
				</svg>
			</div>
			<!-- Image info, comments and meta -->
			<div class="jp-carousel-info">
				<div class="jp-carousel-info-footer">
					<div class="jp-carousel-pagination-container">
						<div class="jp-swiper-pagination swiper-pagination"></div>
						<div class="jp-carousel-pagination"></div>
					</div>
					<div class="jp-carousel-photo-title-container">
						<h2 class="jp-carousel-photo-caption"></h2>
					</div>
					<div class="jp-carousel-photo-icons-container">
						<a href="#" class="jp-carousel-icon-btn jp-carousel-icon-info" aria-label="Toggle photo metadata visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskInfo" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M12.7537 2C7.26076 2 2.80273 6.48 2.80273 12C2.80273 17.52 7.26076 22 12.7537 22C18.2466 22 22.7046 17.52 22.7046 12C22.7046 6.48 18.2466 2 12.7537 2ZM11.7586 7V9H13.7488V7H11.7586ZM11.7586 11V17H13.7488V11H11.7586ZM4.79292 12C4.79292 16.41 8.36531 20 12.7537 20C17.142 20 20.7144 16.41 20.7144 12C20.7144 7.59 17.142 4 12.7537 4C8.36531 4 4.79292 7.59 4.79292 12Z" fill="white"/>
									</mask>
									<g mask="url(#maskInfo)">
										<rect x="0.8125" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>
							</span>
						</a>
												<a href="#" class="jp-carousel-icon-btn jp-carousel-icon-comments" aria-label="Toggle photo comments visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskComments" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M4.3271 2H20.2486C21.3432 2 22.2388 2.9 22.2388 4V16C22.2388 17.1 21.3432 18 20.2486 18H6.31729L2.33691 22V4C2.33691 2.9 3.2325 2 4.3271 2ZM6.31729 16H20.2486V4H4.3271V18L6.31729 16Z" fill="white"/>
									</mask>
									<g mask="url(#maskComments)">
										<rect x="0.34668" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>

								<span class="jp-carousel-has-comments-indicator" aria-label="This image has comments."></span>
							</span>
						</a>
											</div>
				</div>
				<div class="jp-carousel-info-extra">
					<div class="jp-carousel-info-content-wrapper">
						<div class="jp-carousel-photo-title-container">
							<h2 class="jp-carousel-photo-title"></h2>
						</div>
						<div class="jp-carousel-comments-wrapper">
															<div id="jp-carousel-comments-loading">
									<span>Loading Comments...</span>
								</div>
								<div class="jp-carousel-comments"></div>
								<div id="jp-carousel-comment-form-container">
									<span id="jp-carousel-comment-form-spinner">&nbsp;</span>
									<div id="jp-carousel-comment-post-results"></div>
																														<form id="jp-carousel-comment-form">
												<label for="jp-carousel-comment-form-comment-field" class="screen-reader-text">Write a Comment...</label>
												<textarea
													name="comment"
													class="jp-carousel-comment-form-field jp-carousel-comment-form-textarea"
													id="jp-carousel-comment-form-comment-field"
													placeholder="Write a Comment..."
												></textarea>
												<div id="jp-carousel-comment-form-submit-and-info-wrapper">
													<div id="jp-carousel-comment-form-commenting-as">
																													<fieldset>
																<label for="jp-carousel-comment-form-email-field">Email (Required)</label>
																<input type="text" name="email" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-email-field" />
															</fieldset>
															<fieldset>
																<label for="jp-carousel-comment-form-author-field">Name (Required)</label>
																<input type="text" name="author" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-author-field" />
															</fieldset>
															<fieldset>
																<label for="jp-carousel-comment-form-url-field">Website</label>
																<input type="text" name="url" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-url-field" />
															</fieldset>
																											</div>
													<input
														type="submit"
														name="submit"
														class="jp-carousel-comment-form-button"
														id="jp-carousel-comment-form-button-submit"
														value="Post Comment" />
												</div>
											</form>
																											</div>
													</div>
						<div class="jp-carousel-image-meta">
							<div class="jp-carousel-title-and-caption">
								<div class="jp-carousel-photo-info">
									<h3 class="jp-carousel-caption" itemprop="caption description"></h3>
								</div>

								<div class="jp-carousel-photo-description"></div>
							</div>
							<ul class="jp-carousel-image-exif" style="display: none;"></ul>
							<a class="jp-carousel-image-download" target="_blank" style="display: none;">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="mask0" mask-type="alpha" maskUnits="userSpaceOnUse" x="3" y="3" width="19" height="18">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M5.84615 5V19H19.7775V12H21.7677V19C21.7677 20.1 20.8721 21 19.7775 21H5.84615C4.74159 21 3.85596 20.1 3.85596 19V5C3.85596 3.9 4.74159 3 5.84615 3H12.8118V5H5.84615ZM14.802 5V3H21.7677V10H19.7775V6.41L9.99569 16.24L8.59261 14.83L18.3744 5H14.802Z" fill="white"/>
									</mask>
									<g mask="url(#mask0)">
										<rect x="0.870605" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>
								<span class="jp-carousel-download-text"></span>
							</a>
							<div class="jp-carousel-image-map" style="display: none;"></div>
						</div>
					</div>
				</div>
			</div>
		</div>

		</div>
		<link rel='stylesheet' id='all-css-0-2' href='https://s1.wp.com/_static/??-eJyFy00OQDAQQOELGUP8xUKcpWoiZVTTadO4vVhY2LB8L/kwOdCHDWQD7hEcx8VYQa38EYUYJRlHHqZoZ6Zci2T4I1YKTukNnvGFgmGaYVHM5M933Wzch7Ktir5p+rpbL+lvP34=?cssminify=yes' type='text/css' media='all' />
<script id='jetpack-carousel-js-extra'>
var jetpackSwiperLibraryPath = {"url":"\/wp-content\/mu-plugins\/carousel\/swiper-bundle.js"};
var jetpackCarouselStrings = {"widths":[370,700,1000,1200,1400,2000],"is_logged_in":"","lang":"en","ajaxurl":"https:\/\/johncarlosbaez.wordpress.com\/wp-admin\/admin-ajax.php","nonce":"805b669379","display_exif":"1","display_comments":"1","display_geo":"1","single_image_gallery":"1","single_image_gallery_media_file":"","background_color":"black","comment":"Comment","post_comment":"Post Comment","write_comment":"Write a Comment...","loading_comments":"Loading Comments...","download_original":"View full size <span class=\"photo-size\">{0}<span class=\"photo-size-times\">\u00d7<\/span>{1}<\/span>","no_comment_text":"Please be sure to submit some text with your comment.","no_comment_email":"Please provide an email address to comment.","no_comment_author":"Please provide your name to comment.","comment_post_error":"Sorry, but there was an error posting your comment. Please try again later.","comment_approved":"Your comment was approved.","comment_unapproved":"Your comment is in moderation.","camera":"Camera","aperture":"Aperture","shutter_speed":"Shutter Speed","focal_length":"Focal Length","copyright":"Copyright","comment_registration":"0","require_name_email":"1","login_url":"https:\/\/johncarlosbaez.wordpress.com\/wp-login.php?redirect_to=https%3A%2F%2Fjohncarlosbaez.wordpress.com%2F2011%2F10%2F15%2Fnetwork-theory-part-14%2F","blog_id":"12777403","meta_data":["camera","aperture","shutter_speed","focal_length","copyright"],"stats_query_args":"blog=12777403&v=wpcom&tz=0&user_id=0&subd=johncarlosbaez","is_public":"1"};
</script>
<script crossorigin='anonymous' type='text/javascript' src='https://s0.wp.com/_static/??-eJyNkN1uwyAMhV9oDkouKvVi2rMQcCNT/oZN07z9yNRMbTZFu8LH8J2DreYMJkXBKMqxsngjg/neOX5TT1ehQvZ1osiK4oUiyfJTHLzVNlCEURcVNAuWVoEUba68h1q2+6xYlsfRzdmkALmk+wIFW49lYygaXy3yCjWJYUTbtaCDj8xkJxRWXEc2hbJQivyXH8+XNDo0sjfbnG5kMSnNvNq5h84F+ddIT/FGl1QZvXIouY0PW+OAEfJoYdLer1t5Uf9Igu/97WTjPsJ7fxrO534YTr37Ai2cwB8='></script>
<script type="text/javascript">
// <![CDATA[
(function() {
try{
  if ( window.external &&'msIsSiteMode' in window.external) {
    if (window.external.msIsSiteMode()) {
      var jl = document.createElement('script');
      jl.type='text/javascript';
      jl.async=true;
      jl.src='/wp-content/plugins/ie-sitemode/custom-jumplist.php';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jl, s);
    }
  }
}catch(e){}
})();
// ]]>
</script><script type="text/javascript">
			(function() {
				var extend = function(out) {
					out = out || {};

					for (var i = 1; i < arguments.length; i++) {
						if (!arguments[i])
						continue;

						for (var key in arguments[i]) {
						if (arguments[i].hasOwnProperty(key))
							out[key] = arguments[i][key];
						}
					}

					return out;
				};
				extend( window.infiniteScroll.settings.scripts, ["postmessage","mobile-useragent-info","rlt-proxy","jquery-core","jquery-migrate","jquery","wpcom-actionbar-placeholder","grofiles-cards","wpgroho","devicepx","the-neverending-homepage","wpcom-masterbar-tracks-js","jquery.wpcom-proxy-request","wp-embed","jetpack-subscriptions-js","swfobject","videopress","jetpack-carousel","tiled-gallery","carousel-wpcom"] );
				extend( window.infiniteScroll.settings.styles, ["the-neverending-homepage","infinity-contempt","wp-block-library","mediaelement","wp-mediaelement","jetpack-layout-grid","jetpack-ratings","coblocks-frontend","wpcom-core-compat-playlist-styles","wpcom-text-widget-styles","wpcom-bbpress2-staff-css","contempt","geo-location-flair","reblogging","a8c-global-print","h4-global","global-styles","jetpack-global-styles-frontend-style","jetpack-carousel-swiper-css","jetpack-carousel","tiled-gallery"] );
			})();
		</script>
				<span id="infinite-aria" aria-live="polite"></span>
		<script src="//stats.wp.com/w.js?62" defer></script> <script type="text/javascript">
_tkq = window._tkq || [];
_stq = window._stq || [];
_tkq.push(['storeContext', {'blog_id':'12777403','blog_tz':'0','user_lang':'en','blog_lang':'en','user_id':'0'}]);
_stq.push(['view', {'blog':'12777403','v':'wpcom','tz':'0','user_id':'0','subd':'johncarlosbaez'}]);
_stq.push(['extra', {'crypt':'UE40eW5QN0p8M2Y/RE1TaVhzUzFMbjdWNHpwZGhTayxPSUFCMGNrd29+Smw0TDhnZmRTK0hlRi9QSGh6bi9GXVhBJWIlZlR5U1JMLU8/MkNtblkvY1d6eVImTEouL2UleTBRZmlNdkp0aWJaNFJhPS0uTVpHa1hIc25EbVJyQmw/SkZ+Q3lLcjU/NDBvQTZnYnRiMkYuKz1XUnVaX0lsJmh3L2xxcHNhKzVFcDhfWklkZkImNjl5OFdzKy5CNHlwT1QvQmduQ2xKY1Z0bVI3JW9+MythaEZ2SG9naWl+fHhYbzFTJlU9R01pVmFHV0VkLTgveXolQyxKZXRGZHx2JnJSLy9bWjE9TGNYb296dVF+VlhmQUZWTzQmTDE0VywzJWt2R2tMOUlhQ0R0eSVmLHZQN3VbZlszfmx0P2dpX0pfVTRRUzVFSlk3UVZ1dUE3K21aRk8t'}]);
_stq.push([ 'clickTrackerInit', '12777403', '0' ]);
	</script>
<noscript><img src="https://pixel.wp.com/b.gif?v=noscript" style="height:1px;width:1px;overflow:hidden;position:absolute;bottom:1px;" alt="" /></noscript>
<script>
if ( 'object' === typeof wpcom_mobile_user_agent_info ) {

	wpcom_mobile_user_agent_info.init();
	var mobileStatsQueryString = "";
	
	if( false !== wpcom_mobile_user_agent_info.matchedPlatformName )
		mobileStatsQueryString += "&x_" + 'mobile_platforms' + '=' + wpcom_mobile_user_agent_info.matchedPlatformName;
	
	if( false !== wpcom_mobile_user_agent_info.matchedUserAgentName )
		mobileStatsQueryString += "&x_" + 'mobile_devices' + '=' + wpcom_mobile_user_agent_info.matchedUserAgentName;
	
	if( wpcom_mobile_user_agent_info.isIPad() )
		mobileStatsQueryString += "&x_" + 'ipad_views' + '=' + 'views';

	if( "" != mobileStatsQueryString ) {
		new Image().src = document.location.protocol + '//pixel.wp.com/g.gif?v=wpcom-no-pv' + mobileStatsQueryString + '&baba=' + Math.random();
	}
	
}
</script>
</body>
</html>