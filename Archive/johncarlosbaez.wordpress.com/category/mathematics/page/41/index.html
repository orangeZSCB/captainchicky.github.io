<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>mathematics | Azimuth | Page 41</title>
<link rel="profile" href="http://gmpg.org/xfn/11" />
<link rel="pingback" href="https://johncarlosbaez.wordpress.com/xmlrpc.php" />
<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s1.wp.com' />
<link rel='dns-prefetch' href='//s2.wp.com' />
<link rel='dns-prefetch' href='//s0.wp.com' />
<link rel='dns-prefetch' href='//s.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Azimuth &raquo; Feed" href="https://johncarlosbaez.wordpress.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Azimuth &raquo; Comments Feed" href="https://johncarlosbaez.wordpress.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Azimuth &raquo; mathematics Category Feed" href="https://johncarlosbaez.wordpress.com/category/mathematics/feed/" />
	<script type="text/javascript">
		/* <![CDATA[ */
		function addLoadEvent(func) {
			var oldonload = window.onload;
			if (typeof window.onload != 'function') {
				window.onload = func;
			} else {
				window.onload = function () {
					oldonload();
					func();
				}
			}
		}
		/* ]]> */
	</script>
			<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/s1.wp.com\/wp-includes\/js\/wp-emoji-release.min.js?m=1625065786h&ver=5.8.1"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([10084,65039,8205,55357,56613],[10084,65039,8203,55357,56613])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='all-css-0-1' href='https://s2.wp.com/_static/??-eJyNkttSAyEMhl9IlqVOdbxwfBYOEVOBZSBYeXuz1e6sVrveMDl9yU9AHrOwUyJIJGMTOTSPqUpMz5iQ+mIMttYbuVFMLxChytyMPJXFTBfcGfKNXQPFc6aAfFNq2A9KmobBSRMm+yoCmqJLl5V6gKURJhua4zGHKiM41BB46qxo5eSgOxQRwGvbh4hpG+fc2v8G/S3+pJSbAWU9S9Z9aiR8QfdD9r9bFE2YfN3A7fSF7QY18t4cVlqC4nd29WTzzjkes768+BXsiM4DMV7PtiB4v45kHiOMyQVqFXxGbFF8/pSZe4qP6u5W3T/sx3F3+ACgX/YH?cssminify=yes' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify {
	text-align:justify;
}
</style>
<style id='global-styles-inline-css'>
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--normal: 16px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--huge: 42px;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-normal-font-size{font-size: var(--wp--preset--font-size--normal) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-huge-font-size{font-size: var(--wp--preset--font-size--huge) !important;}
</style>
<link rel='stylesheet' id='all-css-2-1' href='https://s0.wp.com/_static/??-eJx9i0EKgCAQAD+ULYJRHaK3qJhY666o0fezW126zcAMGNR09LaUDq4kLFN1VCGeIuHpAxXwjgWy1TUwfURsqEP+W7MzyL6hh1a99JnWuEg1zEpNo1T7DZLtMYQ=?cssminify=yes' type='text/css' media='all' />
<link rel='stylesheet' id='print-css-3-1' href='https://s2.wp.com/wp-content/mu-plugins/global-print/global-print.css?m=1465851035h&cssminify=yes' type='text/css' media='print' />
<style id='jetpack-global-styles-frontend-style-inline-css'>
:root { --font-headings: unset; --font-base: unset; --font-headings-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif; --font-base-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif;}
</style>
<link rel='stylesheet' id='all-css-6-1' href='https://s0.wp.com/wp-content/themes/h4/global.css?m=1420737423h&cssminify=yes' type='text/css' media='all' />
<script id='wpcom-actionbar-placeholder-js-extra'>
var actionbardata = {"siteID":"12777403","siteName":"Azimuth","siteURL":"http:\/\/johncarlosbaez.wordpress.com","siteHost":"johncarlosbaez.wordpress.com","icon":"<img alt='' src='https:\/\/s2.wp.com\/i\/logo\/wpcom-gray-white.png' class='avatar avatar-50' height='50' width='50' \/>","canManageOptions":"","canCustomizeSite":"","isFollowing":"","themeSlug":"pub\/contempt","signupURL":"https:\/\/wordpress.com\/start\/","loginURL":"https:\/\/wordpress.com\/log-in?redirect_to=https%3A%2F%2Fjohncarlosbaez.wordpress.com%2F2012%2F09%2F18%2Fa-course-on-quantum-techniques-for-stochastic-mechanics%2F&signup_flow=account","themeURL":"","xhrURL":"https:\/\/johncarlosbaez.wordpress.com\/wp-admin\/admin-ajax.php","nonce":"e6f6fdfb46","isSingular":"","isFolded":"","isLoggedIn":"","isMobile":"","subscribeNonce":"<input type=\"hidden\" id=\"_wpnonce\" name=\"_wpnonce\" value=\"ffcb185558\" \/>","referer":"https:\/\/johncarlosbaez.wordpress.com\/category\/mathematics\/page\/41\/","canFollow":"1","feedID":"62242","statusMessage":"","subsEmailDefault":"instantly","customizeLink":"https:\/\/johncarlosbaez.wordpress.com\/wp-admin\/customize.php?url=https%3A%2F%2Fjohncarlosbaez.wordpress.com%2Fcategory%2Fmathematics%2Fpage%2F41%2F","i18n":{"view":"View site","follow":"Follow","following":"Following","edit":"Edit","login":"Log in","signup":"Sign up","customize":"Customize","report":"Report this content","themeInfo":"Get theme: Contempt","shortlink":"Copy shortlink","copied":"Copied","followedText":"New posts from this site will now appear in your <a href=\"https:\/\/wordpress.com\/read\">Reader<\/a>","foldBar":"Collapse this bar","unfoldBar":"Expand this bar","editSubs":"Manage subscriptions","viewReader":"View site in Reader","viewReadPost":"View post in Reader","subscribe":"Sign me up","enterEmail":"Enter your email address","followers":"Join 5,211 other followers","alreadyUser":"Already have a WordPress.com account? <a href=\"https:\/\/wordpress.com\/log-in?redirect_to=https%3A%2F%2Fjohncarlosbaez.wordpress.com%2F2012%2F09%2F18%2Fa-course-on-quantum-techniques-for-stochastic-mechanics%2F&signup_flow=account\">Log in now.<\/a>","stats":"Stats","notifyNewPosts":"Notify me of new posts","notifyNewPostsDetails":"Receive web and mobile notifications for new posts from this site.","emailNewPosts":"Email me new posts","emailNewPostsDetails":"You can customize your notification settings further <a href=\"https:\/\/wordpress.com\/following\/manage?s=johncarlosbaez.wordpress.com\">here<\/a>.","emailNewComments":"Email me new comments","instantly":"Instantly","daily":"Daily","weekly":"Weekly"}};
</script>
<script crossorigin='anonymous' type='text/javascript' src='https://s2.wp.com/_static/??-eJyFykEKwkAMQNELmQ4qtboQz1LbWDJMknGSQXt7K9SFILj6i//CI8Og4igeooWs5oxm/YRNtE34vqxXSgjVsCxAHEhu+sOV5JCLPufPIxlSHdHeM94rlnlNwyR/ETBNpXdc8YXP28OuOx3brt3HF3swRvU='></script>
<script type='text/javascript'>
	window.addEventListener( 'DOMContentLoaded', function() {
		rltInitialize( {"token":null,"iframeOrigins":["https:\/\/widgets.wp.com"]} );
	} );
</script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://johncarlosbaez.wordpress.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://s1.wp.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress.com" />

<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="website" />
<meta property="og:title" content="mathematics &#8211; Page 41 &#8211; Azimuth" />
<meta property="og:url" content="https://johncarlosbaez.wordpress.com/category/mathematics/" />
<meta property="og:site_name" content="Azimuth" />
<meta property="og:image" content="https://s0.wp.com/i/blank.jpg" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:site" content="@wordpressdotcom" />
<meta property="fb:app_id" content="249643311490" />

<!-- End Jetpack Open Graph Tags -->
<link rel="shortcut icon" type="image/x-icon" href="https://s1.wp.com/i/favicon.ico" sizes="16x16 24x24 32x32 48x48" />
<link rel="icon" type="image/x-icon" href="https://s1.wp.com/i/favicon.ico" sizes="16x16 24x24 32x32 48x48" />
<link rel="apple-touch-icon" href="https://s2.wp.com/i/webclip.png" />
<link rel='openid.server' href='https://johncarlosbaez.wordpress.com/?openidserver=1' />
<link rel='openid.delegate' href='https://johncarlosbaez.wordpress.com/' />
<link rel="search" type="application/opensearchdescription+xml" href="https://johncarlosbaez.wordpress.com/osd.xml" title="Azimuth" />
<link rel="search" type="application/opensearchdescription+xml" href="https://s1.wp.com/opensearch.xml" title="WordPress.com" />
<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>		<style type="text/css">
			.recentcomments a {
				display: inline !important;
				padding: 0 !important;
				margin: 0 !important;
			}

			table.recentcommentsavatartop img.avatar, table.recentcommentsavatarend img.avatar {
				border: 0px;
				margin: 0;
			}

			table.recentcommentsavatartop a, table.recentcommentsavatarend a {
				border: 0px !important;
				background-color: transparent !important;
			}

			td.recentcommentsavatarend, td.recentcommentsavatartop {
				padding: 0px 0px 1px 0px;
				margin: 0px;
			}

			td.recentcommentstextend {
				border: none !important;
				padding: 0px 0px 2px 10px;
			}

			.rtl td.recentcommentstextend {
				padding: 0px 10px 2px 0px;
			}

			td.recentcommentstexttop {
				border: none;
				padding: 0px 0px 0px 10px;
			}

			.rtl td.recentcommentstexttop {
				padding: 0px 10px 0px 0px;
			}
		</style>
		<meta name="application-name" content="Azimuth" /><meta name="msapplication-window" content="width=device-width;height=device-height" /><meta name="msapplication-task" content="name=Subscribe;action-uri=https://johncarlosbaez.wordpress.com/feed/;icon-uri=https://s1.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=Sign up for a free blog;action-uri=http://wordpress.com/signup/;icon-uri=https://s1.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=WordPress.com Support;action-uri=http://support.wordpress.com/;icon-uri=https://s1.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=WordPress.com Forums;action-uri=http://forums.wordpress.com/;icon-uri=https://s1.wp.com/i/favicon.ico" /><meta name="description" content="Posts about mathematics written by John Baez" />
<style type="text/css">
#headerimg{
	background: url(https://johncarlosbaez.files.wordpress.com/2010/08/azimuth_header.jpg) no-repeat;
}
#header h1 a, .description {
	color:#E5F2E9;
}
</style>
<!-- There is no amphtml version available for this URL. -->		<link rel="stylesheet" id="custom-css-css" type="text/css" href="https://s0.wp.com/?custom-css=1&#038;csblog=RBZ9&#038;cscache=6&#038;csrev=7" />
		</head>
<body class="archive paged category category-mathematics category-3582 paged-41 category-paged-41 customizer-styles-applied highlander-enabled highlander-light">

<div id="page">

<div id="header">
	<div id="headerimg" onclick="location.href='https://johncarlosbaez.wordpress.com';" style="cursor: pointer;">
		<h1><a href="https://johncarlosbaez.wordpress.com/">Azimuth</a></h1>
		<div class="description"></div>
	</div>
</div>

<ul id="pagebar" class="menu pagebar"><li ><a href="https://johncarlosbaez.wordpress.com/">Home</a></li><li class="page_item page-item-2"><a href="https://johncarlosbaez.wordpress.com/about/">About</a></li>
</ul>

<div id="grad" style="height: 65px; width: 100%; background: url(https://s2.wp.com/wp-content/themes/pub/contempt/images/blue_flower/topgrad.jpg);">&nbsp;</div>

	<div id="content">

	
		
			<div class="post-12243 post type-post status-publish format-standard hentry category-chemistry category-mathematics category-networks category-physics" id="post-12243">
				<h2><a href="https://johncarlosbaez.wordpress.com/2012/09/18/a-course-on-quantum-techniques-for-stochastic-mechanics/" rel="bookmark">A Course on Quantum Techniques for Stochastic&nbsp;Mechanics</a></h2>
				<small>18 September, 2012</small><br />


				<div class="entry">
					<p>Jacob Biamonte and I have come out with a draft of a book!</p>
<p>&bull; <a href="http://arxiv.org/abs/1209.3632">A course on quantum techniques for stochastic mechanics</a>.</p>
<p>It&#8217;s based on the first 24 <a href="http://math.ucr.edu/home/baez/networks/">network theory</a> posts on this blog.    It owes a lot to everyone here, and the acknowledgements just scratch the surface of that indebtedness.  At some later time I&#8217;d like to go through the posts and find the top twenty people who need to be thanked.  But I&#8217;m leaving Singapore on Friday, going back to California to teach at U.C. Riverside, so I&#8217;ve been rushing to get something out before then.</p>
<p>If you see typos or other problems, please let us know!<br />
We&#8217;ve reorganized the original blog articles and polished them up a bit, but we plan to do more before publishing these notes as a book.  </p>
<p>I&#8217;m looking forward to teaching a seminar called <i>Mathematics of the Environment</i> when I get back to U.C. Riverside, and with luck I&#8217;ll put some notes from that on the blog here.  I will also be trying to round up a team of grad students to work on network theory. </p>
<p>The next big topics in the network theory series will be electrical circuits and Bayesian networks.  I&#8217;m beginning to see how these fit together with stochastic Petri nets in a unified framework, but I&#8217;ll need to talk and write about it to fill in all the details.</p>
<p>You can get a sense of what this course is about by reading this:</p>
<h3> Foreword </h3>
<p>This course is about a curious relation between two ways of describing situations that change randomly with the passage of time.  The old way is <i>probability theory</i> and the new way is <i>quantum theory</i></p>
<p>Quantum theory is based, not on probabilities, but on amplitudes.  We can use amplitudes to compute probabilities.  However, the relation between them is nonlinear: we take the absolute value of an amplitude and square it to get a probability.  It thus seems odd to treat amplitudes as directly analogous to probabilities.  Nonetheless, if we do this, some good things happen.  In particular, we can take techniques devised in quantum theory and apply them to probability theory.  This gives new insights into old problems.   </p>
<p>There is, in fact, a subject eager to be born, which is mathematically very much like quantum mechanics, but which features probabilities in the same equations where quantum mechanics features amplitudes.  We call this subject <b>stochastic mechanics</b></p>
<h4> Plan of the course </h4>
<div align="center"><img width="440" src="https://i2.wp.com/math.ucr.edu/home/baez/networks/chemistryNetBasicA.png" /></div>
<p>In Section 1 we introduce the basic object of study here: a &#8216;stochastic Petri net&#8217;.  A stochastic Petri net describes in a very general way how collections of things of different kinds can randomly interact and turn into other things.  If we consider large numbers of things, we obtain a simplified deterministic model called the &#8216;rate equation&#8217;, discussed in Section 2.  More fundamental, however, is the &#8216;master equation&#8217;, introduced in Section 3.  This describes how the probability of having various numbers of things of various kinds changes with time.  </p>
<p>In Section 4 we consider a very simple stochastic Petri net and notice that in this case, we can solve the master equation using techniques taken from quantum mechanics.   In Section 5 we sketch how to generalize this: for any stochastic Petri net, we can write down an operator called a &#8216;Hamiltonian&#8217; built from &#8216;creation and annihilation operators&#8217;, which describes the rate of change of the probability of having various numbers of things.  In Section 6 we illustrate this with an example taken from population biology.  In this example the rate equation is just the logistic equation, one of the simplest models in population biology.  The master equation describes reproduction and competition of organisms in a stochastic way.</p>
<div align="center"><img width="300" src="https://i2.wp.com/math.ucr.edu/home/baez/networks/feynman-diagram.png" /></div>
<p>In Section 7 we sketch how time evolution as described by the master equation can be written as a sum over Feynman diagrams.  We do not develop this in detail, but illustrate it with a predator&#8211;prey model from population biology.  In the process, we give a slicker way of writing down the Hamiltonian for any stochastic Petri net.</p>
<div align="center"><img width="440" src="https://i2.wp.com/math.ucr.edu/home/baez/networks/wolf-rabbit.png" /></div>
<p>In Section 8 we enter into a main theme of this course: the study of <i>equilibrium solutions</i> of the master and rate equations.  We present the Anderson&#8211;Craciun&#8211;Kurtz theorem, which shows how to get equilibrium solutions of the master equation from equilibrium solutions of the rate equation, at least if a certain technical condition holds.  Brendan Fong has translated Anderson, Craciun and Kurtz&#8217;s original proof into the language of annihilation and creation operators, and we give Fong&#8217;s proof here.  In this language, it turns out that the equilibrium solutions are mathematically just like &#8216;coherent states&#8217; in quantum mechanics.   </p>
<p>In Section 9 we give an example of the Anderson&#8211;Craciun&#8211;Kurtz theorem coming from a simple reversible reaction in chemistry.  This example leads to a puzzle that is resolved by discovering that the presence of &#8216;conserved quantities&#8217;&#8212;quantities that do not change with time&#8212;let us construct many equilibrium solutions of the rate equation other than those given by the Anderson&#8211;Craciun&#8211;Kurtz theorem.   </p>
<p>Conserved quantities are very important in quantum mechanics, and they are related to symmetries by a result called Noether&#8217;s theorem.  In Section 10 we describe a version of Noether&#8217;s theorem for stochastic mechanics, which we proved with the help of Brendan Fong.   This applies, not just to systems described by stochastic Petri nets, but a much more general class of processes called &#8216;Markov processes&#8217;.  In the analogy to quantum mechanics, Markov processes are analogous to arbitrary quantum systems whose time evolution is given by a Hamiltonian.  Stochastic Petri nets are analogous to a special case of these: the case where the Hamiltonian is built from annihilation and creation operators.  In Section 11 we state the analogy between quantum mechanics and stochastic mechanics more precisely, and with more attention to mathematical rigor.  This allows us to set the quantum and stochastic versions of Noether&#8217;s theorem side by side and compare them in Section 12.</p>
<div align="center"><img width="440" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/pseudorotation.png" /></div>
<p>In Section 13 we take a break from the heavy abstractions and look at a fun example from chemistry, in which a highly symmetrical molecule randomly hops between states.  These states can be seen as vertices of a graph, with the transitions as edges.  In this particular example we get a famous graph with 20 vertices and 30 edges, called the &#8216;Desargues graph&#8217;.  </p>
<div align="center"><img src="https://i2.wp.com/math.ucr.edu/home/baez/networks/300px-Desargues_graph_2COL.svg.png" /></div>
<p>In Section 14 we note that the Hamiltonian in this example is a &#8216;graph Laplacian&#8217;, and, following a computation done by Greg Egan, we work out the eigenvectors and eigenvalues of this Hamiltonian explicitly.  One reason graph Laplacians are interesting is that we can use them as Hamiltonians to describe time evolution in <i>both</i> stochastic <i>and</i> quantum mechanics.  Operators with this special property are called &#8216;Dirichlet operators&#8217;, and we discuss them in Section 15.   As we explain, they also describe electrical circuits made of resistors.    Thus, in a peculiar way, the intersection of quantum mechanics and stochastic mechanics is the study of electrical circuits made of resistors!</p>
<div align="center"><img width="440" src="https://i0.wp.com/math.ucr.edu/home/baez/networks/quantum-vs-probability-theory-IV.png" /></div>
<p>In Section 16, we study the eigenvectors and eigenvalues of an arbitrary Dirichlet operator.  We introduce a famous result called the Perron&#8211;Frobenius theorem for this purpose.   However, we also see that the Perron&#8211;Frobenius theorem is important for understanding the equilibria of Markov processes.   This becomes important later when we prove the &#8216;deficiency zero theorem&#8217;.</p>
<p>We introduce the deficiency zero theorem in Section 17.  This result, proved by the chemists Feinberg, Horn and Jackson, gives equilibrium solutions for the rate equation for a large class of stochastic Petri nets.  Moreover, these equilibria obey the extra condition that lets us apply the Anderson&#8211;Craciun&#8211;Kurtz theorem and obtain equlibrium solutions of the master equations as well.  However, the deficiency zero theorem is best stated, not in terms of stochastic Petri nets, but in terms of another, equivalent, formalism: &#8216;chemical reaction networks&#8217;.  So, we explain chemical reaction networks here, and use them heavily throughout the rest of the course.  However, because they are applicable to such a large range of problems, we call them simply &#8216;reaction networks&#8217;.    Like stochastic Petri nets, they describe  how collections of things of different kinds randomly interact and turn into other things.</p>
<div align="center"><img width="200" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/chemical_reaction_network_part_20_VII.png" /></div>
<p>In Section 18 we consider a simple example of the deficiency zero theorem taken from chemistry: a diatomic gas.   In Section 19 we apply the Anderson&#8211;Craciun&#8211;Kurtz theorem to the same example.</p>
<div align="center"><img src="https://i1.wp.com/math.ucr.edu/home/baez/networks/iodine.jpg" /></div>
<p>In Section 20 we begin the final phase of the course: proving the deficiency zero theorem, or at least a portion of it.  In this section we discuss the concept of &#8216;deficiency&#8217;, which had been introduced before, but not really explained: the definition that makes the deficiency easy to compute is not the one that says what this concept really means.  In Section 21 we show how to rewrite the rate equation of a stochastic Petri net&#8212;or equivalently, of a reaction network&#8212;in terms of a Markov process.  This is surprising because the rate equation is nonlinear, while the equation describing a Markov process is linear in the probabilities involved.  The trick is to use a nonlinear operation called &#8216;matrix exponentiation&#8217;.  In Section 22 we study equilibria for Markov processes.  Then, finally, in Section 23, we use these equilbria to obtain equilibrium solutions of the rate equation, completing our treatment of the deficiency zero theorem.</p>
<div align="center"><img width="200" src="https://i2.wp.com/math.ucr.edu/home/baez/networks/markov_process_vs_reaction_network_5.png" /></div>
									</div>

				<p class="postmetadata">
				<img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/speech_bubble.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2012/09/18/a-course-on-quantum-techniques-for-stochastic-mechanics/#comments">19 Comments</a>				| <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/documents.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/category/chemistry/" rel="category tag">chemistry</a>, <a href="https://johncarlosbaez.wordpress.com/category/mathematics/" rel="category tag">mathematics</a>, <a href="https://johncarlosbaez.wordpress.com/category/networks/" rel="category tag">networks</a>, <a href="https://johncarlosbaez.wordpress.com/category/physics/" rel="category tag">physics</a>								 | <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/permalink.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2012/09/18/a-course-on-quantum-techniques-for-stochastic-mechanics/" rel="bookmark" title="Permanent Link to A Course on Quantum Techniques for Stochastic&nbsp;Mechanics">Permalink</a>
<br /><img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/figure_ver1.gif" alt="" /> Posted by John Baez				</p>
			</div>
			<hr />
		
			<div class="post-12048 post type-post status-publish format-standard hentry category-astronomy category-mathematics" id="post-12048">
				<h2><a href="https://johncarlosbaez.wordpress.com/2012/09/11/rolling-circles-and-balls-part-3/" rel="bookmark">Rolling Circles and Balls (Part&nbsp;3)</a></h2>
				<small>11 September, 2012</small><br />


				<div class="entry">
					<p>In <a href="https://johncarlosbaez.wordpress.com/2012/08/31/rolling-circles-and-balls-part-1/">Part 1</a> and <a href="https://johncarlosbaez.wordpress.com/2012/09/03/rolling-balls-and-circles-part-2/">Part 2</a> we looked at the delightful curves you get by rolling one circle on another.    Now let&#8217;s see what happens when you roll one circle <i>inside</i> another!</p>
<h3>  Four times as big </h3>
<p>If you roll a circle inside a circle that&#8217;s 4 times as big, we get an <a href="http://en.wikipedia.org/wiki/Astroid"><b>astroid</b></a>:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Astroid"><img width="400" src="https://i0.wp.com/math.ucr.edu/home/baez/mathematical/astroid_animation.gif" /></a></div>
<p><b>Puzzle 1.</b> How many times does the rolling circle turn as it rolls all the way around?</p>
<p>By the way: don&#8217;t confuse an astroid with an asteroid.  They both got their names because someone thought they looked like stars, but that&#8217;s where resemblance ends!</p>
<p>You can get an astroid using this funny parody of the equation for a circle:</p>
<p><img src="https://s0.wp.com/latex.php?latex=x%5E%7B2%2F3%7D+%2B+y%5E%7B2%2F3%7D+%3D+1&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x^{2/3} + y^{2/3} = 1" class="latex" /></p>
<p>Or, if you don&#8217;t like equations, you can get a quarter of an astroid by letting a ladder slide down a wall and taking a time-lapse photo!  </p>
<div align="center"><a href="http://mathforum.org/mathimages/index.php/Envelope"><img src="https://i2.wp.com/math.ucr.edu/home/baez/mathematical/astroid_as_envelope_animation.gif" /></a></div>
<p>In other words, you get a whole astroid by taking the envelope of all line segments of length 1 going from some point on the x axis to some point on the y axis!</p>
<div align="center"><a href=""><img src="https://i0.wp.com/math.ucr.edu/home/baez/mathematical/astroid_as_envelope.png" /></a></div>
<h3> Three times as big </h3>
<p>If the fixed circle is just 3 times as big as the one rolling inside it, we get an <a href="http://en.wikipedia.org/wiki/Deltoid"><b>deltoid</b></a>:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Deltoid"><img width="400" src="https://i0.wp.com/math.ucr.edu/home/baez/mathematical/deltoid_animation.gif" /></a></div>
<p><b>Puzzle 2.</b> Now how many times does the rolling circle turn as it rolls all the way around?</p>
<p>By the way: it looks like we&#8217;re back to naming curves after body parts&#8230; but we&#8217;re not: both this curve and the muscle called a deltoid got their names because they look like the Greek letter delta:</p>
<div align="center">
<img src="https://i2.wp.com/math.ucr.edu/home/baez/mathematical/delta.gif" /></div>
<p><b>Puzzle 3.</b>  Did the Greek letter delta get that name because it was shaped like a river delta, or was it the other way around?</p>
<p>As you might almost expect by now, if you&#8217;ve been reading this whole series, there are weird relations between the deltoid and the astroid.  </p>
<p>For example: take a deltoid and shine parallel rays of light at it from <i>any direction</i>.  Then the envelope of these rays is an astroid!</p>
<div align="center"><a href="http://xahlee.info/SpecialPlaneCurves_dir/Deltoid_dir/deltoid.html"><br />
<img src="https://i1.wp.com/math.ucr.edu/home/baez/mathematical/astroid_as_caustic.png" /></a></div>
<p>We summarize this by saying that the astroid is a <a href="http://mathworld.wolfram.com/Catacaustic.html"><b>catacaustic</b></a> of the deltoid.  This picture is by <a href="http://xahlee.info/SpecialPlaneCurves_dir/Deltoid_dir/deltoid.html">Xah Lee</a>, who has also made a nice movie of what happens as you rotate the light source:</p>
<p>&bull; Xah Lee, <a href="http://xahlee.info/SpecialPlaneCurves_dir/Deltoid_dir/deltoidCaustic.mov">Deltoid catacaustic movie</a>.</p>
<p>I don&#8217;t completelly understand the rays going <i>through</i> the deltoid, in either the picture or the movie.  It looks like those rays are getting refracted, but that would be a <b>diacaustic</b>, not a catacaustic.  ,I think they&#8217;re formed by continuing reflected rays to straight lines that go through the deltoid.  If you didn&#8217;t do that you wouldn&#8217;t get a whole astroid, just part of one.</p>
<p>Anyway, at the very least you get part of an astroid, which you can complete to a whole one.  And then, as you rotate the light source, the astroid you get rolls around the deltoid in a pleasant manner!  This is nicely illustrated here:</p>
<p>&bull; <a href="http://mathworld.wolfram.com/DeltoidCatacaustic.html">Deltoid catacaustic</a>, Wolfram Mathworld.</p>
<p>You can also get a deltoid from a deltoid!  Draw all the <a href="http://en.wikipedia.org/wiki/Osculating_circle">osculating circles</a> of the deltoid&#8212;that is, circles that  match the deltoid&#8217;s curvature as well as its slope at the points they touch. The centers of these circles lie on another, larger deltoid:  </p>
<div align="center"><a href="http://xahlee.info/SpecialPlaneCurves_dir/Deltoid_dir/deltoid.html"><img src="https://i0.wp.com/math.ucr.edu/home/baez/mathematical/deltoid_as_evolute.png" /></a></div>
<p>We summarize this by saying that the <a href="http://en.wikipedia.org/wiki/Evolute"><b>evolute</b></a> of a deltoid is another deltoid.</p>
<p>There are also fancier ways to get deltoids if you know more math.  For example, the set of <a href="http://en.wikipedia.org/wiki/Trace_%28linear_algebra%29">traces</a> of matrices lying in the group <a href="http://en.wikipedia.org/wiki/Special_unitary_group">SU(3)</a> forms a filled-in deltoid in the complex plane!</p>
<p>This raises a question which unfortunately I&#8217;m too lazy to answer myself.  So, I&#8217;ll just pose it as a puzzle:</p>
<p><b>Puzzle 4.</b>  Is the set of traces of matrices lying in SU(4) a filled-in astroid?  In simpler terms, consider the values of <img src="https://s0.wp.com/latex.php?latex=a+%2B+b+%2B+c+%2B+d&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="a + b + c + d" class="latex" /> that we can get from complex numbers <img src="https://s0.wp.com/latex.php?latex=a%2Cb%2Cc%2Cd&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="a,b,c,d" class="latex" /> with <img src="https://s0.wp.com/latex.php?latex=%7Ca%7C+%3D+%7Cb%7C+%3D+%7Cc%7C+%3D+%7Cd%7C+%3D+1&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="|a| = |b| = |c| = |d| = 1" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=abcd+%3D+1.+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="abcd = 1. " class="latex" />  Do these values form a filled-in astroid?  </p>
<h3> Twice as big </h3>
<p>But now comes the climax of today&#8217;s story: what happens when we let a circle roll inside a circle that&#8217;s exactly <i>twice</i> as big?   </p>
<div align="center">
<img src="https://i2.wp.com/math.ucr.edu/home/baez/mathematical/tusi_couple_animation.gif" /></div>
<p>Now you can see the rolling circle turn around <i>once</i> as it rolls all the way around the big one.  </p>
<p>More excitingly, if we track a point on the rolling circle, <i>it traces out a straight line!</i>  Can you see why?  Later I&#8217;ll give a few proofs.</p>
<p>This gadget is called a <a href="http://en.wikipedia.org/wiki/Tusi-couple"><b>Tusi couple</b></a>.  You could use it to convert a rolling motion into a vibrating one using some gears.   Greg Egan made a nice animation showing how:</p>
<div align="center">
<img src="https://i0.wp.com/math.ucr.edu/home/baez/mathematical/tusi_gears_animation.gif" /></div>
<p>The Tusi couple is named after the Persian astronomer and mathematician <a href="http://en.wikipedia.org/wiki/Nasir_al-Din_al-Tusi">Nasir al-Din al-Tusi</a>, who discovered it around 1247, when he wrote a commentary on Ptomely&#8217;s <i>Almagest</i>, an important astronomical text:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Nasir_al-Din_al-Tusi"><img src="https://i0.wp.com/math.ucr.edu/home/baez/mathematical/tusi_book.jpg" /></a></div>
<p>He wrote:</p>
<blockquote><p>
If two coplanar circles, the diameter of one of which is equal to half the diameter of the other, are taken to be internally tangent at a point, and if a point is taken on the smaller circle&#8212;and let it be at the point of tangency&#8212;and if the two circles move with simple motions in opposite direction in such a way that the motion of the smaller is twice that of the larger so the smaller completes two rotations for each rotation of the larger, then that point will be seen to move on the diameter of the larger circle that initially passes through the point of tangency, oscillating between the endpoints.
</p></blockquote>
<p>I don&#8217;t quite understand why he was interested in this, but it has something to do with using epicycles to build linear motion out of circular motion.    It also has something to do with the apparent motion of planets between the Earth and the Sun.  </p>
<p>Later Copernicus also studied the Tusi couple.  He proved that the moving point really did trace out a straight line:</p>
<div align="center"><a href="http://www.columbia.edu/~gas1/project/visions/case1/sci.1.html"><img width="400" src="https://i1.wp.com/math.ucr.edu/home/baez/mathematical/tusi_copernicus_book.jpg" /></a></div>
<p>However, many suspect that this was not a true rediscovery: al-Tusi had also proved this, and some aspects of Copernicus&#8217; proof seem too similar to al-Tusi&#8217;s to be coincidence:</p>
<p>&bull; George Saaliba, <a href="http://www.columbia.edu/~gas1/project/visions/case1/sci.1.html">Whose science is Arabic science in Renaissance Europe?</a>, Section 2: <a href="http://www.columbia.edu/~gas1/project/visions/case1/sci.2.html">Arabic/Islamic science and the Renaissance science in Italy</a>.</p>
<p>&bull; I. N. Veselovsky, <a href="http://articles.adsabs.harvard.edu/full/seri/JHA../0004//0000129.000.html">Copernicus and Nasir al-Din al-Tusi</a>, <i>Journal for the History of Astronomy</i> <b>4</b> (1973), 128&#8211;130.</p>
<p>In fact, the Tusi couple goes back way before al-Tusi.   It was known to Proclus back around 450 AD!  Apparently he wrote about it in his <i>Commentary on the First Book of Euclid</i>.  Proclus is mainly famous as a philosopher: people think of him as bringing neo-Platonism to its most refined heights.   Given that, it&#8217;s no surprise that he also liked math.  Indeed, he said:</p>
<blockquote><p>
Wherever there is number, there is beauty.
</p></blockquote>
<p>And of course this is what I&#8217;ve been trying to show you throughout this series.</p>
<h3> Why the Tusi couple works </h3>
<p>So, here are three proofs that a Tusi couple really does trace out a straight line.  I posed this as a puzzle on Google+, and here are my favorite three answers.  I like them because they&#8217;re very different.  Since people have thought about Tusi couples since 450 AD, I doubt any of these proofs are original to the people I&#8217;m mentioning here!  Still, they deserve credit.</p>
<p>The first, due to Omar Antol&iacute;n Camarena, is in the style of traditional Euclidean geometry.  </p>
<p>Let O be the center of the big circle.  Let A be the position of the traced point at the instant t when it&#8217;s the point of tangency between the circles, let B be its position at some future time t′ and let C be the point of tangency at that same time t′.   Let X be the center of the small circle at that future time t′.</p>
<div align="center"><img width="280" src="https://i2.wp.com/math.ucr.edu/home/baez/mathematical/tusi_couple_proof.png" /></div>
<p>We want to prove A, B and O lie on a line.  To do this, it suffices to show that the angle AOC equals the angle BOC:</p>
<p>Want: ∠BOC = ∠AOC</p>
<p>The arc AC of the big circle has the same length as the arc BC of the small circle, since they are both the distance rolled between times t and t′.  But the big circle is twice as, so the angle BXC on the little circle must be twice the angle AOC on the big circle:  </p>
<p>Know: ∠BXC = 2 ∠AOC</p>
<p>But it&#8217;s a <a href="http://aleph0.clarku.edu/~djoyce/java/elements/bookIII/propIII20.html">famous fact</a> in Euclidean geometry that the angle BXC is twice the angle BOC:</p>
<p>Know: ∠BXC = 2 ∠BOC</p>
<p>From the two equations we know, the one we want follows!</p>
<p>Here&#8217;s the proof of that &#8216;famous fact&#8217;, in case you forgot it:</p>
<div align="center"><img width="280" src="https://i2.wp.com/math.ucr.edu/home/baez/mathematical/tusi_couple_proof_2.png" /></div>
<p>The second proof is due to Greg Egan.  He distilled it down to a moving picture:</p>
<div align="center">
<img src="https://i1.wp.com/math.ucr.edu/home/baez/mathematical/tusi_couple_animation_egan.gif" /></div>
<p>It&#8217;s a &#8216;proof without words&#8217;, so you may need to think a while to see how it shows that the Tusi couple traces out a straight line.</p>
<p>The third proof is due to Boris Borcic.  It uses complex numbers.   Let the big circle be the unit circle in the complex plane.  Then the point of contact between the rolling circle and the big one is:</p>
<p><img src="https://s0.wp.com/latex.php?latex=e%5E%7Bi+t%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="e^{i t}" class="latex" /></p>
<p>so the center of the rolling circle is:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Be%5E%7Bit%7D%7D%7B2%7D+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{e^{it}}{2} } " class="latex" /></p>
<p>Since the rolling circle turns around once clockwise as it rolls around the big one, the point whose motion we&#8217;re tracking here:</p>
<div align="center">
<img width="150" src="https://i2.wp.com/math.ucr.edu/home/baez/mathematical/tusi_couple_animation.gif" /></div>
<p>is equal to:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Be%5E%7Bit%7D%7D%7B2%7D+%2B+%5Cfrac%7Be%5E%7Bi%28%5Cpi+-+t%29%7D%7D%7B2%7D+%3D++%5Cfrac%7Be%5E%7Bi+t%7D+-+e%5E%7B-i+t%7D%7D%7B2%7D++%3D+i+%5Csin+t+%3D++i+%5C%3B+%5Cmathrm%7BIm%7D%28e%5E%7Bit%7D%29+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{e^{it}}{2} + &#92;frac{e^{i(&#92;pi - t)}}{2} =  &#92;frac{e^{i t} - e^{-i t}}{2}  = i &#92;sin t =  i &#92;; &#92;mathrm{Im}(e^{it}) } " class="latex" /></p>
<p>So, this point moves up and down along a vertical line, and its height equals the height of the point of contact, <img src="https://s0.wp.com/latex.php?latex=e%5E%7Bit%7D.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="e^{it}." class="latex" /></p>
<p>But the same sort of argument shows that if we track the motion of the <i>opposite</i> point on the rolling circle, it<br />
equals:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Be%5E%7Bit%7D%7D%7B2%7D+-+%5Cfrac%7Be%5E%7Bi%28%5Cpi+-+t%29%7D%7D%7B2%7D+%3D++%5Cfrac%7Be%5E%7Bi+t%7D+%2B+e%5E%7B-i+t%7D%7D%7B2%7D++%3D++%5Ccos+t+%3D+++%5Cmathrm%7BRe%7D%28e%5E%7Bit%7D%29+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{e^{it}}{2} - &#92;frac{e^{i(&#92;pi - t)}}{2} =  &#92;frac{e^{i t} + e^{-i t}}{2}  =  &#92;cos t =   &#92;mathrm{Re}(e^{it}) } " class="latex" /></p>
<p>So, this opposite point moves back and forth along a <i>horizontal</i> straight line&#8230; and its <i>horizontal</i> coordinate equals that of the point of contact!   </p>
<p>You can see all this clearly in the animation Borcic made:</p>
<div align="center">
<img src="https://i0.wp.com/math.ucr.edu/home/baez/mathematical/tusi_couple_animation_borcic.gif" /></div>
<p>The point of contact, the tip of red arrowhead, is <img src="https://s0.wp.com/latex.php?latex=e%5E%7Bit%7D.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="e^{it}." class="latex" />   The two opposite points on the rolling circle are <img src="https://s0.wp.com/latex.php?latex=%5Ccos+t&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;cos t" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=i+%5Csin+t.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i &#92;sin t." class="latex" />  So, the rectangle here illustrates the fact that</p>
<p><img src="https://s0.wp.com/latex.php?latex=e%5E%7Bit%7D+%3D+%5Ccos+t+%2B+i+%5Csin+t&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="e^{it} = &#92;cos t + i &#92;sin t" class="latex" /></p>
<p>It&#8217;s interesting that this famous formula is hiding in the math of the Tusi couple!  But it shouldn&#8217;t be surprising, because the Tusi couple is all about building linear motion out of circular motion&#8230; or conversely, decomposing a circular motion into linear motions.</p>
<h3> Credits </h3>
<p>Few of these pictures were made by me, and none of the animations.  For most, you can see who created them by clicking on them.  The animation of the astroid and deltoid as envelopes come from here:</p>
<p>&bull; <a href="http://mathforum.org/mathimages/index.php/Envelope">Envelope</a>, Math Images Project.</p>
<p>where they were made available under a <a href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License</a>.  Here&#8217;s another animation from there:</p>
<div align="center"><a href="http://mathforum.org/mathimages/index.php/Envelope#2._A_Deltoid_as_the_envelope_of_Wallace-Simson_lines"><img width="455" src="https://i0.wp.com/math.ucr.edu/home/baez/mathematical/deltoid_simson_lines_animation.gif" /></a></div>
<p>This is a way of creating a deltoid as the envelope of some lines called &#8216;Wallace-Simson lines&#8217;.  The definition of these lines is so baroque I didn&#8217;t dare tell it to you it earlier.   But if you&#8217;re so bored you&#8217;re actually reading these credits, you might enjoy this.  </p>
<p>Any triangle can be circumscribed by a circle.   If we take any point on this circle, say M, we can drop perpendicular<br />
lines from it to the triangle&#8217;s three sides, and get three points, say P, Q and R:</p>
<div align="center"><a href="http://mathforum.org/mathimages/index.php/Envelope#2._A_Deltoid_as_the_envelope_of_Wallace-Simson_lines"><img src="https://i2.wp.com/math.ucr.edu/home/baez/mathematical/deltoid_simson_line_1.png" /></a></div>
<p>Amazingly, these points lie on a line:</p>
<div align="center"><a href="http://mathforum.org/mathimages/index.php/Envelope#2._A_Deltoid_as_the_envelope_of_Wallace-Simson_lines"><img src="https://i0.wp.com/math.ucr.edu/home/baez/mathematical/deltoid_simson_line_2.png" /></a></div>
<p>This is the <a href="http://mathworld.wolfram.com/SimsonLine.html"><b>Wallace&#8211;Simson line</b></a> of M.  If we move the point M around the circle, we get lots of Wallace&#8211;Simson lines&#8230; and the envelope of these lines is a deltoid!</p>
<p>By the way: the Wallace&#8211;Simson line is named after <a href="http://en.wikipedia.org/wiki/William_Wallace_%28mathematician%29">William Wallace</a>, who wrote about it, and <a href="http://en.wikipedia.org/wiki/Robert_Simson">Robert Simson</a>, who didn&#8217;t.  Don&#8217;t confuse it with the <a href="http://en.wikipedia.org/wiki/Wallace_Line">Wallace line</a>!  That was discovered by <a href="http://en.wikipedia.org/wiki/Alfred_Russel_Wallace">Alfred Russel Wallace</a>.</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Wallace_Line"><img src="https://i2.wp.com/math.ucr.edu/home/baez/ecological/wallace_line.png" /></a></div>
									</div>

				<p class="postmetadata">
				<img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/speech_bubble.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2012/09/11/rolling-circles-and-balls-part-3/#comments">70 Comments</a>				| <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/documents.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/category/astronomy/" rel="category tag">astronomy</a>, <a href="https://johncarlosbaez.wordpress.com/category/mathematics/" rel="category tag">mathematics</a>								 | <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/permalink.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2012/09/11/rolling-circles-and-balls-part-3/" rel="bookmark" title="Permanent Link to Rolling Circles and Balls (Part&nbsp;3)">Permalink</a>
<br /><img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/figure_ver1.gif" alt="" /> Posted by John Baez				</p>
			</div>
			<hr />
		
			<div class="post-11137 post type-post status-publish format-standard hentry category-mathematics" id="post-11137">
				<h2><a href="https://johncarlosbaez.wordpress.com/2012/09/07/symmetry-and-the-fourth-dimension-part-7/" rel="bookmark">Symmetry and the Fourth Dimension (Part&nbsp;7)</a></h2>
				<small>7 September, 2012</small><br />


				<div class="entry">
					<p><a href="https://johncarlosbaez.wordpress.com/2012/08/11/symmetry-and-the-fourth-dimension-part-6/">Lately</a> I&#8217;ve been showing you what happens if you start with a Platonic solid and start chopping off its corners, more and more, until you get the dual Platonic solid.  There&#8217;s just one I haven&#8217;t done yet: the tetrahedron.</p>
<div align="center"><img src="https://i1.wp.com/math.ucr.edu/home/baez/mathematical/tetrahedron_spinning.gif" /></div>
<p>This is the simplest Platonic solid, so why did I wait and do this it last?  </p>
<p>Because the tetrahedron is <i>self-dual</i>.  Remember, the Coxeter diagram of this shape looks like this:</p>
<div align="center">
<b> V&#8212;3&#8212;E&#8212;3&#8212;F </b>
</div>
<p>And remember what this diagram means.  It means the tetrahedron has</p>
<p>&bull; 3 vertices and 3 edges touching each face,<br />
&bull; 3 edges and 3 faces touching each vertex.</p>
<p>When we take the dual of a solid, we</p>
<p>&bull; replace vertices by faces;<br />
&bull; replace edges by edges;<br />
&bull; replace faces by vertices.</p>
<p>So when we do this to the tetrahedron, we get back a tetrahedron! This &#8216;self-duality&#8217; is reflected in the symmetry of its Coxeter diagram.   If we switch the letters V and F, we get the same thing back&#8212;drawn backwards, but that doesn&#8217;t matter.</p>
<p>This self-duality also means that when we take a tetrahedron and keep cutting off the corners more and more deeply, we wind up where we started.  And in fact, when we reach the halfway point of this process, we start retracing our steps&#8230; going backwards!</p>
<p>Let&#8217;s see how it goes.  Remember, we have a system of diagrams for drawing the most important solids we meet along the way.</p>
<h3> Tetrahedron: <b> •&#8212;3&#8212;o&#8212;3&#8212;o </b></h3>
<p>We start with the <a href="http://en.wikipedia.org/wiki/Tetrahedron"><b>tetrahedron</b></a>:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Tetrahedron"><br />
<img width="300" src="https://i2.wp.com/math.ucr.edu/home/baez/mathematical/400px-tetrahedron.png" /></a></div>
<h3> Truncated tetrahedron: <b> •&#8212;3&#8212;•&#8212;3&#8212;o </b></h3>
<p>Then we get the <a href="http://en.wikipedia.org/wiki/Truncated_tetrahedron"><b>truncated tetrahedron</b></a>:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Truncated_tetrahedron"><br />
<img width="300" src="https://i1.wp.com/math.ucr.edu/home/baez/mathematical/400px-truncated_tetrahedron.png" /></a></div>
<h3> Octahedron: <b> o&#8212;3&#8212;•&#8212;3&#8212;o </b></h3>
<p>Then, halfway through, we get a shape we&#8217;ve seen before!  It&#8217;s our friend the <a href="http://en.wikipedia.org/wiki/Octahedron"><b>octahedron</b></a>:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Octahedron"><br />
<img width="300" src="https://i1.wp.com/math.ucr.edu/home/baez/mathematical/400px-rectified_tetrahedron.png" /></a></div>
<p>Like the other &#8216;halfway through&#8217; shapes we&#8217;ve seen&#8212;the cuboctahedron and icosidodecahedron&#8212;every edge of the octahedron lies on a great circle&#8217;s worth of edges:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Octahedron"><img width="100" src="https://i1.wp.com/math.ucr.edu/home/baez/mathematical/400px-rectified_tetrahedron.png" /></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://en.wikipedia.org/wiki/Cuboctahedron"><img width="100" src="https://i0.wp.com/math.ucr.edu/home/baez/mathematical/400px-cuboctahedron.png" /></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://en.wikipedia.org/wiki/Icosidodecahedron"><img width="100" src="https://i0.wp.com/math.ucr.edu/home/baez/mathematical/400px-icosidodecahedron.png" /></a></div>
<p><b>Puzzle 1.</b>  Why does it always work this way?  </p>
<p>I don&#8217;t actually know!  </p>
<h3> Truncated tetrahedron: <b> o&#8212;3&#8212;•&#8212;3&#8212;• </b></h3>
<p>Then we get back to the <a href="http://en.wikipedia.org/wiki/Truncated_tetrahedron"><b>truncated tetrahedron</b></a>:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Truncated_tetrahedron"><br />
<img width="300" src="https://i2.wp.com/math.ucr.edu/home/baez/mathematical/400px-bitruncated_tetrahedron.png" /></a></div>
<h3> Tetrahedron: <b> o&#8212;3&#8212;o&#8212;3&#8212;• </b></h3>
<p>At the end, we get back where we started&#8230; the <a href="http://en.wikipedia.org/wiki/tetrahedron"><b>tetrahedron</b></a>:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Tetrahedron"><br />
<img width="300" src="https://i0.wp.com/math.ucr.edu/home/baez/mathematical/400px-dual_tetrahedron.png" /></a></div>
<h3> Where are we? </h3>
<p>We&#8217;ve begun to explore the three great families of <a href="http://en.wikipedia.org/wiki/Semiregular_polyhedron">semiregular polyhedra</a>:</p>
<p>&bull; the tetrahedron family shown here, </p>
<p>&bull; the cube/octahedron family shown in <a href="https://johncarlosbaez.wordpress.com/2012/08/03/symmetry-and-the-fourth-dimension-part-5/">Part 5</a>, </p>
<p>&bull; and the dodecahedron/icosahedron family shown in <a href="https://johncarlosbaez.wordpress.com/2012/08/11/symmetry-and-the-fourth-dimension-part-6/">Part 6</a>.  </p>
<p>We&#8217;ve seen that for each family, we have a <a href="https://johncarlosbaez.wordpress.com/2012/05/21/symmetry-and-the-fourth-dimension-part-1/">Coxeter complex</a>, which is summarized by a <a href="https://johncarlosbaez.wordpress.com/2012/07/22/symmetry-and-the-fourth-dimension-part-3/">Coxeter diagram</a>.  By coloring the dots in this diagram either white or black, we get different polyhedra in our family.  </p>
<p>Our goal is to explore how this works in 4 dimensions.  It&#8217;s very similar, but much more rich!    We can still use Coxeter diagrams, but they&#8217;ll have four dots, so there will be more ways to label them, and we&#8217;ll get more shapes.  And, of course, we&#8217;ll have the fun of learning to visualize 4-dimensional shapes!</p>
<p>But before we can explore the 4d story, there&#8217;s a hole in the story so far, that I need to fill.  </p>
<p><b>Puzzle 2.</b> Can you guess what it is?  </p>
<p>Maybe you&#8217;ll see it if you look over our results so far.</p>
<h3> The tetrahedron family </h3>
<p>Here are the shapes related to the tetrahedron.  It has some repeats, because the tetrahedron is its own dual!  It also repeats some shapes we&#8217;ll see in other families.</p>
<div align="center">
<table border="2">
<tr>
<td> tetrahedron
</td>
<td> <img width="140" src="https://i2.wp.com/math.ucr.edu/home/baez/mathematical/400px-tetrahedron.png" />
</td>
<td> <b> •&#8212;3&#8212;o&#8212;3&#8212;o </b>
</td>
</tr>
<tr>
<td> truncated tetrahedron
</td>
<td>  <img width="140" src="https://i1.wp.com/math.ucr.edu/home/baez/mathematical/400px-truncated_tetrahedron.png" />  </td>
<td> <b> •&#8212;3&#8212;•&#8212;3&#8212;o</b>
</td>
</tr>
<tr>
<td> octahedron
</td>
<td>  <img width="140" src="https://i1.wp.com/math.ucr.edu/home/baez/mathematical/400px-rectified_tetrahedron.png" />  </td>
<td> <b> o&#8212;3&#8212;•&#8212;3&#8212;o</b>
</td>
</tr>
<tr>
<td> truncated tetrahedron
</td>
<td>  <img width="140" src="https://i2.wp.com/math.ucr.edu/home/baez/mathematical/400px-bitruncated_tetrahedron.png" />
</td>
<td> <b> o&#8212;3&#8212;•&#8212;3&#8212;•</b>
</td>
</tr>
<tr>
<td> tetrahedron
</td>
<td>  <img width="140" src="https://i0.wp.com/math.ucr.edu/home/baez/mathematical/400px-dual_tetrahedron.png" />  </td>
<td> <b> o&#8212;3&#8212;o&#8212;3&#8212;•</b>
</td>
</tr>
</table>
</div>
<p>And here&#8217;s the Coxeter complex that runs the show:</p>
<div align="center">
<img width="250" src="https://i1.wp.com/math.ucr.edu/home/baez/mathematical/coxeter_complex_tetrahedral.png" /></div>
<p>This has one right triangle for each element in the group that acts as symmetries of all these shapes.  This group has 24 elements, and it&#8217;s called the <a href="http://en.wikipedia.org/wiki/Tetrahedral_symmetry">tetrahedral finite reflection group</a>, or A<sub>3</sub>.  So, we can also call this collection of polyhedra the A<sub>3</sub> family.  </p>
<h3> The cube/octahedron family </h3>
<p>Here are the shapes related to the cube and the octahedron:</p>
<div align="center">
<table border="2">
<tr>
<td> cube
</td>
<td> <img width="140" src="https://i1.wp.com/math.ucr.edu/home/baez/mathematical/400px-cube.png" />
</td>
<td> <b> •&#8212;4&#8212;o&#8212;3&#8212;o </b>
</td>
</tr>
<tr>
<td> truncated cube
</td>
<td>  <img width="140" src="https://i1.wp.com/math.ucr.edu/home/baez/mathematical/400px-truncated_cube.png" />  </td>
<td> <b> •&#8212;4&#8212;•&#8212;3&#8212;o</b>
</td>
</tr>
<tr>
<td> cuboctahedron
</td>
<td>  <img width="140" src="https://i0.wp.com/math.ucr.edu/home/baez/mathematical/400px-cuboctahedron.png" />  </td>
<td> <b> o&#8212;4&#8212;•&#8212;3&#8212;o</b>
</td>
</tr>
<tr>
<td> truncated octahedron
</td>
<td>  <img width="140" src="https://i1.wp.com/math.ucr.edu/home/baez/mathematical/400px-truncated_octahedron.png" />
</td>
<td> <b> o&#8212;4&#8212;•&#8212;3&#8212;•</b>
</td>
</tr>
<tr>
<td> octahedron
</td>
<td>  <img width="140" src="https://i1.wp.com/math.ucr.edu/home/baez/mathematical/400px-octahedron.png" />  </td>
<td> <b> o&#8212;4&#8212;o&#8212;3&#8212;•</b>
</td>
</tr>
</table>
</div>
<p>And here&#8217;s the Coxeter complex:</p>
<div align="center">
<img width="300" src="https://i0.wp.com/math.ucr.edu/home/baez/mathematical/coxeter_complex_octahedral.png" /></div>
<p>Again, this has one right triangle for each element in the group that acts as symmetries of all these shapes.  This group has 48 elements, and it&#8217;s called the <a href="http://en.wikipedia.org/wiki/Octahedral_symmetry">octahedral finite reflection group</a>, or B<sub>3</sub>.  So, we can call this collection of polyhedra the B<sub>3</sub> family.  </p>
<h3> The dodecahedron/icosahedron family </h3>
<p>And here are the shapes related to dodecahedron and icosahedron:</p>
<div align="center">
<table border="2">
<tr>
<td> dodecahedron
</td>
<td> <img width="140" src="https://i0.wp.com/math.ucr.edu/home/baez/mathematical/400px-dodecahedron.png" />
</td>
<td> <b> •&#8212;5&#8212;o&#8212;3&#8212;o </b>
</td>
</tr>
<tr>
<td> truncated dodecahedron
</td>
<td>  <img width="140" src="https://i1.wp.com/math.ucr.edu/home/baez/mathematical/400px-truncated_dodecahedron.png" />  </td>
<td> <b> •&#8212;5&#8212;•&#8212;3&#8212;o</b>
</td>
</tr>
<tr>
<td> icosidodecahedron
</td>
<td>  <img width="140" src="https://i0.wp.com/math.ucr.edu/home/baez/mathematical/400px-icosidodecahedron.png" />  </td>
<td> <b> o&#8212;5&#8212;•&#8212;3&#8212;o</b>
</td>
</tr>
<tr>
<td> truncated icosahedron
</td>
<td>  <img width="140" src="https://i2.wp.com/math.ucr.edu/home/baez/mathematical/400px-truncated_icosahedron.png" />  </td>
<td> <b> o&#8212;5&#8212;•&#8212;3&#8212;•</b>
</td>
</tr>
<tr>
<td> icosahedron
</td>
<td>  <img width="140" src="https://i1.wp.com/math.ucr.edu/home/baez/mathematical/400px-icosahedron.png" />  </td>
<td> <b> o&#8212;5&#8212;o&#8212;3&#8212;•</b>
</td>
</tr>
</table>
</div>
<p>And here&#8217;s the Coxeter complex:</p>
<div align="center">
<img width="400" src="https://i2.wp.com/math.ucr.edu/home/baez/mathematical/coxeter_complex_icosahedral.png" /></div>
<p>Yet again, this has one right triangle for each element in the group that acts as symmetries of all these shapes.  This group has 120 elements, and it&#8217;s called the <a href="http://en.wikipedia.org/wiki/Icosahedral_symmetry">icosahedral finite reflection group</a>, or H<sub>3</sub>.  So, we can call this collection of polyhedra the H<sub>3</sub> family.  </p>
									</div>

				<p class="postmetadata">
				<img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/speech_bubble.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2012/09/07/symmetry-and-the-fourth-dimension-part-7/#comments">12 Comments</a>				| <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/documents.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/category/mathematics/" rel="category tag">mathematics</a>								 | <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/permalink.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2012/09/07/symmetry-and-the-fourth-dimension-part-7/" rel="bookmark" title="Permanent Link to Symmetry and the Fourth Dimension (Part&nbsp;7)">Permalink</a>
<br /><img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/figure_ver1.gif" alt="" /> Posted by John Baez				</p>
			</div>
			<hr />
		
			<div class="post-11899 post type-post status-publish format-standard hentry category-mathematics" id="post-11899">
				<h2><a href="https://johncarlosbaez.wordpress.com/2012/09/03/rolling-balls-and-circles-part-2/" rel="bookmark">Rolling Circles and Balls (Part&nbsp;2)</a></h2>
				<small>3 September, 2012</small><br />


				<div class="entry">
					<p><a href="https://johncarlosbaez.wordpress.com/2012/08/31/rolling-circles-and-balls-part-1/">Last time</a> we rolled a circle on another circle the same size, and looked at the curve traced out by a point on the rolling circle:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Cardioid"><img src="https://i0.wp.com/math.ucr.edu/home/baez/mathematical/cardioid_animation_2.gif" /></a>
</div>
<p>It&#8217;s called a <a href="http://en.wikipedia.org/wiki/Cardioid"><b>cardioid</b></a>.</p>
<p>But suppose we roll a circle on another circle that&#8217;s twice as big. Then we get a <a href="http://en.wikipedia.org/wiki/Nephroid"><b>nephroid</b></a>:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Nephroid"><img src="https://i1.wp.com/math.ucr.edu/home/baez/mathematical/nephroid_animation_2.gif" /></a>
</div>
<p><b>Puzzle 1.</b> How many times does the small circle rotate as it rolls all the way around the big one here?</p>
<p>By the way, the name &#8216;cardioid&#8217; comes from the Greek word for &#8216;heart&#8217;.  The name &#8216;nephroid&#8217; comes from the Greek word for a less noble organ: the kidney!  But the Greeks didn&#8217;t talk about cardioids or nephroids&#8212;these names were invented in modern times.  </p>
<p>Here are my 7 favorite ways to get a nephroid:</p>
<p>1) The way just described: roll a circle on a circle twice as big, and track the path of a point.</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Nephroid"><img src="https://i1.wp.com/math.ucr.edu/home/baez/mathematical/nephroid_animation.gif" /></a>
</div>
<p>2) Alternatively, take a circle that&#8217;s one and a half times big as another, fit it <i>around</i> that smaller one, roll it around, and let one of its points trace out a curve.  Again you get a nephroid!</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Nephroid"><img src="https://i1.wp.com/math.ucr.edu/home/baez/mathematical/nephroid_animation_epicycloid.gif" /></a>
</div>
<p>3) Take a semicircle, point it upwards, shine parallel rays of light straight down at it, and let those rays reflect off it.  The envelope of the reflected rays will be half of a nephroid:</p>
<div align="center"><a href="//en.wikipedia.org/wiki/Nephroid"><img src="https://i0.wp.com/math.ucr.edu/home/baez/mathematical/nephroid_as_caustic_of_circle.png" /></a>
</div>
<p>This was discovered by Huygens  <a href="http://www-history.mcs.st-and.ac.uk/Curves/Nephroid.html">in 1678</a>, in his work on light.  He was really big on the study of curves.</p>
<p>As I mentioned last time, a <a href="http://mathworld.wolfram.com/Catacaustic.html"><b>catacaustic</b></a> is a curve formed as the envelope of rays emanating from a specified point and reflecting off a given curve.  We can stretch the rules a bit and let that point be a &#8216;point at infinity&#8217;.  Then the rays will be parallel.  So, we&#8217;re seeing that the nephroid is a catacaustic of a circle.   </p>
<p>Last time we saw the cardioid is <i>also</i> a catacaustic of a circle, but with light emanating from a point on the circle.   It&#8217;s neat that the cardioid and nephroid both show up as catacaustics of the circle.  But it&#8217;s just the beginning of the fun&#8230;</p>
<p>4) The nephroid is the catacaustic of the cardioid, if we let the light emanate from the cardioid&#8217;s cusp!  </p>
<div align="center"><a href="http://xahlee.info/SpecialPlaneCurves_dir/Nephroid_dir/nephroid.html"><img src="https://i2.wp.com/math.ucr.edu/home/baez/mathematical/nephroid_as_caustic_of_cardioid.png" /></a>
</div>
<p>This was discovered by Jacques Bernoulli in <a href="http://xahlee.info/SpecialPlaneCurves_dir/Nephroid_dir/nephroid.html">1692</a>.</p>
<p>5) Let two points move around a circle, starting at the same place, but with one moving 3 times as fast as the other.  At each moment connect them with a line.  The envelope of these lines is a nephroid!</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Nephroid"><img src="https://i0.wp.com/math.ucr.edu/home/baez/mathematical/nephroid_as_envelope_of_lines.png" /></a> </div>
<p>Last time we saw that if we replace the number 3 by 2 here, we get a cardioid.  So, this is yet another way these two curves are related!</p>
<p>6) Draw a circle in blue and draw its diameter as a vertical line.  Then draw all the circles that have their center somewhere on that blue circle, and are tangent to that vertical line.   You get a nephroid:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Nephroid"><img src="https://i0.wp.com/math.ucr.edu/home/baez/mathematical/nephroid_as_envelope_of_circles.png" /></a> </div>
<p>The red circle here has the red dot as its center, and it&#8217;s tangent to a point on the vertical line.  Here&#8217;s a nice animation of the process, made available by the <a href="http://mathforum.org/mathimages/index.php/Envelope#Envelope_of_circles">Math Images Project</a> under a <a href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License</a>:</p>
<div align="center"><a href="http://mathforum.org/mathimages/index.php/Envelope#Envelope_of_circles"><img src="https://i0.wp.com/math.ucr.edu/home/baez/mathematical/nephroid_as_envelope_animation.gif" /></a> </div>
<p>7) Finally, here’s how to draw a nephroid starting with a nephroid!  Draw all the <a href="http://en.wikipedia.org/wiki/Osculating_circle"><b>osculating circles</b></a> of the nephroid&#8212;that is, circles that match the nephroid’s curvature as well as its slope at the points they touch. The centers of these circles give another nephroid:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Nephroid"><img src="https://i1.wp.com/math.ucr.edu/home/baez/mathematical/nephroid_as_evolute.png" /></a> </div>
<p>This trick is an example of an &#8216;evolute&#8217;.  The <a href="http://en.wikipedia.org/wiki/Evolute"><b>evolute</b></a> of a curve is the set of centers of the osculating circles of that curve.  Last time we saw the evolute of a cardioid is another cardioid.  Now we&#8217;re seeing the nephroid shares this property!  </p>
<p>Apparently the same is true for all curves formed by rolling one circle on another. These curves are called <a href="http://en.wikipedia.org/wiki/Epicycloid"><b>epicycloids</b></a>.   In a sense, these are the mathematical leftovers of the theory of epicycles in astronomy.  </p>
<p>It would be nice if some of the funny relations we&#8217;ve been seeing between the cardioid and the nephroid generalize to relations between the epicycloid with k cusps and the one with k+1 cusps.  But I don&#8217;t know if that&#8217;s true.</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Epicycloid"><img src="http://upload.wikimedia.org/wikipedia/commons/thumb/9/96/Epicycloid-3.svg/200px-Epicycloid-3.svg.png" /><img src="http://upload.wikimedia.org/wikipedia/commons/thumb/e/e4/Epicycloid-4.svg/200px-Epicycloid-4.svg.png" /></a></div>
<p>It would also be nice if the epicycloids with more and more cusps were named after increasingly disgusting organs of the body.  But in fact, I don&#8217;t know <i>any</i> special names for them once we reach k = 3.</p>
<p><b>Puzzle 2.</b> Use one of the 7 constructions above to get an equation for the nephroid.  What is the simplest equation you can find for this curve?</p>
<h3> Next time </h3>
<p>Most of the pictures above are from <a href="http://commons.wikimedia.org/w/index.php?search=nephroid&amp;title=Special%3ASearch">Wikicommons</a>, but the picture of the nephroid as a catacaustic of the cardioid is from <a href="//xahlee.info/SpecialPlaneCurves_dir/Nephroid_dir/nephroid.html">Xah Lee&#8217;s wonderful website on plane curves</a>.  As usual, you can click on the pictures and get more informatino.</p>
<p>My ultimate goal is to tell you some amazing things about what happens when you roll one ball on another that&#8217;s exactly 3 times as big.    These things have nothing to do with plane curves, actually.   But I&#8217;ve been taking many detours,  and next time I&#8217;ll talk about some curves formed by rolling one circle <i>inside</i> another!   </p>
<p>Right now, thought I need a break.  I need to stop thinking about all these curves.  I think I&#8217;ll get a cup of coffee.</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Caustic_%28optics%29"><img src="https://i1.wp.com/math.ucr.edu/home/baez/mathematical/caustic_in_coffee_cup.jpg" /></a> </div>
									</div>

				<p class="postmetadata">
				<img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/speech_bubble.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2012/09/03/rolling-balls-and-circles-part-2/#comments">45 Comments</a>				| <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/documents.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/category/mathematics/" rel="category tag">mathematics</a>								 | <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/permalink.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2012/09/03/rolling-balls-and-circles-part-2/" rel="bookmark" title="Permanent Link to Rolling Circles and Balls (Part&nbsp;2)">Permalink</a>
<br /><img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/figure_ver1.gif" alt="" /> Posted by John Baez				</p>
			</div>
			<hr />
		
			<div class="post-11676 post type-post status-publish format-standard hentry category-mathematics" id="post-11676">
				<h2><a href="https://johncarlosbaez.wordpress.com/2012/08/31/rolling-circles-and-balls-part-1/" rel="bookmark">Rolling Circles and Balls (Part&nbsp;1)</a></h2>
				<small>31 August, 2012</small><br />


				<div class="entry">
					<p>For over a decade I&#8217;ve been struggling with certain math puzzle, first with the help of James Dolan and later also with John Huerta.  It&#8217;s about something amazing that happens when you roll a ball on another ball that&#8217;s <i>exactly 3 times as big</i>.   John Huerta and I just finished a paper about it, and I&#8217;d like to explain that here.</p>
<p>But I&#8217;d like to ease into it slowly, so I&#8217;ll start by talking about what happens when you roll a circle on another circle that&#8217;s the <i>exact same size</i>:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Cardioid"><br />
<img src="https://i2.wp.com/math.ucr.edu/home/baez/mathematical/cardioid_animation.gif" /></a></div>
<p>Can you see how the rolling circle rotates <i>twice</i> as it rolls around the fixed circle <i>once?</i>  Do you understand why?  </p>
<p>The heart-shaped curve traced out by any point on the rolling circle is called a <a href="http://en.wikipedia.org/wiki/Cardioid"><b>cardioid</b></a>.  In her latest video Vi Hart pretends to complain about parabolas while actually telling us quite a lot about them, and much else too:</p>
<span class="embed-youtube" style="text-align:center; display: block;"><iframe class="youtube-player" width="420" height="315" src="https://www.youtube.com/embed/v-pyuaThp-c?version=3&#038;rel=0&#038;showsearch=0&#038;showinfo=1&#038;iv_load_policy=1&#038;fs=1&#038;hl=en&#038;autohide=2&#038;wmode=transparent" allowfullscreen="true" style="border:0;" sandbox="allow-scripts allow-same-origin allow-popups allow-presentation"></iframe></span>
<p>Naturally, with her last name, she prefers the cardioid.  She describes various ways to draw this curve: for example, by turning the hated parabola inside out.   Here are my 6 favorite ways:</p>
<p>1) The one we&#8217;ve seen already: roll a circle on another circle the same size, and track the motion of a point on the rolling circle:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Cardioid"><br />
<img src="https://i0.wp.com/math.ucr.edu/home/baez/mathematical/cardioid_animation_2.gif" /></a></div>
<p>2) Take a parabola and &#8216;turn it inside out&#8217;, replacing each point with polar coordinates (r, θ) by a point with coordinates (1/r, θ).    As long as your parabola doesn&#8217;t contain the origin, you get a cardioid:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Cardioid#Inverse_curve"><img src="http://upload.wikimedia.org/wikipedia/commons/thumb/0/0c/Inverse_Curves_Parabola_Cardioid.svg/400px-Inverse_Curves_Parabola_Cardioid.svg.png" /><br />
</a></div>
<p>This &#8216;turning inside out&#8217; trick is called <a href="http://en.wikipedia.org/wiki/Conformal inversion">conformal inversion</a>.</p>
<p>3) Draw all circles whose centers are points on a fixed circle, and which contain a specified point on that circle:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Cardioid"><img src="http://upload.wikimedia.org/wikipedia/commons/thumb/5/5a/CardioidCircleEnvelope.svg/400px-CardioidCircleEnvelope.svg.png" />&#8220;</a></div>
<p>Here&#8217;s a nice animation of this process, made available by the <a href="http://mathforum.org/mathimages/index.php/Envelope#Envelope_of_circles">Math Images Project</a> under a <a href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License</a>:</p>
<div align="center"><a href="http://mathforum.org/mathimages/index.php/Envelope#Envelope_of_circles"><img src="https://i0.wp.com/math.ucr.edu/home/baez/mathematical/cardioid_as_envelope_animation.gif" /></a> </div>
<p>4) Let light rays emanate from one point on a circle and reflect off all other points on that circle.  Draw all these reflected rays, and you&#8217;ll see a cardioid:</p>
<div align="center"><a href="http://xahlee.info/SpecialPlaneCurves_dir/Cardioid_dir/cardioid.html"><img src="https://i1.wp.com/math.ucr.edu/home/baez/mathematical/cardioid_as_caustic.png" /></a></div>
<p>If you draw all light rays that reflect off some curve, the curve they snuggle up against (their so-called <a href="http://en.wikipedia.org/wiki/Envelope_%28mathematics%29">envelope</a>) is called a <a href="http://mathworld.wolfram.com/Catacaustic.html">catacaustic</a>.</p>
<p>5) Draw 36 equally spaced points on a circle numbered 0 to 35, and draw a line between each point n and the point 2n modulo 36.  You&#8217;ll see a cardioid, approximately:</p>
<div align="center"><a href="http://xahlee.info/SpecialPlaneCurves_dir/Cardioid_dir/cardioid.html"><img src="https://i2.wp.com/math.ucr.edu/home/baez/mathematical/cardioid_as_envelope.png" /></a></div>
<p>But there&#8217;s nothing special about the number 36.  If you take more evenly spaced points, you get a better approximation to a cardioid.  You get a perfect cardioid if you connect each point (1, θ) to the point (1, 2θ) with a line, and take the envelope of these lines.  </p>
<p>6) Finally, here&#8217;s how to draw a cardioid starting with a cardioid!  Draw all the <a href="http://en.wikipedia.org/wiki/Osculating_circle"><b>osculating circles</b></a> of the cardioid&#8212;that is, circles match the cardioid&#8217;s curvature as well as its slope at the points they touch. The centers of these circles give another cardioid:</p>
<div align="center"><a href="http://xahlee.info/SpecialPlaneCurves_dir/Cardioid_dir/cardioid.html"><img src="https://i1.wp.com/math.ucr.edu/home/baez/mathematical/cardioid_as_evolute.png" /></a></div>
<p>This picture has some distracting lines on it; just look at the big and the little cardioid, and the circles.  This trick is an example of an &#8216;evolute&#8217;.  The <a href="http://en.wikipedia.org/wiki/Evolute"><b>evolute</b></a> of a curve is the set of centers of the osculating circles of that curve.  </p>
<p>All the pictures above are from <a href="http://xahlee.info/SpecialPlaneCurves_dir/Cardioid_dir/cardioid.html">Xah Lee&#8217;s wonderful website</a> or the <a href="http://en.wikipedia.org/wiki/Cardioid">Wikipedia article on cardioids</a>.  Click on the picture to see where it came from and get more information.</p>
<p>I ❤ cardioids!</p>
<p>Next time we&#8217;ll see what happens when we roll a circle inside a circle that&#8217;s <i>exactly twice as big</i>.</p>
<h3> Constructions on curves </h3>
<p>We&#8217;ve seen a few constructions on curves:</p>
<p>&bull; A <a href="http://en.wikipedia.org/wiki/Roulette_%28curve%29"><b>roulette</b></a> is the curve traced out by a point attached to a given curve as it rolls without slipping along a second curve.  </p>
<p>We rolled a circle on a circle and got a cardioid, but you could roll a parabola on another parabola:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Roulette_%28curve%29"><img src="http://upload.wikimedia.org/wikipedia/commons/d/d8/RouletteAnim.gif" /></a></div>
<p>This gives a curve called the <a href="http://en.wikipedia.org/wiki/Cissoid_of_Diocles"><b>cissoid of Diocles</b></a>, which in some coordinate system (not the one shown) is given by this cubic equation:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%28x%5E2%2By%5E2%29x%3D2ay%5E2+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(x^2+y^2)x=2ay^2 " class="latex" /></p>
<p>&bull;  A <a href="http://mathworld.wolfram.com/Catacaustic.html"><b>catacaustic</b></a> is the envelope of rays emanating from a specified point (perhaps a point at infinite distance, which produces parallel rays) and reflecting off a given curve.  </p>
<p>We&#8217;ve obtained the cardioid as a catacaustic of the circle.   Supposedly if you take the cissoid of Diocles and form its catacaustic using rays emanating from its &#8216;focus&#8217;, you get a cardioid!  This would be a seventh way to get a cardioid, but I don&#8217;t understand it, even though it&#8217;s described on <a href="http://mathworld.wolfram.com/CissoidofDioclesCatacaustic.html">Wolfram Mathworld</a>.  I don&#8217;t even know what the &#8216;focus&#8217; of a cissoid of Diocles is. Can you help?</p>
<p>&bull; The <a href="http://en.wikipedia.org/wiki/Evolute"><b>evolute</b></a> of a curve is the curve formed by the centers of its tangent circles.  </p>
<p>We&#8217;ve seen that the cardioid is its own evolute.   The evolute of an ellipse looks like this:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Evolute"><img src="http://upload.wikimedia.org/wikipedia/commons/thumb/9/92/Ellipse_evolute.svg/300px-Ellipse_evolute.svg.png" /></a></div>
<p>It&#8217;s called an <a href="http://en.wikipedia.org/wiki/Astroid"><b>astroid</b></a>, and it&#8217;s given by an equation of this form:</p>
<p><img src="https://s0.wp.com/latex.php?latex=a+x%5E%7B2%2F3%7D+%2B+b+y%5E%7B2%2F3%7D+%3D+1&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="a x^{2/3} + b y^{2/3} = 1" class="latex" /></p>
<p>If you take the tangent circles of the black points on the ellipse above, their centers are the sharp pointy &#8216;cusps&#8217; of the astroid.</p>
<h3> Order from chaos? </h3>
<p>Some other famous ways to construct new curves from old ones include the <a href="http://en.wikipedia.org/wiki/Involute">involute</a>, the <a href="http://en.wikipedia.org/wiki/Isoptic">isoptic</a>, and the <a href="http://en.wikipedia.org/wiki/Pedal_curve">pedal</a>. I could describe them&#8230; but I won&#8217;t.   You get the picture: there&#8217;s a zoo of curves and constructions on curves, and lots of relations between these constructions.   It&#8217;s all very beautiful, but also a bit of a mess.</p>
<p>It seems that all these constructions, and their relations, should be studied more systematically in algebraic geometry.  It may seem like a somewhat musty and old-fashioned branch of algebraic geometry, but surely there&#8217;s a way to make it new and fresh using modern math.  Has someone done this?</p>
									</div>

				<p class="postmetadata">
				<img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/speech_bubble.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2012/08/31/rolling-circles-and-balls-part-1/#comments">27 Comments</a>				| <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/documents.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/category/mathematics/" rel="category tag">mathematics</a>								 | <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/permalink.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2012/08/31/rolling-circles-and-balls-part-1/" rel="bookmark" title="Permanent Link to Rolling Circles and Balls (Part&nbsp;1)">Permalink</a>
<br /><img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/figure_ver1.gif" alt="" /> Posted by John Baez				</p>
			</div>
			<hr />
		
			<div class="post-11843 post type-post status-publish format-standard hentry category-information-and-entropy category-mathematics category-probability category-puzzles" id="post-11843">
				<h2><a href="https://johncarlosbaez.wordpress.com/2012/08/29/an-entropy-challenge/" rel="bookmark">An Entropy Challenge</a></h2>
				<small>29 August, 2012</small><br />


				<div class="entry">
					<p>If you like computer calculations, here&#8217;s a little challenge for you.  <a href="http://www.quantumlah.org/people/Dahlsten">Oscar Dahlsten</a> may have solved it, but we&#8217;d love for you to check his work.   It&#8217;s pretty important for the foundations of thermodynamics, but you don&#8217;t need to know any physics or even anything beyond a little algebra to tackle it!  First I&#8217;ll explain it in really simple terms, then I&#8217;ll remind you a bit of why it matters.</p>
<p>We&#8217;re looking for two lists of nonnegative numbers, of the same length, listed in decreasing order:</p>
<p><img src="https://s0.wp.com/latex.php?latex=p_1+%5Cge+p_2+%5Cge+%5Ccdots+%5Cge+p_n+%5Cge+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p_1 &#92;ge p_2 &#92;ge &#92;cdots &#92;ge p_n &#92;ge 0 " class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=q_1+%5Cge+q_2+%5Cge+%5Ccdots+%5Cge+q_n+%5Cge+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q_1 &#92;ge q_2 &#92;ge &#92;cdots &#92;ge q_n &#92;ge 0 " class="latex" /></p>
<p>that sum to 1:</p>
<p><img src="https://s0.wp.com/latex.php?latex=p_1+%2B+%5Ccdots+%2B+p_n+%3D+1&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p_1 + &#92;cdots + p_n = 1" class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=q_1+%2B+%5Ccdots+%2B+q_n+%3D+1&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q_1 + &#92;cdots + q_n = 1" class="latex" /></p>
<p>and that obey this inequality:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7B1%7D%7B1+-+%5Cbeta%7D+%5Cln+%5Csum_%7Bi%3D1%7D%5En+p_i%5E%5Cbeta++%5Cle++%5Cfrac%7B1%7D%7B1+-+%5Cbeta%7D+%5Cln+%5Csum_%7Bi%3D1%7D%5En+q_i%5E%5Cbeta+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{1}{1 - &#92;beta} &#92;ln &#92;sum_{i=1}^n p_i^&#92;beta  &#92;le  &#92;frac{1}{1 - &#92;beta} &#92;ln &#92;sum_{i=1}^n q_i^&#92;beta } " class="latex" /></p>
<p>for all <img src="https://s0.wp.com/latex.php?latex=0+%3C+%5Cbeta+%3C+%5Cinfty&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="0 &lt; &#92;beta &lt; &#92;infty" class="latex" /> (ignoring <img src="https://s0.wp.com/latex.php?latex=%5Cbeta+%3D+1&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;beta = 1" class="latex" />), yet do <i>not</i> obey these inequalities:</p>
<p><img src="https://s0.wp.com/latex.php?latex=p_1+%2B+%5Ccdots+%2B+p_k+%5Cge+q_1+%2B+%5Ccdots+%2B+q_k+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p_1 + &#92;cdots + p_k &#92;ge q_1 + &#92;cdots + q_k " class="latex" /></p>
<p>for all <img src="https://s0.wp.com/latex.php?latex=1+%5Cle+k+%5Cle+n.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="1 &#92;le k &#92;le n." class="latex" /></p>
<p>Oscar&#8217;s proposed solution is this:</p>
<p><img src="https://s0.wp.com/latex.php?latex=p+%3D+%280.4%2C+0.29%2C+0.29%2C+0.02%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p = (0.4, 0.29, 0.29, 0.02)" class="latex" /> </p>
<p><img src="https://s0.wp.com/latex.php?latex=q+%3D+%280.39%2C+0.31%2C+0.2%2C+0.1%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q = (0.39, 0.31, 0.2, 0.1)" class="latex" /></p>
<p>Can you see if this works?  Is there a simpler example, like one with lists of just 3 numbers?</p>
<p>This question came up near the end of my post <a href="https://johncarlosbaez.wordpress.com/2012/08/24/more-second-laws-of-thermodynamics/">More Second Laws of Thermodynamics</a>.  I phrased the question with a bit more jargon, and said a lot more about its significance.  Suppose we have two probability distributions on a finite set, say <img src="https://s0.wp.com/latex.php?latex=p&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=q.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q." class="latex" />  We say <img src="https://s0.wp.com/latex.php?latex=p&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p" class="latex" /> <b>majorizes</b> <img src="https://s0.wp.com/latex.php?latex=q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q" class="latex" /> if</p>
<p><img src="https://s0.wp.com/latex.php?latex=p_1+%2B+%5Ccdots+%2B+p_k+%5Cge+q_1+%2B+%5Ccdots+%2B+q_k+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p_1 + &#92;cdots + p_k &#92;ge q_1 + &#92;cdots + q_k " class="latex" /></p>
<p>for all <img src="https://s0.wp.com/latex.php?latex=1+%5Cle+k+%5Cle+n%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="1 &#92;le k &#92;le n," class="latex" /> when we write both lists of numbers in decreasing order.  This means <img src="https://s0.wp.com/latex.php?latex=p&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p" class="latex" /> is &#8216;less flat&#8217; than <img src="https://s0.wp.com/latex.php?latex=q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q" class="latex" />, so it should have less entropy.  And indeed it does: not just for ordinary entropy, but also for R&eacute;nyi entropy!  The <b>R&eacute;nyi entropy</b> of <img src="https://s0.wp.com/latex.php?latex=p&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p" class="latex" /> is defined by</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+H_%5Cbeta%28p%29+%3D+%5Cfrac%7B1%7D%7B1+-+%5Cbeta%7D+%5Cln+%5Csum_%7Bi%3D1%7D%5En+p_i%5E%5Cbeta++%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ H_&#92;beta(p) = &#92;frac{1}{1 - &#92;beta} &#92;ln &#92;sum_{i=1}^n p_i^&#92;beta  } " class="latex" /></p>
<p>where <img src="https://s0.wp.com/latex.php?latex=0+%3C+%5Cbeta+%3C+1&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="0 &lt; &#92;beta &lt; 1" class="latex" /> or <img src="https://s0.wp.com/latex.php?latex=1+%3C+%5Cbeta+%3C+%5Cinfty&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="1 &lt; &#92;beta &lt; &#92;infty" class="latex" />.  We can also define R&eacute;nyi entropy for <img src="https://s0.wp.com/latex.php?latex=%5Cbeta+%3D+0%2C+1%2C+%5Cinfty&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;beta = 0, 1, &#92;infty" class="latex" /> by taking a limit, and at <img src="https://s0.wp.com/latex.php?latex=%5Cbeta+%3D+1&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;beta = 1" class="latex" /> we get the ordinary entropy</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+H_1%28p%29+%3D+-+%5Csum_%7Bi+%3D+1%7D%5En+p_i+%5Cln+%28p_i%29+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ H_1(p) = - &#92;sum_{i = 1}^n p_i &#92;ln (p_i) } " class="latex" /></p>
<p>The question is whether majorization is more powerful than R&eacute;nyi entropy as a tool to to tell when one probability distribution is less flat than another.  I know that if <img src="https://s0.wp.com/latex.php?latex=p&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p" class="latex" /> majorizes <img src="https://s0.wp.com/latex.php?latex=q%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q," class="latex" /> its R&eacute;nyi entropy is less than than that of <img src="https://s0.wp.com/latex.php?latex=q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q" class="latex" /> for all <img src="https://s0.wp.com/latex.php?latex=0+%5Cle+%5Cbeta+%5Cle+%5Cinfty.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="0 &#92;le &#92;beta &#92;le &#92;infty." class="latex" />  Your mission, should you choose to accept it, is to show the converse is not true.  </p>
									</div>

				<p class="postmetadata">
				<img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/speech_bubble.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2012/08/29/an-entropy-challenge/#comments">30 Comments</a>				| <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/documents.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/category/information-and-entropy/" rel="category tag">information and entropy</a>, <a href="https://johncarlosbaez.wordpress.com/category/mathematics/" rel="category tag">mathematics</a>, <a href="https://johncarlosbaez.wordpress.com/category/probability/" rel="category tag">probability</a>, <a href="https://johncarlosbaez.wordpress.com/category/puzzles/" rel="category tag">puzzles</a>								 | <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/permalink.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2012/08/29/an-entropy-challenge/" rel="bookmark" title="Permanent Link to An Entropy Challenge">Permalink</a>
<br /><img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/figure_ver1.gif" alt="" /> Posted by John Baez				</p>
			</div>
			<hr />
		
			<div class="post-11696 post type-post status-publish format-standard hentry category-chemistry category-mathematics category-networks category-probability" id="post-11696">
				<h2><a href="https://johncarlosbaez.wordpress.com/2012/08/23/network-theory-part-24/" rel="bookmark">Network Theory (Part&nbsp;24)</a></h2>
				<small>23 August, 2012</small><br />


				<div class="entry">
					<p>Now we&#8217;ve reached the climax of our story so far: we&#8217;re ready to prove the deficiency zero theorem.  First let&#8217;s talk about it informally a bit.  Then we&#8217;ll review the notation, and then&#8212;hang on to your seat!&#8212;we&#8217;ll give the proof.</p>
<p>The crucial trick is to relate a bunch of chemical reactions, described by a &#8216;reaction network&#8217; like this:</p>
<div align="center"><img width="200" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/chemical_reaction_network_part_20_VII.png" alt="" /></div>
<p>to a simpler problem where a system randomly hops between states arranged in the same pattern:</p>
<div align="center"><img width="200" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/markov_process_vs_reaction_network_4.png" alt="" /></div>
<p>This is sort of amazing, because we&#8217;ve thrown out lots of detail.  It&#8217;s also amazing because this simpler problem is <i>linear</i>.  In the original problem, the chance that a reaction turns a B + E into a D is proportional to the number of B&#8217;s <i>times</i> the number of E&#8217;s.  That&#8217;s nonlinear!  But in the simplified problem, the chance that your system hops from state 4 to state 3 is just proportional to the probability that it&#8217;s in state 4 to begin with.  That&#8217;s linear.  </p>
<p>The wonderful thing is that, at least under some conditions, we can find <i>equilibrium</i> solutions of our original problem starting from equilibrium solutions of the simpler problem. </p>
<p>Let&#8217;s roughly sketch how it works, and where we are so far.  Our simplified problem is described by an equation like this:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bd%7D%7Bd+t%7D+%5Cpsi+%3D+H+%5Cpsi+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{d}{d t} &#92;psi = H &#92;psi } " class="latex" /></p>
<p>where <img src="https://s0.wp.com/latex.php?latex=%5Cpsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi" class="latex" /> is a function that the probability of being in each state, and <img src="https://s0.wp.com/latex.php?latex=H&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H" class="latex" /> describes the probability per time of hopping from one state to another.   We can easily understand quite a lot about the equilibrium solutions, where <img src="https://s0.wp.com/latex.php?latex=%5Cpsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi" class="latex" /> doesn&#8217;t change at all:</p>
<p><img src="https://s0.wp.com/latex.php?latex=H+%5Cpsi+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H &#92;psi = 0 " class="latex" /></p>
<p>because this is a linear equation.  We did this in <a href="http://math.ucr.edu/home/baez/networks/networks_23.html">Part 23</a>.  Of course, when I say &#8216;easily&#8217;, that&#8217;s a relative thing: we needed to use the Perron&ndash;Frobenius theorem, which Jacob introduced in <a href="http://math.ucr.edu/home/baez/networks_20.html">Part 20</a>.  But that&#8217;s a well-known theorem in linear algebra, and it&#8217;s easy to apply here.</p>
<p>In <a href="http://math.ucr.edu/home/baez/networks_22.html">Part 22</a>, we saw that the original problem was described by an equation like this, called the &#8216;rate equation&#8217;:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bd+x%7D%7Bd+t%7D+%3D+Y+H+x%5EY++%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{d x}{d t} = Y H x^Y  } " class="latex" /></p>
<p>Here <img src="https://s0.wp.com/latex.php?latex=x&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x" class="latex" /> is a vector whose entries describe the amount of each kind of chemical: the amount of A&#8217;s, the amount of B&#8217;s, and so on.  The matrix <img src="https://s0.wp.com/latex.php?latex=H&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H" class="latex" /> is the same as in the simplified problem, but <img src="https://s0.wp.com/latex.php?latex=Y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y" class="latex" /> is a matrix that says how many times each chemical shows up in each spot in our reaction network:</p>
<div align="center"><img width="200" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/chemical_reaction_network_part_20_VII.png" alt="" /></div>
<p>The key thing to notice is <img src="https://s0.wp.com/latex.php?latex=x%5EY%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x^Y," class="latex" /> where we take a vector and raise it to the power of a matrix.   We explained this operation back in <a href="http://math.ucr.edu/home/baez/networks_22.html">Part 22</a>.  It&#8217;s this operation that says how many B + E pairs we have, for example, given the number of B&#8217;s and the number of E&#8217;s.  It&#8217;s this that makes the rate equation nonlinear.  </p>
<p>Now, we&#8217;re looking for equilibrium solutions of the rate equation, where the rate of change is zero:</p>
<p><img src="https://s0.wp.com/latex.php?latex=Y+H+x%5EY+%3D+0++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y H x^Y = 0  " class="latex" /></p>
<p>But in fact we&#8217;ll do even better!  We&#8217;ll find solutions of this:</p>
<p><img src="https://s0.wp.com/latex.php?latex=H+x%5EY+%3D+0&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H x^Y = 0" class="latex" /></p>
<p>And we&#8217;ll get these by taking our solutions of this:</p>
<p><img src="https://s0.wp.com/latex.php?latex=H+%5Cpsi+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H &#92;psi = 0 " class="latex" /></p>
<p>and adjusting them so that </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cpsi+%3D+x%5EY+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi = x^Y " class="latex" /></p>
<p>while <img src="https://s0.wp.com/latex.php?latex=%5Cpsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi" class="latex" /> remains a solution of <img src="https://s0.wp.com/latex.php?latex=H+%5Cpsi+%3D+0.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H &#92;psi = 0." class="latex" />  </p>
<p>But: how do we do this &#8216;adjusting&#8217;?  That&#8217;s the crux of the whole business!  That&#8217;s what we&#8217;ll do today.  </p>
<p>Remember, <img src="https://s0.wp.com/latex.php?latex=%5Cpsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi" class="latex" /> is a function that gives a probability for each &#8216;state&#8217;, or numbered box here:</p>
<div align="center"><img width="200" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/markov_process_vs_reaction_network_4.png" alt="" /></div>
<p>The picture here consists of two pieces, called &#8216;connected components&#8217;: the piece containing boxes 0 and 1, and the piece containing boxes 2, 3 and 4.  It turns out that we can multiply <img src="https://s0.wp.com/latex.php?latex=%5Cpsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi" class="latex" /> by a function that&#8217;s constant on each connected component, and if we had <img src="https://s0.wp.com/latex.php?latex=H+%5Cpsi+%3D+0&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H &#92;psi = 0" class="latex" /> to begin with, that will still be true afterward.  The reason is that there&#8217;s no way for <img src="https://s0.wp.com/latex.php?latex=%5Cpsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi" class="latex" /> to &#8216;leak across&#8217; from one component to another.  It&#8217;s like having water in separate buckets.  You can increase the amount of water in one bucket, and decrease it another, and as long as the water&#8217;s surface remains flat in each bucket, the whole situation remains in equilibrium.</p>
<p>That&#8217;s sort of obvious.  What&#8217;s not obvious is that we can adjust <img src="https://s0.wp.com/latex.php?latex=%5Cpsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi" class="latex" /> this way so as to ensure</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cpsi+%3D+x%5EY+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi = x^Y " class="latex" /></p>
<p>for some <img src="https://s0.wp.com/latex.php?latex=x.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x." class="latex" />  </p>
<p>And indeed, it&#8217;s not always true!  It&#8217;s only true if our reaction network obeys a special condition.  It needs to have &#8216;deficiency zero&#8217;.  We defined this concept back in <a href="http://math.ucr.edu/home/baez/networks/networks_21.html">Part 21</a>, but now we&#8217;ll finally use it for something.  It turns out to be precisely the right condition to guarantee we can tweak any function on our set of states,  multiplying it by a function that&#8217;s constant on each connected component, and get a new function <img src="https://s0.wp.com/latex.php?latex=%5Cpsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi" class="latex" /> with</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cpsi+%3D+x%5EY+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi = x^Y " class="latex" /></p>
<p>When all is said and done, that is the key to the deficiency zero theorem.</p>
<h3> Review </h3>
<p>The battle is almost upon us&mdash;we&#8217;ve got one last chance to review our notation.   We start with a <b>stochastic reaction network</b>:</p>
<div align="center">
<img src="https://i2.wp.com/math.ucr.edu/home/baez/networks/reaction_network_diagram_1.png" alt="" />
</div>
<p>This consists of:</p>
<p>&bull; finite sets of <b>transitions</b> <img src="https://s0.wp.com/latex.php?latex=T%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T," class="latex" /> <b>complexes</b> <img src="https://s0.wp.com/latex.php?latex=K&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="K" class="latex" /> and <b>species</b> <img src="https://s0.wp.com/latex.php?latex=S%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S," class="latex" /></p>
<p>&bull; a map <img src="https://s0.wp.com/latex.php?latex=r%3A+T+%5Cto+%280%2C%5Cinfty%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="r: T &#92;to (0,&#92;infty)" class="latex" /> giving a <b>rate constant</b> for each transition,</p>
<p>&bull; <b>source</b> and <b>target</b> maps <img src="https://s0.wp.com/latex.php?latex=s%2Ct+%3A+T+%5Cto+K&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s,t : T &#92;to K" class="latex" /> saying where each transition starts and ends,</p>
<p>&bull; a one-to-one map <img src="https://s0.wp.com/latex.php?latex=Y+%3A+K+%5Cto+%5Cmathbb%7BN%7D%5ES&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y : K &#92;to &#92;mathbb{N}^S" class="latex" /> saying how each complex is made of species.</p>
<p>Then we extend <img src="https://s0.wp.com/latex.php?latex=s%2C+t&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s, t" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=Y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y" class="latex" /> to linear maps:</p>
<div align="center">
<img src="https://i0.wp.com/math.ucr.edu/home/baez/networks/reaction_network_diagram_6.png" /></div>
<p>Then we put inner products on these vector spaces as described <a href="http://math.ucr.edu/home/baez/networks/networks_22.html">last time</a>, which lets us &#8216;turn around&#8217; the maps <img src="https://s0.wp.com/latex.php?latex=s&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=t&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="t" class="latex" /> by taking their adjoints:</p>
<p><img src="https://s0.wp.com/latex.php?latex=s%5E%5Cdagger%2C+t%5E%5Cdagger+%3A+%5Cmathbb%7BR%7D%5EK+%5Cto+%5Cmathbb%7BR%7D%5ET+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s^&#92;dagger, t^&#92;dagger : &#92;mathbb{R}^K &#92;to &#92;mathbb{R}^T " class="latex" /></p>
<p>More surprisingly, we can &#8216;turn around&#8217; <img src="https://s0.wp.com/latex.php?latex=Y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y" class="latex" /> and get a <i>nonlinear</i> map using &#8216;matrix exponentiation&#8217;:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Barray%7D%7Bccc%7D+%5Cmathbb%7BR%7D%5ES+%26%5Cto%26+%5Cmathbb%7BR%7D%5EK+%5C%5C+++++++++++++++++++++++++++++++x+++++%26%5Cmapsto%26+++x%5EY+%5Cend%7Barray%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;begin{array}{ccc} &#92;mathbb{R}^S &amp;&#92;to&amp; &#92;mathbb{R}^K &#92;&#92;                               x     &amp;&#92;mapsto&amp;   x^Y &#92;end{array} " class="latex" /></p>
<p>This is most easily understood by thinking of <img src="https://s0.wp.com/latex.php?latex=x&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x" class="latex" /> as a row vector and <img src="https://s0.wp.com/latex.php?latex=Y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y" class="latex" /> as a matrix:</p>
<p><img src="https://i1.wp.com/math.ucr.edu/home/baez/networks/matrix_exponential.png" /></p>
<p>Remember, complexes are made out of species.   The matrix entry <img src="https://s0.wp.com/latex.php?latex=Y_%7Bi+j%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y_{i j}" class="latex" /> says how many things of the <img src="https://s0.wp.com/latex.php?latex=j&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="j" class="latex" />th species there are in a complex of the <img src="https://s0.wp.com/latex.php?latex=i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i" class="latex" />th kind.   If <img src="https://s0.wp.com/latex.php?latex=%5Cpsi+%5Cin+%5Cmathbb%7BR%7D%5EK&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi &#92;in &#92;mathbb{R}^K" class="latex" /> says how many complexes there are of each kind, <img src="https://s0.wp.com/latex.php?latex=Y+%5Cpsi+%5Cin+%5Cmathbb%7BR%7D%5ES&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y &#92;psi &#92;in &#92;mathbb{R}^S" class="latex" /> says how many things there are of each species.  Conversely, if <img src="https://s0.wp.com/latex.php?latex=x+%5Cin+%5Cmathbb%7BR%7D%5ES&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x &#92;in &#92;mathbb{R}^S" class="latex" /> says how many things there are of each species, <img src="https://s0.wp.com/latex.php?latex=x%5EY+%5Cin+%5Cmathbb%7BR%7D%5EK&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x^Y &#92;in &#92;mathbb{R}^K" class="latex" /> says how many ways we can build each kind of complex from them.</p>
<p>So, we get these maps:</p>
<div align="center">
<img src="https://i0.wp.com/math.ucr.edu/home/baez/networks/reaction_network_diagram_7.png" /></div>
<p>Next, the <b>boundary operator</b> </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cpartial+%3A+%5Cmathbb%7BR%7D%5ET+%5Cto+%5Cmathbb%7BR%7D%5EK+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;partial : &#92;mathbb{R}^T &#92;to &#92;mathbb{R}^K " class="latex" /> </p>
<p>describes how each transition causes a change in complexes:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cpartial+%3D+t+-+s+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;partial = t - s " class="latex" /></p>
<p>As we saw <a href="http://math.ucr.edu/home/baez/networks/networks_24.html">last time</a>, there is a <b>Hamiltonian</b> </p>
<p><img src="https://s0.wp.com/latex.php?latex=H+%3A+%5Cmathbb%7BR%7D%5EK+%5Cto+%5Cmathbb%7BR%7D%5EK+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H : &#92;mathbb{R}^K &#92;to &#92;mathbb{R}^K " class="latex" /></p>
<p>describing a Markov processes on the set of complexes, given by</p>
<p><img src="https://s0.wp.com/latex.php?latex=H+%3D+%5Cpartial+s%5E%5Cdagger+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H = &#92;partial s^&#92;dagger " class="latex" /></p>
<p>But the star of the show is the rate equation.  This describes how the number of things of each species changes with time.  We write these numbers in a list and get a vector <img src="https://s0.wp.com/latex.php?latex=x+%5Cin+%5Cmathbb%7BR%7D%5ES&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x &#92;in &#92;mathbb{R}^S" class="latex" /> with nonnegative components.  The <b>rate equation</b> says:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bd+x%7D%7Bd+t%7D+%3D+Y+H+x%5EY+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{d x}{d t} = Y H x^Y } " class="latex" /></p>
<p>We can read this as follows:</p>
<p>&bull; <img src="https://s0.wp.com/latex.php?latex=x&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x" class="latex" /> says how many things of each species we have now.</p>
<p>&bull; <img src="https://s0.wp.com/latex.php?latex=x%5EY&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x^Y" class="latex" /> says how many complexes of each kind we can build from these species. </p>
<p>&bull; <img src="https://s0.wp.com/latex.php?latex=s%5E%5Cdagger+x%5EY&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s^&#92;dagger x^Y" class="latex" /> says how many transitions of each kind can originate starting from these complexes, with each transition weighted by its rate.</p>
<p>&bull; <img src="https://s0.wp.com/latex.php?latex=H+x%5EY+%3D+%5Cpartial+s%5E%5Cdagger+x%5EY&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H x^Y = &#92;partial s^&#92;dagger x^Y" class="latex" /> is the rate of change of the number of complexes of each kind, due to these transitions.  </p>
<p>&bull; <img src="https://s0.wp.com/latex.php?latex=Y+H+x%5EY&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y H x^Y" class="latex" /> is the rate of change of the number of things of each species.</p>
<h3> The zero deficiency theorem </h3>
<p>We are looking for <b>equilibrium solutions</b> of the rate equation, where the number of things of each species doesn&#8217;t change at all:</p>
<p><img src="https://s0.wp.com/latex.php?latex=Y+H+x%5EY+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y H x^Y = 0 " class="latex" /></p>
<p>In fact we will find <b>complex balanced</b> equilibrium solutions, where even the number of complexes of each kind doesn&#8217;t change:</p>
<p><img src="https://s0.wp.com/latex.php?latex=H+x%5EY+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H x^Y = 0 " class="latex" /></p>
<p>More precisely, we have:</p>
<p><b>Deficiency Zero Theorem (Child&#8217;s Version).</b>   Suppose we have a reaction network obeying these two conditions:</p>
<p>1. It is <b>weakly reversible</b>, meaning that whenever there&#8217;s a transition from one complex <img src="https://s0.wp.com/latex.php?latex=%5Ckappa&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;kappa" class="latex" /> to another <img src="https://s0.wp.com/latex.php?latex=%5Ckappa%27%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;kappa&#039;," class="latex" /> there&#8217;s a directed path of transitions going back from <img src="https://s0.wp.com/latex.php?latex=%5Ckappa%27&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;kappa&#039;" class="latex" /> to <img src="https://s0.wp.com/latex.php?latex=%5Ckappa.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;kappa." class="latex" /></p>
<p>2.  It has <b>deficiency zero</b>, meaning <img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bim%7D+%5Cpartial++%5Ccap+%5Cmathrm%7Bker%7D+Y+%3D+%5C%7B+0+%5C%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{im} &#92;partial  &#92;cap &#92;mathrm{ker} Y = &#92;{ 0 &#92;} " class="latex" />.</p>
<p>Then for any choice of rate constants there exists a complex balanced equilibrium solution of the rate equation where all species are present in nonzero amounts.  In other words, there exists <img src="https://s0.wp.com/latex.php?latex=x+%5Cin+%5Cmathbb%7BR%7D%5ES&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x &#92;in &#92;mathbb{R}^S" class="latex" /> with all components positive and such that:</p>
<p><img src="https://s0.wp.com/latex.php?latex=H+x%5EY+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H x^Y = 0 " class="latex" /></p>
<p><b>Proof.</b> Because our reaction network is weakly reversible, the theorems in <a href="http://math.ucr.edu/home/baez/networks/networks_23.html">Part 23</a> show there exists <img src="https://s0.wp.com/latex.php?latex=%5Cpsi+%5Cin+%280%2C%5Cinfty%29%5EK&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi &#92;in (0,&#92;infty)^K" class="latex" /> with </p>
<p><img src="https://s0.wp.com/latex.php?latex=H+%5Cpsi+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H &#92;psi = 0 " class="latex" /></p>
<p>This <img src="https://s0.wp.com/latex.php?latex=%5Cpsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi" class="latex" /> may not be of the form <img src="https://s0.wp.com/latex.php?latex=x%5EY%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x^Y," class="latex" /> but we shall adjust <img src="https://s0.wp.com/latex.php?latex=%5Cpsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi" class="latex" /> so that it becomes of this form, while still remaining a solution of <img src="https://s0.wp.com/latex.php?latex=H+%5Cpsi+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H &#92;psi = 0 " class="latex" />latex .   To do this, we need a couple of lemmas:</p>
<p><b>Lemma 1.</b> <img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bker%7D+%5Cpartial%5E%5Cdagger+%2B+%5Cmathrm%7Bim%7D+Y%5E%5Cdagger+%3D+%5Cmathbb%7BR%7D%5EK.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{ker} &#92;partial^&#92;dagger + &#92;mathrm{im} Y^&#92;dagger = &#92;mathbb{R}^K." class="latex" /> </p>
<p><b>Proof.</b>  We need to use a few facts from linear algebra.  If <img src="https://s0.wp.com/latex.php?latex=V&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="V" class="latex" /> is a finite-dimensional vector space with inner product, the <b><a href="http://en.wikipedia.org/wiki/Orthogonal_complement">orthogonal complement</a></b> <img src="https://s0.wp.com/latex.php?latex=L%5E%5Cperp&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="L^&#92;perp" class="latex" /> of a subspace <img src="https://s0.wp.com/latex.php?latex=L+%5Csubseteq+V&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="L &#92;subseteq V" class="latex" /> consists of vectors that are orthogonal to everything in <img src="https://s0.wp.com/latex.php?latex=L&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="L" class="latex" />:</p>
<p><img src="https://s0.wp.com/latex.php?latex=L%5E%5Cperp+%3D+%5C%7B+v+%5Cin+V+%3A+%5Cquad+%5Cforall+w+%5Cin+L+%5Cquad+%5Clangle+v%2C+w+%5Crangle+%3D+0+%5C%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="L^&#92;perp = &#92;{ v &#92;in V : &#92;quad &#92;forall w &#92;in L &#92;quad &#92;langle v, w &#92;rangle = 0 &#92;} " class="latex" /></p>
<p>We have</p>
<p><img src="https://s0.wp.com/latex.php?latex=%28L+%5Ccap+M%29%5E%5Cperp+%3D+L%5E%5Cperp+%2B+M%5E%5Cperp++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(L &#92;cap M)^&#92;perp = L^&#92;perp + M^&#92;perp  " class="latex" /></p>
<p>where <img src="https://s0.wp.com/latex.php?latex=L&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="L" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=M&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="M" class="latex" /> are subspaces of <img src="https://s0.wp.com/latex.php?latex=V&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="V" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=%2B&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="+" class="latex" /> denotes the sum of two subspaces: that is, the smallest subspace containing both.  Also, if <img src="https://s0.wp.com/latex.php?latex=T%3A+V+%5Cto+W&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T: V &#92;to W" class="latex" /> is a linear map between finite-dimensional vector spaces with inner product, we have</p>
<p><img src="https://s0.wp.com/latex.php?latex=%28%5Cmathrm%7Bker%7D+T%29%5E%5Cperp+%3D+%5Cmathrm%7Bim%7D+T%5E%5Cdagger+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(&#92;mathrm{ker} T)^&#92;perp = &#92;mathrm{im} T^&#92;dagger " class="latex" /></p>
<p>and</p>
<p><img src="https://s0.wp.com/latex.php?latex=%28%5Cmathrm%7Bim%7D+T%29%5E%5Cperp+%3D+%5Cmathrm%7Bker%7D+T%5E%5Cdagger+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(&#92;mathrm{im} T)^&#92;perp = &#92;mathrm{ker} T^&#92;dagger " class="latex" /></p>
<p>Now, because our reaction network has deficiency zero, we know that</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bim%7D+%5Cpartial+%5Ccap+%5Cmathrm%7Bker%7D+Y+%3D+%5C%7B+0+%5C%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{im} &#92;partial &#92;cap &#92;mathrm{ker} Y = &#92;{ 0 &#92;} " class="latex" /></p>
<p>Taking the orthogonal complement of both sides, we get</p>
<p><img src="https://s0.wp.com/latex.php?latex=%28%5Cmathrm%7Bim%7D+%5Cpartial+%5Ccap+%5Cmathrm%7Bker%7D+Y%29%5E%5Cperp+%3D+%5Cmathbb%7BR%7D%5EK+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(&#92;mathrm{im} &#92;partial &#92;cap &#92;mathrm{ker} Y)^&#92;perp = &#92;mathbb{R}^K " class="latex" /></p>
<p>and using the rules we mentioned, we obtain</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bker%7D+%5Cpartial%5E%5Cdagger+%2B+%5Cmathrm%7Bim%7D+Y%5E%5Cdagger+%3D+%5Cmathbb%7BR%7D%5EK+++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{ker} &#92;partial^&#92;dagger + &#92;mathrm{im} Y^&#92;dagger = &#92;mathbb{R}^K   " class="latex" /></p>
<p>as desired.   &nbsp;  &#9608;</p>
<p>Now, given a vector <img src="https://s0.wp.com/latex.php?latex=%5Cphi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;phi" class="latex" /> in <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5EK&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^K" class="latex" /> or <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5ES&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^S" class="latex" /> with all positive components, we can define the <b>logarithm</b> of such a vector, component-wise:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%28%5Cln+%5Cphi%29_i+%3D+%5Cln+%28%5Cphi_i%29+++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(&#92;ln &#92;phi)_i = &#92;ln (&#92;phi_i)   " class="latex" /></p>
<p>Similarly, for any vector <img src="https://s0.wp.com/latex.php?latex=%5Cphi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;phi" class="latex" /> in either of these spaces, we can define its <b>exponential</b> in a component-wise way:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%28%5Cexp+%5Cphi%29_i+%3D+%5Cexp%28%5Cphi_i%29++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(&#92;exp &#92;phi)_i = &#92;exp(&#92;phi_i)  " class="latex" /></p>
<p>These operations are inverse to each other.  Moreover:</p>
<p><b>Lemma 2.</b>  The nonlinear operator </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Barray%7D%7Bccc%7D+%5Cmathbb%7BR%7D%5ES+%26%5Cto%26+%5Cmathbb%7BR%7D%5EK+%5C%5C+++++++++++++++++++++++++++++++x+++++%26%5Cmapsto%26+++x%5EY+%5Cend%7Barray%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;begin{array}{ccc} &#92;mathbb{R}^S &amp;&#92;to&amp; &#92;mathbb{R}^K &#92;&#92;                               x     &amp;&#92;mapsto&amp;   x^Y &#92;end{array} " class="latex" /></p>
<p>is related to the linear operator</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Barray%7D%7Bccc%7D+%5Cmathbb%7BR%7D%5ES+%26%5Cto%26+%5Cmathbb%7BR%7D%5EK+%5C%5C+++++++++++++++++++++++++++++++x+++++%26%5Cmapsto%26+++Y%5E%5Cdagger+x+%5Cend%7Barray%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;begin{array}{ccc} &#92;mathbb{R}^S &amp;&#92;to&amp; &#92;mathbb{R}^K &#92;&#92;                               x     &amp;&#92;mapsto&amp;   Y^&#92;dagger x &#92;end{array} " class="latex" /></p>
<p>by the formula </p>
<p><img src="https://s0.wp.com/latex.php?latex=x%5EY+%3D+%5Cexp%28Y%5E%5Cdagger+%5Cln+x+%29+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x^Y = &#92;exp(Y^&#92;dagger &#92;ln x ) " class="latex" /></p>
<p>which holds for all <img src="https://s0.wp.com/latex.php?latex=x+%5Cin+%280%2C%5Cinfty%29%5ES.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x &#92;in (0,&#92;infty)^S." class="latex" />  </p>
<p><b>Proof.</b>  A straightforward calculation.  By the way, this formula would look a bit nicer if we treated <img src="https://s0.wp.com/latex.php?latex=%5Cln+x&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;ln x" class="latex" /> as a row vector and multiplied it on the right by <img src="https://s0.wp.com/latex.php?latex=Y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y" class="latex" />: then we would have</p>
<p><img src="https://s0.wp.com/latex.php?latex=x%5EY+%3D+%5Cexp%28%28%5Cln+x%29+Y%29+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x^Y = &#92;exp((&#92;ln x) Y) " class="latex" /></p>
<p>The problem is that we are following the usual convention of multiplying vectors by matrices on the left, yet writing the matrix on the right in <img src="https://s0.wp.com/latex.php?latex=x%5EY.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x^Y." class="latex" />  Taking the transpose <img src="https://s0.wp.com/latex.php?latex=Y%5E%5Cdagger&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y^&#92;dagger" class="latex" /> of the matrix <img src="https://s0.wp.com/latex.php?latex=Y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y" class="latex" /> serves to compensate for this.  &nbsp;  &#9608;</p>
<p>Now, given our vector <img src="https://s0.wp.com/latex.php?latex=%5Cpsi+%5Cin+%280%2C%5Cinfty%29%5EK&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi &#92;in (0,&#92;infty)^K" class="latex" /> with <img src="https://s0.wp.com/latex.php?latex=H+%5Cpsi+%3D+0%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H &#92;psi = 0," class="latex" /> we can take its logarithm and get <img src="https://s0.wp.com/latex.php?latex=%5Cln+%5Cpsi+%5Cin+%5Cmathbb%7BR%7D%5EK.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;ln &#92;psi &#92;in &#92;mathbb{R}^K." class="latex" />   Lemma 1 says that</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5EK+%3D+%5Cmathrm%7Bker%7D+%5Cpartial%5E%5Cdagger+%2B+%5Cmathrm%7Bim%7D+Y%5E%5Cdagger+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^K = &#92;mathrm{ker} &#92;partial^&#92;dagger + &#92;mathrm{im} Y^&#92;dagger " class="latex" /></p>
<p>so we can write</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cln+%5Cpsi+%3D++%5Calpha+%2B+Y%5E%5Cdagger+%5Cbeta+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;ln &#92;psi =  &#92;alpha + Y^&#92;dagger &#92;beta " class="latex" /></p>
<p>where <img src="https://s0.wp.com/latex.php?latex=%5Calpha+%5Cin+%5Cmathrm%7Bker%7D+%5Cpartial%5E%5Cdagger&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;alpha &#92;in &#92;mathrm{ker} &#92;partial^&#92;dagger" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=%5Cbeta+%5Cin+%5Cmathbb%7BR%7D%5ES.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;beta &#92;in &#92;mathbb{R}^S." class="latex" />  Moreover, we can write</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cbeta+%3D+%5Cln+x+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;beta = &#92;ln x " class="latex" /></p>
<p>for some <img src="https://s0.wp.com/latex.php?latex=x+%5Cin+%280%2C%5Cinfty%29%5ES%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x &#92;in (0,&#92;infty)^S," class="latex" /> so that</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cln+%5Cpsi+%3D+%5Calpha+%2B+Y%5E%5Cdagger+%28%5Cln+x%29+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;ln &#92;psi = &#92;alpha + Y^&#92;dagger (&#92;ln x) " class="latex" /></p>
<p>Exponentiating both sides component-wise, we get</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cpsi++%3D+++%5Cexp%28%5Calpha%29+%5C%3B+%5Cexp%28Y%5E%5Cdagger+%28%5Cln+x%29%29+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi  =   &#92;exp(&#92;alpha) &#92;; &#92;exp(Y^&#92;dagger (&#92;ln x)) " class="latex" /></p>
<p>where at right we are taking the component-wise product of vectors.  Thanks to Lemma 2, we conclude that</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cpsi+%3D+%5Cexp%28%5Calpha%29+x%5EY+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi = &#92;exp(&#92;alpha) x^Y " class="latex" /></p>
<p>So, we have taken <img src="https://s0.wp.com/latex.php?latex=%5Cpsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi" class="latex" /> and <i>almost</i> written it in the form <img src="https://s0.wp.com/latex.php?latex=x%5EY&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x^Y" class="latex" />&#8212;but not quite!  We can adjust <img src="https://s0.wp.com/latex.php?latex=%5Cpsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi" class="latex" /> to make it be of this form:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cexp%28-%5Calpha%29+%5Cpsi+%3D+x%5EY+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;exp(-&#92;alpha) &#92;psi = x^Y " class="latex" /></p>
<p>Clearly all the components of <img src="https://s0.wp.com/latex.php?latex=%5Cexp%28-%5Calpha%29+%5Cpsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;exp(-&#92;alpha) &#92;psi" class="latex" /> are positive, since the same is true for both <img src="https://s0.wp.com/latex.php?latex=%5Cpsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=%5Cexp%28-%5Calpha%29.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;exp(-&#92;alpha)." class="latex" />  So, the only remaining task is to check that </p>
<p><img src="https://s0.wp.com/latex.php?latex=H%28%5Cexp%28-%5Calpha%29+%5Cpsi%29+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H(&#92;exp(-&#92;alpha) &#92;psi) = 0 " class="latex" /></p>
<p>We do this using two lemmas:</p>
<p><b>Lemma 3.</b>    If <img src="https://s0.wp.com/latex.php?latex=H+%5Cpsi+%3D+0&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H &#92;psi = 0" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=%5Calpha+%5Cin+%5Cmathrm%7Bker%7D+%5Cpartial%5E%5Cdagger%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;alpha &#92;in &#92;mathrm{ker} &#92;partial^&#92;dagger," class="latex" /> then <img src="https://s0.wp.com/latex.php?latex=H%28%5Cexp%28-%5Calpha%29+%5Cpsi%29+%3D+0.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H(&#92;exp(-&#92;alpha) &#92;psi) = 0." class="latex" /> </p>
<p><b>Proof.</b>  It is enough to check that multiplication by <img src="https://s0.wp.com/latex.php?latex=%5Cexp%28-%5Calpha%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;exp(-&#92;alpha)" class="latex" /> commutes with the Hamiltonian <img src="https://s0.wp.com/latex.php?latex=H%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H," class="latex" /> since then</p>
<p><img src="https://s0.wp.com/latex.php?latex=H%28%5Cexp%28-%5Calpha%29+%5Cpsi%29+%3D+%5Cexp%28-%5Calpha%29+H+%5Cpsi+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H(&#92;exp(-&#92;alpha) &#92;psi) = &#92;exp(-&#92;alpha) H &#92;psi = 0 " class="latex" /></p>
<p>Recall from <a href="http://math.ucr.edu/home/baez/networks/networks_23.html">Part 23</a> that <img src="https://s0.wp.com/latex.php?latex=H&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H" class="latex" /> is the Hamiltonian of a Markov process associated to this &#8216;graph with rates&#8217;:</p>
<div align="center"><img src="https://i1.wp.com/math.ucr.edu/home/baez/networks/markov_process_diagram_1.png" /></div>
<p>As noted here:</p>
<p>&bull; John Baez and Brendan Fong, <a href="http://arxiv.org/abs/1203.2035">A Noether theorem for Markov processes</a>.</p>
<p>multiplication by some function on <img src="https://s0.wp.com/latex.php?latex=K&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="K" class="latex" /> commutes with <img src="https://s0.wp.com/latex.php?latex=H&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H" class="latex" /> if and only if that function is constant on each connected component of this graph.   Such functions are called <b>conserved quantities</b>.  </p>
<p>So, it suffices to show that <img src="https://s0.wp.com/latex.php?latex=%5Cexp%28-%5Calpha%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;exp(-&#92;alpha)" class="latex" /> is constant on each connected component.   For this, it is enough to show that <img src="https://s0.wp.com/latex.php?latex=%5Calpha&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;alpha" class="latex" /> itself is constant on each connected component.  But this will follow from the next lemma, since <img src="https://s0.wp.com/latex.php?latex=%5Calpha+%5Cin+%5Cmathrm%7Bker%7D+%5Cpartial%5E%5Cdagger.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;alpha &#92;in &#92;mathrm{ker} &#92;partial^&#92;dagger." class="latex" />  &nbsp;  &#9608;</p>
<p><b>Lemma 4.</b>  A function <img src="https://s0.wp.com/latex.php?latex=%5Calpha+%5Cin+%5Cmathbb%7BR%7D%5EK&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;alpha &#92;in &#92;mathbb{R}^K" class="latex" /> is a conserved quantity iff <img src="https://s0.wp.com/latex.php?latex=%5Cpartial%5E%5Cdagger+%5Calpha+%3D+0+.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;partial^&#92;dagger &#92;alpha = 0 ." class="latex" />   In other words, <img src="https://s0.wp.com/latex.php?latex=%5Calpha&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;alpha" class="latex" /> is constant on each connected component of the graph <img src="https://s0.wp.com/latex.php?latex=s%2C+t%3A+T+%5Cto+K&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s, t: T &#92;to K" class="latex" /> iff <img src="https://s0.wp.com/latex.php?latex=%5Cpartial%5E%5Cdagger+%5Calpha+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;partial^&#92;dagger &#92;alpha = 0 " class="latex" />.</p>
<p><b>Proof.</b>  Suppose <img src="https://s0.wp.com/latex.php?latex=%5Cpartial%5E%5Cdagger+%5Calpha+%3D+0%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;partial^&#92;dagger &#92;alpha = 0," class="latex" /> or in other words, <img src="https://s0.wp.com/latex.php?latex=%5Calpha+%5Cin+%5Cmathrm%7Bker%7D+%5Cpartial%5E%5Cdagger%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;alpha &#92;in &#92;mathrm{ker} &#92;partial^&#92;dagger," class="latex" /> or in still other words, <img src="https://s0.wp.com/latex.php?latex=%5Calpha+%5Cin+%28%5Cmathrm%7Bim%7D+%5Cpartial%29%5E%5Cperp.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;alpha &#92;in (&#92;mathrm{im} &#92;partial)^&#92;perp." class="latex" />  To show that <img src="https://s0.wp.com/latex.php?latex=%5Calpha&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;alpha" class="latex" /> is constant on each connected component, it suffices to show that whenever we have two complexes connected by a transition, like this:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Ctau%3A+%5Ckappa+%5Cto+%5Ckappa%27+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau: &#92;kappa &#92;to &#92;kappa&#039; " class="latex" /></p>
<p>then <img src="https://s0.wp.com/latex.php?latex=%5Calpha&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;alpha" class="latex" /> takes the same value at both these complexes:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Calpha_%5Ckappa+%3D+%5Calpha_%7B%5Ckappa%27%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;alpha_&#92;kappa = &#92;alpha_{&#92;kappa&#039;} " class="latex" /></p>
<p>To see this, note</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cpartial+%5Ctau+%3D+t%28%5Ctau%29+-+s%28%5Ctau%29+%3D+%5Ckappa%27+-+%5Ckappa+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;partial &#92;tau = t(&#92;tau) - s(&#92;tau) = &#92;kappa&#039; - &#92;kappa " class="latex" /></p>
<p>and since <img src="https://s0.wp.com/latex.php?latex=%5Calpha+%5Cin+%28%5Cmathrm%7Bim%7D+%5Cpartial%29%5E%5Cperp%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;alpha &#92;in (&#92;mathrm{im} &#92;partial)^&#92;perp," class="latex" /> we conclude</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Clangle+%5Calpha%2C+%5Ckappa%27+-+%5Ckappa+%5Crangle+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;langle &#92;alpha, &#92;kappa&#039; - &#92;kappa &#92;rangle = 0 " class="latex" /></p>
<p>But calculating this inner product, we see</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Calpha_%7B%5Ckappa%27%7D+-+%5Calpha_%7B%5Ckappa%7D+%3D+0++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;alpha_{&#92;kappa&#039;} - &#92;alpha_{&#92;kappa} = 0  " class="latex" /></p>
<p>as desired.  </p>
<p>For the converse, we simply turn the argument around: if <img src="https://s0.wp.com/latex.php?latex=%5Calpha&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;alpha" class="latex" /> is constant on each connected component, we see <img src="https://s0.wp.com/latex.php?latex=%5Clangle+%5Calpha%2C+%5Ckappa%27+-+%5Ckappa+%5Crangle+%3D+0&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;langle &#92;alpha, &#92;kappa&#039; - &#92;kappa &#92;rangle = 0" class="latex" /> whenever there is a transition <img src="https://s0.wp.com/latex.php?latex=%5Ctau+%3A+%5Ckappa+%5Cto+%5Ckappa%27.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau : &#92;kappa &#92;to &#92;kappa&#039;." class="latex" />  It follows that <img src="https://s0.wp.com/latex.php?latex=%5Clangle+%5Calpha%2C+%5Cpartial+%5Ctau+%5Crangle+%3D+0&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;langle &#92;alpha, &#92;partial &#92;tau &#92;rangle = 0" class="latex" /> for every transition <img src="https://s0.wp.com/latex.php?latex=%5Ctau%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau," class="latex" /> so <img src="https://s0.wp.com/latex.php?latex=%5Calpha+%5Cin+%28%5Cmathrm%7Bim%7D+%5Cpartial%29%5E%5Cperp+.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;alpha &#92;in (&#92;mathrm{im} &#92;partial)^&#92;perp ." class="latex" /></p>
<p>And thus concludes the proof of the lemma!   &nbsp;  &#9608;</p>
<p>And thus concludes the proof of the theorem!   &nbsp;  &#9608;</p>
<p>And thus concludes this post!   </p>
									</div>

				<p class="postmetadata">
				<img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/speech_bubble.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2012/08/23/network-theory-part-24/#comments">6 Comments</a>				| <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/documents.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/category/chemistry/" rel="category tag">chemistry</a>, <a href="https://johncarlosbaez.wordpress.com/category/mathematics/" rel="category tag">mathematics</a>, <a href="https://johncarlosbaez.wordpress.com/category/networks/" rel="category tag">networks</a>, <a href="https://johncarlosbaez.wordpress.com/category/probability/" rel="category tag">probability</a>								 | <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/permalink.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2012/08/23/network-theory-part-24/" rel="bookmark" title="Permanent Link to Network Theory (Part&nbsp;24)">Permalink</a>
<br /><img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/figure_ver1.gif" alt="" /> Posted by John Baez				</p>
			</div>
			<hr />
		
			<div class="post-11611 post type-post status-publish format-standard hentry category-chemistry category-mathematics category-networks category-probability" id="post-11611">
				<h2><a href="https://johncarlosbaez.wordpress.com/2012/08/21/network-theory-part-23/" rel="bookmark">Network Theory (Part&nbsp;23)</a></h2>
				<small>21 August, 2012</small><br />


				<div class="entry">
					<p>We&#8217;ve been looking at reaction networks, and we&#8217;re getting ready to find equilibrium solutions of the equations they give.  To do this, we&#8217;ll need to connect them to another kind of network we&#8217;ve studied.   A reaction network is something like this:</p>
<div align="center"><img width="200" src="https://i0.wp.com/math.ucr.edu/home/baez/networks/chemical_reaction_network_part_20_III.png" alt="" /></div>
<p>It&#8217;s a bunch of <b>complexes</b>, which are sums of basic building-blocks called <b>species</b>, together with arrows called <b>transitions</b> going between the complexes.  If we know a number  for each transition describing the rate at which it occurs, we get an equation called the &#8216;rate equation&#8217;.  This describes how the amount of each species changes with time.   We&#8217;ve been talking about this equation ever since the start of this series!   <a href="http://math.ucr.edu/home/baez/networks/networks_22.html">Last time</a>, we wrote it down in a new very compact form:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bd+x%7D%7Bd+t%7D+%3D+Y+H+x%5EY++%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{d x}{d t} = Y H x^Y  } " class="latex" /></p>
<p>Here <img src="https://s0.wp.com/latex.php?latex=x&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x" class="latex" /> is a vector whose components are the amounts of each species, while <img src="https://s0.wp.com/latex.php?latex=H&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=Y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y" class="latex" /> are certain matrices.</p>
<p>But now suppose we forget how each complex is made of species!  Suppose we just think of them as abstract things in their own right, like numbered boxes:</p>
<div align="center"><img width="200" src="https://i0.wp.com/math.ucr.edu/home/baez/networks/markov_process_vs_reaction_network_1.png" alt="" /></div>
<p>We can use these boxes to describe <b>states</b> of some system.  The arrows still describe <b>transitions</b>, but now we think of these as ways for the system to hop from one state to another.   Say we know a number for each transition describing the probability per time at which it occurs:</p>
<div align="center"><img width="200" src="https://i0.wp.com/math.ucr.edu/home/baez/networks/markov_process_vs_reaction_network_2.png" alt="" /></div>
<p>Then we get a &#8216;Markov process&#8217;&#8212;or in other words, a random walk where our system hops from one state to another.  If <img src="https://s0.wp.com/latex.php?latex=%5Cpsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi" class="latex" /> is the probability distribution saying how likely the system is to be in each state, this Markov process is described by this equation:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bd+%5Cpsi%7D%7Bd+t%7D+%3D+H+%5Cpsi++%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{d &#92;psi}{d t} = H &#92;psi  } " class="latex" /></p>
<p>This is simpler than the rate equation, because it&#8217;s linear.  But the matrix <img src="https://s0.wp.com/latex.php?latex=H&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H" class="latex" /> is the same&mdash;we&#8217;ll see that explicitly later on today.</p>
<p>What&#8217;s the point?  Well, our ultimate goal is to prove the deficiency zero theorem, which gives equilibrium solutions of the rate equation.  That means finding <img src="https://s0.wp.com/latex.php?latex=x&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x" class="latex" /> with </p>
<p><img src="https://s0.wp.com/latex.php?latex=Y+H+x%5EY+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y H x^Y = 0 " class="latex" /></p>
<p>Today we&#8217;ll find all equilibria for the Markov process, meaning all <img src="https://s0.wp.com/latex.php?latex=%5Cpsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi" class="latex" /> with</p>
<p><img src="https://s0.wp.com/latex.php?latex=H+%5Cpsi+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H &#92;psi = 0 " class="latex" /></p>
<p>Then next time we&#8217;ll show some of these have the form</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cpsi+%3D+x%5EY+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi = x^Y " class="latex" /></p>
<p>So, we&#8217;ll get </p>
<p><img src="https://s0.wp.com/latex.php?latex=H+x%5EY+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H x^Y = 0 " class="latex" /></p>
<p>and thus</p>
<p><img src="https://s0.wp.com/latex.php?latex=Y+H+x%5EY+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y H x^Y = 0 " class="latex" /></p>
<p>as desired!</p>
<p>So, let&#8217;s get to to work.</p>
<h3> The Markov process of a graph with rates </h3>
<p>We&#8217;ve been looking at stochastic reaction networks, which are things like this:</p>
<div align="center">
<img src="https://i2.wp.com/math.ucr.edu/home/baez/networks/reaction_network_diagram_1.png" alt="" />
</div>
<p>However, we can build a Markov process starting from just part of this information:</p>
<div align="center">
<img src="https://i1.wp.com/math.ucr.edu/home/baez/networks/markov_process_diagram_1.png" alt="" />
</div>
<p>Let&#8217;s call this thing a &#8216;graph with rates&#8217;, for lack of a better name.  We&#8217;ve been calling the things in <img src="https://s0.wp.com/latex.php?latex=K&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="K" class="latex" /> &#8216;complexes&#8217;, but now we&#8217;ll think of them as &#8216;states&#8217;.  So:</p>
<p><b>Definition.</b>  A <b>graph with rates</b> consists of:</p>
<p>&bull; a finite set of <b>states</b> <img src="https://s0.wp.com/latex.php?latex=K%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="K," class="latex" /></p>
<p>&bull; a finite set of <b>transitions</b> <img src="https://s0.wp.com/latex.php?latex=T%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T," class="latex" /></p>
<p>&bull; a map <img src="https://s0.wp.com/latex.php?latex=r%3A+T+%5Cto+%280%2C%5Cinfty%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="r: T &#92;to (0,&#92;infty)" class="latex" /> giving a <b>rate constant</b> for each transition,</p>
<p>&bull; <b>source</b> and <b>target</b> maps <img src="https://s0.wp.com/latex.php?latex=s%2Ct+%3A+T+%5Cto+K&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s,t : T &#92;to K" class="latex" /> saying where each transition starts and ends.</p>
<p>Starting from this, we can get a <a href="http://math.ucr.edu/home/baez/networks/networks_11.html">Markov process</a> describing how a probability distribution <img src="https://s0.wp.com/latex.php?latex=%5Cpsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi" class="latex" /> on our set of states will change with time.  As usual, this Markov process is described by a master equation:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bd+%5Cpsi%7D%7Bd+t%7D+%3D+H+%5Cpsi+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{d &#92;psi}{d t} = H &#92;psi } " class="latex" /></p>
<p>for some Hamiltonian:</p>
<p><img src="https://s0.wp.com/latex.php?latex=H+%3A+%5Cmathbb%7BR%7D%5EK+%5Cto+%5Cmathbb%7BR%7D%5EK+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H : &#92;mathbb{R}^K &#92;to &#92;mathbb{R}^K " class="latex" /></p>
<p>What is this Hamiltonian, exactly?  Let&#8217;s think of it as a matrix where <img src="https://s0.wp.com/latex.php?latex=H_%7Bi+j%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H_{i j}" class="latex" /> is the probability per time for our system to hop from the state <img src="https://s0.wp.com/latex.php?latex=j&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="j" class="latex" /> to the state <img src="https://s0.wp.com/latex.php?latex=i.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i." class="latex" />   This looks backwards, but don&#8217;t blame me&mdash;blame the guys who invented the usual conventions for matrix algebra.  Clearly if <img src="https://s0.wp.com/latex.php?latex=i+%5Cne+j&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i &#92;ne j" class="latex" /> this probability per time should be the sum of the rate constants of all transitions going from <img src="https://s0.wp.com/latex.php?latex=j&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="j" class="latex" /> to <img src="https://s0.wp.com/latex.php?latex=i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i" class="latex" />:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+i+%5Cne+j+%5Cquad+%5CRightarrow+%5Cquad+H_%7Bi+j%7D+%3D++%5Csum_%7B%5Ctau%3A+j+%5Cto+i%7D+r%28%5Ctau%29+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ i &#92;ne j &#92;quad &#92;Rightarrow &#92;quad H_{i j} =  &#92;sum_{&#92;tau: j &#92;to i} r(&#92;tau) } " class="latex" /></p>
<p>where we write <img src="https://s0.wp.com/latex.php?latex=%5Ctau%3A+j+%5Cto+i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau: j &#92;to i" class="latex" /> when <img src="https://s0.wp.com/latex.php?latex=%5Ctau&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau" class="latex" /> is a transition with source <img src="https://s0.wp.com/latex.php?latex=j&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="j" class="latex" /> and target <img src="https://s0.wp.com/latex.php?latex=i.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i." class="latex" /></p>
<p>Now, we saw in <a href="http://math.ucr.edu/home/baez/networks/networks_11.html">Part 11</a> that for a probability distribution to remain a probability distribution as it evolves in time according to the master equation, we need <img src="https://s0.wp.com/latex.php?latex=H&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H" class="latex" /> to be <b>infinitesimal stochastic</b>: its off-diagonal entries must be nonnegative, and the sum of the entries in each column must be zero.  </p>
<p>The first condition holds already, and the second one tells us what the diagonal entries must be.  So, we&#8217;re basically done describing <img src="https://s0.wp.com/latex.php?latex=H.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H." class="latex" />  But we can summarize it this way:</p>
<p><b>Puzzle 1.</b>  Think of <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5EK&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^K" class="latex" /> as the vector space consisting of finite linear combinations of elements <img src="https://s0.wp.com/latex.php?latex=%5Ckappa+%5Cin+K.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;kappa &#92;in K." class="latex" />  Then show</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B++H+%5Ckappa+%3D+%5Csum_%7Bs%28%5Ctau%29+%3D+%5Ckappa%7D+r%28%5Ctau%29+%28t%28%5Ctau%29+-+s%28%5Ctau%29%29+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{  H &#92;kappa = &#92;sum_{s(&#92;tau) = &#92;kappa} r(&#92;tau) (t(&#92;tau) - s(&#92;tau)) } " class="latex" /> </p>
<h3>  Equilibrium solutions of the master equation </h3>
<p>Now we&#8217;ll classify <b>equilibrium solutions</b> of the master equation, meaning <img src="https://s0.wp.com/latex.php?latex=%5Cpsi+%5Cin+%5Cmathbb%7BR%7D%5EK&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi &#92;in &#92;mathbb{R}^K" class="latex" /> with </p>
<p><img src="https://s0.wp.com/latex.php?latex=H+%5Cpsi+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H &#92;psi = 0 " class="latex" /></p>
<p>We&#8217;ll do only do this when our graph with rates is &#8216;weakly reversible&#8217;.  This concept doesn&#8217;t actually depend on the rates, so let&#8217;s be general and say:</p>
<p><b>Definition.</b> A graph is <b>weakly reversible</b> if for every edge <img src="https://s0.wp.com/latex.php?latex=%5Ctau+%3A+i+%5Cto+j%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau : i &#92;to j," class="latex" /> there is <b>directed path</b> going back from <img src="https://s0.wp.com/latex.php?latex=j&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="j" class="latex" /> to <img src="https://s0.wp.com/latex.php?latex=i%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i," class="latex" /> meaning that we have edges</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Ctau_1+%3A+j+%5Cto+j_1+%2C+%5Cquad+%5Ctau_2+%3A+j_1+%5Cto+j_2+%2C+%5Cquad+%5Cdots%2C+%5Cquad+%5Ctau_n%3A+j_%7Bn-1%7D+%5Cto+i+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau_1 : j &#92;to j_1 , &#92;quad &#92;tau_2 : j_1 &#92;to j_2 , &#92;quad &#92;dots, &#92;quad &#92;tau_n: j_{n-1} &#92;to i " class="latex" /></p>
<p>This graph with rates is <i>not</i> weakly reversible:</p>
<div align="center"><img width="200" src="https://i0.wp.com/math.ucr.edu/home/baez/networks/markov_process_vs_reaction_network_2.png" alt="" /></div>
<p>but this one is:</p>
<div align="center"><img width="200" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/markov_process_vs_reaction_network_3.png" alt="" /></div>
<p>The good thing about the weakly reversible case is that we get one equilibrium solution of the master equation for each component of our graph, and all equilibrium solutions are linear combinations of these.   This is <i>not</i> true in general!  For example, this guy is not weakly reversible:</p>
<div align="center"><img width="240" src="https://i0.wp.com/math.ucr.edu/home/baez/networks/markov_process_not_weakly_reversible.png" alt="" /></div>
<p>It has only one component, but the master equation has two linearly independent equilibrium solutions: one that vanishes except at the state 0, and one that vanishes except at the state 2.  </p>
<p>The idea of a &#8216;component&#8217; is supposed to be fairly intuitive&#8212;our graph falls apart into pieces called components&#8212;but we should make it precise.  As explained in <a href="http://math.ucr.edu/home/baez/networks/networks_21.html">Part 21</a>, the graphs we&#8217;re using here are directed multigraphs, meaning things like</p>
<p><img src="https://s0.wp.com/latex.php?latex=s%2C+t+%3A+E+%5Cto+V++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s, t : E &#92;to V  " class="latex" /></p>
<p>where <img src="https://s0.wp.com/latex.php?latex=E&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="E" class="latex" /> is the set of <b>edges</b> (our transitions) and <img src="https://s0.wp.com/latex.php?latex=V&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="V" class="latex" /> is the set of <b>vertices</b> (our states).    There are actually two famous concepts of &#8216;component&#8217; for graphs of this sort: &#8216;strongly connected&#8217; components and &#8216;connected&#8217; components.   We only need connected components, but let me explain both concepts, in a futile attempt to slake your insatiable thirst for knowledge.</p>
<p>Two vertices <img src="https://s0.wp.com/latex.php?latex=i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=j&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="j" class="latex" /> of a graph lie in the same <b>strongly connected component</b> iff you can find a directed path of edges from <img src="https://s0.wp.com/latex.php?latex=i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i" class="latex" /> to <img src="https://s0.wp.com/latex.php?latex=j&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="j" class="latex" /> and also one from <img src="https://s0.wp.com/latex.php?latex=j&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="j" class="latex" /> back to <img src="https://s0.wp.com/latex.php?latex=i.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i." class="latex" />  </p>
<p>Remember, a directed path from <img src="https://s0.wp.com/latex.php?latex=i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i" class="latex" /> to <img src="https://s0.wp.com/latex.php?latex=j&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="j" class="latex" /> looks like this:</p>
<p><img src="https://s0.wp.com/latex.php?latex=i+%5Cto+a+%5Cto+b+%5Cto+c+%5Cto+j+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i &#92;to a &#92;to b &#92;to c &#92;to j " class="latex" /></p>
<p>Here&#8217;s a path from <img src="https://s0.wp.com/latex.php?latex=x&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x" class="latex" /> to <img src="https://s0.wp.com/latex.php?latex=y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="y" class="latex" /> that is not directed:</p>
<p><img src="https://s0.wp.com/latex.php?latex=i+%5Cto+a+%5Cleftarrow+b+%5Cto+c+%5Cto+j+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i &#92;to a &#92;leftarrow b &#92;to c &#92;to j " class="latex" /></p>
<p>and I hope you can write down the obvious but tedious definition of an &#8216;undirected path&#8217;, meaning a path made of edges that don&#8217;t necessarily point in the correct direction.   Given that, we say two vertices <img src="https://s0.wp.com/latex.php?latex=i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=j&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="j" class="latex" /> lie in the same <b>connected component</b> iff you can find an <i>undirected</i> path going from <img src="https://s0.wp.com/latex.php?latex=i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i" class="latex" /> to <img src="https://s0.wp.com/latex.php?latex=j.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="j." class="latex" />  In this case, there will automatically also be an undirected path going from <img src="https://s0.wp.com/latex.php?latex=j&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="j" class="latex" /> to <img src="https://s0.wp.com/latex.php?latex=i.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i." class="latex" /></p>
<p>For example, <img src="https://s0.wp.com/latex.php?latex=i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=j&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="j" class="latex" /> lie in the same connected component here, but not the same strongly connected component:</p>
<p><img src="https://s0.wp.com/latex.php?latex=i+%5Cto+a+%5Cleftarrow+b+%5Cto+c+%5Cto+j+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i &#92;to a &#92;leftarrow b &#92;to c &#92;to j " class="latex" /></p>
<p>Here&#8217;s a graph with one connected component and 3 strongly connected components, which are marked in blue:</p>
<div align="center"><a href="http://en.wikipedia.org/wiki/Strongly_connected_component"><img src="https://i2.wp.com/math.ucr.edu/home/baez/networks/strongly_connected_component.png" /></a></div>
<p>For the theory we&#8217;re looking at now, <i>we only care about connected components, not strongly connected components!</i>   However:</p>
<p><b>Puzzle 2.</b>  Show that for weakly reversible graph, the connected components are the same as the strongly connected components.  </p>
<p>With these definitions out of way, we can state today&#8217;s big theorem:</p>
<p><b>Theorem.</b>  Suppose <img src="https://s0.wp.com/latex.php?latex=H&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H" class="latex" /> is the Hamiltonian of a weakly reversible graph with rates:</p>
<div align="center">
<img src="https://i1.wp.com/math.ucr.edu/home/baez/networks/markov_process_diagram_1.png" alt="" />
</div>
<p>Then for each connected component <img src="https://s0.wp.com/latex.php?latex=C+%5Csubseteq+K%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="C &#92;subseteq K," class="latex" /> there exists a unique probability distribution <img src="https://s0.wp.com/latex.php?latex=%5Cpsi_C+%5Cin+%5Cmathbb%7BR%7D%5EK&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi_C &#92;in &#92;mathbb{R}^K" class="latex" /> that is positive on that component, zero elsewhere, and is an equilibrium solution of the master equation:</p>
<p><img src="https://s0.wp.com/latex.php?latex=H+%5Cpsi_C+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H &#92;psi_C = 0 " class="latex" /></p>
<p>Moreover, these probability distributions <img src="https://s0.wp.com/latex.php?latex=%5Cpsi_C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi_C" class="latex" /> form a basis for the space of equilibrium solutions of the master equation.  So, the dimension of this space is the number of components of <img src="https://s0.wp.com/latex.php?latex=K.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="K." class="latex" /></p>
<p><i>Proof.</i>   We start by assuming our graph has one connected component.  We use the Perron&ndash;Frobenius theorem, as explained in <a href="http://math.ucr.edu/home/baez/networks/networks_20.html">Part 20</a>.  This applies to &#8216;nonnegative&#8217; matrices, meaning those whose entries are all nonnegative.  That is not true of <img src="https://s0.wp.com/latex.php?latex=H&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H" class="latex" /> itself, but only its diagonal entries can be negative, so if we choose a large enough number <img src="https://s0.wp.com/latex.php?latex=c+%3E+0%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="c &gt; 0," class="latex" /> <img src="https://s0.wp.com/latex.php?latex=H+%2B+c+I&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H + c I" class="latex" /> will be nonnegative.  </p>
<p>Since our graph is weakly reversible and has one connected component, it follows straight from the definitions that the operator <img src="https://s0.wp.com/latex.php?latex=H+%2B+c+I&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H + c I" class="latex" /> will also be &#8216;irreducible&#8217; in the sense of <a href="http://math.ucr.edu/home/baez/networks/networks_20.html">Part 20</a>.  The Perron&ndash;Frobenius theorem then swings into action, and we instantly conclude several things.</p>
<p>First, <img src="https://s0.wp.com/latex.php?latex=H+%2B+c+I&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H + c I" class="latex" /> has a positive real eigenvalue <img src="https://s0.wp.com/latex.php?latex=r&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="r" class="latex" /> such that any other eigenvalue, possibly complex, has absolute value <img src="https://s0.wp.com/latex.php?latex=%5Cle+r.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;le r." class="latex" />  Second, there is an eigenvector <img src="https://s0.wp.com/latex.php?latex=%5Cpsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi" class="latex" /> with eigenvalue <img src="https://s0.wp.com/latex.php?latex=r&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="r" class="latex" /> and all positive components.  Third, any other eigenvector with eigenvalue <img src="https://s0.wp.com/latex.php?latex=r&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="r" class="latex" /> is a scalar multiple of <img src="https://s0.wp.com/latex.php?latex=%5Cpsi.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi." class="latex" />  </p>
<p>Subtracting <img src="https://s0.wp.com/latex.php?latex=c%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="c," class="latex" /> it follows that <img src="https://s0.wp.com/latex.php?latex=%5Clambda+%3D+r+-+c&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;lambda = r - c" class="latex" /> is the eigenvalue of <img src="https://s0.wp.com/latex.php?latex=H&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H" class="latex" /> with the largest real part.  We have <img src="https://s0.wp.com/latex.php?latex=H+%5Cpsi+%3D+%5Clambda+%5Cpsi%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H &#92;psi = &#92;lambda &#92;psi," class="latex" /> and any other vector with this property is a scalar multiple of <img src="https://s0.wp.com/latex.php?latex=%5Cpsi.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi." class="latex" />   </p>
<p>We can show that in fact <img src="https://s0.wp.com/latex.php?latex=%5Clambda+%3D+0.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;lambda = 0." class="latex" />  To do this we copy an argument from <a href="http://math.ucr.edu/home/baez/networks/networks_20.html">Part 20</a>.   First, since <img src="https://s0.wp.com/latex.php?latex=%5Cpsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi" class="latex" /> is positive we can normalize it to be a probability distribution:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Csum_%7Bi+%5Cin+K%7D+%5Cpsi_i+%3D+1+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;sum_{i &#92;in K} &#92;psi_i = 1 } " class="latex" /></p>
<p>Since <img src="https://s0.wp.com/latex.php?latex=H&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H" class="latex" /> is infinitesimal stochastic, <img src="https://s0.wp.com/latex.php?latex=%5Cexp%28t+H%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;exp(t H)" class="latex" /> sends probability distributions to probability distributions:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Csum_%7Bi+%5Cin+K%7D+%28%5Cexp%28t+H%29+%5Cpsi%29_i+%3D+1+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;sum_{i &#92;in K} (&#92;exp(t H) &#92;psi)_i = 1 } " class="latex" /></p>
<p>for all <img src="https://s0.wp.com/latex.php?latex=t+%5Cge+0.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="t &#92;ge 0." class="latex" />  On the other hand,</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Csum_%7Bi+%5Cin+K%7D+%28%5Cexp%28t+H%29%5Cpsi%29_i+%3D+%5Csum_%7Bi+%5Cin+K%7D+e%5E%7Bt+%5Clambda%7D+%5Cpsi_i+%3D+e%5E%7Bt+%5Clambda%7D+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;sum_{i &#92;in K} (&#92;exp(t H)&#92;psi)_i = &#92;sum_{i &#92;in K} e^{t &#92;lambda} &#92;psi_i = e^{t &#92;lambda} } " class="latex" /></p>
<p>so we must have <img src="https://s0.wp.com/latex.php?latex=%5Clambda+%3D+0.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;lambda = 0." class="latex" />  </p>
<p>We conclude that when our graph has one connected component, there is a probability distribution <img src="https://s0.wp.com/latex.php?latex=%5Cpsi+%5Cin+%5Cmathbb%7BR%7D%5EK&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi &#92;in &#92;mathbb{R}^K" class="latex" /> that is positive everywhere and has <img src="https://s0.wp.com/latex.php?latex=H+%5Cpsi+%3D+0.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H &#92;psi = 0." class="latex" />  Moreover, any <img src="https://s0.wp.com/latex.php?latex=%5Cphi+%5Cin+%5Cmathbb%7BR%7D%5EK&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;phi &#92;in &#92;mathbb{R}^K" class="latex" /> with <img src="https://s0.wp.com/latex.php?latex=H+%5Cphi+%3D+0&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H &#92;phi = 0" class="latex" /> is a scalar multiple of <img src="https://s0.wp.com/latex.php?latex=%5Cpsi.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi." class="latex" /></p>
<p>When <img src="https://s0.wp.com/latex.php?latex=K&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="K" class="latex" /> has several components, the matrix <img src="https://s0.wp.com/latex.php?latex=H&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H" class="latex" /> is block diagonal, with one block for each component.  So, we can run the above argument on each component <img src="https://s0.wp.com/latex.php?latex=C+%5Csubseteq+K&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="C &#92;subseteq K" class="latex" /> and get a probability distribution <img src="https://s0.wp.com/latex.php?latex=%5Cpsi_C+%5Cin+%5Cmathbb%7BR%7D%5EK&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi_C &#92;in &#92;mathbb{R}^K" class="latex" /> that is positive on <img src="https://s0.wp.com/latex.php?latex=C.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="C." class="latex" />  We can then check that <img src="https://s0.wp.com/latex.php?latex=H+%5Cpsi_C+%3D+0&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H &#92;psi_C = 0" class="latex" /> and that every <img src="https://s0.wp.com/latex.php?latex=%5Cphi+%5Cin+%5Cmathbb%7BR%7D%5EK&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;phi &#92;in &#92;mathbb{R}^K" class="latex" /> with <img src="https://s0.wp.com/latex.php?latex=H+%5Cphi+%3D+0&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H &#92;phi = 0" class="latex" /> can be expressed as a linear combination of these probability distributions <img src="https://s0.wp.com/latex.php?latex=%5Cpsi_C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi_C" class="latex" /> in a unique way.   &nbsp;  &#9608;</p>
<p>This result must be absurdly familiar to people who study Markov processes, but I haven&#8217;t bothered to look up a reference yet.  Do you happen to know a good one?  I&#8217;d like to see one that generalizes this theorem to graphs that aren&#8217;t weakly reversible.  I think I see how it goes.  We don&#8217;t need that generalization right now, but it would be good to have around.</p>
<h3> The Hamiltonian, revisited </h3>
<p>One last small piece of business: <a href="http://math.ucr.edu/home/baez/networks/networks_22.html">last time</a> I showed you a very slick formula for the Hamiltonian <img src="https://s0.wp.com/latex.php?latex=H.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H." class="latex" />  I&#8217;d like to prove it agrees with the formula I gave this time.</p>
<p>We start with any graph with rates:</p>
<div align="center">
<img src="https://i1.wp.com/math.ucr.edu/home/baez/networks/markov_process_diagram_1.png" alt="" />
</div>
<p>We extend <img src="https://s0.wp.com/latex.php?latex=s&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=t&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="t" class="latex" /> to linear maps between vector spaces:</p>
<div align="center">
<img src="https://i0.wp.com/math.ucr.edu/home/baez/networks/markov_process_diagram_4.png" /></div>
<p>We define the <b>boundary operator</b> just as we did last time:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cpartial+%3D+t+-+s+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;partial = t - s " class="latex" /></p>
<p>Then we put an inner product on the vector spaces <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5ET&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^T" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5EK.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^K." class="latex" />  So, for <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5EK&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^K" class="latex" /> we let the elements of <img src="https://s0.wp.com/latex.php?latex=K&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="K" class="latex" /> be an orthonormal basis, but for <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5ET&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^T" class="latex" /> we define the inner product in a more clever way involving the rate constants:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Clangle+%5Ctau%2C+%5Ctau%27+%5Crangle+%3D+%5Cfrac%7B1%7D%7Br%28%5Ctau%29%7D+%5Cdelta_%7B%5Ctau%2C+%5Ctau%27%7D+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;langle &#92;tau, &#92;tau&#039; &#92;rangle = &#92;frac{1}{r(&#92;tau)} &#92;delta_{&#92;tau, &#92;tau&#039;} } " class="latex" /></p>
<p>where <img src="https://s0.wp.com/latex.php?latex=%5Ctau%2C+%5Ctau%27+%5Cin+T.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau, &#92;tau&#039; &#92;in T." class="latex" />  This lets us define adjoints of the maps <img src="https://s0.wp.com/latex.php?latex=s%2C+t&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s, t" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=%5Cpartial%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;partial," class="latex" /> via formulas like this:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Clangle+s%5E%5Cdagger+%5Cphi%2C+%5Cpsi+%5Crangle+%3D+%5Clangle+%5Cphi%2C+s+%5Cpsi+%5Crangle+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;langle s^&#92;dagger &#92;phi, &#92;psi &#92;rangle = &#92;langle &#92;phi, s &#92;psi &#92;rangle " class="latex" /></p>
<p>Then:</p>
<p><b>Theorem.</b>  The Hamiltonian for a graph with rates is given by </p>
<p><img src="https://s0.wp.com/latex.php?latex=H+%3D+%5Cpartial+s%5E%5Cdagger+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H = &#92;partial s^&#92;dagger " class="latex" /></p>
<p><i>Proof.</i>  It suffices to check that this formula agrees with the formula for <img src="https://s0.wp.com/latex.php?latex=H&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H" class="latex" /> given in Puzzle 1:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+++H+%5Ckappa+%3D+%5Csum_%7Bs%28%5Ctau%29+%3D+%5Ckappa%7D+r%28%5Ctau%29+%28t%28%5Ctau%29+-+s%28%5Ctau%29%29+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{   H &#92;kappa = &#92;sum_{s(&#92;tau) = &#92;kappa} r(&#92;tau) (t(&#92;tau) - s(&#92;tau)) } " class="latex" /> </p>
<p>Here we are using the complex <img src="https://s0.wp.com/latex.php?latex=%5Ckappa+%5Cin+K&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;kappa &#92;in K" class="latex" /> as a name for one of the standard basis vectors of <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5EK.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^K." class="latex" />   Similarly shall we write things like <img src="https://s0.wp.com/latex.php?latex=%5Ctau&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau" class="latex" /> or <img src="https://s0.wp.com/latex.php?latex=%5Ctau%27&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau&#039;" class="latex" /> for basis vectors of <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5ET.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^T." class="latex" /></p>
<p>First, we claim that</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+s%5E%5Cdagger+%5Ckappa+%3D+%5Csum_%7B%5Ctau%3A+%5C%3B+s%28%5Ctau%29+%3D+%5Ckappa%7D+r%28%5Ctau%29+%5C%2C+%5Ctau+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ s^&#92;dagger &#92;kappa = &#92;sum_{&#92;tau: &#92;; s(&#92;tau) = &#92;kappa} r(&#92;tau) &#92;, &#92;tau } " class="latex" /></p>
<p>To prove this it&#8217;s enough to check that taking the inner products of either sides with any basis vector <img src="https://s0.wp.com/latex.php?latex=%5Ctau%27%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau&#039;," class="latex" /> we get results that agree.  On the one hand:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Barray%7D%7Bccl%7D++%5Clangle+%5Ctau%27+%2C+s%5E%5Cdagger+%5Ckappa+%5Crangle+%26%3D%26+++%5Clangle+s+%5Ctau%27%2C+%5Ckappa+%5Crangle+%5C%5C++%5C%5C++%26%3D%26+%5Cdelta_%7Bs%28%5Ctau%27%29%2C+%5Ckappa%7D++++%5Cend%7Barray%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;begin{array}{ccl}  &#92;langle &#92;tau&#039; , s^&#92;dagger &#92;kappa &#92;rangle &amp;=&amp;   &#92;langle s &#92;tau&#039;, &#92;kappa &#92;rangle &#92;&#92;  &#92;&#92;  &amp;=&amp; &#92;delta_{s(&#92;tau&#039;), &#92;kappa}    &#92;end{array} " class="latex" /></p>
<p>On the other hand:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Barray%7D%7Bccl%7D+%5Cdisplaystyle%7B+%5Clangle+%5Ctau%27%2C+%5Csum_%7B%5Ctau%3A+%5C%3B+s%28%5Ctau%29+%3D+%5Ckappa%7D+r%28%5Ctau%29+%5C%2C+%5Ctau+%5Crangle+%7D+%26%3D%26++%5Csum_%7B%5Ctau%3A+%5C%3B+s%28%5Ctau%29+%3D+%5Ckappa%7D+r%28%5Ctau%29+%5C%2C+%5Clangle+%5Ctau%27%2C+%5Ctau+%5Crangle+++%5C%5C++%5C%5C++%26%3D%26+%5Cdisplaystyle%7B+%5Csum_%7B%5Ctau%3A+%5C%3B+s%28%5Ctau%29+%3D+%5Ckappa%7D+%5Cdelta_%7B%5Ctau%27%2C+%5Ctau%7D+%7D+++%5C%5C++%5C%5C++%26%3D%26+++%5Cdelta_%7Bs%28%5Ctau%27%29%2C+%5Ckappa%7D+++%5Cend%7Barray%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;begin{array}{ccl} &#92;displaystyle{ &#92;langle &#92;tau&#039;, &#92;sum_{&#92;tau: &#92;; s(&#92;tau) = &#92;kappa} r(&#92;tau) &#92;, &#92;tau &#92;rangle } &amp;=&amp;  &#92;sum_{&#92;tau: &#92;; s(&#92;tau) = &#92;kappa} r(&#92;tau) &#92;, &#92;langle &#92;tau&#039;, &#92;tau &#92;rangle   &#92;&#92;  &#92;&#92;  &amp;=&amp; &#92;displaystyle{ &#92;sum_{&#92;tau: &#92;; s(&#92;tau) = &#92;kappa} &#92;delta_{&#92;tau&#039;, &#92;tau} }   &#92;&#92;  &#92;&#92;  &amp;=&amp;   &#92;delta_{s(&#92;tau&#039;), &#92;kappa}   &#92;end{array} " class="latex" /></p>
<p>where the factor of <img src="https://s0.wp.com/latex.php?latex=1%2Fr%28%5Ctau%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="1/r(&#92;tau)" class="latex" /> in the inner product on <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5ET&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^T" class="latex" /> cancels the visible factor of <img src="https://s0.wp.com/latex.php?latex=r%28%5Ctau%29.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="r(&#92;tau)." class="latex" />    So indeed the results match.</p>
<p>Using this formula for <img src="https://s0.wp.com/latex.php?latex=s%5E%5Cdagger+%5Ckappa&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s^&#92;dagger &#92;kappa" class="latex" />  we now see that</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Barray%7D%7Bccl%7D++H+%5Ckappa+%26%3D%26+%5Cpartial+s%5E%5Cdagger+%5Ckappa+++%5C%5C++%5C%5C++%26%3D%26+%5Cpartial+%5Cdisplaystyle%7B+%5Csum_%7B%5Ctau%3A+%5C%3B+s%28%5Ctau%29+%3D+%5Ckappa%7D+r%28%5Ctau%29+%5C%2C+%5Ctau+%7D++++%5C%5C++%5C%5C++%26%3D%26+%5Cdisplaystyle%7B+%5Csum_%7B%5Ctau%3A+%5C%3B+s%28%5Ctau%29+%3D+%5Ckappa%7D+r%28%5Ctau%29+%5C%2C+%28t%28%5Ctau%29+-+s%28%5Ctau%29%29+%7D++%5Cend%7Barray%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;begin{array}{ccl}  H &#92;kappa &amp;=&amp; &#92;partial s^&#92;dagger &#92;kappa   &#92;&#92;  &#92;&#92;  &amp;=&amp; &#92;partial &#92;displaystyle{ &#92;sum_{&#92;tau: &#92;; s(&#92;tau) = &#92;kappa} r(&#92;tau) &#92;, &#92;tau }    &#92;&#92;  &#92;&#92;  &amp;=&amp; &#92;displaystyle{ &#92;sum_{&#92;tau: &#92;; s(&#92;tau) = &#92;kappa} r(&#92;tau) &#92;, (t(&#92;tau) - s(&#92;tau)) }  &#92;end{array} " class="latex" /></p>
<p>which is precisely what we want.  &nbsp;  &#9608;</p>
<p>I hope you see through the formulas to their intuitive meaning.  As usual, the formulas are just a way of precisely saying something that makes plenty of sense.  If <img src="https://s0.wp.com/latex.php?latex=%5Ckappa&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;kappa" class="latex" /> is some state of our Markov process, <img src="https://s0.wp.com/latex.php?latex=s%5E%5Cdagger+%5Ckappa&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s^&#92;dagger &#92;kappa" class="latex" /> is the sum of all transitions starting at this state, weighted by their rates.  Applying <img src="https://s0.wp.com/latex.php?latex=%5Cpartial&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;partial" class="latex" /> to a transition tells us what change in state it causes.  So <img src="https://s0.wp.com/latex.php?latex=%5Cpartial+s%5E%5Cdagger+%5Ckappa&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;partial s^&#92;dagger &#92;kappa" class="latex" /> tells us the rate at which things change when we start in the state <img src="https://s0.wp.com/latex.php?latex=%5Ckappa.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;kappa." class="latex" /> That&#8217;s why <img src="https://s0.wp.com/latex.php?latex=%5Cpartial+s%5E%5Cdagger&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;partial s^&#92;dagger" class="latex" /> is the Hamiltonian for our Markov process.  After all, the Hamiltonian tells us how things change:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bd+%5Cpsi%7D%7Bd+t%7D+%3D+H+%5Cpsi+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{d &#92;psi}{d t} = H &#92;psi } " class="latex" /></p>
<p>Okay, we&#8217;ve got all the machinery in place.  Next time we&#8217;ll prove the deficiency zero theorem!</p>
									</div>

				<p class="postmetadata">
				<img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/speech_bubble.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2012/08/21/network-theory-part-23/#comments">9 Comments</a>				| <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/documents.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/category/chemistry/" rel="category tag">chemistry</a>, <a href="https://johncarlosbaez.wordpress.com/category/mathematics/" rel="category tag">mathematics</a>, <a href="https://johncarlosbaez.wordpress.com/category/networks/" rel="category tag">networks</a>, <a href="https://johncarlosbaez.wordpress.com/category/probability/" rel="category tag">probability</a>								 | <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/permalink.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2012/08/21/network-theory-part-23/" rel="bookmark" title="Permanent Link to Network Theory (Part&nbsp;23)">Permalink</a>
<br /><img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/figure_ver1.gif" alt="" /> Posted by John Baez				</p>
			</div>
			<hr />
		
			<div class="post-11586 post type-post status-publish format-standard hentry category-chemistry category-mathematics category-networks" id="post-11586">
				<h2><a href="https://johncarlosbaez.wordpress.com/2012/08/16/network-theory-part-22/" rel="bookmark">Network Theory (Part&nbsp;22)</a></h2>
				<small>16 August, 2012</small><br />


				<div class="entry">
					<p>Okay, now let&#8217;s dig deeper into the proof of the deficiency zero theorem.  We&#8217;re only going to prove a baby version, at first.  Later we can enhance it:</p>
<p><b>Deficiency Zero Theorem (Baby Version).</b>   Suppose we have a weakly reversible reaction network with deficiency zero.  Then for any choice of rate constants there exists an equilibrium solution of the rate equation where all species are present in nonzero amounts.</p>
<p>The first step is to write down the rate equation in a new, more conceptual way.  It&#8217;s incredibly cool.   You&#8217;ve probably seen Schr&ouml;dinger&#8217;s equation, which describes the motion of a quantum particle:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle+%7B+%5Cfrac%7Bd+%5Cpsi%7D%7Bd+t%7D+%3D+-i+H+%5Cpsi+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle { &#92;frac{d &#92;psi}{d t} = -i H &#92;psi } " class="latex" /></p>
<p>If you&#8217;ve been following this series, you&#8217;ve probably also seen the master equation, which describes the motion of a &#8216;stochastic&#8217; particle:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle+%7B+%5Cfrac%7Bd+%5Cpsi%7D%7Bd+t%7D+%3D+H+%5Cpsi+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle { &#92;frac{d &#92;psi}{d t} = H &#92;psi } " class="latex" /></p>
<p>A &#8216;stochastic&#8217; particle is one that&#8217;s carrying out a random walk, and now <img src="https://s0.wp.com/latex.php?latex=%5Cpsi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi" class="latex" /> describes its probability to be somewhere, instead of its amplitude.</p>
<p>Today we&#8217;ll see that the rate equation for a reaction network looks somewhat similar:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle+%7B+%5Cfrac%7Bd+x%7D%7Bd+t%7D+%3D++Y+H+x%5EY+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle { &#92;frac{d x}{d t} =  Y H x^Y } " class="latex" /></p>
<p>where <img src="https://s0.wp.com/latex.php?latex=Y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y" class="latex" /> is some matrix, and <img src="https://s0.wp.com/latex.php?latex=x%5EY&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x^Y" class="latex" /> is defined using a new thing called &#8216;matrix exponentiation&#8217;, which makes the equation <i>nonlinear!</i> </p>
<p>If you&#8217;re reading this you probably know how to multiply a vector by a matrix.  But if you&#8217;re like me, you&#8217;ve never seen anyone take a vector and raise to the power of some matrix!   I&#8217;ll explain it, don&#8217;t worry&#8230; right now I&#8217;m just trying to get you intrigued.  It&#8217;s not complicated, but it&#8217;s exciting how this unusual operation shows up naturally in chemistry.  That&#8217;s just what I&#8217;m looking for these days: new math ideas that show up in practical subjects like chemistry, and new ways that math can help people in these subjects.</p>
<p>Since we&#8217;re looking for an <i>equilibrium</i> solution of the rate equation, we actually want to solve</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle+%7B+%5Cfrac%7Bd+x%7D%7Bd+t%7D+%3D++0+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle { &#92;frac{d x}{d t} =  0 } " class="latex" /></p>
<p>or in other words</p>
<p><img src="https://s0.wp.com/latex.php?latex=Y+H+x%5EY+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y H x^Y = 0 " class="latex" /></p>
<p>In fact we will do better: we will find a solution of</p>
<p><img src="https://s0.wp.com/latex.php?latex=H+x%5EY+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H x^Y = 0 " class="latex" /></p>
<p>And we&#8217;ll do this in two stages:</p>
<p>&bull; First we&#8217;ll find all solutions of</p>
<p><img src="https://s0.wp.com/latex.php?latex=H+%5Cpsi+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H &#92;psi = 0 " class="latex" /></p>
<p>This equation is <i>linear</i>, so it&#8217;s easy to understand.</p>
<p>&bull; Then, among these solutions <img src="https://s0.wp.com/latex.php?latex=%5Cpsi%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi," class="latex" /> we&#8217;ll find one that also obeys</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cpsi+%3D+x%5EY+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi = x^Y " class="latex" /></p>
<p>This is a <i>nonlinear</i> problem involving matrix exponentiation, but still, we can do it, using a clever trick called &#8216;logarithms&#8217;.</p>
<p>Putting the pieces together, we get our solution of </p>
<p><img src="https://s0.wp.com/latex.php?latex=H+x%5EY+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H x^Y = 0 " class="latex" /></p>
<p>and thus our equilibrium solution of the rate equation:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle+%7B+%5Cfrac%7Bd+x%7D%7Bd+t%7D+%3D+Y+H+x%5EY+%3D+0+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle { &#92;frac{d x}{d t} = Y H x^Y = 0 } " class="latex" /></p>
<p>That&#8217;s a rough outline of the plan.  But now let&#8217;s get started, because the details are actually fascinating.  Today I&#8217;ll just show you how to rewrite the rate equation in this new way.</p>
<h3> The rate equation </h3>
<p>Remember how the rate equation goes.  We start with a <b>stochastic reaction network</b>, meaning a little diagram like this:</p>
<div align="center">
<img src="https://i2.wp.com/math.ucr.edu/home/baez/networks/reaction_network_diagram_1.png" alt="" />
</div>
<p>This contains quite a bit of information:</p>
<p>&bull; a finite set <img src="https://s0.wp.com/latex.php?latex=T&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T" class="latex" /> of <b>transitions</b>,</p>
<p>&bull; a finite set <img src="https://s0.wp.com/latex.php?latex=K&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="K" class="latex" /> of <b>complexes</b>,</p>
<p>&bull; a finite set <img src="https://s0.wp.com/latex.php?latex=S&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S" class="latex" /> of <b>species</b>, </p>
<p>&bull; a map <img src="https://s0.wp.com/latex.php?latex=r%3A+T+%5Cto+%280%2C%5Cinfty%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="r: T &#92;to (0,&#92;infty)" class="latex" /> giving a <b>rate constant</b> for each transition,</p>
<p>&bull; <b>source</b> and <b>target</b> maps <img src="https://s0.wp.com/latex.php?latex=s%2Ct+%3A+T+%5Cto+K&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s,t : T &#92;to K" class="latex" /> saying where each transition starts and ends,</p>
<p>&bull; a one-to-one map <img src="https://s0.wp.com/latex.php?latex=Y+%3A+K+%5Cto+%5Cmathbb%7BN%7D%5ES&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y : K &#92;to &#92;mathbb{N}^S" class="latex" /> saying how each complex is made of species.</p>
<p>Given all this, the rate equation says how the amount of each species changes with time.  We describe these amounts with a vector <img src="https://s0.wp.com/latex.php?latex=x+%5Cin+%5B0%2C%5Cinfty%29%5ES.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x &#92;in [0,&#92;infty)^S." class="latex" />  So, we want a differential equation filling in the question marks here:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bd+x%7D%7Bd+t%7D+%3D+%3F%3F%3F+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{d x}{d t} = ??? } " class="latex" /></p>
<p>Now <a href="https://johncarlosbaez.wordpress.com/2012/08/14/network-theory-part-21/">last time</a>, we started by thinking of <img src="https://s0.wp.com/latex.php?latex=K&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="K" class="latex" /> as a subset of <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BN%7D%5ES%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{N}^S," class="latex" /> and thus of the vector space <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5ES.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^S." class="latex" />  Back then, we wrote the rate equation as follows:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bd+x%7D%7Bd+t%7D+%3D+%5Csum_%7B%5Ctau+%5Cin+T%7D+r%28%5Ctau%29+%5C%3B+%5Cleft%28t%28%5Ctau%29+-+s%28%5Ctau%29%5Cright%29+%5C%3B+x%5E%7Bs%28%5Ctau%29%7D+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{d x}{d t} = &#92;sum_{&#92;tau &#92;in T} r(&#92;tau) &#92;; &#92;left(t(&#92;tau) - s(&#92;tau)&#92;right) &#92;; x^{s(&#92;tau)} } " class="latex" /></p>
<p>where vector exponentiation is defined by</p>
<p><img src="https://s0.wp.com/latex.php?latex=x%5Es+%3D+x_1%5E%7Bs_1%7D+%5Ccdots+x_k%5E%7Bs_k%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x^s = x_1^{s_1} &#92;cdots x_k^{s_k} " class="latex" /></p>
<p>when <img src="https://s0.wp.com/latex.php?latex=x&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=s&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s" class="latex" /> are vectors in <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5ES.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^S." class="latex" /></p>
<p>However, we&#8217;ve now switched to thinking of our set of complexes <img src="https://s0.wp.com/latex.php?latex=K&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="K" class="latex" /> as a set in its own right that is mapped into <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BN%7D%5ES&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{N}^S" class="latex" /> by <img src="https://s0.wp.com/latex.php?latex=Y.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y." class="latex" />  This is good for lots of reasons, like defining the concept of &#8216;deficiency&#8217;, which we did last time.   But it means the rate equation above doesn&#8217;t quite parse anymore!   Things like <img src="https://s0.wp.com/latex.php?latex=s%28%5Ctau%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s(&#92;tau)" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=t%28%5Ctau%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="t(&#92;tau)" class="latex" /> live in <img src="https://s0.wp.com/latex.php?latex=K&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="K" class="latex" />; we need to explicitly convert them into elements of <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5ES&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^S" class="latex" /> using <img src="https://s0.wp.com/latex.php?latex=Y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y" class="latex" /> for our equation to make sense!</p>
<p>So now we have to write the <b>rate equation</b> like this:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bd+x%7D%7Bd+t%7D+%3D+Y+%5Csum_%7B%5Ctau+%5Cin+T%7D+r%28%5Ctau%29+%5C%3B++%5Cleft%28t%28%5Ctau%29+-+s%28%5Ctau%29%5Cright%29+%5C%3B+x%5E%7BY+s%28%5Ctau%29%7D+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{d x}{d t} = Y &#92;sum_{&#92;tau &#92;in T} r(&#92;tau) &#92;;  &#92;left(t(&#92;tau) - s(&#92;tau)&#92;right) &#92;; x^{Y s(&#92;tau)} } " class="latex" /></p>
<p>This looks more ugly, but if you&#8217;ve got even one mathematical bone in your body, you can already see vague glimmerings of how we&#8217;ll rewrite this the way we want:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle+%7B+%5Cfrac%7Bd+x%7D%7Bd+t%7D+%3D++Y+H+x%5EY+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle { &#92;frac{d x}{d t} =  Y H x^Y } " class="latex" /></p>
<p>Here&#8217;s how.</p>
<p>First, we extend our maps <img src="https://s0.wp.com/latex.php?latex=s%2C+t&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s, t" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=Y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y" class="latex" /> to linear maps between vector spaces:</p>
<div align="center">
<img src="https://i0.wp.com/math.ucr.edu/home/baez/networks/reaction_network_diagram_6.png" /></div>
<p>Then, we put an inner product on the vector spaces <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5ET%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^T," class="latex" /> <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5EK&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^K" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5ES.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^S." class="latex" />  For <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5EK&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^K" class="latex" /> we do this in the most obvious way, by letting the complexes be an orthonormal basis.  So, given two complexes <img src="https://s0.wp.com/latex.php?latex=%5Ckappa%2C+%5Ckappa%27%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;kappa, &#92;kappa&#039;," class="latex" /> we define their inner product by</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Clangle+%5Ckappa%2C+%5Ckappa%27+%5Crangle+%3D+%5Cdelta_%7B%5Ckappa%2C+%5Ckappa%27%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;langle &#92;kappa, &#92;kappa&#039; &#92;rangle = &#92;delta_{&#92;kappa, &#92;kappa&#039;} " class="latex" /></p>
<p>We do the same for <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5ES.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^S." class="latex" />  But for <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5ET&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^T" class="latex" /> we define the inner product in a more clever way involving the rate constants.  If <img src="https://s0.wp.com/latex.php?latex=%5Ctau%2C+%5Ctau%27+%5Cin+T&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau, &#92;tau&#039; &#92;in T" class="latex" /> are two transitions, we define their inner product by:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Clangle+%5Ctau%2C+%5Ctau%27+%5Crangle+%3D+%5Cfrac%7B1%7D%7Br%28%5Ctau%29%7D+%5Cdelta_%7B%5Ctau%2C+%5Ctau%27%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;langle &#92;tau, &#92;tau&#039; &#92;rangle = &#92;frac{1}{r(&#92;tau)} &#92;delta_{&#92;tau, &#92;tau&#039;} " class="latex" /></p>
<p>This will seem perfectly natural when we continue our study of circuits made of electrical resistors, and if you&#8217;re very clever you can already see it lurking in <a href="http://math.ucr.edu/home/baez/networks/networks_16.html">Part 16</a>.  But never mind.</p>
<p>Having put inner products on these three vector spaces, we can take the adjoints of the linear maps between them, to get linear maps going back the other way:</p>
<div align="center">
<img src="https://i1.wp.com/math.ucr.edu/home/baez/networks/reaction_network_diagram_3.png" /></div>
<p>These are defined in the usual way&#8212;though we&#8217;re using daggers here they way physicists do, where mathematicians would prefer to see stars!   For example, <img src="https://s0.wp.com/latex.php?latex=s%5E%5Cdagger+%3A+%5Cmathbb%7BR%7D%5EK+%5Cto+%5Cmathbb%7BR%7D%5ET&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s^&#92;dagger : &#92;mathbb{R}^K &#92;to &#92;mathbb{R}^T" class="latex" /> is defined by the relation</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Clangle+s%5E%5Cdagger+%5Cphi%2C+%5Cpsi+%5Crangle+%3D+%5Clangle+%5Cphi%2C+s+%5Cpsi+%5Crangle+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;langle s^&#92;dagger &#92;phi, &#92;psi &#92;rangle = &#92;langle &#92;phi, s &#92;psi &#92;rangle " class="latex" /></p>
<p>and so on.</p>
<p>Next, we set up a random walk on the set of complexes.  Remember, our reaction network is a graph with complexes as vertices and transitions as edges, like this:</p>
<div align="center">
<img width="200" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/chemical_reaction_network_part_20_V.png" alt="" />
</div>
<p>Each transition <img src="https://s0.wp.com/latex.php?latex=%5Ctau&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau" class="latex" /> has a number attached to it: the rate constant <img src="https://s0.wp.com/latex.php?latex=r%28%5Ctau%29.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="r(&#92;tau)." class="latex" />  So, we can randomly hop from complex to complex along these transitions, with probabilities per unit time described by these numbers.  The probability of being at some particular complex will then be described by a function </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cpsi+%3A+K+%5Cto+%5Cmathbb%7BR%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;psi : K &#92;to &#92;mathbb{R} " class="latex" /></p>
<p>which also depends on time, and changes according to the equation</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle+%7B+%5Cfrac%7Bd+%5Cpsi%7D%7Bd+t%7D+%3D+H+%5Cpsi+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle { &#92;frac{d &#92;psi}{d t} = H &#92;psi } " class="latex" /></p>
<p>for some <b>Hamiltonian</b> </p>
<p><img src="https://s0.wp.com/latex.php?latex=H+%3A+%5Cmathbb%7BR%7D%5EK+%5Cto+%5Cmathbb%7BR%7D%5EK+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H : &#92;mathbb{R}^K &#92;to &#92;mathbb{R}^K " class="latex" /></p>
<p>I defined this Hamiltonian back in <a href="https://johncarlosbaez.wordpress.com/2011/10/26/network-theory-part-15/">Part 15</a>, but now I see a slicker way to write it:</p>
<p><img src="https://s0.wp.com/latex.php?latex=H+%3D+%28t+-+s%29+s%5E%5Cdagger+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="H = (t - s) s^&#92;dagger " class="latex" /></p>
<p>I&#8217;ll justify this next time.  For now, the main point is that with this Hamiltonian, the rate equation is equivalent to this:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bd+x%7D%7Bd+t%7D+%3D+Y+H+x%5EY+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{d x}{d t} = Y H x^Y } " class="latex" /></p>
<p>The only thing I haven&#8217;t defined yet is the funny exponential <img src="https://s0.wp.com/latex.php?latex=x%5EY.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x^Y." class="latex" />  That&#8217;s what makes the equation nonlinear.  We&#8217;re taking a <i>vector</i> to the power of a <i>matrix</i> and getting a <i>vector</i>.  This sounds weird&#8212;but it actually makes sense!</p>
<p>It only makes sense because we have chosen bases for our vector spaces. To understand it, let&#8217;s number our species <img src="https://s0.wp.com/latex.php?latex=1%2C+%5Cdots%2C+k&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="1, &#92;dots, k" class="latex" /> as we&#8217;ve been doing all along, and number our complexes <img src="https://s0.wp.com/latex.php?latex=1%2C+%5Cdots%2C+%5Cell.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="1, &#92;dots, &#92;ell." class="latex" />   Our linear map <img src="https://s0.wp.com/latex.php?latex=Y+%3A+%5Cmathbb%7BR%7D%5EK+%5Cto+%5Cmathbb%7BR%7D%5ES&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y : &#92;mathbb{R}^K &#92;to &#92;mathbb{R}^S" class="latex" /> then becomes a <img src="https://s0.wp.com/latex.php?latex=k+%5Ctimes+%5Cell&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="k &#92;times &#92;ell" class="latex" /> matrix of natural numbers.  Its entries say how many times each species shows up in each complex:</p>
<p><img src="https://s0.wp.com/latex.php?latex=Y+%3D+%5Cleft%28+%5Cbegin%7Barray%7D%7Bcccc%7D+++Y_%7B11%7D+%26+Y_%7B12%7D++%26+%5Ccdots+%26+Y_%7B1+%5Cell%7D+%5C%5C++Y_%7B21%7D+%26+Y_%7B22%7D++%26+%5Ccdots+%26+Y_%7B2+%5Cell%7D+%5C%5C++%5Cvdots++%26+%5Cvdots+++%26+%5Cddots+%26+%5Cvdots+%5C%5C++Y_%7Bk1%7D+%26+Y_%7Bk2%7D++%26+%5Ccdots+%26+Y_%7Bk+%5Cell%7D+%5Cend%7Barray%7D+%5Cright%29+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y = &#92;left( &#92;begin{array}{cccc}   Y_{11} &amp; Y_{12}  &amp; &#92;cdots &amp; Y_{1 &#92;ell} &#92;&#92;  Y_{21} &amp; Y_{22}  &amp; &#92;cdots &amp; Y_{2 &#92;ell} &#92;&#92;  &#92;vdots  &amp; &#92;vdots   &amp; &#92;ddots &amp; &#92;vdots &#92;&#92;  Y_{k1} &amp; Y_{k2}  &amp; &#92;cdots &amp; Y_{k &#92;ell} &#92;end{array} &#92;right) " class="latex" /></p>
<p>The entry <img src="https://s0.wp.com/latex.php?latex=Y_%7Bi+j%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y_{i j}" class="latex" /> says how many times the <img src="https://s0.wp.com/latex.php?latex=i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i" class="latex" />th species shows up in the <img src="https://s0.wp.com/latex.php?latex=j&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="j" class="latex" />th complex.  </p>
<p>Now, let&#8217;s be a bit daring and think of the vector <img src="https://s0.wp.com/latex.php?latex=x+%5Cin+%5Cmathbb%7BR%7D%5ES&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x &#92;in &#92;mathbb{R}^S" class="latex" /> as a row vector with <img src="https://s0.wp.com/latex.php?latex=k&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="k" class="latex" /> entries:</p>
<p><img src="https://s0.wp.com/latex.php?latex=x+%3D+%5Cleft%28x_1+%2C+x_2+%2C++%5Cdots+%2C++x_k+%5Cright%29+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x = &#92;left(x_1 , x_2 ,  &#92;dots ,  x_k &#92;right) " class="latex" /></p>
<p>Then we can multiply <img src="https://s0.wp.com/latex.php?latex=x&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x" class="latex" /> on the <i>right</i> by the matrix <img src="https://s0.wp.com/latex.php?latex=Y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y" class="latex" /> and get a vector in <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5EK&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^K" class="latex" />:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Barray%7D%7Bccl%7D+x+Y+%26%3D%26+%28+x_1+%2C+x_2%2C+%5Cdots%2C+x_k%29+%5C%3B+++%5Cleft%28+%5Cbegin%7Barray%7D%7Bcccc%7D+++Y_%7B11%7D+%26+Y_%7B12%7D++%26+%5Ccdots+%26+Y_%7B1+%5Cell%7D+%5C%5C++Y_%7B21%7D+%26+Y_%7B22%7D++%26+%5Ccdots+%26+Y_%7B2+%5Cell%7D+%5C%5C++%5Cvdots++%26+%5Cvdots+++%26+%5Cddots+%26+%5Cvdots+%5C%5C++Y_%7Bk1%7D+%26+Y_%7Bk2%7D++%26+%5Ccdots+%26+Y_%7Bk+%5Cell%7D+%5Cend%7Barray%7D+%5Cright%29+++%5C%5C++%5C%5C++%26%3D%26+%5Cleft%28+x_1+Y_%7B11%7D+%2B+%5Ccdots+%2B+x_k+Y_%7Bk1%7D%2C+%5C%3B+%5Cdots%2C+%5C%3B+x_1+Y_%7B1+%5Cell%7D+%2B+%5Ccdots+%2B+x_k+Y_%7Bk+%5Cell%7D+%5Cright%29+++%5Cend%7Barray%7D++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;begin{array}{ccl} x Y &amp;=&amp; ( x_1 , x_2, &#92;dots, x_k) &#92;;   &#92;left( &#92;begin{array}{cccc}   Y_{11} &amp; Y_{12}  &amp; &#92;cdots &amp; Y_{1 &#92;ell} &#92;&#92;  Y_{21} &amp; Y_{22}  &amp; &#92;cdots &amp; Y_{2 &#92;ell} &#92;&#92;  &#92;vdots  &amp; &#92;vdots   &amp; &#92;ddots &amp; &#92;vdots &#92;&#92;  Y_{k1} &amp; Y_{k2}  &amp; &#92;cdots &amp; Y_{k &#92;ell} &#92;end{array} &#92;right)   &#92;&#92;  &#92;&#92;  &amp;=&amp; &#92;left( x_1 Y_{11} + &#92;cdots + x_k Y_{k1}, &#92;; &#92;dots, &#92;; x_1 Y_{1 &#92;ell} + &#92;cdots + x_k Y_{k &#92;ell} &#92;right)   &#92;end{array}  " class="latex" /></p>
<p>So far, no big deal.  But now you&#8217;re ready to see the definition of <img src="https://s0.wp.com/latex.php?latex=x%5EY%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x^Y," class="latex" /> which is very similar:</p>
<p><img src="https://i1.wp.com/math.ucr.edu/home/baez/networks/matrix_exponential.png" /></p>
<p>It&#8217;s exactly the same, but with <i>multiplication</i> replacing <i>addition</i>, and <i>exponentiation</i> replacing <i>multiplication!</i>   Apparently my class on matrices stopped too soon: we learned about matrix multiplication, but matrix exponentiation is also worthwhile. </p>
<p>What&#8217;s the point of it?  Well, suppose you have a certain number of hydrogen molecules, a certain number of oxygen molecules, a certain number of water molecules, and so on&#8212;a certain number of things of each species.  You can list these numbers and get a vector <img src="https://s0.wp.com/latex.php?latex=x+%5Cin+%5Cmathbb%7BR%7D%5ES.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x &#92;in &#92;mathbb{R}^S." class="latex" />  Then the components of <img src="https://s0.wp.com/latex.php?latex=x%5EY&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x^Y" class="latex" /> describe how many ways you can build up each complex from the things you have.  For example, </p>
<p><img src="https://s0.wp.com/latex.php?latex=x_1%5E%7BY_%7B11%7D%7D+x_2%5E%7BY_%7B21%7D%7D+%5Ccdots++x_k%5E%7BY_%7Bk1%7D%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x_1^{Y_{11}} x_2^{Y_{21}} &#92;cdots  x_k^{Y_{k1}} " class="latex" /></p>
<p>say roughly how many ways you can build complex 1 by picking <img src="https://s0.wp.com/latex.php?latex=Y_%7B11%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y_{11}" class="latex" /> things of species 1, <img src="https://s0.wp.com/latex.php?latex=Y_%7B21%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y_{21}" class="latex" /> things of species 2, and so on.  </p>
<p>Why &#8216;roughly&#8217;?   Well, we&#8217;re pretending we can pick the same thing twice.  So if we have 4 water molecules and we need to pick 3, this formula gives <img src="https://s0.wp.com/latex.php?latex=4%5E3.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="4^3." class="latex" />  The right answer is <img src="https://s0.wp.com/latex.php?latex=4+%5Ctimes+3+%5Ctimes+2.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="4 &#92;times 3 &#92;times 2." class="latex" />   To get this answer we&#8217;d need to use the &#8216;falling power&#8217; <img src="https://s0.wp.com/latex.php?latex=4%5E%7B%5Cunderline%7B3%7D%7D+%3D+4+%5Ctimes+3+%5Ctimes+2%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="4^{&#92;underline{3}} = 4 &#92;times 3 &#92;times 2," class="latex" /> as explained in <a href="http://math.ucr.edu/home/baez/networks/networks_4.html">Part 4</a>.  But the rate equation describes chemistry in the limit where we have lots of things of each species.  In this limit, the ordinary power becomes a good approximation.</p>
<p><b>Puzzle.</b> In this post we&#8217;ve seen a vector raised to a matrix power, which is a vector, and also a vector raised to a vector power, which is a number.  How are they related?</p>
<p>There&#8217;s more to say about this, which I&#8217;d be glad to explain if you&#8217;re interested.  But let&#8217;s get to the punchline:</p>
<p><b>Theorem.</b>  The rate equation:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bd+x%7D%7Bd+t%7D+%3D+Y+%5Csum_%7B%5Ctau+%5Cin+T%7D+r%28%5Ctau%29+%5C%3B+%5Cleft%28t%28%5Ctau%29+-+s%28%5Ctau%29%5Cright%29+%5C%3B+x%5E%7BY+s%28%5Ctau%29%7D+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{d x}{d t} = Y &#92;sum_{&#92;tau &#92;in T} r(&#92;tau) &#92;; &#92;left(t(&#92;tau) - s(&#92;tau)&#92;right) &#92;; x^{Y s(&#92;tau)} } " class="latex" /></p>
<p>is equivalent to this equation:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bd+x%7D%7Bd+t%7D+%3D+Y+%28t+-+s%29+s%5E%5Cdagger+x%5EY+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{d x}{d t} = Y (t - s) s^&#92;dagger x^Y } " class="latex" /></p>
<p>or in other words:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bd+x%7D%7Bd+t%7D+%3D+Y+H+x%5EY+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{d x}{d t} = Y H x^Y } " class="latex" /></p>
<p><i>Proof.</i>  It&#8217;s enough to show </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%28t+-+s%29+s%5E%5Cdagger+x%5EY+%3D+%5Csum_%7B%5Ctau+%5Cin+T%7D+r%28%5Ctau%29+%5C%3B+%5Cleft%28t%28%5Ctau%29+-+s%28%5Ctau%29%5Cright%29+%5C%3B+x%5E%7BY+s%28%5Ctau%29%7D+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ (t - s) s^&#92;dagger x^Y = &#92;sum_{&#92;tau &#92;in T} r(&#92;tau) &#92;; &#92;left(t(&#92;tau) - s(&#92;tau)&#92;right) &#92;; x^{Y s(&#92;tau)} } " class="latex" /></p>
<p>So, we&#8217;ll compute <img src="https://s0.wp.com/latex.php?latex=%28t+-+s%29+s%5E%5Cdagger+x%5EY%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(t - s) s^&#92;dagger x^Y," class="latex" /> and think about the meaning of each quantity we get <i>en route</i>.  </p>
<p>We start with <img src="https://s0.wp.com/latex.php?latex=x+%5Cin+%5Cmathbb%7BR%7D%5ES.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x &#92;in &#92;mathbb{R}^S." class="latex" />  This is a list of numbers saying how many things of each species we have: our raw ingredients, as it were.  Then we compute</p>
<p><img src="https://s0.wp.com/latex.php?latex=x%5EY+%3D+%28x_1%5E%7BY_%7B11%7D%7D+%5Ccdots++x_k%5E%7BY_%7Bk1%7D%7D+%2C++%5Cdots%2C++x_1%5E%7BY_%7B1+%5Cell%7D%7D+%5Ccdots+x_k%5E%7BY_%7Bk+%5Cell%7D%7D+%29+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x^Y = (x_1^{Y_{11}} &#92;cdots  x_k^{Y_{k1}} ,  &#92;dots,  x_1^{Y_{1 &#92;ell}} &#92;cdots x_k^{Y_{k &#92;ell}} ) " class="latex" /></p>
<p>This is a vector in <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5EK.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^K." class="latex" />  It&#8217;s a list of numbers saying how many ways we can build each complex starting from our raw ingredients.  </p>
<p>Alternatively, we can write this vector <img src="https://s0.wp.com/latex.php?latex=x%5EY&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x^Y" class="latex" /> as a sum over basis vectors:</p>
<p><img src="https://s0.wp.com/latex.php?latex=x%5EY+%3D+%5Csum_%7B%5Ckappa+%5Cin+K%7D+x_1%5E%7BY_%7B1%5Ckappa%7D%7D+%5Ccdots++x_k%5E%7BY_%7Bk%5Ckappa%7D%7D+%5C%3B+%5Ckappa+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x^Y = &#92;sum_{&#92;kappa &#92;in K} x_1^{Y_{1&#92;kappa}} &#92;cdots  x_k^{Y_{k&#92;kappa}} &#92;; &#92;kappa " class="latex" /></p>
<p>Next let&#8217;s apply <img src="https://s0.wp.com/latex.php?latex=s%5E%5Cdagger&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s^&#92;dagger" class="latex" /> to this.  We claim that</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+s%5E%5Cdagger+%5Ckappa+%3D+%5Csum_%7B%5Ctau+%5C%3B+%3A+%5C%3B+s%28%5Ctau%29+%3D+%5Ckappa%7D+r%28%5Ctau%29+%5C%3B+%5Ctau+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ s^&#92;dagger &#92;kappa = &#92;sum_{&#92;tau &#92;; : &#92;; s(&#92;tau) = &#92;kappa} r(&#92;tau) &#92;; &#92;tau } " class="latex" /></p>
<p>In other words, we claim <img src="https://s0.wp.com/latex.php?latex=s%5E%5Cdagger+%5Ckappa&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s^&#92;dagger &#92;kappa" class="latex" /> is the sum of all the transitions having <img src="https://s0.wp.com/latex.php?latex=%5Ckappa&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;kappa" class="latex" /> as their source, <i>weighted by their rate constants!</i>   To prove this claim, it&#8217;s enough to take the inner product of each side with any transition <img src="https://s0.wp.com/latex.php?latex=%5Ctau%27%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau&#039;," class="latex" /> and check that we get the same answer.  For the left side we get</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Clangle+s%5E%5Cdagger+%5Ckappa%2C+%5Ctau%27+%5Crangle+%3D+%5Clangle+%5Ckappa%2C+s%28%5Ctau%27%29+%5Crangle+%3D+%5Cdelta_%7B%5Ckappa%2C+s+%28%5Ctau%27%29+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;langle s^&#92;dagger &#92;kappa, &#92;tau&#039; &#92;rangle = &#92;langle &#92;kappa, s(&#92;tau&#039;) &#92;rangle = &#92;delta_{&#92;kappa, s (&#92;tau&#039;) } " class="latex" /></p>
<p>To compute the right side, we need to use the cleverly chosen inner product on <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5ET.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^T." class="latex" />  Here we get</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cleft%5Clangle+%5Csum_%7B%5Ctau+%5C%3B+%3A+%5C%3B+s%28%5Ctau%29+%3D+%5Ckappa%7D+r%28%5Ctau%29+%5Ctau%2C+%5C%3B+%5Ctau%27+%5Cright%5Crangle+%3D++%5Csum_%7B%5Ctau+%5C%3B+%3A+%5C%3B+s%28%5Ctau%29+%3D+%5Ckappa%7D+%5Cdelta_%7B%5Ctau%2C+%5Ctau%27%7D+%3D+%5Cdelta_%7B%5Ckappa%2C+s%28%5Ctau%27%29%7D++%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;left&#92;langle &#92;sum_{&#92;tau &#92;; : &#92;; s(&#92;tau) = &#92;kappa} r(&#92;tau) &#92;tau, &#92;; &#92;tau&#039; &#92;right&#92;rangle =  &#92;sum_{&#92;tau &#92;; : &#92;; s(&#92;tau) = &#92;kappa} &#92;delta_{&#92;tau, &#92;tau&#039;} = &#92;delta_{&#92;kappa, s(&#92;tau&#039;)}  } " class="latex" /></p>
<p>In the first step here, the factor of <img src="https://s0.wp.com/latex.php?latex=1+%2Fr%28%5Ctau%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="1 /r(&#92;tau)" class="latex" /> in the cleverly chosen inner product canceled the visible factor of <img src="https://s0.wp.com/latex.php?latex=r%28%5Ctau%29.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="r(&#92;tau)." class="latex" />  For the second step, you just need to think for half a minute&mdash;or ten, depending on how much coffee you&#8217;ve had.   </p>
<p>Either way, we we conclude that indeed</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+s%5E%5Cdagger+%5Ckappa+%3D+%5Csum_%7B%5Ctau+%5C%3B+%3A+%5C%3B+s%28%5Ctau%29+%3D+%5Ckappa%7D+r%28%5Ctau%29+%5Ctau+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ s^&#92;dagger &#92;kappa = &#92;sum_{&#92;tau &#92;; : &#92;; s(&#92;tau) = &#92;kappa} r(&#92;tau) &#92;tau } " class="latex" /></p>
<p>Next let&#8217;s combine this with our formula for <img src="https://s0.wp.com/latex.php?latex=x%5EY&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x^Y" class="latex" />:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle+%7B+x%5EY+%3D+%5Csum_%7B%5Ckappa+%5Cin+K%7D+x_1%5E%7BY_%7B1%5Ckappa%7D%7D+%5Ccdots++x_k%5E%7BY_%7Bk%5Ckappa%7D%7D+%5C%3B+%5Ckappa+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle { x^Y = &#92;sum_{&#92;kappa &#92;in K} x_1^{Y_{1&#92;kappa}} &#92;cdots  x_k^{Y_{k&#92;kappa}} &#92;; &#92;kappa } " class="latex" /></p>
<p>We get this:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle+%7B+s%5E%5Cdagger+x%5EY+%3D+%5Csum_%7B%5Ckappa%2C+%5Ctau+%5C%3B+%3A+%5C%3B+s%28%5Ctau%29+%3D+%5Ckappa%7D+r%28%5Ctau%29+%5C%3B+x_1%5E%7BY_%7B1%5Ckappa%7D%7D+%5Ccdots++x_k%5E%7BY_%7Bk%5Ckappa%7D%7D+%5C%3B+%5Ctau+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle { s^&#92;dagger x^Y = &#92;sum_{&#92;kappa, &#92;tau &#92;; : &#92;; s(&#92;tau) = &#92;kappa} r(&#92;tau) &#92;; x_1^{Y_{1&#92;kappa}} &#92;cdots  x_k^{Y_{k&#92;kappa}} &#92;; &#92;tau } " class="latex" /></p>
<p>In other words, <img src="https://s0.wp.com/latex.php?latex=s%5E%5Cdagger+x%5EY&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s^&#92;dagger x^Y" class="latex" /> is a linear combination of transitions, where each one is weighted both by <i>the rate it happens</i> and <i>how many ways it can happen</i> starting with our raw ingredients.</p>
<p>Our goal is to compute <img src="https://s0.wp.com/latex.php?latex=%28t+-+s%29s%5E%5Cdagger+x%5EY.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(t - s)s^&#92;dagger x^Y." class="latex" />  We&#8217;re almost there.  Remember, <img src="https://s0.wp.com/latex.php?latex=s&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s" class="latex" /> says which complex is the input of a given transition, and <img src="https://s0.wp.com/latex.php?latex=t&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="t" class="latex" /> says which complex is the output.  So, <img src="https://s0.wp.com/latex.php?latex=%28t+-+s%29+s%5E%5Cdagger+x%5EY&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(t - s) s^&#92;dagger x^Y" class="latex" /> says the total rate at which complexes are created and/or destroyed starting with the species in <img src="https://s0.wp.com/latex.php?latex=x&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x" class="latex" /> as our raw ingredients.  </p>
<p>That sounds good.   But let&#8217;s just pedantically check that everything works.  Applying <img src="https://s0.wp.com/latex.php?latex=t+-+s&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="t - s" class="latex" /> to both sides of our last equation, we get</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%28t+-+s%29+s%5E%5Cdagger+x%5EY+%3D+%5Csum_%7B%5Ckappa%2C+%5Ctau+%5C%3B+%3A+%5C%3B+s%28%5Ctau%29+%3D+%5Ckappa%7D+r%28%5Ctau%29+%5C%3B+x_1%5E%7BY_%7B1%5Ckappa%7D%7D+%5Ccdots++x_k%5E%7BY_%7Bk%5Ckappa%7D%7D+%5C%3B+%5Cleft%28+t%28%5Ctau%29+-+s%28%5Ctau%29%5Cright%29+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ (t - s) s^&#92;dagger x^Y = &#92;sum_{&#92;kappa, &#92;tau &#92;; : &#92;; s(&#92;tau) = &#92;kappa} r(&#92;tau) &#92;; x_1^{Y_{1&#92;kappa}} &#92;cdots  x_k^{Y_{k&#92;kappa}} &#92;; &#92;left( t(&#92;tau) - s(&#92;tau)&#92;right) } " class="latex" /></p>
<p>Remember, our goal was to prove that this equals</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Csum_%7B%5Ctau+%5Cin+T%7D+r%28%5Ctau%29+%5C%3B+%5Cleft%28t%28%5Ctau%29+-+s%28%5Ctau%29%5Cright%29+%5C%3B+x%5E%7BY+s%28%5Ctau%29%7D+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;sum_{&#92;tau &#92;in T} r(&#92;tau) &#92;; &#92;left(t(&#92;tau) - s(&#92;tau)&#92;right) &#92;; x^{Y s(&#92;tau)} } " class="latex" /></p>
<p>But if you stare at these a while and think, you&#8217;ll see they&#8217;re equal.     &nbsp;  &#9608;</p>
<p>It took me a couple of weeks to really understand this, so I&#8217;ll be happy if it takes you just a few days.  It seems peculiar at first but ultimately it all makes sense.  The interesting subtlety is that we use the linear map called &#8216;multiplying by <img src="https://s0.wp.com/latex.php?latex=Y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y" class="latex" />’:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Barray%7D%7Bccc%7D+%5Cmathbb%7BR%7D%5EK+%26%5Cto%26+%5Cmathbb%7BR%7D%5ES+%5C%5C+++++++++++++++++++++++++++++++%5Cpsi+++++%26%5Cmapsto%26+++Y+%5Cpsi+%5Cend%7Barray%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;begin{array}{ccc} &#92;mathbb{R}^K &amp;&#92;to&amp; &#92;mathbb{R}^S &#92;&#92;                               &#92;psi     &amp;&#92;mapsto&amp;   Y &#92;psi &#92;end{array} " class="latex" /></p>
<p>to take a bunch of complexes and work out the species they contain, while we use the <i>nonlinear</i> map called &#8216;raising to the <img src="https://s0.wp.com/latex.php?latex=Y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y" class="latex" />th power’:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Barray%7D%7Bccc%7D+%5Cmathbb%7BR%7D%5ES+%26%5Cto%26+%5Cmathbb%7BR%7D%5EK+%5C%5C+++++++++++++++++++++++++++++++x+++++%26%5Cmapsto%26+++x%5EY+%5Cend%7Barray%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;begin{array}{ccc} &#92;mathbb{R}^S &amp;&#92;to&amp; &#92;mathbb{R}^K &#92;&#92;                               x     &amp;&#92;mapsto&amp;   x^Y &#92;end{array} " class="latex" /></p>
<p>to take a bunch of species and work out how many ways we can build each complex from them.  There is much more to say about this: for example, these maps arise from a pair of what category theorists call &#8216;adjoint functors&#8217;.  But I&#8217;m worn out and you probably are too, if you&#8217;re still here at all.</p>
<h3> References </h3>
<p>I found this thesis to be the most helpful reference when I was trying to understand the proof of the deficiency zero theorem:</p>
<p>&bull; Jonathan M. Guberman, <i><a href="http://www4.utsouthwestern.edu/altschulerwulab/theses/GubermanJ_Thesis.pdf">Mass Action Reaction Networks and the Deficiency Zero Theorem</a></i>, B.A. thesis, Department of Mathematics, Harvard University, 2003.</p>
<p>I urge you to check it out.  In particular, Section 3 and Appendix A discuss matrix exponentiation.  Has anyone discussed this before?</p>
<p>Here&#8217;s another good modern treatment of the deficiency zero theorem:</p>
<p>&bull; Jeremy Gunawardena, <a href="http://vcp.med.harvard.edu/papers/crnt.pdf">Chemical reaction network theory for <i>in silico</i> biologists</a>, 2003.</p>
<p>The theorem was first proved here:</p>
<p>&bull; Martin Feinberg, <a href="http://www.seas.upenn.edu/~jadbabai/ESE680/Fei87a.pdf">Chemical reaction network structure and the stability of complex isothermal reactors: I. The deficiency zero and deficiency one theorems</a>, <i>Chemical Engineering Science</i> <b>42</b> (1987), 2229-2268. </p>
<p>However, Feinberg&#8217;s treatment here relies heavily on this paper:</p>
<p>&bull; F. Horn and R. Jackson, General mass action kinetics, <a href="http://www.springerlink.com/content/p345k578348107tj/"><i>Archive for Rational Mechanics and Analysis</i></a> <b>47</b> (1972), 81-116.</p>
<p>(Does anyone work on &#8216;irrational mechanics&#8217;?)  These lectures are also very helpful:</p>
<p>&bull; Martin Feinberg, <a href="http://www.che.eng.ohio-state.edu/~FEINBERG/LecturesOnReactionNetworks/">Lectures on reaction networks</a>, 1979.</p>
<p>If you&#8217;ve seen other proofs, let us know.</p>
									</div>

				<p class="postmetadata">
				<img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/speech_bubble.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2012/08/16/network-theory-part-22/#comments">17 Comments</a>				| <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/documents.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/category/chemistry/" rel="category tag">chemistry</a>, <a href="https://johncarlosbaez.wordpress.com/category/mathematics/" rel="category tag">mathematics</a>, <a href="https://johncarlosbaez.wordpress.com/category/networks/" rel="category tag">networks</a>								 | <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/permalink.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2012/08/16/network-theory-part-22/" rel="bookmark" title="Permanent Link to Network Theory (Part&nbsp;22)">Permalink</a>
<br /><img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/figure_ver1.gif" alt="" /> Posted by John Baez				</p>
			</div>
			<hr />
		
			<div class="post-11472 post type-post status-publish format-standard hentry category-chemistry category-mathematics category-networks" id="post-11472">
				<h2><a href="https://johncarlosbaez.wordpress.com/2012/08/14/network-theory-part-21/" rel="bookmark">Network Theory (Part&nbsp;21)</a></h2>
				<small>14 August, 2012</small><br />


				<div class="entry">
					<p>Recently we&#8217;ve been talking about &#8216;reaction networks&#8217;, like this:</p>
<div align="center">
<img width="230" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/chemical_reaction_network_part_20_V.png" alt="" />
</div>
<p>The letters are names of chemicals, and the arrows are chemical reactions.   If we know how fast each reaction goes, we can write down a &#8216;rate equation&#8217; describing how the amount of each chemical changes with time.   </p>
<p>In <a href="http://math.ucr.edu/home/baez/networks/networks_17.html">Part 17</a> we met the deficiency zero theorem.  This is a powerful tool for finding <i>equilibrium solutions</i> of the rate equation: in other words, solutions where the amounts of the various chemicals don&#8217;t change at all.   To apply this theorem, two conditions must hold.   Both are quite easy to check:</p>
<p>&bull; Your reaction network needs to be &#8216;weakly reversible&#8217;: if you have a reaction that takes one bunch of chemicals to another, there&#8217;s a series of reactions that takes that other bunch back to the one you started with.  </p>
<p>&bull; A number called the &#8216;deficiency&#8217; that you can compute from your reaction network needs to be zero.</p>
<p>The first condition makes a lot of sense, intuitively: you won&#8217;t get an equilibrium with all the different chemicals present if some chemicals can turn into others but not the other way around.   But the second condition, and indeed the concept of &#8216;deficiency&#8217;, seems mysterious.</p>
<p>Luckily, when you work through the proof of the deficiency zero theorem, the mystery evaporates.   It turns out that there are two equivalent ways to define the deficiency of a reaction network.  One makes it easy to compute, and that&#8217;s the definition people usually give.  But the other explains why it&#8217;s important.</p>
<p>In fact the whole proof of the deficiency zero theorem is full of great insights, so I want to show it to you.  This will be the most intense part of the network theory series so far, but also the climax of its first phase.  After a little wrapping up, we will then turn to another kind of network: <i>electrical circuits!</i>  </p>
<p>Today I&#8217;ll just unfold the concept of &#8216;deficiency&#8217; so we see what it means.  Next time I&#8217;ll show you a slick way to write the rate equation, which is crucial to proving the deficiency zero theorem.  Then we&#8217;ll start the proof.</p>
<h3> Reaction networks </h3>
<p>Let&#8217;s recall what a reaction network is, and set up our notation.  In chemistry we consider a finite set of &#8216;species&#8217; like C, O<sub>2</sub>, H<sub>2</sub>O and so on&#8230; and then consider reactions like</p>
<p>CH<sub>4</sub> + 2O<sub>2</sub> <img src="https://s0.wp.com/latex.php?latex=%5Clongrightarrow&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;longrightarrow" class="latex" /> CO<sub>2</sub> + 2H<sub>2</sub>O </p>
<p>On each side of this reaction we have a finite linear combination of species, with natural numbers as coefficients.  Chemists call such a thing a <b>complex</b>.</p>
<p>So, given any finite collection of species, say <img src="https://s0.wp.com/latex.php?latex=S%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S," class="latex" /> let&#8217;s write <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BN%7D%5ES&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{N}^S" class="latex" /> to mean the set of finite linear combinations of elements of <img src="https://s0.wp.com/latex.php?latex=S%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S," class="latex" /> with natural numbers as coefficients.   The complexes appearing in our reactions will form a subset of this, say <img src="https://s0.wp.com/latex.php?latex=K.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="K." class="latex" />   </p>
<p>We&#8217;ll also consider a finite collection of reactions&#8212;or in the language of <a href="http://math.ucr.edu/home/baez/networks/networks_2.html">Petri nets</a>, &#8216;transitions&#8217;.  Let&#8217;s call this <img src="https://s0.wp.com/latex.php?latex=T&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T" class="latex" />.  Each transition goes from some complex to some other complex: if we want a reaction to be reversible we&#8217;ll explicitly include another reaction going the other way.  So, given a transition <img src="https://s0.wp.com/latex.php?latex=%5Ctau+%5Cin+T&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau &#92;in T" class="latex" /> it will always go from some complex called its <b>source</b> <img src="https://s0.wp.com/latex.php?latex=s%28%5Ctau%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s(&#92;tau)" class="latex" /> to some complex called its <b>target</b> <img src="https://s0.wp.com/latex.php?latex=t%28%5Ctau%29.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="t(&#92;tau)." class="latex" /></p>
<p>All this data, put together, is a reaction network:</p>
<p><b> Definition.</b> A <b>reaction network</b> <img src="https://s0.wp.com/latex.php?latex=%28S%2C%5C%3B+s%2Ct+%3A+T+%5Cto+K%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(S,&#92;; s,t : T &#92;to K)" class="latex" /> consists of:</p>
<p>&bull; a finite set <img src="https://s0.wp.com/latex.php?latex=S&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S" class="latex" /> of <b>species</b>, </p>
<p>&bull; a finite set <img src="https://s0.wp.com/latex.php?latex=T&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T" class="latex" /> of <b>transitions</b>,</p>
<p>&bull; a finite set <img src="https://s0.wp.com/latex.php?latex=K+%5Csubset+%5Cmathbb%7BN%7D%5ES&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="K &#92;subset &#92;mathbb{N}^S" class="latex" /> of <b>complexes</b>,</p>
<p>&bull; <b>source</b> and <b>target</b> maps <img src="https://s0.wp.com/latex.php?latex=s%2Ct+%3A+T+%5Cto+K.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s,t : T &#92;to K." class="latex" /></p>
<p>We can draw a reaction network as a graph with complexes as vertices and transitions as edges:</p>
<div align="center">
<img width="200" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/chemical_reaction_network_part_20_I.png" alt="" />
</div>
<p>The set of species here is <img src="https://s0.wp.com/latex.php?latex=S+%3D+%5C%7BA%2CB%2CC%2CD%2CE%5C%7D%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S = &#92;{A,B,C,D,E&#92;}," class="latex" /> and the set of complexes is <img src="https://s0.wp.com/latex.php?latex=K+%3D+%5C%7BA%2CB%2CD%2CA%2BC%2CB%2BE%5C%7D.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="K = &#92;{A,B,D,A+C,B+E&#92;}." class="latex" /></p>
<p>But to write down the &#8216;rate equation&#8217; describing our chemical reactions, we need a bit more information: constants <img src="https://s0.wp.com/latex.php?latex=r%28%5Ctau%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="r(&#92;tau)" class="latex" /> saying the rate at which each transition <img src="https://s0.wp.com/latex.php?latex=%5Ctau&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau" class="latex" /> occurs.   So, we define:</p>
<p><b> Definition.</b> A <b>stochastic reaction network</b> is a reaction network together with a map <img src="https://s0.wp.com/latex.php?latex=r%3A+T+%5Cto+%280%2C%5Cinfty%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="r: T &#92;to (0,&#92;infty)" class="latex" /> assigning a <b>rate constant</b> to each transition.</p>
<p>Let me remind you how the rate equation works.  At any time we have some amount <img src="https://s0.wp.com/latex.php?latex=x_i+%5Cin+%5B0%2C%5Cinfty%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x_i &#92;in [0,&#92;infty)" class="latex" /> of each species <img src="https://s0.wp.com/latex.php?latex=i.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i." class="latex" />  These numbers are the components of a vector <img src="https://s0.wp.com/latex.php?latex=x+%5Cin+%5Cmathbb%7BR%7D%5ES%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x &#92;in &#92;mathbb{R}^S," class="latex" /> which of course depends on time.  The <b>rate equation</b> says how this vector changes:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bd+x_i%7D%7Bd+t%7D+%3D+%5Csum_%7B%5Ctau+%5Cin+T%7D+r%28%5Ctau%29+%5Cleft%28t_i%28%5Ctau%29+-+s_i%28%5Ctau%29%5Cright%29++x%5E%7Bs%28%5Ctau%29%7D+%7D++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{d x_i}{d t} = &#92;sum_{&#92;tau &#92;in T} r(&#92;tau) &#92;left(t_i(&#92;tau) - s_i(&#92;tau)&#92;right)  x^{s(&#92;tau)} }  " class="latex" /> </p>
<p>Here I&#8217;m writing <img src="https://s0.wp.com/latex.php?latex=s_i%28%5Ctau%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s_i(&#92;tau)" class="latex" /> for the <img src="https://s0.wp.com/latex.php?latex=i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i" class="latex" />th component of the vector <img src="https://s0.wp.com/latex.php?latex=s%28%5Ctau%29%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s(&#92;tau)," class="latex" /> and similarly for <img src="https://s0.wp.com/latex.php?latex=t_i%28%5Ctau%29.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="t_i(&#92;tau)." class="latex" />   I should remind you what <img src="https://s0.wp.com/latex.php?latex=x%5E%7Bs%28%5Ctau%29%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x^{s(&#92;tau)}" class="latex" /> means, since here we are raising a vector to a vector power, which is a bit unusual.   So, suppose we have any vector </p>
<p><img src="https://s0.wp.com/latex.php?latex=x+%3D+%28x_1%2C+%5Cdots%2C+x_k%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x = (x_1, &#92;dots, x_k)" class="latex" /> </p>
<p>and we raise it to the power of </p>
<p><img src="https://s0.wp.com/latex.php?latex=s+%3D+%28s_1%2C+%5Cdots%2C+s_k%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s = (s_1, &#92;dots, s_k)" class="latex" />  </p>
<p>Then by definition we get</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+x%5Es+%3D+x_1%5E%7Bs_1%7D+%5Ccdots+x_k%5E%7Bs_k%7D+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ x^s = x_1^{s_1} &#92;cdots x_k^{s_k} } " class="latex" /></p>
<p>Given this, I hope the rate equation makes intuitive sense!  There&#8217;s one term for each transition <img src="https://s0.wp.com/latex.php?latex=%5Ctau.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau." class="latex" />   The factor of <img src="https://s0.wp.com/latex.php?latex=t_i%28%5Ctau%29+-+s_i%28%5Ctau%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="t_i(&#92;tau) - s_i(&#92;tau)" class="latex" /> shows up because our transition destroys <img src="https://s0.wp.com/latex.php?latex=s_i%28%5Ctau%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s_i(&#92;tau)" class="latex" /> things of the <img src="https://s0.wp.com/latex.php?latex=i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i" class="latex" />th species and creates <img src="https://s0.wp.com/latex.php?latex=t_i%28%5Ctau%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="t_i(&#92;tau)" class="latex" /> of them. The big product </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+x%5E%7Bs%28%5Ctau%29%7D+%3D+x_1%5E%7Bs_1%28%5Ctau%29%7D+%5Ccdots+x_k%5E%7Bs_k%28%5Ctau%29%7D+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ x^{s(&#92;tau)} = x_1^{s_1(&#92;tau)} &#92;cdots x_k^{s_k(&#92;tau)} } " class="latex" /></p>
<p>shows up because our transition occurs at a rate proportional to the product of the numbers of things it takes as inputs.  The constant of proportionality is the reaction rate <img src="https://s0.wp.com/latex.php?latex=r%28%5Ctau%29.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="r(&#92;tau)." class="latex" />  </p>
<p>The deficiency zero theorem says lots of things, but in the next few episodes we&#8217;ll prove a weak version, like this:</p>
<p><b> Deficiency Zero Theorem (Baby Version).</b>   Suppose we have a weakly reversible reaction network with deficiency zero.  Then for any choice of rate constants there exists an equilibrium solution <img src="https://s0.wp.com/latex.php?latex=x+%5Cin+%280%2C%5Cinfty%29%5ES&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x &#92;in (0,&#92;infty)^S" class="latex" /> of the rate equation.  In other words:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Csum_%7B%5Ctau+%5Cin+T%7D+r%28%5Ctau%29+%5Cleft%28t_i%28%5Ctau%29+-+s_i%28%5Ctau%29%5Cright%29++x%5E%7Bs%28%5Ctau%29%7D+%3D+0%7D++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;sum_{&#92;tau &#92;in T} r(&#92;tau) &#92;left(t_i(&#92;tau) - s_i(&#92;tau)&#92;right)  x^{s(&#92;tau)} = 0}  " class="latex" /> </p>
<p>An important feature of this result is that all the components of the vector <img src="https://s0.wp.com/latex.php?latex=x&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x" class="latex" /> are <i>positive</i>.  In other words, there&#8217;s actually some chemical of each species present!  </p>
<p>But what do the hypotheses in this theorem mean?</p>
<p>A reaction network is <b>weakly reversible</b> if for any transition <img src="https://s0.wp.com/latex.php?latex=%5Ctau+%5Cin+T&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau &#92;in T" class="latex" /> going from a complex <img src="https://s0.wp.com/latex.php?latex=%5Ckappa&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;kappa" class="latex" /> to a complex <img src="https://s0.wp.com/latex.php?latex=%5Ckappa%27%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;kappa&#039;," class="latex" /> there is a sequence of transitions going from <img src="https://s0.wp.com/latex.php?latex=%5Ckappa%27&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;kappa&#039;" class="latex" /> back to <img src="https://s0.wp.com/latex.php?latex=%5Ckappa.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;kappa." class="latex" />  But what about &#8216;deficiency zero&#8217;?  As I mentioned, this requires more work to understand.  </p>
<p>So, let&#8217;s dive in!  </p>
<h3> Deficiency </h3>
<p>In modern math, we like to take all the stuff we&#8217;re thinking about and compress it into a diagram with a few objects and maps going between these objects.   So, to understand the deficiency zero theorem, I wanted to isolate the crucial maps.  For starters, there&#8217;s an obvious map</p>
<p><img src="https://s0.wp.com/latex.php?latex=Y+%3A+K+%5Cto+%5Cmathbb%7BN%7D%5ES++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y : K &#92;to &#92;mathbb{N}^S  " class="latex" /> </p>
<p>sending each complex to the linear combination of species that it is.  </p>
<p>Indeed, we can change viewpoints a bit and think of <img src="https://s0.wp.com/latex.php?latex=K&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="K" class="latex" /> as an abstract set equipped with this map saying how each complex is made of species.  From now on this is what we&#8217;ll do.  Then all the information in a stochastic reaction network sits in this diagram:</p>
<div align="center">
<img src="https://i2.wp.com/math.ucr.edu/home/baez/networks/reaction_network_diagram_1.png" alt="" />
</div>
<p>This is fundamental to everything we&#8217;ll do for the next few episodes, so take a minute to lock it into your brain.</p>
<p>We&#8217;ll do lots of different things with this diagram.  For example, we often want to use ideas from linear algebra, and then we want our maps to be linear.   For example, <img src="https://s0.wp.com/latex.php?latex=Y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y" class="latex" /> extends uniquely to a linear map</p>
<p><img src="https://s0.wp.com/latex.php?latex=Y+%3A+%5Cmathbb%7BR%7D%5EK+%5Cto+%5Cmathbb%7BR%7D%5ES++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y : &#92;mathbb{R}^K &#92;to &#92;mathbb{R}^S  " class="latex" /> </p>
<p>sending real linear combinations of complexes to real linear combinations of species.   Reusing the name <img src="https://s0.wp.com/latex.php?latex=Y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y" class="latex" /> here won&#8217;t cause confusion.  We can also extend <img src="https://s0.wp.com/latex.php?latex=r%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="r," class="latex" /> <img src="https://s0.wp.com/latex.php?latex=s%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s," class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=t&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="t" class="latex" /> to linear maps in a unique way, getting a little diagram like this:</p>
<div align="center">
<img src="https://i1.wp.com/math.ucr.edu/home/baez/networks/reaction_network_diagram_2.png" alt="" />
</div>
<p>Linear algebra lets us talk about <i>differences</i> of complexes.  Each transition <img src="https://s0.wp.com/latex.php?latex=%5Ctau&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;tau" class="latex" /> gives a vector</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cpartial%28%5Ctau%29+%3D+t%28%5Ctau%29+-+s%28%5Ctau%29+%5Cin+%5Cmathbb%7BR%7D%5EK++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;partial(&#92;tau) = t(&#92;tau) - s(&#92;tau) &#92;in &#92;mathbb{R}^K  " class="latex" /> </p>
<p>saying the change in complexes that it causes.  And we can extend <img src="https://s0.wp.com/latex.php?latex=%5Cpartial&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;partial" class="latex" /> uniquely to a linear map</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cpartial+%3A+%5Cmathbb%7BR%7D%5ET+%5Cto+%5Cmathbb%7BR%7D%5EK++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;partial : &#92;mathbb{R}^T &#92;to &#92;mathbb{R}^K  " class="latex" /> </p>
<p>defined on linear combinations of transitions.  Mathematicians would call <img src="https://s0.wp.com/latex.php?latex=%5Cpartial&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;partial" class="latex" /> a <b>boundary operator</b>.</p>
<p>So, we have a little sequence of linear maps</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5ET+%5Cstackrel%7B%5Cpartial%7D%7B%5Cto%7D+%5Cmathbb%7BR%7D%5EK+%5Cstackrel%7BY%7D%7B%5Cto%7D+%5Cmathbb%7BR%7D%5ES+++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^T &#92;stackrel{&#92;partial}{&#92;to} &#92;mathbb{R}^K &#92;stackrel{Y}{&#92;to} &#92;mathbb{R}^S   " class="latex" /> </p>
<p>This turns a transition into a change in complexes, and then a change in species.   </p>
<p>If you know fancy math you&#8217;ll be wondering if this sequence is a &#8216;chain complex&#8217;, which is a fancy way of saying that <img src="https://s0.wp.com/latex.php?latex=Y+%5Cpartial+%3D+0.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y &#92;partial = 0." class="latex" />  The answer is no.   This equation means that every linear combination of reactions leaves the amount of all species unchanged.   Or equivalently: every reaction leaves the amount of all species unchanged.   This only happens in very silly examples.</p>
<p>Nonetheless, it&#8217;s <i>possible</i> for a linear combination of reactions to leave the amount of all species unchanged.</p>
<p>For example, this will happen if we have a linear combination of reactions that leaves the amount of all <i>complexes</i> unchanged.   But this sufficient condition is not necessary.  And this leads us to the concept of &#8216;deficiency zero&#8217;:</p>
<p><b> Definition.</b>  A reaction network has <b>deficiency zero</b> if any linear combination of reactions that leaves the amount of every species unchanged also leaves the amount of every complex unchanged.</p>
<p>In short, a reaction network has deficiency zero iff</p>
<p><img src="https://s0.wp.com/latex.php?latex=Y+%28%5Cpartial+%5Crho%29+%3D+0+%5Cimplies+%5Cpartial+%5Crho+%3D+0+++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y (&#92;partial &#92;rho) = 0 &#92;implies &#92;partial &#92;rho = 0   " class="latex" /> </p>
<p>for every <img src="https://s0.wp.com/latex.php?latex=%5Crho+%5Cin+%5Cmathbb%7BR%7D%5ET.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;rho &#92;in &#92;mathbb{R}^T." class="latex" />  In other words&#8212;using some basic concepts from linear algebra&#8212;a reaction network has deficiency zero iff <img src="https://s0.wp.com/latex.php?latex=Y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y" class="latex" /> is one-to-one when restricted to the image of <img src="https://s0.wp.com/latex.php?latex=%5Cpartial.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;partial." class="latex" />  Remember, the <a href="http://en.wikipedia.org/wiki/Image_%28mathematics%29">image</a> of <img src="https://s0.wp.com/latex.php?latex=%5Cpartial&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;partial" class="latex" /> is </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bim%7D+%5Cpartial+%3D+%5C%7B+%5Cpartial+%5Crho+%5C%3B+%3A+%5C%3B+%5Crho+%5Cin+%5Cmathbb%7BR%7D%5ET+%5C%7D+++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{im} &#92;partial = &#92;{ &#92;partial &#92;rho &#92;; : &#92;; &#92;rho &#92;in &#92;mathbb{R}^T &#92;}   " class="latex" /> </p>
<p>Roughly speaking, this consists of all changes in complexes that can occur due to reactions. </p>
<p>In still other words, a reaction network has deficiency zero if 0 is the only vector in both the image of <img src="https://s0.wp.com/latex.php?latex=%5Cpartial&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;partial" class="latex" /> and the kernel of <img src="https://s0.wp.com/latex.php?latex=Y%3A&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y:" class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bim%7D+%5Cpartial+%5Ccap+%5Cmathrm%7Bker%7D+Y+%3D+%5C%7B+0+%5C%7D+++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{im} &#92;partial &#92;cap &#92;mathrm{ker} Y = &#92;{ 0 &#92;}   " class="latex" /> </p>
<p>Remember, the <a href="http://en.wikipedia.org/wiki/Kernel_%28mathematics%29">kernel</a> of <img src="https://s0.wp.com/latex.php?latex=Y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y" class="latex" /> is</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bker%7D+Y+%3D+%5C%7B+%5Cphi+%5Cin+%5Cmathbb%7BR%7D%5EK+%3A+Y+%5Cphi+%3D+0+%5C%7D++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{ker} Y = &#92;{ &#92;phi &#92;in &#92;mathbb{R}^K : Y &#92;phi = 0 &#92;}  " class="latex" /> </p>
<p>Roughly speaking, this consists of all changes in complexes that don&#8217;t cause changes in species.  So, &#8216;deficiency zero&#8217; roughly says that if a reaction causes a change in complexes, it causes a change in species.  </p>
<p>(All this &#8216;roughly speaking&#8217; stuff is because in reality I should be talking about <i>linear combinations</i> of transitions, complexes and species.  But it&#8217;s a bit distracting to keep saying that when I&#8217;m trying to get across the basic ideas!)</p>
<p>Now we&#8217;re ready to understand deficiencies other than zero, at least a little.  They&#8217;re defined like this:</p>
<p><b> Definition.</b>  The <b>deficiency</b> of a reaction network is the dimension of <img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bim%7D+%5Cpartial+%5Ccap+%5Cmathrm%7Bker%7D+Y.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{im} &#92;partial &#92;cap &#92;mathrm{ker} Y." class="latex" />  </p>
<h3>  How to compute the deficiency </h3>
<p>You can compute the deficiency of a reaction network just by looking at it.  However, it takes a little training.  First, remember that a reaction network can be drawn as a graph with complexes as vertices and transitions as edges, like this:</p>
<div align="center">
<img width="200" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/chemical_reaction_network_part_20_I.png" alt="" />
</div>
<p>There are three important numbers we can extract from this graph:</p>
<p>&bull; We can count the number of vertices in this graph; let&#8217;s call that <img src="https://s0.wp.com/latex.php?latex=%7CK%7C%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="|K|," class="latex" /> since it&#8217;s just the number of complexes.  </p>
<p>&bull; We can count the number of pieces or &#8216;components&#8217; of this graph; let&#8217;s call that <img src="https://s0.wp.com/latex.php?latex=%5C%23+%5Cmathrm%7Bcomponents%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;# &#92;mathrm{components}" class="latex" /> for now.  </p>
<p>&bull; We can also count the dimension of the image of <img src="https://s0.wp.com/latex.php?latex=Y+%5Cpartial.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y &#92;partial." class="latex" />  This space, <img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bim%7D+Y+%5Cpartial%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{im} Y &#92;partial," class="latex" /> is called the <b>stochiometric subspace</b>: vectors in here are changes in species that can be accomplished by transitions in our reaction network, or linear combinations of transitions.  </p>
<p>These three numbers, all rather easy to compute, let us calculate the deficiency:</p>
<p><b> Theorem.</b> The deficiency of a reaction network equals </p>
<p><img src="https://s0.wp.com/latex.php?latex=%7CK%7C+-+%5C%23+%5Cmathrm%7Bcomponents%7D+-+%5Cmathrm%7Bdim%7D+%5Cleft%28+%5Cmathrm%7Bim%7D+Y+%5Cpartial+%5Cright%29++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="|K| - &#92;# &#92;mathrm{components} - &#92;mathrm{dim} &#92;left( &#92;mathrm{im} Y &#92;partial &#92;right)  " class="latex" /> </p>
<p><i>Proof.</i>   By definition we have</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bdeficiency%7D+%3D+%5Cdim+%5Cleft%28+%5Cmathrm%7Bim%7D+%5Cpartial+%5Ccap+%5Cmathrm%7Bker%7D+Y+%5Cright%29++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{deficiency} = &#92;dim &#92;left( &#92;mathrm{im} &#92;partial &#92;cap &#92;mathrm{ker} Y &#92;right)  " class="latex" /> </p>
<p>but another way to say this is</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bdeficiency%7D+%3D+%5Cmathrm%7Bdim%7D+%28%5Cmathrm%7Bker%7D+Y%7C_%7B%5Cmathrm%7Bim%7D+%5Cpartial%7D%29++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{deficiency} = &#92;mathrm{dim} (&#92;mathrm{ker} Y|_{&#92;mathrm{im} &#92;partial})  " class="latex" /> </p>
<p>where we are restricting <img src="https://s0.wp.com/latex.php?latex=Y&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y" class="latex" /> to the subspace <img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bim%7D+%5Cpartial%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{im} &#92;partial," class="latex" /> and taking the dimension of the kernel of that.</p>
<p>The <a href="http://en.wikipedia.org/wiki/Rank%E2%80%93nullity_theorem"><b>rank-nullity theorem</b></a> says that whenever you have a linear map <img src="https://s0.wp.com/latex.php?latex=T%3A+V+%5Cto+W&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T: V &#92;to W" class="latex" /> between finite-dimensional vector spaces, then</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bdim%7D+%5Cleft%28%5Cmathrm%7Bker%7D+T+%5Cright%29+%5C%3B+%3D+%5C%3B+%5Cmathrm%7Bdim%7D%5Cleft%28%5Cmathrm%7Bdom%7D+T%5Cright%29+%5C%3B+-+%5C%3B+%5Cmathrm%7Bdim%7D+%5Cleft%28%5Cmathrm%7Bim%7D+T%5Cright%29++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{dim} &#92;left(&#92;mathrm{ker} T &#92;right) &#92;; = &#92;; &#92;mathrm{dim}&#92;left(&#92;mathrm{dom} T&#92;right) &#92;; - &#92;; &#92;mathrm{dim} &#92;left(&#92;mathrm{im} T&#92;right)  " class="latex" /> </p>
<p>where <img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bdom%7D+T&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{dom} T" class="latex" /> is the <a href="http://en.wikipedia.org/wiki/Domain_of_a_function">domain</a> of <img src="https://s0.wp.com/latex.php?latex=T%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T," class="latex" /> namely the vector space <img src="https://s0.wp.com/latex.php?latex=V.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="V." class="latex" />  It follows that</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bdim%7D%28%5Cmathrm%7Bker%7D+Y%7C_%7B%5Cmathrm%7Bim%7D+%5Cpartial%7D%29+%3D+%5Cmathrm%7Bdim%7D%28%5Cmathrm%7Bdom%7D++Y%7C_%7B%5Cmathrm%7Bim%7D+%5Cpartial%7D%29+-+%5Cmathrm%7Bdim%7D%28%5Cmathrm%7Bim%7D++Y%7C_%7B%5Cmathrm%7Bim%7D+%5Cpartial%7D%29++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{dim}(&#92;mathrm{ker} Y|_{&#92;mathrm{im} &#92;partial}) = &#92;mathrm{dim}(&#92;mathrm{dom}  Y|_{&#92;mathrm{im} &#92;partial}) - &#92;mathrm{dim}(&#92;mathrm{im}  Y|_{&#92;mathrm{im} &#92;partial})  " class="latex" /> </p>
<p>The domain of <img src="https://s0.wp.com/latex.php?latex=Y%7C_%7B%5Cmathrm%7Bim%7D+%5Cpartial%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Y|_{&#92;mathrm{im} &#92;partial}" class="latex" /> is just <img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bim%7D+%5Cpartial%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{im} &#92;partial," class="latex" /> while its image equals <img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bim%7D+Y+%5Cpartial%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{im} Y &#92;partial," class="latex" /> so</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bdeficiency%7D+%3D+%5Cmathrm%7Bdim%7D%28%5Cmathrm%7Bim%7D+%5Cpartial%29+-+%5Cmathrm%7Bdim%7D%28%5Cmathrm%7Bim%7D+Y+%5Cpartial%29+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{deficiency} = &#92;mathrm{dim}(&#92;mathrm{im} &#92;partial) - &#92;mathrm{dim}(&#92;mathrm{im} Y &#92;partial) " class="latex" /></p>
<p>The theorem then follows from this:</p>
<p><b> Lemma.</b>  <img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bdim%7D+%28%5Cmathrm%7Bim%7D+%5Cpartial%29+%3D+%7CK%7C+-+%5C%23+%5Cmathrm%7Bcomponents%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{dim} (&#92;mathrm{im} &#92;partial) = |K| - &#92;# &#92;mathrm{components} " class="latex" /></p>
<p><i>Proof.</i>  In fact this holds whenever we have a finite set of complexes and a finite set of transitions going between them.  We get a diagram</p>
<div align="center">
<img src="https://i2.wp.com/math.ucr.edu/home/baez/networks/markov_process_diagram_3.png" alt="" />
</div>
<p>We can extend the source and target functions to linear maps as usual:</p>
<div align="center">
<img src="https://i0.wp.com/math.ucr.edu/home/baez/networks/markov_process_diagram_4.png" alt="" />
</div>
<p>and then we can define <img src="https://s0.wp.com/latex.php?latex=%5Cpartial+%3D+t+-+s.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;partial = t - s." class="latex" />  We claim that </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bdim%7D+%28%5Cmathrm%7Bim%7D+%5Cpartial%29+%3D+%7CK%7C+-+%5C%23+%5Cmathrm%7Bcomponents%7D++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{dim} (&#92;mathrm{im} &#92;partial) = |K| - &#92;# &#92;mathrm{components}  " class="latex" /> </p>
<p>where <img src="https://s0.wp.com/latex.php?latex=%5C%23+%5Cmathrm%7Bcomponents%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;# &#92;mathrm{components}" class="latex" /> is the number of connected components of the graph with <img src="https://s0.wp.com/latex.php?latex=K&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="K" class="latex" /> as vertices and <img src="https://s0.wp.com/latex.php?latex=T&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T" class="latex" /> as edges.  </p>
<p>This is easiest to see using an inductive argument where we start by throwing out all the edges of our graph and then put them back in one at a time.  When our graph has no edges, <img src="https://s0.wp.com/latex.php?latex=%5Cpartial+%3D+0&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;partial = 0" class="latex" /> and the number of components is <img src="https://s0.wp.com/latex.php?latex=%7CK%7C%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="|K|," class="latex" /> so our claim holds: both sides of the equation above are zero.  Then, each time we put in an edge, there are two choices: either it goes between two different components of the graph we have built so far, or it doesn&#8217;t.  If goes between two different components, it increases <img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bdim%7D+%28%5Cmathrm%7Bim%7D+%5Cpartial%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{dim} (&#92;mathrm{im} &#92;partial)" class="latex" /> by 1 and decreases the number of components by 1, so our equation continues to hold.   If it doesn&#8217;t, neither of these quantities change, so our equation again continues to hold.   &nbsp;  &#9608;</p>
<h3> Examples </h3>
<div align="center">
<img width="200" src="https://i2.wp.com/math.ucr.edu/home/baez/networks/chemical_reaction_network_part_17_I.png" alt="" />
</div>
<p>This reaction network is not weakly reversible, since we can get from <img src="https://s0.wp.com/latex.php?latex=B+%2B+E&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="B + E" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=A+%2B+C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A + C" class="latex" /> to <img src="https://s0.wp.com/latex.php?latex=D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="D" class="latex" /> but not back.   It becomes weakly reversible if we throw in another transition:</p>
<div align="center">
<img width="200" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/chemical_reaction_network_part_17_II.png" alt="" />
</div>
<p>Taking a reaction network and throwing in the reverse of an existing transition never changes the number of complexes, the number of components, or the dimension of the stoichiometric subspace.  So, the deficiency of the reaction network remains unchanged.  We computed it back in <a href="http://math.ucr.edu/home/baez/networks/networks_17.html">Part 17</a>.  For either reaction network above:</p>
<p>&bull; the number of complexes is 5:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%7CK%7C+%3D+%7C%5C%7BA%2CB%2CD%2C+A%2BC%2C+B%2BE%5C%7D%7C+%3D+5++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="|K| = |&#92;{A,B,D, A+C, B+E&#92;}| = 5  " class="latex" /> </p>
<p>&bull; the number of components is 2:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5C%23+%5Cmathrm%7Bcomponents%7D+%3D+2++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;# &#92;mathrm{components} = 2  " class="latex" /> </p>
<p>&bull; the dimension of the stoichiometric subspace is 3.  For this we go through each transition, see what change in species it causes, and take the vector space spanned by these changes.  Then we find a basis for this space and count it:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bim%7D+Y+%5Cpartial+%3D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{im} Y &#92;partial = " class="latex" /> </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Clangle+B+-+A%2C+A+-+B%2C+D+-+A+-+C%2C+D+-+%28B%2BE%29+%2C++%28B%2BE%29-%28A%2BC%29+%5Crangle++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;langle B - A, A - B, D - A - C, D - (B+E) ,  (B+E)-(A+C) &#92;rangle  " class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=%3D+%5Clangle+B+-A%2C+D+-+A+-+C%2C+D+-+A+-+E+%5Crangle++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="= &#92;langle B -A, D - A - C, D - A - E &#92;rangle  " class="latex" /></p>
<p>so </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bdim%7D+%5Cleft%28%5Cmathrm%7Bim%7D+Y+%5Cpartial+%5Cright%29+%3D+3++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{dim} &#92;left(&#92;mathrm{im} Y &#92;partial &#92;right) = 3  " class="latex" /> </p>
<p>As a result, the deficiency is zero:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Barray%7D%7Bccl%7D+%5Cmathrm%7Bdeficiency%7D+++%26%3D%26+%7CK%7C+-+%5C%23+%5Cmathrm%7Bcomponents%7D+-+%5Cmathrm%7Bdim%7D+%5Cleft%28+%5Cmathrm%7Bim%7D+Y+%5Cpartial+%5Cright%29+%5C%5C++%26%3D%26+5+-+2+-+3+%5C%5C++%26%3D%26++0+%5Cend%7Barray%7D++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;begin{array}{ccl} &#92;mathrm{deficiency}   &amp;=&amp; |K| - &#92;# &#92;mathrm{components} - &#92;mathrm{dim} &#92;left( &#92;mathrm{im} Y &#92;partial &#92;right) &#92;&#92;  &amp;=&amp; 5 - 2 - 3 &#92;&#92;  &amp;=&amp;  0 &#92;end{array}  " class="latex" /> </p>
<p>Now let&#8217;s throw in another complex and some more transitions:</p>
<div align="center">
<img width="200" src="https://i0.wp.com/math.ucr.edu/home/baez/networks/chemical_reaction_network_part_20_II.png" alt="" />
</div>
<p>Now:</p>
<p>&bull; the number of complexes increases by 1:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%7CK%7C+%3D+%7C%5C%7BA%2CB%2CD%2CE%2C+A%2BC%2C+B%2BE%5C%7D%7C+%3D+6++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="|K| = |&#92;{A,B,D,E, A+C, B+E&#92;}| = 6  " class="latex" /> </p>
<p>&bull; the number of components is unchanged:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5C%23+%5Cmathrm%7Bcomponents%7D+%3D+2++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;# &#92;mathrm{components} = 2  " class="latex" /> </p>
<p>&bull; the dimension of the stoichiometric subspace increases by 1.  We never need to include reverses of transitions when computing this:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bim%7D+Y+%5Cpartial+%3D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{im} Y &#92;partial = " class="latex" /> </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Clangle+B-A%2C+E-B%2C++D+-+%28A%2BC%29%2C+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;langle B-A, E-B,  D - (A+C), " class="latex" /><br />
<img src="https://s0.wp.com/latex.php?latex=D+-+%28B%2BE%29+%2C+%28B%2BE%29-%28A%2BC%29+%5Crangle++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="D - (B+E) , (B+E)-(A+C) &#92;rangle  " class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=%3D+%5Clangle+B+-A%2C+E-B%2C+D+-+A+-+C%2C+D+-+B+-+E+%5Crangle++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="= &#92;langle B -A, E-B, D - A - C, D - B - E &#92;rangle  " class="latex" /></p>
<p>so </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bdim%7D+%5Cleft%28%5Cmathrm%7Bim%7D+Y+%5Cpartial+%5Cright%29+%3D+4++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{dim} &#92;left(&#92;mathrm{im} Y &#92;partial &#92;right) = 4  " class="latex" /> </p>
<p>As a result, the deficiency is still zero:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Barray%7D%7Bccl%7D+%5Cmathrm%7Bdeficiency%7D+++%26%3D%26+%7CK%7C+-+%5C%23+%5Cmathrm%7Bcomponents%7D+-+%5Cmathrm%7Bdim%7D+%5Cleft%28+%5Cmathrm%7Bim%7D+Y+%5Cpartial+%5Cright%29+%5C%5C++%26%3D%26+6+-+2+-+4+%5C%5C++%26%3D%26++0+%5Cend%7Barray%7D++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;begin{array}{ccl} &#92;mathrm{deficiency}   &amp;=&amp; |K| - &#92;# &#92;mathrm{components} - &#92;mathrm{dim} &#92;left( &#92;mathrm{im} Y &#92;partial &#92;right) &#92;&#92;  &amp;=&amp; 6 - 2 - 4 &#92;&#92;  &amp;=&amp;  0 &#92;end{array}  " class="latex" /> </p>
<p>Do <i>all</i> reaction networks have deficiency zero?   That would be nice. Let&#8217;s try one more example:</p>
<div align="center">
<img width="200" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/chemical_reaction_network_part_20_V.png" alt="" />
</div>
<p>&bull; the number of complexes is the same as in our last example:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%7CK%7C+%3D+%7C%5C%7BA%2CB%2CD%2CE%2C+A%2BC%2C+B%2BE%5C%7D%7C+%3D+6++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="|K| = |&#92;{A,B,D,E, A+C, B+E&#92;}| = 6  " class="latex" /> </p>
<p>&bull; the number of components is also the same:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5C%23+%5Cmathrm%7Bcomponents%7D+%3D+2++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;# &#92;mathrm{components} = 2  " class="latex" /> </p>
<p>&bull; the dimension of the stoichiometric subspace is also the same:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bim%7D+Y+%5Cpartial+%3D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{im} Y &#92;partial = " class="latex" /> </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Clangle+B-A%2C++D+-+%28A%2BC%29%2C+D+-+%28B%2BE%29+%2C+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;langle B-A,  D - (A+C), D - (B+E) , " class="latex" /><br />
<img src="https://s0.wp.com/latex.php?latex=%28B%2BE%29-%28A%2BC%29%2C+%28B%2BE%29+-+B+%5Crangle+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(B+E)-(A+C), (B+E) - B &#92;rangle " class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=%3D+%5Clangle+B+-A%2C+D+-+A+-+C%2C+D+-+B+%2C+E%5Crangle+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="= &#92;langle B -A, D - A - C, D - B , E&#92;rangle " class="latex" /> </p>
<p>so </p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bdim%7D+%5Cleft%28%5Cmathrm%7Bim%7D+Y+%5Cpartial+%5Cright%29+%3D+4++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathrm{dim} &#92;left(&#92;mathrm{im} Y &#92;partial &#92;right) = 4  " class="latex" /> </p>
<p>So the deficiency is still zero:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Barray%7D%7Bccl%7D+%5Cmathrm%7Bdeficiency%7D+++%26%3D%26+%7CK%7C+-+%5C%23+%5Cmathrm%7Bcomponents%7D+-+%5Cmathrm%7Bdim%7D+%5Cleft%28+%5Cmathrm%7Bim%7D+Y+%5Cpartial+%5Cright%29+%5C%5C++%26%3D%26+6+-+2+-+4+%5C%5C++%26%3D%26++0+%5Cend%7Barray%7D++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;begin{array}{ccl} &#92;mathrm{deficiency}   &amp;=&amp; |K| - &#92;# &#92;mathrm{components} - &#92;mathrm{dim} &#92;left( &#92;mathrm{im} Y &#92;partial &#92;right) &#92;&#92;  &amp;=&amp; 6 - 2 - 4 &#92;&#92;  &amp;=&amp;  0 &#92;end{array}  " class="latex" /> </p>
<p>It&#8217;s sure easy to find examples with deficiency zero!  </p>
<p><b> Puzzle 1.</b> Can you find an example where the deficiency is <i>not</i> zero?</p>
<p><b>Puzzle 2.</b>  If you can&#8217;t find an example, prove the deficiency is always zero. If you can, find 1) the smallest example and 2) the smallest example that actually arises in chemistry.  </p>
<p>Note that not all reaction networks can actually arise in chemistry.  For example, the transition $A \to A + A$ would violate conservation of mass.  Nonetheless a reaction network like this might be useful in a very simple model of amoeba reproduction, one that doesn&#8217;t take limited resources into account.</p>
<h3> Different kinds of graphs </h3>
<p>I&#8217;ll conclude with some technical remarks that only a mathematician could love; feel free to skip them if you&#8217;re not in the mood.  As you&#8217;ve already seen, it&#8217;s important that a reaction network can be drawn as a graph:</p>
<div align="center">
<img width="200" src="https://i1.wp.com/math.ucr.edu/home/baez/networks/chemical_reaction_network_part_17_II.png" alt="" />
</div>
<p>But there are many <i>kinds</i> of graph.  What kind of graph is this, exactly?  </p>
<p>As I mentioned in <a href="http://math.ucr.edu/home/baez/networks/networks_17.html">Part 17</a>, it&#8217;s a <b>directed multigraph</b>, meaning that the edges have arrows on them, more than one edge can go from one vertex to another, and we can have any number of edges going from a vertex to itself.  Not all those features are present in this example, but they&#8217;re certainly allowed by our definition of reaction network!  </p>
<p>After all, we&#8217;ve seen that a stochastic reaction network amounts to a little diagram like this:</p>
<div align="center">
<img src="https://i2.wp.com/math.ucr.edu/home/baez/networks/reaction_network_diagram_1.png" alt="" />
</div>
<p>If we throw out the rate constants, we&#8217;re left with a reaction network.  So, a reaction network is just a diagram like this:</p>
<div align="center">
<img src="https://i2.wp.com/math.ucr.edu/home/baez/networks/reaction_network_diagram_4.png" alt="" />
</div>
<p>If we throw out the information about how complexes are made of species, we&#8217;re left with an even smaller diagram:</p>
<div align="center">
<img src="https://i2.wp.com/math.ucr.edu/home/baez/networks/markov_process_diagram_3.png" alt="" />
</div>
<p>And this precisely matches the slick definition of a <b>directed multigraph</b>: it&#8217;s a set <img src="https://s0.wp.com/latex.php?latex=E&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="E" class="latex" /> of <b>edges</b>, a set <img src="https://s0.wp.com/latex.php?latex=V&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="V" class="latex" /> of <b>vertices</b>, and functions <img src="https://s0.wp.com/latex.php?latex=s%2Ct+%3A+E+%5Cto+V&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="s,t : E &#92;to V" class="latex" /> saying where each edge starts and where it ends: its <b>source</b> and <b>target</b>.  </p>
<p>Since this series is about networks, we should expect to run into many kinds of graphs.  While their diversity is a bit annoying at first, we must learn to love it, at least if we&#8217;re mathematicians and want everything to be completely precise.   </p>
<p>There are at least 2<sup>3</sup> = 8 kinds of graphs, depending on our answers to three questions:</p>
<p>&bull; Do the edges have arrows on them?</p>
<p>&bull; Can more than one edge can go between a specific pair of vertices?</p>
<p>and</p>
<p>&bull; Can an edge can go from a vertex to itself?</p>
<p>We get directed multigraphs if we answer YES, YES and YES to these questions.  Since they allow all three features, directed multigraphs are very important.  For example, a <i>category</i> is a directed multigraph equipped with some extra structure.  Also, what mathematicians call a <i>quiver</i> is just another name for a directed multigraph.</p>
<p>We&#8217;ve met two other kinds of graph so far:</p>
<p>&bull; In <a href="http://math.ucr.edu/home/baez/networks/networks_15.html">Part 15</a> and <a href="http://math.ucr.edu/home/baez/networks/networks_16.html">Part 16</a> we described circuits made of resistors&mdash;or, in other words, Dirichlet operators&mdash;using &#8216;simple graphs&#8217;.  We get simple graphs when we answer NO, NO and NO to the three questions above.   The slick definition of a <b>simple graph</b> is that it&#8217;s a set <img src="https://s0.wp.com/latex.php?latex=V&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="V" class="latex" /> of vertices together with a subset <img src="https://s0.wp.com/latex.php?latex=E&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="E" class="latex" /> of the collection of 2-element subsets of <img src="https://s0.wp.com/latex.php?latex=V&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="V" class="latex" />.</p>
<p>&bull;  In <a href="http://math.ucr.edu/home/baez/networks/networks_20.html">Part 20</a> we described Markov processes on finite sets&mdash;or, in other words, infinitesimal stochastic operators&mdash;using &#8216;directed graphs&#8217;.  We get directed graphs when we answer YES, NO and YES to the three questions.  The slick definition of a <b>directed graph</b> is that it&#8217;s a set <img src="https://s0.wp.com/latex.php?latex=V&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="V" class="latex" /> of vertices together with a subset <img src="https://s0.wp.com/latex.php?latex=E&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="E" class="latex" /> of the ordered pairs of <img src="https://s0.wp.com/latex.php?latex=V&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="V" class="latex" />:  <img src="https://s0.wp.com/latex.php?latex=E+%5Csubseteq+V+%5Ctimes+V&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="E &#92;subseteq V &#92;times V" class="latex" />.  </p>
<p>There is a lot to say about this business, but for now I&#8217;ll just note that you can use directed multigraphs with edges labelled by positive numbers to describe Markov processes, just as we used directed graphs.  You don&#8217;t get anything more general, though!  After all, if we have multiple edges from one vertex to another, we can replace them by a single edge as long as we add up their rate constants.  And an edge from a vertex to itself has no effect at all.</p>
<p>In short, both for Markov processes and reaction networks, we can take &#8216;graph&#8217; to mean either &#8216;directed graph&#8217; or &#8216;directed multigraph&#8217;, as long as we make some minor adjustments. In what follows, we&#8217;ll use directed multigraphs for <i>both</i> Markov processes and reaction networks.  It will work a bit better if we ever get around to explaining how category theory fits into this story.</p>
									</div>

				<p class="postmetadata">
				<img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/speech_bubble.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2012/08/14/network-theory-part-21/#comments">35 Comments</a>				| <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/documents.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/category/chemistry/" rel="category tag">chemistry</a>, <a href="https://johncarlosbaez.wordpress.com/category/mathematics/" rel="category tag">mathematics</a>, <a href="https://johncarlosbaez.wordpress.com/category/networks/" rel="category tag">networks</a>								 | <img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/permalink.gif" alt="" /> <a href="https://johncarlosbaez.wordpress.com/2012/08/14/network-theory-part-21/" rel="bookmark" title="Permanent Link to Network Theory (Part&nbsp;21)">Permalink</a>
<br /><img src="https://s2.wp.com/wp-content/themes/pub/contempt/images/blog/figure_ver1.gif" alt="" /> Posted by John Baez				</p>
			</div>
			<hr />
		
		<div class="navigation">
			<div class="alignleft"><a href="https://johncarlosbaez.wordpress.com/category/mathematics/page/42/" >&laquo; Previous Entries</a></div>
			<div class="alignright"><a href="https://johncarlosbaez.wordpress.com/category/mathematics/page/40/" >Next Entries &raquo;</a></div>
		</div>

	
	</div>

	<div id="sidebar">
				<ul>

		 <li>

				<p>You are currently browsing the archives for the mathematics category.</p>

					</li> 
		<li id="recent-posts-3" class="widget widget_recent_entries">
		<h2 class="widgettitle">latest posts:</h2>

		<ul>
											<li>
					<a href="https://johncarlosbaez.wordpress.com/2021/09/26/classical-mechanics-versus-thermodynamics-part-4/">Classical Mechanics versus Thermodynamics (Part&nbsp;4)</a>
									</li>
											<li>
					<a href="https://johncarlosbaez.wordpress.com/2021/09/23/classical-mechanics-versus-thermodynamics-part-3/">Classical Mechanics versus Thermodynamics (Part&nbsp;3)</a>
									</li>
											<li>
					<a href="https://johncarlosbaez.wordpress.com/2021/09/22/maxwells-relations-part-3/">Maxwell&#8217;s Relations (Part&nbsp;3)</a>
									</li>
											<li>
					<a href="https://johncarlosbaez.wordpress.com/2021/09/18/maxwells-relations-part-two/">Maxwell&#8217;s Relations (Part&nbsp;2)</a>
									</li>
											<li>
					<a href="https://johncarlosbaez.wordpress.com/2021/09/17/maxwells-relations-part-1/">Maxwell&#8217;s Relations (Part&nbsp;1)</a>
									</li>
											<li>
					<a href="https://johncarlosbaez.wordpress.com/2021/09/13/the-cyclic-identity-for-partial-derivatives/">The Cyclic Identity for Partial&nbsp;Derivatives</a>
									</li>
											<li>
					<a href="https://johncarlosbaez.wordpress.com/2021/08/17/information-geometry-part-21/">Information Geometry (Part&nbsp;21)</a>
									</li>
											<li>
					<a href="https://johncarlosbaez.wordpress.com/2021/08/14/information-geometry-part-20/">Information Geometry (Part&nbsp;20)</a>
									</li>
											<li>
					<a href="https://johncarlosbaez.wordpress.com/2021/08/08/information-geometry-part-19/">Information Geometry (Part&nbsp;19)</a>
									</li>
											<li>
					<a href="https://johncarlosbaez.wordpress.com/2021/08/05/information-geometry-part-18/">Information Geometry (Part&nbsp;18)</a>
									</li>
					</ul>

		</li>
<li id="recent-comments-2" class="widget widget_recent_comments"><h2 class="widgettitle">latest comments:</h2>
				<table class="recentcommentsavatar" cellspacing="0" cellpadding="0" border="0">
					<tr><td title="Peter Morgan" class="recentcommentsavatartop" style="height:32px; width:32px;"><img alt='' src='https://0.gravatar.com/avatar/cd90f0688cecdf25a11b4ba396151b5f?s=32&#038;d=identicon&#038;r=G' class='avatar avatar-32' height='32' width='32' /></td><td class="recentcommentstexttop" style="">Peter Morgan on <a href="https://johncarlosbaez.wordpress.com/2021/09/26/classical-mechanics-versus-thermodynamics-part-4/#comment-172599">Classical Mechanics versus The&hellip;</a></td></tr><tr><td title="Toby Bartels" class="recentcommentsavatarend" style="height:32px; width:32px;"><a href="http://tobybartels.name/" rel="nofollow"><img alt='' src='https://0.gravatar.com/avatar/68c7b083965f5073c50bf7c8d2aac358?s=32&#038;d=identicon&#038;r=G' class='avatar avatar-32' height='32' width='32' /></a></td><td class="recentcommentstextend" style=""><a href="http://tobybartels.name/" rel="nofollow">Toby Bartels</a> on <a href="https://johncarlosbaez.wordpress.com/2021/09/23/classical-mechanics-versus-thermodynamics-part-3/#comment-172598">Classical Mechanics versus The&hellip;</a></td></tr><tr><td title="David Corfield" class="recentcommentsavatarend" style="height:32px; width:32px;"><img alt='' src='https://0.gravatar.com/avatar/34784534843022b3541c8ddd693718cb?s=32&#038;d=identicon&#038;r=G' class='avatar avatar-32' height='32' width='32' /></td><td class="recentcommentstextend" style="">David Corfield on <a href="https://johncarlosbaez.wordpress.com/2021/09/23/classical-mechanics-versus-thermodynamics-part-3/#comment-172597">Classical Mechanics versus The&hellip;</a></td></tr><tr><td title="Toby Bartels" class="recentcommentsavatarend" style="height:32px; width:32px;"><a href="http://tobybartels.name/" rel="nofollow"><img alt='' src='https://0.gravatar.com/avatar/68c7b083965f5073c50bf7c8d2aac358?s=32&#038;d=identicon&#038;r=G' class='avatar avatar-32' height='32' width='32' /></a></td><td class="recentcommentstextend" style=""><a href="http://tobybartels.name/" rel="nofollow">Toby Bartels</a> on <a href="https://johncarlosbaez.wordpress.com/2021/09/26/classical-mechanics-versus-thermodynamics-part-4/#comment-172596">Classical Mechanics versus The&hellip;</a></td></tr><tr><td title="David Corfield" class="recentcommentsavatarend" style="height:32px; width:32px;"><img alt='' src='https://lh3.googleusercontent.com/a/AATXAJxXcoKzwm_cY3LJp3qldhAQvZVoBimQd4xe5tDl=s96-c' class='avatar avatar-32' height='32' width='32' /></td><td class="recentcommentstextend" style="">David Corfield on <a href="https://johncarlosbaez.wordpress.com/2021/09/23/classical-mechanics-versus-thermodynamics-part-3/#comment-172590">Classical Mechanics versus The&hellip;</a></td></tr><tr><td title="amarashiki" class="recentcommentsavatarend" style="height:32px; width:32px;"><a href="http://gravatar.com/amarashiki" rel="nofollow"><img alt='' src='https://0.gravatar.com/avatar/62b2df0762257e75433ad6f161488c3a?s=32&#038;d=identicon&#038;r=G' class='avatar avatar-32' height='32' width='32' /></a></td><td class="recentcommentstextend" style=""><a href="http://gravatar.com/amarashiki" rel="nofollow">amarashiki</a> on <a href="https://johncarlosbaez.wordpress.com/2012/01/23/classical-mechanics-versus-thermodynamics-part-2/#comment-172566">Classical Mechanics versus The&hellip;</a></td></tr><tr><td title="John Baez" class="recentcommentsavatarend" style="height:32px; width:32px;"><a href="http://math.ucr.edu/home/baez/" rel="nofollow"><img alt='' src='https://0.gravatar.com/avatar/34784534843022b3541c8ddd693718cb?s=32&#038;d=identicon&#038;r=G' class='avatar avatar-32' height='32' width='32' /></a></td><td class="recentcommentstextend" style=""><a href="http://math.ucr.edu/home/baez/" rel="nofollow">John Baez</a> on <a href="https://johncarlosbaez.wordpress.com/2021/09/23/classical-mechanics-versus-thermodynamics-part-3/#comment-172560">Classical Mechanics versus The&hellip;</a></td></tr><tr><td title="domenico" class="recentcommentsavatarend" style="height:32px; width:32px;"><img alt='' src='https://2.gravatar.com/avatar/ba06491deb8346d20356ac2ae05893ee?s=32&#038;d=identicon&#038;r=G' class='avatar avatar-32' height='32' width='32' /></td><td class="recentcommentstextend" style="">domenico on <a href="https://johncarlosbaez.wordpress.com/2021/09/23/classical-mechanics-versus-thermodynamics-part-3/#comment-172559">Classical Mechanics versus The&hellip;</a></td></tr><tr><td title="domenico" class="recentcommentsavatarend" style="height:32px; width:32px;"><img alt='' src='https://2.gravatar.com/avatar/ba06491deb8346d20356ac2ae05893ee?s=32&#038;d=identicon&#038;r=G' class='avatar avatar-32' height='32' width='32' /></td><td class="recentcommentstextend" style="">domenico on <a href="https://johncarlosbaez.wordpress.com/2021/09/23/classical-mechanics-versus-thermodynamics-part-3/#comment-172558">Classical Mechanics versus The&hellip;</a></td></tr><tr><td title="Maxwell Relations | Equivalent eXchange" class="recentcommentsavatarend" style="height:32px; width:32px;"><a href="http://equivalentexchange.blog/2021/09/25/maxwell-relations/" rel="nofollow"></a></td><td class="recentcommentstextend" style=""><a href="http://equivalentexchange.blog/2021/09/25/maxwell-relations/" rel="nofollow">Maxwell Relations |&hellip;</a> on <a href="https://johncarlosbaez.wordpress.com/2021/09/22/maxwells-relations-part-3/#comment-172557">Maxwell&#8217;s Relations (Par&hellip;</a></td></tr>				</table>
				</li>
<li id="text-3" class="widget widget_text"><h2 class="widgettitle">How To Write Math Here:</h2>
			<div class="textwidget"><p>You can <a href="http://en.wikibooks.org/wiki/LaTeX/Mathematics">include math in your comments using LaTeX</a>,  but you need to do it this way:</p>
<p>&#036;latex  E = mc^2&#036;</p>
<p>You need the word 'latex' right after the first dollar sign, and it needs a space after it.  Double dollar signs don't work, and other limitations apply, some described <a href="http://en.support.wordpress.com/latex/">here</a>.  You can't preview comments here, but I'm happy to fix errors.</p>
</div>
		</li>
<li id="categories-2" class="widget widget_categories"><h2 class="widgettitle">Read Posts On:</h2>

			<ul>
					<li class="cat-item cat-item-177"><a href="https://johncarlosbaez.wordpress.com/category/art/">art</a> (3)
</li>
	<li class="cat-item cat-item-4003"><a href="https://johncarlosbaez.wordpress.com/category/astronomy/">astronomy</a> (29)
</li>
	<li class="cat-item cat-item-8262191"><a href="https://johncarlosbaez.wordpress.com/category/azimuth/">azimuth</a> (60)
</li>
	<li class="cat-item cat-item-86856"><a href="https://johncarlosbaez.wordpress.com/category/biodiversity/">biodiversity</a> (38)
</li>
	<li class="cat-item cat-item-4936"><a href="https://johncarlosbaez.wordpress.com/category/biology/">biology</a> (107)
</li>
	<li class="cat-item cat-item-355244"><a href="https://johncarlosbaez.wordpress.com/category/carbon-emissions/">carbon emissions</a> (78)
</li>
	<li class="cat-item cat-item-5936"><a href="https://johncarlosbaez.wordpress.com/category/chemistry/">chemistry</a> (74)
</li>
	<li class="cat-item cat-item-6108"><a href="https://johncarlosbaez.wordpress.com/category/climate/">climate</a> (155)
</li>
	<li class="cat-item cat-item-5043"><a href="https://johncarlosbaez.wordpress.com/category/computer-science/">computer science</a> (57)
</li>
	<li class="cat-item cat-item-9204"><a href="https://johncarlosbaez.wordpress.com/category/conferences/">conferences</a> (81)
</li>
	<li class="cat-item cat-item-1098"><a href="https://johncarlosbaez.wordpress.com/category/culture/">culture</a> (4)
</li>
	<li class="cat-item cat-item-657"><a href="https://johncarlosbaez.wordpress.com/category/economics/">economics</a> (32)
</li>
	<li class="cat-item cat-item-1212"><a href="https://johncarlosbaez.wordpress.com/category/energy/">energy</a> (50)
</li>
	<li class="cat-item cat-item-25393"><a href="https://johncarlosbaez.wordpress.com/category/engineering/">engineering</a> (11)
</li>
	<li class="cat-item cat-item-14852"><a href="https://johncarlosbaez.wordpress.com/category/mathematics/game-theory/">game theory</a> (29)
</li>
	<li class="cat-item cat-item-1215"><a href="https://johncarlosbaez.wordpress.com/category/geography/">geography</a> (4)
</li>
	<li class="cat-item cat-item-337"><a href="https://johncarlosbaez.wordpress.com/category/health/">health</a> (4)
</li>
	<li class="cat-item cat-item-678"><a href="https://johncarlosbaez.wordpress.com/category/history/">history</a> (2)
</li>
	<li class="cat-item cat-item-23375499"><a href="https://johncarlosbaez.wordpress.com/category/information-and-entropy/">information and entropy</a> (92)
</li>
	<li class="cat-item cat-item-3558"><a href="https://johncarlosbaez.wordpress.com/category/jobs/">jobs</a> (11)
</li>
	<li class="cat-item cat-item-5465"><a href="https://johncarlosbaez.wordpress.com/category/journals/">journals</a> (5)
</li>
	<li class="cat-item cat-item-3582 current-cat"><a aria-current="page" href="https://johncarlosbaez.wordpress.com/category/mathematics/">mathematics</a> (479)
</li>
	<li class="cat-item cat-item-18"><a href="https://johncarlosbaez.wordpress.com/category/music/">music</a> (3)
</li>
	<li class="cat-item cat-item-3968"><a href="https://johncarlosbaez.wordpress.com/category/networks/">networks</a> (185)
</li>
	<li class="cat-item cat-item-154934"><a href="https://johncarlosbaez.wordpress.com/category/oceans/">oceans</a> (13)
</li>
	<li class="cat-item cat-item-1211"><a href="https://johncarlosbaez.wordpress.com/category/physics/">physics</a> (205)
</li>
	<li class="cat-item cat-item-10451"><a href="https://johncarlosbaez.wordpress.com/category/probability/">probability</a> (92)
</li>
	<li class="cat-item cat-item-4909"><a href="https://johncarlosbaez.wordpress.com/category/psychology/">psychology</a> (6)
</li>
	<li class="cat-item cat-item-3330"><a href="https://johncarlosbaez.wordpress.com/category/publishing/">publishing</a> (19)
</li>
	<li class="cat-item cat-item-46615"><a href="https://johncarlosbaez.wordpress.com/category/puzzles/">puzzles</a> (14)
</li>
	<li class="cat-item cat-item-4140243"><a href="https://johncarlosbaez.wordpress.com/category/quantum-technologies/">quantum technologies</a> (28)
</li>
	<li class="cat-item cat-item-562"><a href="https://johncarlosbaez.wordpress.com/category/questions/">questions</a> (3)
</li>
	<li class="cat-item cat-item-93974"><a href="https://johncarlosbaez.wordpress.com/category/risks/">risks</a> (48)
</li>
	<li class="cat-item cat-item-37893"><a href="https://johncarlosbaez.wordpress.com/category/seminars/">seminars</a> (21)
</li>
	<li class="cat-item cat-item-581"><a href="https://johncarlosbaez.wordpress.com/category/software/">software</a> (19)
</li>
	<li class="cat-item cat-item-39438"><a href="https://johncarlosbaez.wordpress.com/category/strategies/">strategies</a> (36)
</li>
	<li class="cat-item cat-item-6877"><a href="https://johncarlosbaez.wordpress.com/category/sustainability/">sustainability</a> (71)
</li>
	<li class="cat-item cat-item-66608272"><a href="https://johncarlosbaez.wordpress.com/category/the-practice-of-science/">the practice of science</a> (27)
</li>
	<li class="cat-item cat-item-61590"><a href="https://johncarlosbaez.wordpress.com/category/this-weeks-finds/">this week&#039;s finds</a> (18)
</li>
			</ul>

			</li>
<li id="linkcat-20924250" class="widget widget_links"><h2 class="widgettitle">also visit these:</h2>

	<ul class='xoxo blogroll'>
<li><a href="http://www.azimuthproject.org/azimuth/show/Azimuth+Blog" title="Go here to see what’s on this blog, organized by topic or author!">Azimuth Blog Overview</a></li>
<li><a href="http://www.azimuthproject.org/azimuth/show/HomePage" title="for scientists and engineers who want to save the planet">Azimuth Project</a></li>
<li><a href="http://bittooth.blogspot.com/" title="David Summers on energy: oil, gas and more">Bit Tooth Energy</a></li>
<li><a href="http://bravenewclimate.com/" title="Barry Brooks on climate and energy policy">Brave New Climate</a></li>
<li><a href="http://physics.ucsd.edu/do-the-math/" title="UC San Diego prof uses physics and estimation to assess energy, growth, options">Do the Math</a></li>
<li><a href="http://dotearth.blogs.nytimes.com/" title="Andrew Revkin’s environmental blog on the New York Times">Dot Earth</a></li>
<li><a href="http://e360.yale.edu/" title="News from the Yale School of Forestry &amp; Environmental Studies">Environment 360</a></li>
<li><a href="http://planet3.org/" title="A metablog on sustainability">Planet3.0</a></li>
<li><a href="http://www.realclimate.org/" title="climate science from climate scientists">RealClimate</a></li>
<li><a href="http://www.easterbrook.ca/steve/" title="Steve Easterbrook&#8217;s blog on software engineering and climate modeling">Serendipity</a></li>
<li><a href="http://scienceofdoom.com/" title="climate science in perspective">The Science of Doom</a></li>
<li><a href="http://e360.yale.edu/" title="opinion, analysis, reporting and debate on environmental issues">Yale Environment 360</a></li>

	</ul>
</li>

<li id="rss_links-3" class="widget widget_rss_links"><h2 class="widgettitle">RSS feeds:</h2>
<p class="size-small"><a class="feed-image-link" href="https://johncarlosbaez.wordpress.com/feed/" title="Subscribe to Posts"><img src="https://johncarlosbaez.wordpress.com/i/rss/red-small.png?m=1391188133h" alt="RSS Feed" /></a>&nbsp;<a href="https://johncarlosbaez.wordpress.com/feed/" title="Subscribe to Posts">RSS - Posts</a></p><p class="size-small"><a class="feed-image-link" href="https://johncarlosbaez.wordpress.com/comments/feed/" title="Subscribe to Comments"><img src="https://johncarlosbaez.wordpress.com/i/rss/red-small.png?m=1391188133h" alt="RSS Feed" /></a>&nbsp;<a href="https://johncarlosbaez.wordpress.com/comments/feed/" title="Subscribe to Comments">RSS - Comments</a></p>
</li>
<li id="blog_subscription-3" class="widget widget_blog_subscription jetpack_subscription_widget"><h2 class="widgettitle"><label for="subscribe-field">Email Subscription:</label></h2>

			<form
				action="https://subscribe.wordpress.com"
				method="post"
				accept-charset="utf-8"
				id=""
			>
				<p>Enter your email address to subscribe to this blog and receive notifications of new posts by email.</p>
					<div class="jetpack-subscribe-count">
						<p>
						Join 5,211 other followers						</p>
					</div>
									<p id="subscribe-email">
					<label
						id="subscribe-field-label"
						for="subscribe-field"
						class="screen-reader-text"
					>
						Email Address:					</label>

					<input
							type="email"
							name="email"
							
							style="width: 95%; padding: 1px 10px"
							placeholder="Enter your email address"
							value=""
							id="subscribe-field"
						/>				</p>

				<p id="subscribe-submit"
									>
                    <input type="hidden" name="action" value="subscribe"/>
                    <input type="hidden" name="blog_id" value="12777403"/>
                    <input type="hidden" name="source" value="https://johncarlosbaez.wordpress.com/category/mathematics/page/41/"/>
                    <input type="hidden" name="sub-type" value="widget"/>
                    <input type="hidden" name="redirect_fragment" value="blog_subscription-3"/>
					<input type="hidden" id="_wpnonce" name="_wpnonce" value="ffcb185558" />                    <button type="submit"
	                    	                        class="wp-block-button__link"
	                    		                	                >
	                    Sign me up!                    </button>
                </p>
            </form>
			
</li>
<li id="search-3" class="widget widget_search"><h2 class="widgettitle">SEARCH:</h2>
<form method="get" id="searchform" action="https://johncarlosbaez.wordpress.com/">
<div><label for="s" class="search-label">Search</label><input type="text" value="" name="s" id="s" />
<input type="submit" id="searchsubmit" value="Search" />
</div>
</form></li>
<li id="blog-stats-2" class="widget widget_blog-stats"><h2 class="widgettitle">Blog Stats:</h2>
		<ul>
			<li>4,177,706 hits</li>
		</ul>
		</li>
		</ul>
	</div>



<div id="footer">
	<p>
	<br />
	<a href="https://wordpress.com/?ref=footer_blog" rel="nofollow">Blog at WordPress.com.</a>
	</p>
</div>

</div>

				<script type="text/javascript">
		//<![CDATA[
		var infiniteScroll = JSON.parse( decodeURIComponent( '%7B%22settings%22%3A%7B%22id%22%3A%22content%22%2C%22ajaxurl%22%3A%22https%3A%5C%2F%5C%2Fjohncarlosbaez.wordpress.com%5C%2F%3Finfinity%3Dscrolling%22%2C%22type%22%3A%22scroll%22%2C%22wrapper%22%3Atrue%2C%22wrapper_class%22%3A%22infinite-wrap%22%2C%22footer%22%3Atrue%2C%22click_handle%22%3A%221%22%2C%22text%22%3A%22Older%20posts%22%2C%22totop%22%3A%22Scroll%20back%20to%20top%22%2C%22currentday%22%3A%2214.08.12%22%2C%22order%22%3A%22DESC%22%2C%22scripts%22%3A%5B%5D%2C%22styles%22%3A%5B%5D%2C%22google_analytics%22%3Afalse%2C%22offset%22%3A41%2C%22history%22%3A%7B%22host%22%3A%22johncarlosbaez.wordpress.com%22%2C%22path%22%3A%22%5C%2Fcategory%5C%2Fmathematics%5C%2Fpage%5C%2F%25d%5C%2F%22%2C%22use_trailing_slashes%22%3Atrue%2C%22parameters%22%3A%22%22%7D%2C%22query_args%22%3A%7B%22paged%22%3A41%2C%22category_name%22%3A%22mathematics%22%2C%22error%22%3A%22%22%2C%22m%22%3A%22%22%2C%22p%22%3A0%2C%22post_parent%22%3A%22%22%2C%22subpost%22%3A%22%22%2C%22subpost_id%22%3A%22%22%2C%22attachment%22%3A%22%22%2C%22attachment_id%22%3A0%2C%22name%22%3A%22%22%2C%22pagename%22%3A%22%22%2C%22page_id%22%3A0%2C%22second%22%3A%22%22%2C%22minute%22%3A%22%22%2C%22hour%22%3A%22%22%2C%22day%22%3A0%2C%22monthnum%22%3A0%2C%22year%22%3A0%2C%22w%22%3A0%2C%22tag%22%3A%22%22%2C%22cat%22%3A3582%2C%22tag_id%22%3A%22%22%2C%22author%22%3A%22%22%2C%22author_name%22%3A%22%22%2C%22feed%22%3A%22%22%2C%22tb%22%3A%22%22%2C%22meta_key%22%3A%22%22%2C%22meta_value%22%3A%22%22%2C%22preview%22%3A%22%22%2C%22s%22%3A%22%22%2C%22sentence%22%3A%22%22%2C%22title%22%3A%22%22%2C%22fields%22%3A%22%22%2C%22menu_order%22%3A%22%22%2C%22embed%22%3A%22%22%2C%22category__in%22%3A%5B%5D%2C%22category__not_in%22%3A%5B%5D%2C%22category__and%22%3A%5B%5D%2C%22post__in%22%3A%5B%5D%2C%22post__not_in%22%3A%5B%5D%2C%22post_name__in%22%3A%5B%5D%2C%22tag__in%22%3A%5B%5D%2C%22tag__not_in%22%3A%5B%5D%2C%22tag__and%22%3A%5B%5D%2C%22tag_slug__in%22%3A%5B%5D%2C%22tag_slug__and%22%3A%5B%5D%2C%22post_parent__in%22%3A%5B%5D%2C%22post_parent__not_in%22%3A%5B%5D%2C%22author__in%22%3A%5B%5D%2C%22author__not_in%22%3A%5B%5D%2C%22lazy_load_term_meta%22%3Afalse%2C%22posts_per_page%22%3A10%2C%22ignore_sticky_posts%22%3Afalse%2C%22suppress_filters%22%3Afalse%2C%22cache_results%22%3Afalse%2C%22update_post_term_cache%22%3Atrue%2C%22update_post_meta_cache%22%3Atrue%2C%22post_type%22%3A%22%22%2C%22nopaging%22%3Afalse%2C%22comments_per_page%22%3A%22100%22%2C%22no_found_rows%22%3Afalse%2C%22order%22%3A%22DESC%22%7D%2C%22query_before%22%3A%222021-09-26%2019%3A30%3A08%22%2C%22last_post_date%22%3A%222012-08-14%2002%3A57%3A56%22%2C%22body_class%22%3A%22infinite-scroll%20neverending%22%2C%22loading_text%22%3A%22Loading%20new%20page%22%2C%22stats%22%3A%22blog%3D12777403%26v%3Dwpcom%26tz%3D0%26user_id%3D0%26subd%3Djohncarlosbaez%26x_pagetype%3Dinfinite%22%7D%7D' ) );
		//]]>
		</script>
		<!--  -->
<script src='//0.gravatar.com/js/gprofiles.js?ver=202138y' id='grofiles-cards-js'></script>
<script id='wpgroho-js-extra'>
var WPGroHo = {"my_hash":""};
</script>
<script crossorigin='anonymous' type='text/javascript' src='https://s1.wp.com/wp-content/mu-plugins/gravatar-hovercards/wpgroho.js?m=1610363240h'></script>

	<script>
		// Initialize and attach hovercards to all gravatars
		( function() {
			function init() {
				if ( typeof Gravatar === 'undefined' ) {
					return;
				}

				if ( typeof Gravatar.init !== 'function' ) {
					return;
				}

				Gravatar.profile_cb = function ( hash, id ) {
					WPGroHo.syncProfileData( hash, id );
				};

				Gravatar.my_hash = WPGroHo.my_hash;
				Gravatar.init( 'body', '#wp-admin-bar-my-account' );
			}

			if ( document.readyState !== 'loading' ) {
				init();
			} else {
				document.addEventListener( 'DOMContentLoaded', init );
			}
		} )();
	</script>

		<div style="display:none">
	<div class="grofile-hash-map-cd90f0688cecdf25a11b4ba396151b5f">
	</div>
	<div class="grofile-hash-map-68c7b083965f5073c50bf7c8d2aac358">
	</div>
	<div class="grofile-hash-map-34784534843022b3541c8ddd693718cb">
	</div>
	<div class="grofile-hash-map-7d52fbe20c8ac05886a296e9ee2159b1">
	</div>
	<div class="grofile-hash-map-62b2df0762257e75433ad6f161488c3a">
	</div>
	<div class="grofile-hash-map-ba06491deb8346d20356ac2ae05893ee">
	</div>
	</div>
		<div id="infinite-footer">
			<div class="container">
				<div class="blog-info">
					<a id="infinity-blog-title" href="https://johncarlosbaez.wordpress.com/" rel="home">
						Azimuth					</a>
				</div>
				<div class="blog-credits">
					<a href="https://wordpress.com/?ref=footer_blog" rel="nofollow">Blog at WordPress.com.</a> 				</div>
			</div>
		</div><!-- #infinite-footer -->
		
<script>
window.addEventListener( "load", function( event ) {
	var link = document.createElement( "link" );
	link.href = "https://s0.wp.com/wp-content/mu-plugins/actionbar/actionbar.css?v=20210915";
	link.type = "text/css";
	link.rel = "stylesheet";
	document.head.appendChild( link );

	var script = document.createElement( "script" );
	script.src = "https://s0.wp.com/wp-content/mu-plugins/actionbar/actionbar.js?v=20210920";
	script.defer = true;
	document.body.appendChild( script );
} );
</script>

			<div id="jp-carousel-loading-overlay">
			<div id="jp-carousel-loading-wrapper">
				<span id="jp-carousel-library-loading">&nbsp;</span>
			</div>
		</div>
		<div class="jp-carousel-overlay" style="display: none;">

		<div class="jp-carousel-container">
			<!-- The Carousel Swiper -->
			<div
				class="jp-carousel-wrap swiper-container jp-carousel-swiper-container jp-carousel-transitions"
				itemscope
				itemtype="https://schema.org/ImageGallery">
				<div class="jp-carousel swiper-wrapper"></div>
				<div class="jp-swiper-button-prev swiper-button-prev">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskPrev" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="9" height="12">
							<path d="M16.2072 16.59L11.6496 12L16.2072 7.41L14.8041 6L8.8335 12L14.8041 18L16.2072 16.59Z" fill="white"/>
						</mask>
						<g mask="url(#maskPrev)">
							<rect x="0.579102" width="23.8823" height="24" fill="#FFFFFF"/>
						</g>
					</svg>
				</div>
				<div class="jp-swiper-button-next swiper-button-next">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskNext" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="8" height="12">
							<path d="M8.59814 16.59L13.1557 12L8.59814 7.41L10.0012 6L15.9718 12L10.0012 18L8.59814 16.59Z" fill="white"/>
						</mask>
						<g mask="url(#maskNext)">
							<rect x="0.34375" width="23.8822" height="24" fill="#FFFFFF"/>
						</g>
					</svg>
				</div>
			</div>
			<!-- The main close buton -->
			<div class="jp-carousel-close-hint">
				<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
					<mask id="maskClose" mask-type="alpha" maskUnits="userSpaceOnUse" x="5" y="5" width="15" height="14">
						<path d="M19.3166 6.41L17.9135 5L12.3509 10.59L6.78834 5L5.38525 6.41L10.9478 12L5.38525 17.59L6.78834 19L12.3509 13.41L17.9135 19L19.3166 17.59L13.754 12L19.3166 6.41Z" fill="white"/>
					</mask>
					<g mask="url(#maskClose)">
						<rect x="0.409668" width="23.8823" height="24" fill="#FFFFFF"/>
					</g>
				</svg>
			</div>
			<!-- Image info, comments and meta -->
			<div class="jp-carousel-info">
				<div class="jp-carousel-info-footer">
					<div class="jp-carousel-pagination-container">
						<div class="jp-swiper-pagination swiper-pagination"></div>
						<div class="jp-carousel-pagination"></div>
					</div>
					<div class="jp-carousel-photo-title-container">
						<h2 class="jp-carousel-photo-caption"></h2>
					</div>
					<div class="jp-carousel-photo-icons-container">
						<a href="#" class="jp-carousel-icon-btn jp-carousel-icon-info" aria-label="Toggle photo metadata visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskInfo" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M12.7537 2C7.26076 2 2.80273 6.48 2.80273 12C2.80273 17.52 7.26076 22 12.7537 22C18.2466 22 22.7046 17.52 22.7046 12C22.7046 6.48 18.2466 2 12.7537 2ZM11.7586 7V9H13.7488V7H11.7586ZM11.7586 11V17H13.7488V11H11.7586ZM4.79292 12C4.79292 16.41 8.36531 20 12.7537 20C17.142 20 20.7144 16.41 20.7144 12C20.7144 7.59 17.142 4 12.7537 4C8.36531 4 4.79292 7.59 4.79292 12Z" fill="white"/>
									</mask>
									<g mask="url(#maskInfo)">
										<rect x="0.8125" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>
							</span>
						</a>
												<a href="#" class="jp-carousel-icon-btn jp-carousel-icon-comments" aria-label="Toggle photo comments visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskComments" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M4.3271 2H20.2486C21.3432 2 22.2388 2.9 22.2388 4V16C22.2388 17.1 21.3432 18 20.2486 18H6.31729L2.33691 22V4C2.33691 2.9 3.2325 2 4.3271 2ZM6.31729 16H20.2486V4H4.3271V18L6.31729 16Z" fill="white"/>
									</mask>
									<g mask="url(#maskComments)">
										<rect x="0.34668" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>

								<span class="jp-carousel-has-comments-indicator" aria-label="This image has comments."></span>
							</span>
						</a>
											</div>
				</div>
				<div class="jp-carousel-info-extra">
					<div class="jp-carousel-info-content-wrapper">
						<div class="jp-carousel-photo-title-container">
							<h2 class="jp-carousel-photo-title"></h2>
						</div>
						<div class="jp-carousel-comments-wrapper">
															<div id="jp-carousel-comments-loading">
									<span>Loading Comments...</span>
								</div>
								<div class="jp-carousel-comments"></div>
								<div id="jp-carousel-comment-form-container">
									<span id="jp-carousel-comment-form-spinner">&nbsp;</span>
									<div id="jp-carousel-comment-post-results"></div>
																														<form id="jp-carousel-comment-form">
												<label for="jp-carousel-comment-form-comment-field" class="screen-reader-text">Write a Comment...</label>
												<textarea
													name="comment"
													class="jp-carousel-comment-form-field jp-carousel-comment-form-textarea"
													id="jp-carousel-comment-form-comment-field"
													placeholder="Write a Comment..."
												></textarea>
												<div id="jp-carousel-comment-form-submit-and-info-wrapper">
													<div id="jp-carousel-comment-form-commenting-as">
																													<fieldset>
																<label for="jp-carousel-comment-form-email-field">Email (Required)</label>
																<input type="text" name="email" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-email-field" />
															</fieldset>
															<fieldset>
																<label for="jp-carousel-comment-form-author-field">Name (Required)</label>
																<input type="text" name="author" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-author-field" />
															</fieldset>
															<fieldset>
																<label for="jp-carousel-comment-form-url-field">Website</label>
																<input type="text" name="url" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-url-field" />
															</fieldset>
																											</div>
													<input
														type="submit"
														name="submit"
														class="jp-carousel-comment-form-button"
														id="jp-carousel-comment-form-button-submit"
														value="Post Comment" />
												</div>
											</form>
																											</div>
													</div>
						<div class="jp-carousel-image-meta">
							<div class="jp-carousel-title-and-caption">
								<div class="jp-carousel-photo-info">
									<h3 class="jp-carousel-caption" itemprop="caption description"></h3>
								</div>

								<div class="jp-carousel-photo-description"></div>
							</div>
							<ul class="jp-carousel-image-exif" style="display: none;"></ul>
							<a class="jp-carousel-image-download" target="_blank" style="display: none;">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="mask0" mask-type="alpha" maskUnits="userSpaceOnUse" x="3" y="3" width="19" height="18">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M5.84615 5V19H19.7775V12H21.7677V19C21.7677 20.1 20.8721 21 19.7775 21H5.84615C4.74159 21 3.85596 20.1 3.85596 19V5C3.85596 3.9 4.74159 3 5.84615 3H12.8118V5H5.84615ZM14.802 5V3H21.7677V10H19.7775V6.41L9.99569 16.24L8.59261 14.83L18.3744 5H14.802Z" fill="white"/>
									</mask>
									<g mask="url(#mask0)">
										<rect x="0.870605" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>
								<span class="jp-carousel-download-text"></span>
							</a>
							<div class="jp-carousel-image-map" style="display: none;"></div>
						</div>
					</div>
				</div>
			</div>
		</div>

		</div>
		<link rel='stylesheet' id='all-css-0-2' href='https://s1.wp.com/_static/??-eJyFy00OQDAQQOELGUP8xUKcpWoiZVTTadO4vVhY2LB8L/kwOdCHDWQD7hEcx8VYQa38EYUYJRlHHqZoZ6Zci2T4I1YKTukNnvGFgmGaYVHM5M933Wzch7Ktir5p+rpbL+lvP34=?cssminify=yes' type='text/css' media='all' />
<script id='jetpack-carousel-js-extra'>
var jetpackSwiperLibraryPath = {"url":"\/wp-content\/mu-plugins\/carousel\/swiper-bundle.js"};
var jetpackCarouselStrings = {"widths":[370,700,1000,1200,1400,2000],"is_logged_in":"","lang":"en","ajaxurl":"https:\/\/johncarlosbaez.wordpress.com\/wp-admin\/admin-ajax.php","nonce":"805b669379","display_exif":"1","display_comments":"1","display_geo":"1","single_image_gallery":"1","single_image_gallery_media_file":"","background_color":"black","comment":"Comment","post_comment":"Post Comment","write_comment":"Write a Comment...","loading_comments":"Loading Comments...","download_original":"View full size <span class=\"photo-size\">{0}<span class=\"photo-size-times\">\u00d7<\/span>{1}<\/span>","no_comment_text":"Please be sure to submit some text with your comment.","no_comment_email":"Please provide an email address to comment.","no_comment_author":"Please provide your name to comment.","comment_post_error":"Sorry, but there was an error posting your comment. Please try again later.","comment_approved":"Your comment was approved.","comment_unapproved":"Your comment is in moderation.","camera":"Camera","aperture":"Aperture","shutter_speed":"Shutter Speed","focal_length":"Focal Length","copyright":"Copyright","comment_registration":"0","require_name_email":"1","login_url":"https:\/\/johncarlosbaez.wordpress.com\/wp-login.php?redirect_to=https%3A%2F%2Fjohncarlosbaez.wordpress.com%2F2012%2F08%2F14%2Fnetwork-theory-part-21%2F","blog_id":"12777403","meta_data":["camera","aperture","shutter_speed","focal_length","copyright"],"stats_query_args":"blog=12777403&v=wpcom&tz=0&user_id=0&subd=johncarlosbaez","is_public":"1"};
</script>
<script crossorigin='anonymous' type='text/javascript' src='https://s0.wp.com/_static/??-eJyNkN1uwyAMhV9oDkouKvVi2rMQcCNT/oZN07z9yNRMbTZFu8LH8J2DreYMJkXBKMqxsngjg/neOX5TT1ehQvZ1osiK4oUiyfJTHLzVNlCEURcVNAuWVoEUba68h1q2+6xYlsfRzdmkALmk+wIFW49lYygaXy3yCjWJYUTbtaCDj8xkJxRWXEc2hbJQivyXH8+XNDo0sjfbnG5kMSnNvNq5h84F+ddIT/FGl1QZvXIouY0PW+OAEfJoYdLer1t5Uf9Igu/97WTjPsJ7fxrO534YTr37Ai2cwB8='></script>
<script type="text/javascript">
// <![CDATA[
(function() {
try{
  if ( window.external &&'msIsSiteMode' in window.external) {
    if (window.external.msIsSiteMode()) {
      var jl = document.createElement('script');
      jl.type='text/javascript';
      jl.async=true;
      jl.src='/wp-content/plugins/ie-sitemode/custom-jumplist.php';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jl, s);
    }
  }
}catch(e){}
})();
// ]]>
</script><script type="text/javascript">
			(function() {
				var extend = function(out) {
					out = out || {};

					for (var i = 1; i < arguments.length; i++) {
						if (!arguments[i])
						continue;

						for (var key in arguments[i]) {
						if (arguments[i].hasOwnProperty(key))
							out[key] = arguments[i][key];
						}
					}

					return out;
				};
				extend( window.infiniteScroll.settings.scripts, ["postmessage","mobile-useragent-info","rlt-proxy","jquery-core","jquery-migrate","jquery","wpcom-actionbar-placeholder","grofiles-cards","wpgroho","devicepx","the-neverending-homepage","wpcom-masterbar-tracks-js","jquery.wpcom-proxy-request","wp-embed","jetpack-subscriptions-js","swfobject","videopress","jetpack-carousel","tiled-gallery","carousel-wpcom"] );
				extend( window.infiniteScroll.settings.styles, ["the-neverending-homepage","infinity-contempt","wp-block-library","mediaelement","wp-mediaelement","jetpack-layout-grid","jetpack-ratings","coblocks-frontend","wpcom-core-compat-playlist-styles","wpcom-text-widget-styles","wpcom-bbpress2-staff-css","contempt","geo-location-flair","reblogging","a8c-global-print","h4-global","global-styles","jetpack-global-styles-frontend-style","jetpack-carousel-swiper-css","jetpack-carousel","tiled-gallery"] );
			})();
		</script>
				<span id="infinite-aria" aria-live="polite"></span>
		<script src="//stats.wp.com/w.js?62" defer></script> <script type="text/javascript">
_tkq = window._tkq || [];
_stq = window._stq || [];
_tkq.push(['storeContext', {'blog_id':'12777403','blog_tz':'0','user_lang':'en','blog_lang':'en','user_id':'0'}]);
_stq.push(['view', {'blog':'12777403','v':'wpcom','tz':'0','user_id':'0','subd':'johncarlosbaez'}]);
_stq.push(['extra', {'crypt':'UE40eW5QN0p8M2Y/RE1TaVhzUzFMbjdWNHpwZGhTayxPSUFCMGNrd29+Smw0TDhnZmRTK0hlRi9QSGh6bi9GXVhBJWIlZlR5U1JMLU8/MkNtblkvY1d6eVImTEouL2UleTBRZmlNdkp0aWJaNFJhPS0uTVpHa1hIc25EbVJyQmw/SkZ+Q3lLcjU/NDBvQTZVVFouOFlZVGtFYlk5Q1UmfEx+K2RHSjlIVHRhZ358RFVJMG1SMEJxNnBUVEhpW19IRjk3N2VGYmRFRitnN1VaMGkzeFZKMldUdURXOS8yJjhsVnxvTkMsJlpCb2VOUGNiVltTemQ9JjRZdTVKXzFRQzhYRHNMc3xBNEVSdk1DRlZBXT8lMEVCdDNkNHpBSH5MMnJRZH5+bV9QR28uUjNyeGlhRGdoeDJ3eENZJnVtQ1BxemtdTUV1dVAvU21PSCtsdGFoVmw3'}]);
_stq.push([ 'clickTrackerInit', '12777403', '0' ]);
	</script>
<noscript><img src="https://pixel.wp.com/b.gif?v=noscript" style="height:1px;width:1px;overflow:hidden;position:absolute;bottom:1px;" alt="" /></noscript>
<script>
if ( 'object' === typeof wpcom_mobile_user_agent_info ) {

	wpcom_mobile_user_agent_info.init();
	var mobileStatsQueryString = "";
	
	if( false !== wpcom_mobile_user_agent_info.matchedPlatformName )
		mobileStatsQueryString += "&x_" + 'mobile_platforms' + '=' + wpcom_mobile_user_agent_info.matchedPlatformName;
	
	if( false !== wpcom_mobile_user_agent_info.matchedUserAgentName )
		mobileStatsQueryString += "&x_" + 'mobile_devices' + '=' + wpcom_mobile_user_agent_info.matchedUserAgentName;
	
	if( wpcom_mobile_user_agent_info.isIPad() )
		mobileStatsQueryString += "&x_" + 'ipad_views' + '=' + 'views';

	if( "" != mobileStatsQueryString ) {
		new Image().src = document.location.protocol + '//pixel.wp.com/g.gif?v=wpcom-no-pv' + mobileStatsQueryString + '&baba=' + Math.random();
	}
	
}
</script>
</body>
</html>