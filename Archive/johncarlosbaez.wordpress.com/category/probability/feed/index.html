<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	xmlns:georss="http://www.georss.org/georss" xmlns:geo="http://www.w3.org/2003/01/geo/wgs84_pos#" xmlns:media="http://search.yahoo.com/mrss/"
	>

<channel>
	<title>probability &#8211; Azimuth</title>
	<atom:link href="https://johncarlosbaez.wordpress.com/category/probability/feed/" rel="self" type="application/rss+xml" />
	<link>https://johncarlosbaez.wordpress.com</link>
	<description></description>
	<lastBuildDate>Fri, 24 Sep 2021 20:18:46 +0000</lastBuildDate>
	<language>en</language>
	<sy:updatePeriod>
	hourly	</sy:updatePeriod>
	<sy:updateFrequency>
	1	</sy:updateFrequency>
	<generator>http://wordpress.com/</generator>
<cloud domain='johncarlosbaez.wordpress.com' port='80' path='/?rsscloud=notify' registerProcedure='' protocol='http-post' />
<image>
		<url>https://s0.wp.com/i/buttonw-com.png</url>
		<title>probability &#8211; Azimuth</title>
		<link>https://johncarlosbaez.wordpress.com</link>
	</image>
	<atom:link rel="search" type="application/opensearchdescription+xml" href="https://johncarlosbaez.wordpress.com/osd.xml" title="Azimuth" />
	<atom:link rel='hub' href='https://johncarlosbaez.wordpress.com/?pushpress=hub'/>
	<item>
		<title>Information Geometry (Part 21)</title>
		<link>https://johncarlosbaez.wordpress.com/2021/08/17/information-geometry-part-21/</link>
					<comments>https://johncarlosbaez.wordpress.com/2021/08/17/information-geometry-part-21/#comments</comments>
		
		<dc:creator><![CDATA[John Baez]]></dc:creator>
		<pubDate>Tue, 17 Aug 2021 05:25:12 +0000</pubDate>
				<category><![CDATA[information and entropy]]></category>
		<category><![CDATA[mathematics]]></category>
		<category><![CDATA[physics]]></category>
		<category><![CDATA[probability]]></category>
		<guid isPermaLink="false">http://johncarlosbaez.wordpress.com/?p=31635</guid>

					<description><![CDATA[Last time I ended with a formula for the &#8216;Gibbs distribution&#8217;: the probability distribution that maximizes entropy subject to constraints on the expected values of some observables. This formula is well-known, but I&#8217;d like to derive it here. My argument won&#8217;t be up to the highest standards of rigor: I&#8217;ll do a bunch of computations, [&#8230;]]]></description>
										<content:encoded><![CDATA[<p><a href="https://johncarlosbaez.wordpress.com/2021/08/14/information-geometry-part-20/">Last time</a> I ended with a formula for the &#8216;Gibbs distribution&#8217;: the probability distribution that maximizes entropy subject to constraints on the expected values of some observables.</p>
<p>This formula is well-known, but I&#8217;d like to derive it here.   My argument won&#8217;t be up to the highest standards of rigor: I&#8217;ll do a bunch of computations, and it would take more work to state conditions under which these computations are justified.   But even a nonrigorous approach is worthwhile, since the computations will give us more than the mere formula for the Gibbs distribution.</p>
<p>I&#8217;ll start by reminding you of what I claimed last time.   I&#8217;ll state it in a way that removes all unnecessary distractions, so go back to <a href="https://johncarlosbaez.wordpress.com/2021/08/14/information-geometry-part-20/">Part 20</a> if you want more explanation.</p>
<h3> The Gibbs distribution</h3>
<p>Take a measure space <img src="https://s0.wp.com/latex.php?latex=%5COmega&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Omega" class="latex" /> with measure <img src="https://s0.wp.com/latex.php?latex=%5Cmu.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mu." class="latex" />    Suppose there is a probability distribution <img src="https://s0.wp.com/latex.php?latex=%5Cpi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi" class="latex" /> on <img src="https://s0.wp.com/latex.php?latex=%5COmega&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Omega" class="latex" /> that maximizes the <b>entropy</b></p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+-%5Cint_%5COmega+%5Cpi%28x%29+%5Cln+%5Cpi%28x%29+%5C%2C+d%5Cmu%28x%29+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ -&#92;int_&#92;Omega &#92;pi(x) &#92;ln &#92;pi(x) &#92;, d&#92;mu(x) } " class="latex" /></p>
<p>subject to the requirement that some integrable functions <img src="https://s0.wp.com/latex.php?latex=A%5E1%2C+%5Cdots%2C+A%5En&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A^1, &#92;dots, A^n" class="latex" /> on <img src="https://s0.wp.com/latex.php?latex=%5COmega&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Omega" class="latex" /> have expected values equal to some chosen list of numbers <img src="https://s0.wp.com/latex.php?latex=q%5E1%2C+%5Cdots%2C+q%5En.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q^1, &#92;dots, q^n." class="latex" /></p>
<p>(Unlike last time, now I&#8217;m writing <img src="https://s0.wp.com/latex.php?latex=A%5Ei&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A^i" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=q%5Ei&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q^i" class="latex" /> with superscripts rather than subscripts, because I&#8217;ll be using the Einstein summation convention: I&#8217;ll sum over any repeated index that appears once as a a superscript and once as a subscript.)</p>
<p>Furthermore, suppose <img src="https://s0.wp.com/latex.php?latex=%5Cpi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi" class="latex" /> depends smoothly on <img src="https://s0.wp.com/latex.php?latex=q+%5Cin+%5Cmathbb%7BR%7D%5En.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q &#92;in &#92;mathbb{R}^n." class="latex" />    I&#8217;ll call it <img src="https://s0.wp.com/latex.php?latex=%5Cpi_q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi_q" class="latex" /> to indicate its dependence on <img src="https://s0.wp.com/latex.php?latex=q.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q." class="latex" />   Then, I claim <img src="https://s0.wp.com/latex.php?latex=%5Cpi_q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi_q" class="latex" /> is the so-called <b>Gibbs distribution</b></p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B++%5Cpi_q%28x%29+%3D%5Cfrac%7Be%5E%7B-p_i+A%5Ei%28x%29%7D%7D%7B%5Cint_%5COmega+e%5E%7B-p_i+A%5Ei%28x%29%7D+%5C%2C+d%5Cmu%28x%29%7D+++%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{  &#92;pi_q(x) =&#92;frac{e^{-p_i A^i(x)}}{&#92;int_&#92;Omega e^{-p_i A^i(x)} &#92;, d&#92;mu(x)}   }" class="latex" /></p>
<p>where</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+p_i+%3D+%5Cfrac%7B%5Cpartial+f%28q%29%7D%7B%5Cpartial+q%5Ei%7D+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ p_i = &#92;frac{&#92;partial f(q)}{&#92;partial q^i} }" class="latex" /></p>
<p>and</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+f%28q%29+%3D+-+%5Cint_%5COmega+%5Cpi_q%28x%29+%5Cln+%5Cpi_q%28x%29+%5C%2C+d%5Cmu%28x%29+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ f(q) = - &#92;int_&#92;Omega &#92;pi_q(x) &#92;ln &#92;pi_q(x) &#92;, d&#92;mu(x) } " class="latex" /></p>
<p>is the entropy of <img src="https://s0.wp.com/latex.php?latex=%5Cpi_q.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi_q." class="latex" /></p>
<p>Let&#8217;s show this is true!</p>
<h3> Finding the Gibbs distribution</h3>
<p>So, we are trying to find a probability distribution <img src="https://s0.wp.com/latex.php?latex=%5Cpi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi" class="latex" /> that maximizes entropy subject to these constraints:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cint_%5COmega+%5Cpi%28x%29+A%5Ei%28x%29+%5C%2C+d%5Cmu%28x%29+%3D+q%5Ei+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;int_&#92;Omega &#92;pi(x) A^i(x) &#92;, d&#92;mu(x) = q^i } " class="latex" /></p>
<p>We can solve this problem using <a href="https://en.wikipedia.org/wiki/Lagrange_multiplier">Lagrange multipliers</a>.  We need one Lagrange multiplier, say <img src="https://s0.wp.com/latex.php?latex=%5Cbeta_i%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;beta_i," class="latex" /> for each of the above constraints.  But it&#8217;s easiest if we start by letting <img src="https://s0.wp.com/latex.php?latex=%5Cpi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi" class="latex" /> range over all of <img src="https://s0.wp.com/latex.php?latex=L%5E1%28%5COmega%29%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="L^1(&#92;Omega)," class="latex" /> that is, the space of all integrable functions on <img src="https://s0.wp.com/latex.php?latex=%5COmega.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Omega." class="latex" />  Then, because we want <img src="https://s0.wp.com/latex.php?latex=%5Cpi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi" class="latex" /> to be a probability distribution, we need to impose one extra constraint</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cint_%5COmega+%5Cpi%28x%29+%5C%2C+d%5Cmu%28x%29+%3D+1+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;int_&#92;Omega &#92;pi(x) &#92;, d&#92;mu(x) = 1 } " class="latex" /></p>
<p>To do this we need an extra Lagrange multiplier, say <img src="https://s0.wp.com/latex.php?latex=%5Cgamma.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;gamma." class="latex" /></p>
<p>So, that&#8217;s what we&#8217;ll do!  We&#8217;ll look for critical points of this function on <img src="https://s0.wp.com/latex.php?latex=L%5E1%28%5COmega%29%3A&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="L^1(&#92;Omega):" class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+-+%5Cint+%5Cpi+%5Cln+%5Cpi+%5C%2C+d%5Cmu+-+%5Cbeta_i++%5Cint+%5Cpi+A%5Ei+%5C%2C+d%5Cmu+-+%5Cgamma+%5Cint+%5Cpi%5C%2C++d%5Cmu++%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ - &#92;int &#92;pi &#92;ln &#92;pi &#92;, d&#92;mu - &#92;beta_i  &#92;int &#92;pi A^i &#92;, d&#92;mu - &#92;gamma &#92;int &#92;pi&#92;,  d&#92;mu  }" class="latex" /></p>
<p>Here I&#8217;m using some tricks to keep things short.  First, I&#8217;m dropping the dummy variable <i>x</i> which appeared in all of the integrals we had: I&#8217;m leaving it implicit.  Second, all my integrals are over <img src="https://s0.wp.com/latex.php?latex=%5COmega&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Omega" class="latex" /> so I won&#8217;t say that.  And third, I&#8217;m using the Einstein summation convention, so there&#8217;s a sum over <i>i</i> implicit here.</p>
<p>Okay, now let&#8217;s do the <a href="https://en.wikipedia.org/wiki/Functional_derivative">variational derivative</a> required to find a critical point of this function.   When I was a math major taking physics classes, the way physicists did variational derivatives seemed like black magic to me.  Then I spent months reading how mathematicians rigorously justified these techniques.  I don&#8217;t feel like a massive digression into this right now, so I&#8217;ll just do the calculations&#8212;and if they seem like black magic, I&#8217;m sorry!</p>
<p>We need to find <img src="https://s0.wp.com/latex.php?latex=%5Cpi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi" class="latex" /> obeying</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7B%5Cdelta%7D%7B%5Cdelta+%5Cpi%28x%29%7D+%5Cleft%28-+%5Cint+%5Cpi+%5Cln+%5Cpi+%5C%2C+d%5Cmu+-+%5Cbeta_i++%5Cint+%5Cpi+A%5Ei+%5C%2C+d%5Cmu+-+%5Cgamma+%5Cint+%5Cpi+%5C%2C+d%5Cmu+%5Cright%29+%3D+0+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{&#92;delta}{&#92;delta &#92;pi(x)} &#92;left(- &#92;int &#92;pi &#92;ln &#92;pi &#92;, d&#92;mu - &#92;beta_i  &#92;int &#92;pi A^i &#92;, d&#92;mu - &#92;gamma &#92;int &#92;pi &#92;, d&#92;mu &#92;right) = 0 } " class="latex" /></p>
<p>or in other words</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7B%5Cdelta%7D%7B%5Cdelta+%5Cpi%28x%29%7D+%5Cleft%28%5Cint+%5Cpi+%5Cln+%5Cpi+%5C%2C+d%5Cmu+%2B+%5Cbeta_i++%5Cint+%5Cpi+A%5Ei+%5C%2C+d%5Cmu+%2B+%5Cgamma+%5Cint+%5Cpi+%5C%2C+d%5Cmu+%5Cright%29+%3D+0+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{&#92;delta}{&#92;delta &#92;pi(x)} &#92;left(&#92;int &#92;pi &#92;ln &#92;pi &#92;, d&#92;mu + &#92;beta_i  &#92;int &#92;pi A^i &#92;, d&#92;mu + &#92;gamma &#92;int &#92;pi &#92;, d&#92;mu &#92;right) = 0 } " class="latex" /></p>
<p>First we need to simplify this expression.   The only part that takes any work, if you know how to do variational derivatives, is the first term.  Since the derivative of <img src="https://s0.wp.com/latex.php?latex=z+%5Cln+z&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="z &#92;ln z" class="latex" /> is <img src="https://s0.wp.com/latex.php?latex=1+%2B+%5Cln+z%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="1 + &#92;ln z," class="latex" /> we have</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7B%5Cdelta%7D%7B%5Cdelta+%5Cpi%28x%29%7D+%5Cint+%5Cpi+%5Cln+%5Cpi+%5C%2C+d%5Cmu++%3D+1+%2B+%5Cln+%5Cpi%28x%29+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{&#92;delta}{&#92;delta &#92;pi(x)} &#92;int &#92;pi &#92;ln &#92;pi &#92;, d&#92;mu  = 1 + &#92;ln &#92;pi(x) } " class="latex" /></p>
<p>The second and third terms are easy, so we get</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7B%5Cdelta%7D%7B%5Cdelta+%5Cpi%28x%29%7D+%5Cleft%28+%5Cint+%5Cpi+%5Cln+%5Cpi+%5C%2C+d%5Cmu+%2B+%5Cbeta_i+%5Cint+%5Cpi+A%5Ei+%5C%2C+d%5Cmu+%2B+%5Cgamma+%5Cint+%5Cpi+%5C%2C+d%5Cmu+%5Cright%29+%3D%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{&#92;delta}{&#92;delta &#92;pi(x)} &#92;left( &#92;int &#92;pi &#92;ln &#92;pi &#92;, d&#92;mu + &#92;beta_i &#92;int &#92;pi A^i &#92;, d&#92;mu + &#92;gamma &#92;int &#92;pi &#92;, d&#92;mu &#92;right) =} " class="latex" /></p>
<p>&nbsp; &nbsp; &nbsp; &nbsp;  <img src="https://s0.wp.com/latex.php?latex=1+%2B+%5Cln+%5Cpi%28x%29+%2B+%5Cbeta_i+A%5Ei%28x%29+%2B+%5Cgamma++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="1 + &#92;ln &#92;pi(x) + &#92;beta_i A^i(x) + &#92;gamma  " class="latex" /></p>
<p>Thus, we need to solve this equation:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+1+%2B+%5Cln+%5Cpi%28x%29+%2B+%5Cbeta_i+A%5Ei%28x%29+%2B+%5Cgamma++%3D+0%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ 1 + &#92;ln &#92;pi(x) + &#92;beta_i A^i(x) + &#92;gamma  = 0} " class="latex" /></p>
<p>That&#8217;s easy to do:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cpi%28x%29+%3D+e%5E%7B-1+-+%5Cgamma+-+%5Cbeta_i+A%5Ei%28x%29%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi(x) = e^{-1 - &#92;gamma - &#92;beta_i A^i(x)} " class="latex" /></p>
<p>Good!   It&#8217;s starting to look like the Gibbs distribution!</p>
<p>We now need to choose the Lagrange multipliers <img src="https://s0.wp.com/latex.php?latex=%5Cbeta_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;beta_i" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=%5Cgamma&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;gamma" class="latex" /> to make the constraints hold.  To satisfy this constraint</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cint+%5Cpi+%5C%2C+d%5Cmu+%3D+1+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;int &#92;pi &#92;, d&#92;mu = 1 } " class="latex" /></p>
<p>we must choose <img src="https://s0.wp.com/latex.php?latex=%5Cgamma&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;gamma" class="latex" /> so that</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cint++e%5E%7B-1+-+%5Cgamma+-+%5Cbeta_i+A%5Ei+%7D+%5C%2C+d%5Cmu+%3D+1+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;int  e^{-1 - &#92;gamma - &#92;beta_i A^i } &#92;, d&#92;mu = 1 } " class="latex" /></p>
<p>or in other words</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+e%5E%7B1+%2B+%5Cgamma%7D+%3D+%5Cint+e%5E%7B-+%5Cbeta_i+A%5Ei%7D+%5C%2C+d%5Cmu+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ e^{1 + &#92;gamma} = &#92;int e^{- &#92;beta_i A^i} &#92;, d&#92;mu } " class="latex" /></p>
<p>Plugging this into our earlier formula</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cpi%28x%29+%3D+e%5E%7B-1+-+%5Cgamma+-+%5Cbeta_i+A%5Ei%28x%29%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi(x) = e^{-1 - &#92;gamma - &#92;beta_i A^i(x)} " class="latex" /></p>
<p>we get this:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cpi_q%28x%29+%3D+%5Cfrac%7Be%5E%7B-+%5Cbeta_i+A%5Ei%28x%29%7D%7D%7B%5Cint+e%5E%7B-+%5Cbeta_i+A%5Ei%7D+%5C%2C+d%5Cmu%7D+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;pi_q(x) = &#92;frac{e^{- &#92;beta_i A^i(x)}}{&#92;int e^{- &#92;beta_i A^i} &#92;, d&#92;mu} } " class="latex" /></p>
<p>Great!  Even more like the Gibbs distribution!</p>
<p>By the way, you must have noticed the &#8220;1&#8221; that showed up here:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7B%5Cdelta%7D%7B%5Cdelta+%5Cpi%28x%29%7D+%5Cint+%5Cpi+%5Cln+%5Cpi+%5C%2C+d%5Cmu++%3D+1+%2B+%5Cln+%5Cpi%28x%29+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{&#92;delta}{&#92;delta &#92;pi(x)} &#92;int &#92;pi &#92;ln &#92;pi &#92;, d&#92;mu  = 1 + &#92;ln &#92;pi(x) } " class="latex" /></p>
<p>It buzzed around like an annoying fly in the otherwise beautiful calculation, but eventually went away.  This is the same irksome &#8220;1&#8221; that showed up in <a href="https://johncarlosbaez.wordpress.com/2021/08/08/information-geometry-part-19/">Part 19</a>.   Someday I&#8217;d like to say a bit more about it.</p>
<p>Now, where were we?  We were trying to show that</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B++%5Cpi_q%28x%29+%3D%5Cfrac%7Be%5E%7B-p_i+A%5Ei%28x%29%7D%7D%7B%5Cint+e%5E%7B-p_i+A%5Ei%7D+%5C%2C+d%5Cmu%7D+++%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{  &#92;pi_q(x) =&#92;frac{e^{-p_i A^i(x)}}{&#92;int e^{-p_i A^i} &#92;, d&#92;mu}   }" class="latex" /></p>
<p>minimizes entropy subject to our constraints.  So far we&#8217;ve shown</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cpi%28x%29+%3D+%5Cfrac%7Be%5E%7B-+%5Cbeta_i+A%5Ei%28x%29%7D%7D%7B%5Cint+e%5E%7B-+%5Cbeta_i+A%5Ei%7D+%5C%2C+d%5Cmu%7D+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;pi(x) = &#92;frac{e^{- &#92;beta_i A^i(x)}}{&#92;int e^{- &#92;beta_i A^i} &#92;, d&#92;mu} } " class="latex" /></p>
<p>is a critical point.   It&#8217;s clear that</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cpi%28x%29+%5Cge+0&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi(x) &#92;ge 0" class="latex" /></p>
<p>so <img src="https://s0.wp.com/latex.php?latex=%5Cpi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi" class="latex" /> really is a probability distribution.  We should show it actually <i>maximizes</i> entropy subject to our constraints, but I will skip that.   Given that, <img src="https://s0.wp.com/latex.php?latex=%5Cpi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi" class="latex" /> will be our claimed Gibbs distribution <img src="https://s0.wp.com/latex.php?latex=%5Cpi_q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi_q" class="latex" /> if we can show</p>
<p><img src="https://s0.wp.com/latex.php?latex=p_i+%3D+%5Cbeta_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p_i = &#92;beta_i" class="latex" /></p>
<p>This is interesting!   It&#8217;s saying our Lagrange multipliers <img src="https://s0.wp.com/latex.php?latex=%5Cbeta_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;beta_i" class="latex" /> actually equal the so-called <b>conjugate variables</b> <img src="https://s0.wp.com/latex.php?latex=p_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p_i" class="latex" /> given by</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+p_i+%3D+%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+q%5Ei%7D+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ p_i = &#92;frac{&#92;partial f}{&#92;partial q^i} }" class="latex" /></p>
<p>where <img src="https://s0.wp.com/latex.php?latex=f%28q%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="f(q)" class="latex" /> is the entropy of <img src="https://s0.wp.com/latex.php?latex=%5Cpi_q%3A&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi_q:" class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+f%28q%29+%3D+-+%5Cint_%5COmega+%5Cpi_q%28x%29+%5Cln+%5Cpi_q%28x%29+%5C%2C+d%5Cmu%28x%29+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ f(q) = - &#92;int_&#92;Omega &#92;pi_q(x) &#92;ln &#92;pi_q(x) &#92;, d&#92;mu(x) } " class="latex" /></p>
<p>There are two ways to show this: the easy way and the hard way.  The easy way is to reflect on the meaning of Lagrange multipliers, and I&#8217;ll sketch that way first.  The hard way is to use brute force: just compute <img src="https://s0.wp.com/latex.php?latex=p_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p_i" class="latex" /> and show it equals <img src="https://s0.wp.com/latex.php?latex=%5Cbeta_i.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;beta_i." class="latex" />   This is a good test of our computational muscle&#8212;but more importantly, it will help us discover some interesting facts about the Gibbs distribution.</p>
<h3> The easy way</h3>
<p>Consider a simple Lagrange multiplier problem where you&#8217;re trying to find a critical point of a smooth function</p>
<p><img src="https://s0.wp.com/latex.php?latex=f+%5Ccolon+%5Cmathbb%7BR%7D%5E2+%5Cto+%5Cmathbb%7BR%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="f &#92;colon &#92;mathbb{R}^2 &#92;to &#92;mathbb{R} " class="latex" /></p>
<p>subject to the constraint</p>
<p><img src="https://s0.wp.com/latex.php?latex=g+%3D+c&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="g = c" class="latex" /></p>
<p>for some smooth function</p>
<p><img src="https://s0.wp.com/latex.php?latex=g+%5Ccolon+%5Cmathbb%7BR%7D%5E2+%5Cto+%5Cmathbb%7BR%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="g &#92;colon &#92;mathbb{R}^2 &#92;to &#92;mathbb{R} " class="latex" /></p>
<p>and constant <i>c</i>.   (The function <i>f</i> here has nothing to do with the <i>f</i> in the previous sections.)   To answer this we introduce a Lagrange multiplier <img src="https://s0.wp.com/latex.php?latex=%5Clambda&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;lambda" class="latex" /> and seek points where</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cnabla+%28+f+-+%5Clambda+g%29+%3D+0&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;nabla ( f - &#92;lambda g) = 0" class="latex" /></p>
<p>This works because the above equation says</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cnabla+f+%3D+%5Clambda+%5Cnabla+g&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;nabla f = &#92;lambda &#92;nabla g" class="latex" /></p>
<p>Geometrically this means we&#8217;re at a point where the gradient of <img src="https://s0.wp.com/latex.php?latex=f&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="f" class="latex" /> points at right angles to the level surface of <img src="https://s0.wp.com/latex.php?latex=g%3A&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="g:" class="latex" /></p>
<p><a href="https://en.wikipedia.org/wiki/Lagrange_multiplier"><img loading="lazy" data-attachment-id="31685" data-permalink="https://johncarlosbaez.wordpress.com/2021/08/17/information-geometry-part-21/lagrange_multipliers/" data-orig-file="https://johncarlosbaez.files.wordpress.com/2021/08/lagrange_multipliers.png" data-orig-size="2560,1843" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="lagrange_multipliers" data-image-description="" data-image-caption="" data-medium-file="https://johncarlosbaez.files.wordpress.com/2021/08/lagrange_multipliers.png?w=300" data-large-file="https://johncarlosbaez.files.wordpress.com/2021/08/lagrange_multipliers.png?w=450" src="https://johncarlosbaez.files.wordpress.com/2021/08/lagrange_multipliers.png?w=450&#038;h=324" alt="" class="aligncenter size-full wp-image-31685" width="450" height="324" srcset="https://johncarlosbaez.files.wordpress.com/2021/08/lagrange_multipliers.png?w=450&amp;h=324 450w, https://johncarlosbaez.files.wordpress.com/2021/08/lagrange_multipliers.png?w=900&amp;h=648 900w, https://johncarlosbaez.files.wordpress.com/2021/08/lagrange_multipliers.png?w=150&amp;h=108 150w, https://johncarlosbaez.files.wordpress.com/2021/08/lagrange_multipliers.png?w=300&amp;h=216 300w, https://johncarlosbaez.files.wordpress.com/2021/08/lagrange_multipliers.png?w=768&amp;h=553 768w" sizes="(max-width: 450px) 100vw, 450px" /></a></p>
<p>Thus, to first order we can&#8217;t change <img src="https://s0.wp.com/latex.php?latex=f&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="f" class="latex" /> by moving along the level surface of <img src="https://s0.wp.com/latex.php?latex=g.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="g." class="latex" /></p>
<p>But also, if we start at a point where</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cnabla+f+%3D+%5Clambda+%5Cnabla+g&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;nabla f = &#92;lambda &#92;nabla g" class="latex" /></p>
<p>and we begin moving in any direction, the function <img src="https://s0.wp.com/latex.php?latex=f&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="f" class="latex" /> will change at a rate equal to <img src="https://s0.wp.com/latex.php?latex=%5Clambda&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;lambda" class="latex" /> times the rate of change of <img src="https://s0.wp.com/latex.php?latex=g&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="g" class="latex" />.  That&#8217;s just what the equation says!   And this fact gives a conceptual meaning to the Lagrange multiplier <img src="https://s0.wp.com/latex.php?latex=%5Clambda.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;lambda." class="latex" /></p>
<p>Our situation is more complicated, since our functions are defined on the infinite-dimensional space <img src="https://s0.wp.com/latex.php?latex=L%5E1%28%5COmega%29%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="L^1(&#92;Omega)," class="latex" /> and we have an <i>n</i>-tuple of constraints  with an <i>n</i>-tuple of Lagrange multipliers.   But the same principle holds.</p>
<p>So, when we are at a solution <img src="https://s0.wp.com/latex.php?latex=%5Cpi_q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi_q" class="latex" /> of our constrained entropy-maximization problem, and we start moving the point <img src="https://s0.wp.com/latex.php?latex=%5Cpi_q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi_q" class="latex" /> by changing the value of the <i>i</i>th constraint, namely <img src="https://s0.wp.com/latex.php?latex=q%5Ei%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q^i," class="latex" /> the rate at which the entropy changes will be <img src="https://s0.wp.com/latex.php?latex=%5Cbeta_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;beta_i" class="latex" /> times the rate of change of <img src="https://s0.wp.com/latex.php?latex=q%5Ei.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q^i." class="latex" />    So, we have</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+q%5Ei%7D+%3D+%5Cbeta_i+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{&#92;frac{&#92;partial f}{&#92;partial q^i} = &#92;beta_i }" class="latex" /></p>
<p>But this is just what we needed to show!</p>
<h3> The hard way</h3>
<p>Here&#8217;s another way to show</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+q%5Ei%7D+%3D+%5Cbeta_i+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{&#92;frac{&#92;partial f}{&#92;partial q^i} = &#92;beta_i }" class="latex" /></p>
<p>We start by solving our constrained entropy-maximization problem using Lagrange multipliers.  As already shown, we get</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cpi_q%28x%29+%3D+%5Cfrac%7Be%5E%7B-+%5Cbeta_i+A%5Ei%28x%29%7D%7D%7B%5Cint+e%5E%7B-+%5Cbeta_i+A%5Ei%7D+%5C%2C+d%5Cmu%7D+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;pi_q(x) = &#92;frac{e^{- &#92;beta_i A^i(x)}}{&#92;int e^{- &#92;beta_i A^i} &#92;, d&#92;mu} } " class="latex" /></p>
<p>Then we&#8217;ll compute the entropy</p>
<p><img src="https://s0.wp.com/latex.php?latex=f%28q%29+%3D+-+%5Cint+%5Cpi_q+%5Cln+%5Cpi_q+%5C%2C+d%5Cmu+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="f(q) = - &#92;int &#92;pi_q &#92;ln &#92;pi_q &#92;, d&#92;mu " class="latex" /></p>
<p>Then we&#8217;ll differentiate this with respect to <img src="https://s0.wp.com/latex.php?latex=q_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q_i" class="latex" /> and show we get <img src="https://s0.wp.com/latex.php?latex=%5Cbeta_i.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;beta_i." class="latex" /></p>
<p>Let&#8217;s try it!   The calculation is a bit heavy, so let&#8217;s write <img src="https://s0.wp.com/latex.php?latex=Z%28q%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Z(q)" class="latex" /> for the so-called <b>partition function</b></p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+Z%28q%29+%3D+%5Cint+e%5E%7B-+%5Cbeta_i+A%5Ei%7D+%5C%2C+d%5Cmu+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ Z(q) = &#92;int e^{- &#92;beta_i A^i} &#92;, d&#92;mu } " class="latex" /></p>
<p>so that</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cpi_q%28x%29+%3D+%5Cfrac%7Be%5E%7B-+%5Cbeta_i+A%5Ei%28x%29%7D%7D%7BZ%28q%29%7D+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;pi_q(x) = &#92;frac{e^{- &#92;beta_i A^i(x)}}{Z(q)} } " class="latex" /></p>
<p>and the entropy is</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Barray%7D%7Bccl%7D++f%28q%29+%26%3D%26+-+%5Cdisplaystyle%7B+%5Cint++%5Cpi_q++%5Cln+%5Cleft%28+%5Cfrac%7Be%5E%7B-+%5Cbeta_k+A%5Ek%7D%7D%7BZ%28q%29%7D+%5Cright%29++%5C%2C+d%5Cmu+%7D++%5C%5C+%5C%5C++%26%3D%26+%5Cdisplaystyle%7B+%5Cint+%5Cpi_q+%5Cleft%28%5Cbeta_k+A%5Ek+%2B+%5Cln+Z%28q%29+%5Cright%29++%5C%2C+d%5Cmu+%7D+%5C%5C+%5C%5C++%5Cend%7Barray%7D++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;begin{array}{ccl}  f(q) &amp;=&amp; - &#92;displaystyle{ &#92;int  &#92;pi_q  &#92;ln &#92;left( &#92;frac{e^{- &#92;beta_k A^k}}{Z(q)} &#92;right)  &#92;, d&#92;mu }  &#92;&#92; &#92;&#92;  &amp;=&amp; &#92;displaystyle{ &#92;int &#92;pi_q &#92;left(&#92;beta_k A^k + &#92;ln Z(q) &#92;right)  &#92;, d&#92;mu } &#92;&#92; &#92;&#92;  &#92;end{array}  " class="latex" /></p>
<p>This is the sum of two terms.  The first term</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cint+%5Cpi_q+%5Cbeta_k+A%5Ek+++%5C%2C+d%5Cmu+%3D++%5Cbeta_k+%5Cint+%5Cpi_q+A%5Ek+++%5C%2C+d%5Cmu%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;int &#92;pi_q &#92;beta_k A^k   &#92;, d&#92;mu =  &#92;beta_k &#92;int &#92;pi_q A^k   &#92;, d&#92;mu} " class="latex" /></p>
<p>is <img src="https://s0.wp.com/latex.php?latex=%5Cbeta_k&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;beta_k" class="latex" /> times the expected value of <img src="https://s0.wp.com/latex.php?latex=A%5Ek&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A^k" class="latex" /> with respect to the probability distribution <img src="https://s0.wp.com/latex.php?latex=%5Cpi_q%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi_q," class="latex" /> all summed over <img src="https://s0.wp.com/latex.php?latex=k.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="k." class="latex" />    But the expected value of <img src="https://s0.wp.com/latex.php?latex=A%5Ek&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A^k" class="latex" /> is <img src="https://s0.wp.com/latex.php?latex=q%5Ek%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q^k," class="latex" /> so we get</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cint++%5Cpi_q+%5Cbeta_k+A%5Ek+%5C%2C+d%5Cmu+%7D+%3D++%5Cbeta_k+q%5Ek+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;int  &#92;pi_q &#92;beta_k A^k &#92;, d&#92;mu } =  &#92;beta_k q^k " class="latex" /></p>
<p>The second term is easier:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cint_%5COmega++%5Cpi_q+%5Cln+Z%28q%29+%5C%2C+d%5Cmu+%3D+%5Cln+Z%28q%29+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;int_&#92;Omega  &#92;pi_q &#92;ln Z(q) &#92;, d&#92;mu = &#92;ln Z(q) }" class="latex" /></p>
<p>since <img src="https://s0.wp.com/latex.php?latex=%5Cpi_q%28x%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi_q(x)" class="latex" /> integrates to 1 and the partition function <img src="https://s0.wp.com/latex.php?latex=Z%28q%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Z(q)" class="latex" /> doesn&#8217;t depend on <img src="https://s0.wp.com/latex.php?latex=x+%5Cin+%5COmega.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x &#92;in &#92;Omega." class="latex" /></p>
<p>Putting together these two terms we get an interesting formula for the entropy:</p>
<p><img src="https://s0.wp.com/latex.php?latex=f%28q%29+%3D+%5Cbeta_k+q%5Ek+%2B+%5Cln+Z%28q%29+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="f(q) = &#92;beta_k q^k + &#92;ln Z(q) " class="latex" /></p>
<p>This formula is one reason this brute-force approach is actually worthwhile!  I&#8217;ll say more about it later.</p>
<p>But for now, let&#8217;s use this formula to show what we&#8217;re trying to show, namely</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+q%5Ei%7D+%3D+%5Cbeta_i+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{&#92;frac{&#92;partial f}{&#92;partial q^i} = &#92;beta_i }" class="latex" /></p>
<p>For starters,</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Barray%7D%7Bccl%7D++%5Cdisplaystyle%7B%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+q%5Ei%7D%7D+%26%3D%26+%5Cdisplaystyle%7B%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+q%5Ei%7D+%5Cleft%28%5Cbeta_k+q%5Ek+%2B+%5Cln+Z%28q%29+%5Cright%29+%7D+%5C%5C+%5C%5C++%26%3D%26+%5Cdisplaystyle%7B+%5Cfrac%7B%5Cpartial+%5Cbeta_k%7D%7B%5Cpartial+q%5Ei%7D+q%5Ek+%2B+%5Cbeta_k+++%5Cfrac%7B%5Cpartial+q%5Ek%7D%7B%5Cpartial+q%5Ei%7D+%2B+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+q%5Ei%7D+%5Cln+Z%28q%29+++%7D++%5C%5C+%5C%5C++%26%3D%26+%5Cdisplaystyle%7B+%5Cfrac%7B%5Cpartial+%5Cbeta_k%7D%7B%5Cpartial+q%5Ei%7D+q%5Ek+%2B+%5Cbeta_k++%5Cdelta%5Ek_i+%2B+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+q%5Ei%7D+%5Cln+Z%28q%29+++%7D+%5C%5C+%5C%5C++%26%3D%26+%5Cdisplaystyle%7B+%5Cfrac%7B%5Cpartial+%5Cbeta_k%7D%7B%5Cpartial+q%5Ei%7D+q%5Ek+%2B+%5Cbeta_i+%2B+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+q%5Ei%7D+%5Cln+Z%28q%29++%7D++%5Cend%7Barray%7D++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;begin{array}{ccl}  &#92;displaystyle{&#92;frac{&#92;partial f}{&#92;partial q^i}} &amp;=&amp; &#92;displaystyle{&#92;frac{&#92;partial}{&#92;partial q^i} &#92;left(&#92;beta_k q^k + &#92;ln Z(q) &#92;right) } &#92;&#92; &#92;&#92;  &amp;=&amp; &#92;displaystyle{ &#92;frac{&#92;partial &#92;beta_k}{&#92;partial q^i} q^k + &#92;beta_k   &#92;frac{&#92;partial q^k}{&#92;partial q^i} + &#92;frac{&#92;partial}{&#92;partial q^i} &#92;ln Z(q)   }  &#92;&#92; &#92;&#92;  &amp;=&amp; &#92;displaystyle{ &#92;frac{&#92;partial &#92;beta_k}{&#92;partial q^i} q^k + &#92;beta_k  &#92;delta^k_i + &#92;frac{&#92;partial}{&#92;partial q^i} &#92;ln Z(q)   } &#92;&#92; &#92;&#92;  &amp;=&amp; &#92;displaystyle{ &#92;frac{&#92;partial &#92;beta_k}{&#92;partial q^i} q^k + &#92;beta_i + &#92;frac{&#92;partial}{&#92;partial q^i} &#92;ln Z(q)  }  &#92;end{array}  " class="latex" /></p>
<p>where we played a little Kronecker delta game with the second term.</p>
<p>Now we just need to compute the third term:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Barray%7D%7Bccl%7D++%5Cdisplaystyle%7B+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+q%5Ei%7D+%5Cln+Z%28q%29+%7D+%26%3D%26++%5Cdisplaystyle%7B+%5Cfrac%7B1%7D%7BZ%28q%29%7D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+q%5Ei%7D+Z%28q%29+%7D+%5C%5C++%5C%5C++%26%3D%26++%5Cdisplaystyle%7B+%5Cfrac%7B1%7D%7BZ%28q%29%7D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+q%5Ei%7D++%5Cint+e%5E%7B-+%5Cbeta_j+A%5Ej%7D++%5C%2C+d%5Cmu++%7D++%5C%5C+%5C%5C++%26%3D%26++%5Cdisplaystyle%7B+%5Cfrac%7B1%7D%7BZ%28q%29%7D+%5Cint+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+q%5Ei%7D+%5Cleft%28e%5E%7B-+%5Cbeta_j+A%5Ej%7D%5Cright%29+%5C%2C+d%5Cmu++%7D++%5C%5C+%5C%5C++%26%3D%26++%5Cdisplaystyle%7B+%5Cfrac%7B1%7D%7BZ%28q%29%7D+%5Cint+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+q%5Ei%7D%5Cleft%28+-+%5Cbeta_k+A%5Ek+%5Cright%29++e%5E%7B-+%5Cbeta_j+A%5Ej%7D+%5C%2C+d%5Cmu++%7D++%5C%5C+%5C%5C++%26%3D%26++%5Cdisplaystyle%7B+-%5Cfrac%7B1%7D%7BZ%28q%29%7D+%5Cint+%5Cfrac%7B%5Cpartial+%5Cbeta_k%7D%7B%5Cpartial+q%5Ei%7D++A%5Ek+++e%5E%7B-+%5Cbeta_j+A%5Ej%7D+%5C%2C+d%5Cmu++%7D++%5C%5C+%5C%5C++%26%3D%26++%5Cdisplaystyle%7B+-+%5Cfrac%7B%5Cpartial+%5Cbeta_k%7D%7B%5Cpartial+q%5Ei%7D+%5Cfrac%7B1%7D%7BZ%28q%29%7D+%5Cint++A%5Ek+++e%5E%7B-+%5Cbeta_j+A%5Ej%7D+%5C%2C+d%5Cmu++%7D++%5C%5C+%5C%5C++%26%3D%26++%5Cdisplaystyle%7B+-+%5Cfrac%7B%5Cpartial+%5Cbeta_k%7D%7B%5Cpartial+q%5Ei%7D+q%5Ek+%7D++%5Cend%7Barray%7D++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;begin{array}{ccl}  &#92;displaystyle{ &#92;frac{&#92;partial}{&#92;partial q^i} &#92;ln Z(q) } &amp;=&amp;  &#92;displaystyle{ &#92;frac{1}{Z(q)} &#92;frac{&#92;partial}{&#92;partial q^i} Z(q) } &#92;&#92;  &#92;&#92;  &amp;=&amp;  &#92;displaystyle{ &#92;frac{1}{Z(q)} &#92;frac{&#92;partial}{&#92;partial q^i}  &#92;int e^{- &#92;beta_j A^j}  &#92;, d&#92;mu  }  &#92;&#92; &#92;&#92;  &amp;=&amp;  &#92;displaystyle{ &#92;frac{1}{Z(q)} &#92;int &#92;frac{&#92;partial}{&#92;partial q^i} &#92;left(e^{- &#92;beta_j A^j}&#92;right) &#92;, d&#92;mu  }  &#92;&#92; &#92;&#92;  &amp;=&amp;  &#92;displaystyle{ &#92;frac{1}{Z(q)} &#92;int &#92;frac{&#92;partial}{&#92;partial q^i}&#92;left( - &#92;beta_k A^k &#92;right)  e^{- &#92;beta_j A^j} &#92;, d&#92;mu  }  &#92;&#92; &#92;&#92;  &amp;=&amp;  &#92;displaystyle{ -&#92;frac{1}{Z(q)} &#92;int &#92;frac{&#92;partial &#92;beta_k}{&#92;partial q^i}  A^k   e^{- &#92;beta_j A^j} &#92;, d&#92;mu  }  &#92;&#92; &#92;&#92;  &amp;=&amp;  &#92;displaystyle{ - &#92;frac{&#92;partial &#92;beta_k}{&#92;partial q^i} &#92;frac{1}{Z(q)} &#92;int  A^k   e^{- &#92;beta_j A^j} &#92;, d&#92;mu  }  &#92;&#92; &#92;&#92;  &amp;=&amp;  &#92;displaystyle{ - &#92;frac{&#92;partial &#92;beta_k}{&#92;partial q^i} q^k }  &#92;end{array}  " class="latex" /></p>
<p>Ah, you don&#8217;t know how good it feels, after years of category theory, to be doing calculations like this again!</p>
<p>Now we can finish the job we started:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Barray%7D%7Bccl%7D++%5Cdisplaystyle%7B%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+q%5Ei%7D%7D+%26%3D%26++%5Cdisplaystyle%7B+%5Cfrac%7B%5Cpartial+%5Cbeta_k%7D%7B%5Cpartial+q%5Ei%7D+q%5Ek+%2B+%5Cbeta_i+%2B+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+q%5Ei%7D+%5Cln+Z%28q%29++%7D+%5C%5C+%5C%5C++%26%3D%26++%5Cdisplaystyle%7B+%5Cfrac%7B%5Cpartial+%5Cbeta_k%7D%7B%5Cpartial+q%5Ei%7D+q%5Ek+%2B+%5Cbeta_i+-+%5Cfrac%7B%5Cpartial+%5Cbeta_k%7D%7B%5Cpartial+q%5Ei%7D+q%5Ek++%7D+%5C%5C+%5C%5C++%26%3D%26+%5Cbeta_i++%5Cend%7Barray%7D++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;begin{array}{ccl}  &#92;displaystyle{&#92;frac{&#92;partial f}{&#92;partial q^i}} &amp;=&amp;  &#92;displaystyle{ &#92;frac{&#92;partial &#92;beta_k}{&#92;partial q^i} q^k + &#92;beta_i + &#92;frac{&#92;partial}{&#92;partial q^i} &#92;ln Z(q)  } &#92;&#92; &#92;&#92;  &amp;=&amp;  &#92;displaystyle{ &#92;frac{&#92;partial &#92;beta_k}{&#92;partial q^i} q^k + &#92;beta_i - &#92;frac{&#92;partial &#92;beta_k}{&#92;partial q^i} q^k  } &#92;&#92; &#92;&#92;  &amp;=&amp; &#92;beta_i  &#92;end{array}  " class="latex" /></p>
<p>Voilà!</p>
<h3> Conclusions</h3>
<p>We&#8217;ve learned the formula for the probability distribution that maximizes entropy subject to some constraints on the expected values of observables.  But more importantly, we&#8217;ve seen that the anonymous Lagrange multipliers <img src="https://s0.wp.com/latex.php?latex=%5Cbeta_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;beta_i" class="latex" /> that show up in this problem are actually the partial derivatives of entropy!  They equal</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+p_i+%3D+%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+q%5Ei%7D+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ p_i = &#92;frac{&#92;partial f}{&#92;partial q^i} } " class="latex" /></p>
<p>Thus, they are rich in meaning.   From what we&#8217;ve seen earlier, they are &#8216;surprisals&#8217;.   They are <i>analogous to momentum</i> in classical mechanics and have the meaning of <i>intensive variables</i> in thermodynamics:</p>
<div align="center">
<table border="1">
<tbody>
<tr>
<td></td>
<td style="text-align:center;">&nbsp;<b>Classical Mechanics</b>&nbsp;</td>
<td style="text-align:center;">&nbsp;<b>Thermodynamics</b>&nbsp;</td>
<td style="text-align:center;">&nbsp;<b>Probability Theory</b>&nbsp;</td>
</tr>
<tr>
<td>&nbsp;<i>q</i> &nbsp;</td>
<td style="text-align:center;">position</td>
<td style="text-align:center;">extensive variables</td>
<td style="text-align:center;">probabilities</td>
</tr>
<tr>
<td>&nbsp;<i>p</i>&nbsp;</td>
<td style="text-align:center;"> momentum</td>
<td style="text-align:center;">intensive variables</td>
<td style="text-align:center;">surprisals</td>
</tr>
<tr>
<td>&nbsp;<i>S</i> &nbsp;</td>
<td style="text-align:center;"> action</td>
<td style="text-align:center;">entropy</td>
<td style="text-align:center;"> Shannon entropy</td>
</tr>
</tbody>
</table>
</div>
<p>Furthermore, by showing <img src="https://s0.wp.com/latex.php?latex=%5Cbeta_i+%3D+p_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;beta_i = p_i" class="latex" /> the hard way we discovered an interesting fact.  There&#8217;s a relation between the entropy and the logarithm of the partition function:</p>
<p><img src="https://s0.wp.com/latex.php?latex=f%28q%29+%3D+p_i+q%5Ei+%2B+%5Cln+Z%28q%29+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="f(q) = p_i q^i + &#92;ln Z(q) " class="latex" /></p>
<p>(We proved this formula with <img src="https://s0.wp.com/latex.php?latex=%5Cbeta_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;beta_i" class="latex" /> replacing <img src="https://s0.wp.com/latex.php?latex=p_i%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p_i," class="latex" /> but now we know those are equal.)</p>
<p>This formula suggests that the logarithm of the partition function is important&#8212;and it is!  It&#8217;s closely related to the concept of <a href="https://en.wikipedia.org/wiki/Partition_function_(statistical_mechanics)#Relation_to_thermodynamic_variables">free energy</a>&#8212;even though &#8216;energy&#8217;, free or otherwise, doesn&#8217;t show up at the level of generality we&#8217;re working at now.</p>
<p>This formula should also remind you of the tautological 1-form on the cotangent bundle <img src="https://s0.wp.com/latex.php?latex=T%5E%5Cast+Q%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T^&#92;ast Q," class="latex" /> namely</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Ctheta+%3D+p_i+dq%5Ei&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;theta = p_i dq^i" class="latex" /></p>
<p>It should remind you even more of the contact 1-form on the contact manifold <img src="https://s0.wp.com/latex.php?latex=T%5E%5Cast+Q+%5Ctimes+%5Cmathbb%7BR%7D%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T^&#92;ast Q &#92;times &#92;mathbb{R}," class="latex" /> namely</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Calpha+%3D+-dS+%2B+p_i+dq%5Ei+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;alpha = -dS + p_i dq^i " class="latex" /></p>
<p>Here <img src="https://s0.wp.com/latex.php?latex=S&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S" class="latex" /> is a coordinate on the contact manifold that&#8217;s a kind of abstract stand-in for our entropy function <img src="https://s0.wp.com/latex.php?latex=f.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="f." class="latex" /></p>
<p>So, it&#8217;s clear there&#8217;s a lot more to say: we&#8217;re seeing hints of things here and there, but not yet the full picture.</p>
<hr />
<p>For all my old posts on information geometry, go here:</p>
<p>• <a href="https://math.ucr.edu/home/baez/information/">Information geometry</a>.</p>
]]></content:encoded>
					
					<wfw:commentRss>https://johncarlosbaez.wordpress.com/2021/08/17/information-geometry-part-21/feed/</wfw:commentRss>
			<slash:comments>11</slash:comments>
		
		
		
		<media:thumbnail url="https://johncarlosbaez.files.wordpress.com/2021/08/lagrange_multipliers.png" />
		<media:content url="https://johncarlosbaez.files.wordpress.com/2021/08/lagrange_multipliers.png" medium="image">
			<media:title type="html">lagrange_multipliers</media:title>
		</media:content>

		<media:content url="https://0.gravatar.com/avatar/34784534843022b3541c8ddd693718cb?s=96&#38;d=identicon&#38;r=G" medium="image">
			<media:title type="html">John Baez</media:title>
		</media:content>
	</item>
		<item>
		<title>Information Geometry (Part 20)</title>
		<link>https://johncarlosbaez.wordpress.com/2021/08/14/information-geometry-part-20/</link>
					<comments>https://johncarlosbaez.wordpress.com/2021/08/14/information-geometry-part-20/#comments</comments>
		
		<dc:creator><![CDATA[John Baez]]></dc:creator>
		<pubDate>Sat, 14 Aug 2021 22:02:59 +0000</pubDate>
				<category><![CDATA[information and entropy]]></category>
		<category><![CDATA[mathematics]]></category>
		<category><![CDATA[physics]]></category>
		<category><![CDATA[probability]]></category>
		<guid isPermaLink="false">http://johncarlosbaez.wordpress.com/?p=31552</guid>

					<description><![CDATA[Last time we worked out an analogy between classical mechanics, thermodynamics and probability theory. The latter two look suspiciously similar: &#160;Classical Mechanics&#160; &#160;Thermodynamics&#160; &#160;Probability Theory&#160; &#160;q &#160; position extensive variables probabilities &#160;p&#160; momentum intensive variables surprisals &#160;S &#160; action entropy Shannon entropy This is no coincidence. After all, in the subject of statistical mechanics we [&#8230;]]]></description>
										<content:encoded><![CDATA[<p><a href="https://johncarlosbaez.wordpress.com/2021/08/08/information-geometry-part-19/">Last time</a> we worked out an analogy between classical mechanics, thermodynamics and probability theory.  The latter two look suspiciously similar:</p>
<div align="center">
<table border="1">
<tbody>
<tr>
<td></td>
<td style="text-align:center;">&nbsp;<b>Classical Mechanics</b>&nbsp;</td>
<td style="text-align:center;">&nbsp;<b>Thermodynamics</b>&nbsp;</td>
<td style="text-align:center;">&nbsp;<b>Probability Theory</b>&nbsp;</td>
</tr>
<tr>
<td>&nbsp;<i>q</i> &nbsp;</td>
<td style="text-align:center;">position</td>
<td style="text-align:center;">extensive variables</td>
<td style="text-align:center;">probabilities</td>
</tr>
<tr>
<td>&nbsp;<i>p</i>&nbsp;</td>
<td style="text-align:center;"> momentum</td>
<td style="text-align:center;">intensive variables</td>
<td style="text-align:center;">surprisals</td>
</tr>
<tr>
<td>&nbsp;<i>S</i> &nbsp;</td>
<td style="text-align:center;"> action</td>
<td style="text-align:center;">entropy</td>
<td style="text-align:center;"> Shannon entropy</td>
</tr>
</tbody>
</table>
</div>
<p>This is no coincidence.  After all, in the subject of statistical mechanics we <i>explain</i> classical thermodynamics using probability theory&#8212;and entropy is revealed to be Shannon entropy (or its quantum analogue).</p>
<p>Now I want to make this precise.</p>
<p>To connect classical thermodynamics to probability theory, I&#8217;ll start by discussing &#8216;statistical manifolds&#8217;.  I introduced the idea of a statistical manifold in <a href="https://math.ucr.edu/home/baez/information/information_geometry_7.html">Part 7</a>: it&#8217;s a manifold <img src="https://s0.wp.com/latex.php?latex=Q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Q" class="latex" /> equipped with a map sending each point <img src="https://s0.wp.com/latex.php?latex=q+%5Cin+Q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q &#92;in Q" class="latex" /> to a probability distribution <img src="https://s0.wp.com/latex.php?latex=%5Cpi_q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi_q" class="latex" /> on some measure space <img src="https://s0.wp.com/latex.php?latex=%5COmega.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Omega." class="latex" />   Now I&#8217;ll say how these fit into the second column of the above chart.</p>
<p>Then I&#8217;ll talk about statistical manifolds of a special sort used in thermodynamics, which I&#8217;ll call &#8216;Gibbsian&#8217;, since they really go back to Josiah Willard Gibbs.</p>
<div align="center"><a href="https://en.wikipedia.org/wiki/Josiah_Willard_Gibbs"><img src="https://johncarlosbaez.files.wordpress.com/2021/08/josiah_willard_gibbs_-from_mms-.jpg?w=200" alt="" width="200" /></a></div>
<p>In a Gibbsian statistical manifold, for each <img src="https://s0.wp.com/latex.php?latex=q+%5Cin+Q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q &#92;in Q" class="latex" /> the probability distribution <img src="https://s0.wp.com/latex.php?latex=%5Cpi_q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi_q" class="latex" /> is a &#8216;Gibbs distribution&#8217;.   Physically, these Gibbs distributions describe <a href="https://en.wikipedia.org/wiki/Thermodynamic_equilibrium">thermodynamic equilibria</a>.  For example, if you specify the volume, energy and number of particles in a box of gas, there will be a Gibbs distribution describing what the particles do in thermodynamic equilibrium under these conditions.   Mathematically, Gibbs distributions <i>maximize entropy</i> subject to some constraints specified by the point <img src="https://s0.wp.com/latex.php?latex=q+%5Cin+Q.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q &#92;in Q." class="latex" /></p>
<p>More precisely: in a Gibbsian statistical manifold we have a list of observables <img src="https://s0.wp.com/latex.php?latex=A_1%2C+%5Cdots+%2C+A_n&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A_1, &#92;dots , A_n" class="latex" /> whose expected values serve as coordinates <img src="https://s0.wp.com/latex.php?latex=q_1%2C+%5Cdots%2C+q_n&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q_1, &#92;dots, q_n" class="latex" /> for points <img src="https://s0.wp.com/latex.php?latex=q+%5Cin+Q%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q &#92;in Q," class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=%5Cpi_q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi_q" class="latex" /> is the probability distribution that maximizes entropy subject to the constraint that the expected value of <img src="https://s0.wp.com/latex.php?latex=A_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A_i" class="latex" /> is <img src="https://s0.wp.com/latex.php?latex=q_i.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q_i." class="latex" />   We can derive most of the interesting formulas of thermodynamics starting from this!</p>
<h3> Statistical manifolds</h3>
<p>Let&#8217;s fix a measure space <img src="https://s0.wp.com/latex.php?latex=%5COmega&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Omega" class="latex" /> with measure <img src="https://s0.wp.com/latex.php?latex=%5Cmu.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mu." class="latex" />  A <b>statistical manifold</b> is then a manifold <img src="https://s0.wp.com/latex.php?latex=Q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Q" class="latex" /> equipped with a smooth map <img src="https://s0.wp.com/latex.php?latex=%5Cpi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi" class="latex" /> assigning to each point <img src="https://s0.wp.com/latex.php?latex=q+%5Cin+Q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q &#92;in Q" class="latex" /> a probability distribution on <img src="https://s0.wp.com/latex.php?latex=%5COmega%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Omega," class="latex" /> which I&#8217;ll call <img src="https://s0.wp.com/latex.php?latex=%5Cpi_q.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi_q." class="latex" />   So, <img src="https://s0.wp.com/latex.php?latex=%5Cpi_q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi_q" class="latex" /> is a function on <img src="https://s0.wp.com/latex.php?latex=%5COmega&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Omega" class="latex" /> with</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cint_%5COmega+%5Cpi_q+%5C%2C+d%5Cmu+%3D+1+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;int_&#92;Omega &#92;pi_q &#92;, d&#92;mu = 1 }" class="latex" /></p>
<p>and</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cpi_q%28x%29+%5Cge+0&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi_q(x) &#92;ge 0" class="latex" /></p>
<p>for all <img src="https://s0.wp.com/latex.php?latex=x+%5Cin+%5COmega.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x &#92;in &#92;Omega." class="latex" /></p>
<p>The idea here is that the space of <i>all</i> probability distributions on <img src="https://s0.wp.com/latex.php?latex=%5COmega&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Omega" class="latex" /> may be too huge to understand in as much detail as we&#8217;d like, so instead we describe <i>some</i> of these probability distributions&#8212;a family parametrized by points of some manifold <img src="https://s0.wp.com/latex.php?latex=Q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Q" class="latex" />&#8212;using the map <img src="https://s0.wp.com/latex.php?latex=%5Cpi.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi." class="latex" />   This is the basic idea behind <a href="https://en.wikipedia.org/wiki/Parametric_statistics">parametric statistics</a>.</p>
<p>Information geometry is the geometry of statistical manifolds.  Any statistical manifold comes with a bunch of interesting geometrical structures.   One is the &#8216;Fisher information metric&#8217;, a Riemannian metric I explained in <a href="https://math.ucr.edu/home/baez/information/information_geometry_7.html">Part 7</a>.  Another is a 1-parameter family of connections on the tangent bundle <img src="https://s0.wp.com/latex.php?latex=T+Q%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T Q," class="latex" /> which is important in Amari&#8217;s approach to information geometry.   You can read about this here:</p>
<p>• Hiroshi Matsuzoe, <a href="https://projecteuclid.org/download/pdf_1/euclid.aspm/1543086326">Statistical manifolds and affine differential geometry</a>, in <i>Advanced Studies in Pure Mathematics 57</i>, pp. 303–321.</p>
<p>I don&#8217;t want to talk about it now&#8212;I just wanted to reassure you that I&#8217;m not completely ignorant of it!</p>
<p>I want to focus on the story I&#8217;ve been telling, which is about <i>entropy</i>.   Our statistical manifold <img src="https://s0.wp.com/latex.php?latex=Q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Q" class="latex" /> comes with a smooth <b>entropy</b> function</p>
<p><img src="https://s0.wp.com/latex.php?latex=f+%5Ccolon+Q+%5Cto+%5Cmathbb%7BR%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="f &#92;colon Q &#92;to &#92;mathbb{R}" class="latex" /></p>
<p>namely</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B++f%28q%29+%3D+-%5Cint_%5COmega+%5Cpi_q%28x%29+%5C%2C+%5Cln+%5Cpi_q%28x%29+%5C%2C+d%5Cmu%28x%29++++%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{  f(q) = -&#92;int_&#92;Omega &#92;pi_q(x) &#92;, &#92;ln &#92;pi_q(x) &#92;, d&#92;mu(x)    } " class="latex" /></p>
<p>We can use this entropy function to do many of the things we usually do in thermodynamics!   For example, at any point <img src="https://s0.wp.com/latex.php?latex=q+%5Cin+Q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q &#92;in Q" class="latex" /> where this function is differentiable, its differential gives a cotangent vector</p>
<p><img src="https://s0.wp.com/latex.php?latex=p+%3D+%28df%29_q+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p = (df)_q " class="latex" /></p>
<p>which has an important physical meaning.   In coordinates we have</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+p_i+%3D+%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+q_i%7D+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ p_i = &#92;frac{&#92;partial f}{&#92;partial q_i} } " class="latex" /></p>
<p>and we call <img src="https://s0.wp.com/latex.php?latex=p_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p_i" class="latex" /> the <b>intensive variable conjugate to</b> <img src="https://s0.wp.com/latex.php?latex=q_i.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q_i." class="latex" />   For example if <img src="https://s0.wp.com/latex.php?latex=q_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q_i" class="latex" /> is energy, <img src="https://s0.wp.com/latex.php?latex=p_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p_i" class="latex" /> will be &#8216;coolness&#8217;: the reciprocal of temperature.</p>
<p>Defining <img src="https://s0.wp.com/latex.php?latex=p&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p" class="latex" /> this way gives a Lagrangian submanifold</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5CLambda+%3D+%5C%7B+%28q%2Cp%29+%5Cin+T%5E%5Cast+Q+%3A+%5C%3B+x+%5Cin+M%2C+%5C%3B+p+%3D++%28df%29_x+%5C%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Lambda = &#92;{ (q,p) &#92;in T^&#92;ast Q : &#92;; x &#92;in M, &#92;; p =  (df)_x &#92;} " class="latex" /></p>
<p>of the cotangent bundle <img src="https://s0.wp.com/latex.php?latex=T%5E%5Cast+Q.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T^&#92;ast Q." class="latex" />   We can also get contact geometry into the game by defining a contact manifold <img src="https://s0.wp.com/latex.php?latex=T%5E%5Cast+Q+%5Ctimes+%5Cmathbb%7BR%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T^&#92;ast Q &#92;times &#92;mathbb{R}" class="latex" /> and a Legendrian submanifold</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5CSigma+%3D+%5C%7B+%28q%2Cp%2CS%29+%5Cin+T%5E%5Cast+Q+%5Ctimes+%5Cmathbb%7BR%7D+%3A+%5C%3B+x+%5Cin+M%2C+%5C%3B+p+%3D++%28df%29_q+%2C+S+%3D+f%28q%29+%5C%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Sigma = &#92;{ (q,p,S) &#92;in T^&#92;ast Q &#92;times &#92;mathbb{R} : &#92;; x &#92;in M, &#92;; p =  (df)_q , S = f(q) &#92;}" class="latex" /></p>
<p>But I&#8217;ve been talking about these ideas for the last three episodes, so I won&#8217;t say more just now!   Instead, I want to throw a new idea into the pot.</p>
<h3> Gibbsian statistical manifolds</h3>
<p>Thermodynamics, and statistical mechanics, spend a lot of time dealing with statistical manifold of a special sort I&#8217;ll call &#8216;Gibbsian&#8217;.  In these, each probability distribution <img src="https://s0.wp.com/latex.php?latex=%5Cpi_q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi_q" class="latex" /> is a &#8216;Gibbs distribution&#8217;, meaning that it maximizes entropy subject to certain constraints specified by the point <img src="https://s0.wp.com/latex.php?latex=q+%5Cin+Q.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q &#92;in Q." class="latex" /></p>
<p>How does this work?  For starters, an integrable function</p>
<p><img src="https://s0.wp.com/latex.php?latex=A+%5Ccolon+%5COmega+%5Cto+%5Cmathbb%7BR%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A &#92;colon &#92;Omega &#92;to &#92;mathbb{R}" class="latex" /></p>
<p>is called a <b>random variable</b>, or in physics an <b>observable</b>.  The <b>expected value</b> of an observable is a smooth real-valued function on our statistical manifold</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Clangle+A+%5Crangle+%5Ccolon+Q+%5Cto+%5Cmathbb%7BR%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;langle A &#92;rangle &#92;colon Q &#92;to &#92;mathbb{R} " class="latex" /></p>
<p>given by</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Clangle+A+%5Crangle%28q%29+%3D+%5Cint_%5COmega+A%28x%29+%5Cpi_q%28x%29+%5C%2C+d%5Cmu%28x%29+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;langle A &#92;rangle(q) = &#92;int_&#92;Omega A(x) &#92;pi_q(x) &#92;, d&#92;mu(x) } " class="latex" /></p>
<p>In other words, <img src="https://s0.wp.com/latex.php?latex=%5Clangle+A+%5Crangle&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;langle A &#92;rangle" class="latex" /> is a function whose value at at any point <img src="https://s0.wp.com/latex.php?latex=q+%5Cin+Q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q &#92;in Q" class="latex" /> is the expected value of <img src="https://s0.wp.com/latex.php?latex=A&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A" class="latex" /> with respect to the probability distribution <img src="https://s0.wp.com/latex.php?latex=%5Cpi_q.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi_q." class="latex" /></p>
<p>Now, suppose our statistical manifold is <i>n</i>-dimensional and we have <i>n</i> observables <img src="https://s0.wp.com/latex.php?latex=A_1%2C+%5Cdots%2C+A_n.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="A_1, &#92;dots, A_n." class="latex" />   Their expected values will be smooth functions on our manifold&#8212;and sometimes these functions will be a coordinate system!</p>
<p>This may sound rather unlikely, but it&#8217;s really not so outlandish.  Indeed, if there&#8217;s a point <img src="https://s0.wp.com/latex.php?latex=q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q" class="latex" /> such that the differentials of the functions <img src="https://s0.wp.com/latex.php?latex=%5Clangle+A_i+%5Crangle&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;langle A_i &#92;rangle" class="latex" /> are linearly independent at this point, these functions will be a coordinate system in some neighborhood of this point, by the <a href="https://en.wikipedia.org/wiki/Inverse_function_theorem">inverse function theorem</a>.  So, we can take this neighborhood, use <i>it</i> as our statistical manifold, and the functions <img src="https://s0.wp.com/latex.php?latex=%5Clangle+A_i+%5Crangle&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;langle A_i &#92;rangle" class="latex" /> will be coordinates.</p>
<p>So, let&#8217;s assume the expected values of our observables give a coordinate system on <img src="https://s0.wp.com/latex.php?latex=Q.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Q." class="latex" />   Let&#8217;s call these coordinates <img src="https://s0.wp.com/latex.php?latex=q_1%2C+%5Cdots%2C+q_n%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q_1, &#92;dots, q_n," class="latex" /> so that</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Clangle+A_i+%5Crangle%28q%29+%3D+q_i++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;langle A_i &#92;rangle(q) = q_i  " class="latex" /></p>
<p>Now for the kicker: we say our statistical manifold is <b>Gibbsian</b> if for each point <img src="https://s0.wp.com/latex.php?latex=q+%5Cin+Q%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q &#92;in Q," class="latex" /> <img src="https://s0.wp.com/latex.php?latex=%5Cpi_q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi_q" class="latex" /> is the probability distribution that <i>maximizes entropy subject to the above condition!</i></p>
<p>Which condition?   The condition saying that</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cint_%5COmega+A_i%28x%29+%5Cpi_q%28x%29+%5C%2C+d%5Cmu%28x%29+%3D+q_i+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;int_&#92;Omega A_i(x) &#92;pi_q(x) &#92;, d&#92;mu(x) = q_i } " class="latex" /></p>
<p>for all <i>i</i>.   This is just the previous equation spelled out so that you can see it&#8217;s a condition on <img src="https://s0.wp.com/latex.php?latex=%5Cpi_q.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi_q." class="latex" /></p>
<p>This assumption of the entropy-maximizing nature of <img src="https://s0.wp.com/latex.php?latex=%5Cpi_q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi_q" class="latex" /> is a very powerful, because it implies a useful and nontrivial formula for <img src="https://s0.wp.com/latex.php?latex=%5Cpi_q.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi_q." class="latex" />   It&#8217;s called the <b><a href="https://en.wikipedia.org/wiki/Gibbs_measure">Gibbs distribution</a></b>:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B++%5Cpi_q%28x%29+%3D+%5Cfrac%7B1%7D%7BZ%28q%29%7D+%5Cexp%5Cleft%28-%5Csum_%7Bi+%3D+1%7D%5En+p_i+A_i%28x%29%5Cright%29+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{  &#92;pi_q(x) = &#92;frac{1}{Z(q)} &#92;exp&#92;left(-&#92;sum_{i = 1}^n p_i A_i(x)&#92;right) }" class="latex" /></p>
<p>for all <img src="https://s0.wp.com/latex.php?latex=x+%5Cin+%5COmega.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x &#92;in &#92;Omega." class="latex" /></p>
<p>Here <img src="https://s0.wp.com/latex.php?latex=p_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p_i" class="latex" /> is the intensive variable conjugate to <img src="https://s0.wp.com/latex.php?latex=q_i%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q_i," class="latex" /> while <img src="https://s0.wp.com/latex.php?latex=Z%28q%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Z(q)" class="latex" /> is the <b>partition function</b>: the thing we must divide by to make sure <img src="https://s0.wp.com/latex.php?latex=%5Cpi_q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi_q" class="latex" /> integrates to 1.  In other words:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+Z%28q%29+%3D+%5Cint_%5COmega+%5Cexp%5Cleft%28-%5Csum_%7Bi+%3D+1%7D%5En+p_i+A_i%28x%29+%5Cright%29+%5C%2C+d%5Cmu%28x%29+++%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ Z(q) = &#92;int_&#92;Omega &#92;exp&#92;left(-&#92;sum_{i = 1}^n p_i A_i(x) &#92;right) &#92;, d&#92;mu(x)   } " class="latex" /></p>
<p>By the way, this formula may look confusing at first, since the left side depends on the point <img src="https://s0.wp.com/latex.php?latex=q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q" class="latex" /> in our statistical manifold, while there&#8217;s no <img src="https://s0.wp.com/latex.php?latex=q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q" class="latex" /> visible in the right side!  Do you see what&#8217;s going on?</p>
<p>I&#8217;ll tell you: the conjugate variable <img src="https://s0.wp.com/latex.php?latex=p_i%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p_i," class="latex" /> sitting on the right side of the above formula, depends on <img src="https://s0.wp.com/latex.php?latex=q.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q." class="latex" />   Remember, we got it by taking the partial derivative of the entropy in the <img src="https://s0.wp.com/latex.php?latex=q_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q_i" class="latex" /> direction</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+p_i+%3D+%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+q_i%7D+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ p_i = &#92;frac{&#92;partial f}{&#92;partial q_i} } " class="latex" /></p>
<p>and the evaluating this derivative at the point <img src="https://s0.wp.com/latex.php?latex=q.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q." class="latex" /></p>
<p>But wait a minute!  <img src="https://s0.wp.com/latex.php?latex=f&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="f" class="latex" /> here is the entropy&#8212;but the entropy of <i>what?</i></p>
<p>The entropy of <img src="https://s0.wp.com/latex.php?latex=%5Cpi_q%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi_q," class="latex" /> of course!</p>
<p>So there&#8217;s something circular about our formula for <img src="https://s0.wp.com/latex.php?latex=%5Cpi_q.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi_q." class="latex" /> To know <img src="https://s0.wp.com/latex.php?latex=%5Cpi_q%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi_q," class="latex" /> you need to know the conjugate variables <img src="https://s0.wp.com/latex.php?latex=p_i%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p_i," class="latex" /> but to compute these you need to know the entropy of <img src="https://s0.wp.com/latex.php?latex=%5Cpi_q.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi_q." class="latex" /></p>
<p>This is actually okay.  While circular, the formula for <img src="https://s0.wp.com/latex.php?latex=%5Cpi_q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi_q" class="latex" /> is still <i>true</i>.  It&#8217;s harder to work with than you might hope.  But it&#8217;s still extremely useful.</p>
<p>Next time I&#8217;ll prove that this formula for <img src="https://s0.wp.com/latex.php?latex=%5Cpi_q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi_q" class="latex" /> is true, and do a few things with it.   All this material was discovered by Gibbs in the late 1800&#8217;s, and it&#8217;s lurking any good book on statistical mechanics&#8212;but not phrased in the language of statistical manifolds.  The physics textbooks usually consider special cases, like a box of gas where:</p>
<p>&bull; <img src="https://s0.wp.com/latex.php?latex=q_1&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q_1" class="latex" /> is energy, <img src="https://s0.wp.com/latex.php?latex=p_1&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p_1" class="latex" /> is 1/temperature.</p>
<p>&bull; <img src="https://s0.wp.com/latex.php?latex=q_2&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q_2" class="latex" /> is volume, <img src="https://s0.wp.com/latex.php?latex=p_2&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p_2" class="latex" /> is &ndash;pressure/temperature.</p>
<p>&bull; <img src="https://s0.wp.com/latex.php?latex=q_3&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q_3" class="latex" /> is the number of particles, <img src="https://s0.wp.com/latex.php?latex=p_3&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p_3" class="latex" /> is chemical potential / pressure.</p>
<p>While these special cases are important and interesting, I&#8217;d rather be general!</p>
<h3> Technical comments</h3>
<p>I said &#8220;Any statistical manifold comes with a bunch of interesting geometrical structures&#8221;, but in fact some conditions are required.  For example, the Fisher information metric is only well-defined and nondegenerate under some conditions on the map <img src="https://s0.wp.com/latex.php?latex=%5Cpi.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi." class="latex" />   For example, if <img src="https://s0.wp.com/latex.php?latex=%5Cpi&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi" class="latex" /> maps every point of <img src="https://s0.wp.com/latex.php?latex=Q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Q" class="latex" /> to the same probability distribution, the Fisher information metric will <i>vanish</i>.</p>
<p>Similarly, the entropy function <img src="https://s0.wp.com/latex.php?latex=f&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="f" class="latex" /> is only smooth under some conditions on <img src="https://s0.wp.com/latex.php?latex=%5Cpi.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi." class="latex" /></p>
<p>Furthermore, the integral</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cint_%5COmega+%5Cexp%5Cleft%28-%5Csum_%7Bi+%3D+1%7D%5En+p_i+A_i%28x%29+%5Cright%29+%5C%2C+d%5Cmu%28x%29+++%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;int_&#92;Omega &#92;exp&#92;left(-&#92;sum_{i = 1}^n p_i A_i(x) &#92;right) &#92;, d&#92;mu(x)   } " class="latex" /></p>
<p>may not converge for all values of the numbers <img src="https://s0.wp.com/latex.php?latex=p_1%2C+%5Cdots%2C+p_n.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p_1, &#92;dots, p_n." class="latex" />   But in my discussion of Gibbsian statistical manifolds, I was assuming that an entropy-maximizing probability distribution <img src="https://s0.wp.com/latex.php?latex=%5Cpi_q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi_q" class="latex" /> with</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cint_%5COmega+A_i%28x%29+%5Cpi_q%28x%29+%5C%2C+d%5Cmu%28x%29+%3D+q_i+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;int_&#92;Omega A_i(x) &#92;pi_q(x) &#92;, d&#92;mu(x) = q_i } " class="latex" /></p>
<p>actually <i>exists</i>.   In this case the probability distribution is also unique (almost everywhere).</p>
<hr />
<p>For all my old posts on information geometry, go here:</p>
<p>• <a href="https://math.ucr.edu/home/baez/information/">Information geometry</a>.</p>
]]></content:encoded>
					
					<wfw:commentRss>https://johncarlosbaez.wordpress.com/2021/08/14/information-geometry-part-20/feed/</wfw:commentRss>
			<slash:comments>16</slash:comments>
		
		
		
		<media:thumbnail url="https://johncarlosbaez.files.wordpress.com/2021/08/600px-phase_diagram_of_water_simplified.svg_.png" />
		<media:content url="https://johncarlosbaez.files.wordpress.com/2021/08/600px-phase_diagram_of_water_simplified.svg_.png" medium="image">
			<media:title type="html">600px-Phase_diagram_of_water_simplified.svg</media:title>
		</media:content>

		<media:content url="https://0.gravatar.com/avatar/34784534843022b3541c8ddd693718cb?s=96&#38;d=identicon&#38;r=G" medium="image">
			<media:title type="html">John Baez</media:title>
		</media:content>

		<media:content url="https://johncarlosbaez.files.wordpress.com/2021/08/josiah_willard_gibbs_-from_mms-.jpg" medium="image" />
	</item>
		<item>
		<title>Information Geometry (Part 19)</title>
		<link>https://johncarlosbaez.wordpress.com/2021/08/08/information-geometry-part-19/</link>
					<comments>https://johncarlosbaez.wordpress.com/2021/08/08/information-geometry-part-19/#comments</comments>
		
		<dc:creator><![CDATA[John Baez]]></dc:creator>
		<pubDate>Sun, 08 Aug 2021 00:56:31 +0000</pubDate>
				<category><![CDATA[information and entropy]]></category>
		<category><![CDATA[mathematics]]></category>
		<category><![CDATA[physics]]></category>
		<category><![CDATA[probability]]></category>
		<guid isPermaLink="false">http://johncarlosbaez.wordpress.com/?p=31491</guid>

					<description><![CDATA[Last time I figured out the analogue of momentum in probability theory, but I didn&#8217;t say what it&#8217;s called. Now I will tell you&#8212;thanks to some help from Abel Jansma and Toby Bartels. SURPRISE: it&#8217;s called SURPRISAL! This is a well-known concept in information theory. It&#8217;s also called &#8216;information content&#8216;. Let&#8217;s see why. First, let&#8217;s [&#8230;]]]></description>
										<content:encoded><![CDATA[<p><a href="https://johncarlosbaez.wordpress.com/2021/08/05/information-geometry-part-18/">Last time</a> I figured out the analogue of <i>momentum</i> in probability theory, but I didn&#8217;t say what it&#8217;s called.  Now I will tell you&#8212;thanks to some help from <a href="https://twitter.com/Abelaer/status/1423656405286916098">Abel Jansma</a> and <a href="https://johncarlosbaez.wordpress.com/2021/08/05/information-geometry-part-18/#comment-171310">Toby Bartels</a>.</p>
<p><b>SURPRISE:</b> it&#8217;s called <b>SURPRISAL!</b></p>
<p>This is a well-known concept in information theory.  It&#8217;s also called &#8216;<a href="https://en.wikipedia.org/wiki/Information_content">information content</a>&#8216;.</p>
<p>Let&#8217;s see why.  First, let&#8217;s remember the setup.   We have a manifold</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+Q+%3D+%5C%7B+q+%5Cin+%5Cmathbb%7BR%7D%5En+%3A+%5C%3B+q_i+%3E+0%2C+%5C%3B+%5Csum_%7Bi%3D1%7D%5En+q_i+%3D+1+%5C%7D+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ Q = &#92;{ q &#92;in &#92;mathbb{R}^n : &#92;; q_i &gt; 0, &#92;; &#92;sum_{i=1}^n q_i = 1 &#92;} } " class="latex" /></p>
<p>whose points <img src="https://s0.wp.com/latex.php?latex=q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q" class="latex" /> are nowhere vanishing probability distributions on the set <img src="https://s0.wp.com/latex.php?latex=%5C%7B1%2C+%5Cdots%2C+n%5C%7D.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;{1, &#92;dots, n&#92;}." class="latex" />   We have a function</p>
<p><img src="https://s0.wp.com/latex.php?latex=f+%5Ccolon+Q+%5Cto+%5Cmathbb%7BR%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="f &#92;colon Q &#92;to &#92;mathbb{R} " class="latex" /></p>
<p>called the <a href="https://en.wikipedia.org/wiki/Entropy_(information_theory)">Shannon entropy</a>, defined by</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+f%28q%29+%3D+-+%5Csum_%7Bj+%3D+1%7D%5En+q_j+%5Cln+q_j+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ f(q) = - &#92;sum_{j = 1}^n q_j &#92;ln q_j } " class="latex" /></p>
<p>For each point <img src="https://s0.wp.com/latex.php?latex=q+%5Cin+Q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q &#92;in Q" class="latex" /> we define a cotangent vector <img src="https://s0.wp.com/latex.php?latex=p+%5Cin+T%5E%5Cast_q+Q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p &#92;in T^&#92;ast_q Q" class="latex" /> by</p>
<p><img src="https://s0.wp.com/latex.php?latex=p+%3D+%28df%29_q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p = (df)_q" class="latex" /></p>
<p>As mentioned <a href="https://johncarlosbaez.wordpress.com/2021/08/05/information-geometry-part-18/">last time</a>, this is the analogue of momentum in probability theory.   In the second half of this post I&#8217;ll say more about exactly why.   But first let&#8217;s compute it and see what it actually equals!</p>
<p>Let&#8217;s start with a naive calculation, acting as if the probabilities <img src="https://s0.wp.com/latex.php?latex=q_1%2C+%5Cdots%2C+q_n&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q_1, &#92;dots, q_n" class="latex" /> were a coordinate system on the manifold <img src="https://s0.wp.com/latex.php?latex=Q.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Q." class="latex" />   We get</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+p_i+%3D+%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+q_i%7D+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ p_i = &#92;frac{&#92;partial f}{&#92;partial q_i} }" class="latex" /></p>
<p>so using the definition of the Shannon entropy we have</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Barray%7D%7Bccl%7D++p_i+%26%3D%26+%5Cdisplaystyle%7B+-%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+q_i%7D+%5Csum_%7Bj+%3D+1%7D%5En+q_j+%5Cln+q_j++%7D%5C%5C+%5C%5C++%26%3D%26+%5Cdisplaystyle%7B+-%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+q_i%7D+%5Cleft%28+q_i+%5Cln+q_i+%5Cright%29+%7D+%5C%5C+%5C%5C++%26%3D%26+-%5Cln%28q_i%29+-+1++%5Cend%7Barray%7D++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;begin{array}{ccl}  p_i &amp;=&amp; &#92;displaystyle{ -&#92;frac{&#92;partial}{&#92;partial q_i} &#92;sum_{j = 1}^n q_j &#92;ln q_j  }&#92;&#92; &#92;&#92;  &amp;=&amp; &#92;displaystyle{ -&#92;frac{&#92;partial}{&#92;partial q_i} &#92;left( q_i &#92;ln q_i &#92;right) } &#92;&#92; &#92;&#92;  &amp;=&amp; -&#92;ln(q_i) - 1  &#92;end{array}  " class="latex" /></p>
<p>Now, the quantity <img src="https://s0.wp.com/latex.php?latex=-%5Cln+q_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="-&#92;ln q_i" class="latex" /> is called the <b>surprisal</b> of the probability distribution at <img src="https://s0.wp.com/latex.php?latex=i.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i." class="latex" />   Intuitively, it&#8217;s a measure of how surprised you should be if an event of probability <img src="https://s0.wp.com/latex.php?latex=q_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q_i" class="latex" /> occurs.    For example, if you flip a fair coin and it lands heads up, your surprisal is ln 2.   If you flip 100 fair coins and they all land heads up, your surprisal is 100 times ln 2.</p>
<p>Of course &#8216;surprise&#8217; is a psychological term, not a term from math or physics, so we shouldn&#8217;t take it too seriously here.  We can derive the concept of surprisal from three axioms:</p>
<ol>
<li>The surprisal of an event of probability <img src="https://s0.wp.com/latex.php?latex=q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q" class="latex" /> is some function of <img src="https://s0.wp.com/latex.php?latex=q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q" class="latex" />, say <img src="https://s0.wp.com/latex.php?latex=F%28q%29.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="F(q)." class="latex" /></li>
<li>The less probable an event is, the larger its surprisal is: <img src="https://s0.wp.com/latex.php?latex=q_1+%5Cle+q_2+%5Cimplies++F%28q_1%29+%5Cge+F%28q_2%29.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q_1 &#92;le q_2 &#92;implies  F(q_1) &#92;ge F(q_2)." class="latex" /></li>
<li>The surprisal of two independent events is the sum of their surprisals: <img src="https://s0.wp.com/latex.php?latex=F%28q_1+q_2%29+%3D+F%28q_1%29+%2B+F%28q_2%29.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="F(q_1 q_2) = F(q_1) + F(q_2)." class="latex" /></li>
</ol>
<p>It follows from work on <a href="https://en.wikipedia.org/wiki/Cauchy%27s_functional_equation">Cauchy&#8217;s functional equation</a> that <img src="https://s0.wp.com/latex.php?latex=F&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="F" class="latex" /> must be of this form:</p>
<p><img src="https://s0.wp.com/latex.php?latex=F%28q%29+%3D+-+%5Clog_b+q+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="F(q) = - &#92;log_b q " class="latex" /></p>
<p>for some constant <img src="https://s0.wp.com/latex.php?latex=b+%3E+1.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="b &gt; 1." class="latex" />   We shall choose <img src="https://s0.wp.com/latex.php?latex=b%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="b," class="latex" /> the base of our logarithms, to be <img src="https://s0.wp.com/latex.php?latex=e.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="e." class="latex" />   We had a similar freedom of choice in defining the Shannon entropy, and we will use base <img src="https://s0.wp.com/latex.php?latex=e&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="e" class="latex" /> for both to be consistent.  If we chose something else, it would change the surprisal and the Shannon entropy by the same constant factor.</p>
<p>So far, so good.  But what about the irksome &#8220;-1&#8221; in our formula?</p>
<p><img src="https://s0.wp.com/latex.php?latex=p_i+%3D+-%5Cln%28q_i%29+-+1+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p_i = -&#92;ln(q_i) - 1 " class="latex" /></p>
<p>Luckily it turns out we can just get rid of this!   The reason is that the probabilities <img src="https://s0.wp.com/latex.php?latex=q_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q_i" class="latex" /> are not really coordinates on the manifold <img src="https://s0.wp.com/latex.php?latex=Q.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Q." class="latex" />  They&#8217;re not independent: they must sum to 1.  So, when we change them a little, the sum of their changes must vanish.  Putting it more technically, the tangent space <img src="https://s0.wp.com/latex.php?latex=T_q+Q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T_q Q" class="latex" /> is not all of <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5En%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^n," class="latex" /> but just the subspace consisting of vectors whose components sum to zero:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+T_q+Q+%3D+%5C%7B+v+%5Cin+%5Cmathbb%7BR%7D%5En+%3A+%5C%3B+%5Csum_%7Bj+%3D+1%7D%5En+v_j+%3D+0+%5C%7D+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ T_q Q = &#92;{ v &#92;in &#92;mathbb{R}^n : &#92;; &#92;sum_{j = 1}^n v_j = 0 &#92;} }" class="latex" /></p>
<p>The cotangent space is the dual of the tangent space.  The dual of a subspace</p>
<p><img src="https://s0.wp.com/latex.php?latex=S+%5Csubseteq+V&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S &#92;subseteq V" class="latex" /></p>
<p>is the quotient space</p>
<p><img src="https://s0.wp.com/latex.php?latex=V%5E%5Cast%2F%5C%7B+%5Cell+%5Ccolon+V+%5Cto+%5Cmathbb%7BR%7D+%3A+%5C%3B+%5Cforall+v+%5Cin+S+%5C%3B+%5C%2C+%5Cell%28v%29+%3D+0+%5C%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="V^&#92;ast/&#92;{ &#92;ell &#92;colon V &#92;to &#92;mathbb{R} : &#92;; &#92;forall v &#92;in S &#92;; &#92;, &#92;ell(v) = 0 &#92;} " class="latex" /></p>
<p>The cotangent space <img src="https://s0.wp.com/latex.php?latex=T_q%5E%5Cast+Q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T_q^&#92;ast Q" class="latex" /> thus consists of linear functionals <img src="https://s0.wp.com/latex.php?latex=%5Cell+%5Ccolon+%5Cmathbb%7BR%7D%5En+%5Cto+%5Cmathbb%7BR%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;ell &#92;colon &#92;mathbb{R}^n &#92;to &#92;mathbb{R}" class="latex" /> modulo those that vanish on vectors <img src="https://s0.wp.com/latex.php?latex=v&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="v" class="latex" /> obeying the equation</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Csum_%7Bj+%3D+1%7D%5En+v_j+%3D+0+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;sum_{j = 1}^n v_j = 0 } " class="latex" /></p>
<p>Of course, we can identify the dual of <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5En&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^n" class="latex" /> with <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5En&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^n" class="latex" /> in the usual way, using the Euclidean inner product: a vector <img src="https://s0.wp.com/latex.php?latex=u+%5Cin+%5Cmathbb%7BR%7D%5En&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="u &#92;in &#92;mathbb{R}^n" class="latex" /> corresponds to the linear functional</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cell%28v%29+%3D+%5Csum_%7Bj+%3D+1%7D%5En+u_j+v_j+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;ell(v) = &#92;sum_{j = 1}^n u_j v_j } " class="latex" /></p>
<p>From this, you can see that a linear functional <img src="https://s0.wp.com/latex.php?latex=%5Cell&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;ell" class="latex" /> vanishes on all vectors <img src="https://s0.wp.com/latex.php?latex=v&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="v" class="latex" /> obeying the equation</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Csum_%7Bj+%3D+1%7D%5En+v_j+%3D+0+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;sum_{j = 1}^n v_j = 0 } " class="latex" /></p>
<p>if and only if its corresponding vector <img src="https://s0.wp.com/latex.php?latex=u&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="u" class="latex" /> has</p>
<p><img src="https://s0.wp.com/latex.php?latex=u_1+%3D+%5Ccdots+%3D+u_n+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="u_1 = &#92;cdots = u_n " class="latex" /></p>
<p>So, we get</p>
<p><img src="https://s0.wp.com/latex.php?latex=T%5E%5Cast_q+Q+%5Ccong+%5Cmathbb%7BR%7D%5En%2F%5C%7B+u+%5Cin+%5Cmathbb%7BR%7D%5En+%3A+%5C%3B+u_1+%3D+%5Ccdots+%3D+u_n+%5C%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T^&#92;ast_q Q &#92;cong &#92;mathbb{R}^n/&#92;{ u &#92;in &#92;mathbb{R}^n : &#92;; u_1 = &#92;cdots = u_n &#92;}" class="latex" /></p>
<p>In words: we can describe cotangent vectors to <img src="https://s0.wp.com/latex.php?latex=Q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Q" class="latex" /> as lists of <i>n</i> numbers if we want, <i>but</i> we have to remember that adding the same constant to each number in the list doesn&#8217;t change the cotangent vector!</p>
<p>This suggests that our naive formula</p>
<p><img src="https://s0.wp.com/latex.php?latex=p_i+%3D+%5Cln%28q_i%29+-+1+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p_i = &#92;ln(q_i) - 1 " class="latex" /></p>
<p>is on the right track, but we&#8217;re free to get rid of the constant 1 if we want!   And that&#8217;s true.</p>
<p>To check this rigorously, we need to show</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+p%28v%29+%3D+-%5Csum_%7Bj%3D1%7D%5En+%5Cln%28q_i%29+v_i%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ p(v) = -&#92;sum_{j=1}^n &#92;ln(q_i) v_i} " class="latex" /></p>
<p>for all <img src="https://s0.wp.com/latex.php?latex=v+%5Cin+T_q+Q.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="v &#92;in T_q Q." class="latex" />   We compute:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Barray%7D%7Bccl%7D++p%28v%29+%26%3D%26+df%28v%29+%5C%5C+%5C%5C++%26%3D%26+v%28f%29+%5C%5C+%5C%5C++%26%3D%26+%5Cdisplaystyle%7B+%5Csum_%7Bj%3D1%7D%5En+v_j+%5C%2C+%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+q_j%7D+%7D+%5C%5C+%5C%5C++%26%3D%26+%5Cdisplaystyle%7B+%5Csum_%7Bj%3D1%7D%5En+v_j+%28-%5Cln%28q_i%29+-+1%29+%7D+%5C%5C+%5C%5C++%26%3D%26+%5Cdisplaystyle%7B+-%5Csum_%7Bj%3D1%7D%5En+%5Cln%28q_i%29+v_i+%7D++%5Cend%7Barray%7D++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;begin{array}{ccl}  p(v) &amp;=&amp; df(v) &#92;&#92; &#92;&#92;  &amp;=&amp; v(f) &#92;&#92; &#92;&#92;  &amp;=&amp; &#92;displaystyle{ &#92;sum_{j=1}^n v_j &#92;, &#92;frac{&#92;partial f}{&#92;partial q_j} } &#92;&#92; &#92;&#92;  &amp;=&amp; &#92;displaystyle{ &#92;sum_{j=1}^n v_j (-&#92;ln(q_i) - 1) } &#92;&#92; &#92;&#92;  &amp;=&amp; &#92;displaystyle{ -&#92;sum_{j=1}^n &#92;ln(q_i) v_i }  &#92;end{array}  " class="latex" /></p>
<p>where in the second to last step we used our earlier calculation:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+q_i%7D+%3D+-%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+q_i%7D+%5Csum_%7Bj+%3D+1%7D%5En+q_j+%5Cln+q_j+%3D+-%5Cln%28q_i%29+-+1+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{&#92;partial f}{&#92;partial q_i} = -&#92;frac{&#92;partial}{&#92;partial q_i} &#92;sum_{j = 1}^n q_j &#92;ln q_j = -&#92;ln(q_i) - 1 } " class="latex" /></p>
<p>and in the last step we used</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Csum_j+v_j+%3D+0+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;sum_j v_j = 0 } " class="latex" /></p>
<h3> Back to the big picture </h3>
<p>Now let&#8217;s take stock of where we are.   We can fill in the question marks in the charts from last time, and combine those charts while we&#8217;re at it.</p>
<div align="center">
<table border="1">
<tbody>
<tr>
<td></td>
<td style="text-align:center;">&nbsp;<b>Classical Mechanics</b>&nbsp;</td>
<td style="text-align:center;">&nbsp;<b>Thermodynamics</b>&nbsp;</td>
<td style="text-align:center;">&nbsp;<b>Probability Theory</b>&nbsp;</td>
</tr>
<tr>
<td>&nbsp;<i>q</i> &nbsp;</td>
<td style="text-align:center;">position</td>
<td style="text-align:center;">extensive variables</td>
<td style="text-align:center;">probabilities</td>
</tr>
<tr>
<td>&nbsp;<i>p</i>&nbsp;</td>
<td style="text-align:center;"> momentum</td>
<td style="text-align:center;">intensive variables</td>
<td style="text-align:center;">surprisals</td>
</tr>
<tr>
<td>&nbsp;<i>S</i> &nbsp;</td>
<td style="text-align:center;"> action</td>
<td style="text-align:center;">entropy</td>
<td style="text-align:center;"> Shannon entropy</td>
</tr>
</tbody>
</table>
</div>
<p>What&#8217;s going on here?   In classical mechanics, action is minimized (or at least the system finds a critical point of the action).  In thermodynamics, entropy is maximized.  In the maximum entropy approach to probability, Shannon entropy is maximized.  This leads to a mathematical analogy that&#8217;s quite precise.   For classical mechanics and thermodynamics, I explained it here:</p>
<p>• <a href="https://johncarlosbaez.wordpress.com/2012/01/19/classical-mechanics-versus-thermodynamics-part-1/">Classical mechanics versus thermodynamics (part 1)</a>.</p>
<p>• <a href="https://johncarlosbaez.wordpress.com/2012/01/23/classical-mechanics-versus-thermodynamics-part-2/">Classical mechanics versus thermodynamics (part 2)</a>.</p>
<p>These posts may give a more approachable introduction to what I&#8217;m doing now: now I&#8217;m bringing <i>probability theory</i> into the analogy, with a big emphasis on symplectic and contact geometry.</p>
<p>Let me spell out a bit of the analogy more carefully:</p>
<p><b>Classical Mechanics.</b>   In classical mechanics, we have a manifold <img src="https://s0.wp.com/latex.php?latex=Q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Q" class="latex" /> whose points are positions of a particle.  There&#8217;s an important function on this manifold: Hamilton&#8217;s principal function</p>
<p><img src="https://s0.wp.com/latex.php?latex=f+%5Ccolon+Q+%5Cto+%5Cmathbb%7BR%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="f &#92;colon Q &#92;to &#92;mathbb{R}" class="latex" /></p>
<p>What&#8217;s this?   It&#8217;s basically <b>action</b>: <img src="https://s0.wp.com/latex.php?latex=f%28q%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="f(q)" class="latex" /> is the action of the least-action path from the position <img src="https://s0.wp.com/latex.php?latex=q_0&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q_0" class="latex" /> at some earlier time <img src="https://s0.wp.com/latex.php?latex=t_0&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="t_0" class="latex" /> to the position <img src="https://s0.wp.com/latex.php?latex=q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q" class="latex" /> at time 0.   The Hamilton&#8211;Jacobi equations say the particle&#8217;s momentum <img src="https://s0.wp.com/latex.php?latex=p&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p" class="latex" /> at time 0 is given by</p>
<p><img src="https://s0.wp.com/latex.php?latex=p+%3D+%28df%29_q+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p = (df)_q " class="latex" /></p>
<p><b>Thermodynamics.</b>  In thermodynamics, we have a manifold <img src="https://s0.wp.com/latex.php?latex=Q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Q" class="latex" /> whose points are equilibrium states of a system.  The coordinates of a point <img src="https://s0.wp.com/latex.php?latex=q+%5Cin+Q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q &#92;in Q" class="latex" /> are called <b>extensive variables</b>.   There&#8217;s an important function on this manifold: the <b>entropy</b></p>
<p><img src="https://s0.wp.com/latex.php?latex=f+%5Ccolon+Q+%5Cto+%5Cmathbb%7BR%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="f &#92;colon Q &#92;to &#92;mathbb{R}" class="latex" /></p>
<p>There is a cotangent vector <img src="https://s0.wp.com/latex.php?latex=p&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p" class="latex" /> at the point <img src="https://s0.wp.com/latex.php?latex=q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q" class="latex" /> given by</p>
<p><img src="https://s0.wp.com/latex.php?latex=p+%3D+%28df%29_q+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p = (df)_q " class="latex" /></p>
<p>The components of this vector are the <b>intensive variables</b> corresponding to the extensive variables.</p>
<p><b>Probability Theory.</b>  In probability theory, we have a manifold <img src="https://s0.wp.com/latex.php?latex=Q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Q" class="latex" /> whose points are nowhere vanishing probability distributions on a finite set.   The coordinates of a point <img src="https://s0.wp.com/latex.php?latex=q+%5Cin+Q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q &#92;in Q" class="latex" /> are <b>probabilities</b>.   There&#8217;s an important function on this manifold: the <b>Shannon entropy</b></p>
<p><img src="https://s0.wp.com/latex.php?latex=f+%5Ccolon+Q+%5Cto+%5Cmathbb%7BR%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="f &#92;colon Q &#92;to &#92;mathbb{R}" class="latex" /></p>
<p>There is a cotangent vector <img src="https://s0.wp.com/latex.php?latex=p&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p" class="latex" /> at the point <img src="https://s0.wp.com/latex.php?latex=q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q" class="latex" /> given by</p>
<p><img src="https://s0.wp.com/latex.php?latex=p+%3D+%28df%29_q+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p = (df)_q " class="latex" /></p>
<p>The components of this vector are the <b>surprisals</b> corresponding to the probabilities.</p>
<p>In all three cases, <img src="https://s0.wp.com/latex.php?latex=T%5E%5Cast+Q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T^&#92;ast Q" class="latex" /> is a symplectic manifold and imposing the constraint <img src="https://s0.wp.com/latex.php?latex=p+%3D+%28df%29_q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p = (df)_q" class="latex" /> picks out a Lagrangian submanifold</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5CLambda+%3D+%5C%7B+%28q%2Cp%29+%5Cin+T%5E%5Cast+Q%3A+%5C%3B+p+%3D+%28df%29_q+%5C%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Lambda = &#92;{ (q,p) &#92;in T^&#92;ast Q: &#92;; p = (df)_q &#92;} " class="latex" /></p>
<p>There is also a contact manifold <img src="https://s0.wp.com/latex.php?latex=T%5E%5Cast+Q+%5Ctimes+%5Cmathbb%7BR%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T^&#92;ast Q &#92;times &#92;mathbb{R}" class="latex" /> where the extra dimension comes with an extra coordinate <img src="https://s0.wp.com/latex.php?latex=S&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S" class="latex" /> that means</p>
<p>• action in classical mechanics,<br />
• entropy in thermodynamics, and<br />
• Shannon entropy in probability theory.</p>
<p>We can then decree that <img src="https://s0.wp.com/latex.php?latex=S+%3D+f%28q%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S = f(q)" class="latex" /> along with <img src="https://s0.wp.com/latex.php?latex=p+%3D+%28df%29_q%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p = (df)_q," class="latex" /> and these constraints pick out a Legendrian submanifold</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5CSigma+%3D+%5C%7B%28q%2Cp%2CS%29+%5Cin+T%5E%5Cast+Q+%5Ctimes+%5Cmathbb%7BR%7D+%3A+%5C%3B+S+%3D+f%28q%29%2C+%5C%3B+p+%3D+%28df%29_q+%5C%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Sigma = &#92;{(q,p,S) &#92;in T^&#92;ast Q &#92;times &#92;mathbb{R} : &#92;; S = f(q), &#92;; p = (df)_q &#92;} " class="latex" /></p>
<p>There&#8217;s a lot more to do with these ideas, and I&#8217;ll continue next time.</p>
<hr />
<p>For all my old posts on information geometry, go here:</p>
<p>• <a href="https://math.ucr.edu/home/baez/information/">Information geometry</a>.</p>
]]></content:encoded>
					
					<wfw:commentRss>https://johncarlosbaez.wordpress.com/2021/08/08/information-geometry-part-19/feed/</wfw:commentRss>
			<slash:comments>29</slash:comments>
		
		
		
		<media:thumbnail url="https://johncarlosbaez.files.wordpress.com/2021/08/simplex.png" />
		<media:content url="https://johncarlosbaez.files.wordpress.com/2021/08/simplex.png" medium="image">
			<media:title type="html">simplex</media:title>
		</media:content>

		<media:content url="https://0.gravatar.com/avatar/34784534843022b3541c8ddd693718cb?s=96&#38;d=identicon&#38;r=G" medium="image">
			<media:title type="html">John Baez</media:title>
		</media:content>
	</item>
		<item>
		<title>Information Geometry (Part 18)</title>
		<link>https://johncarlosbaez.wordpress.com/2021/08/05/information-geometry-part-18/</link>
					<comments>https://johncarlosbaez.wordpress.com/2021/08/05/information-geometry-part-18/#comments</comments>
		
		<dc:creator><![CDATA[John Baez]]></dc:creator>
		<pubDate>Thu, 05 Aug 2021 16:17:37 +0000</pubDate>
				<category><![CDATA[information and entropy]]></category>
		<category><![CDATA[mathematics]]></category>
		<category><![CDATA[physics]]></category>
		<category><![CDATA[probability]]></category>
		<guid isPermaLink="false">http://johncarlosbaez.wordpress.com/?p=31321</guid>

					<description><![CDATA[Last time I sketched how two related forms of geometry, symplectic and contact geometry, show up in thermodynamics. Today I want to explain how they show up in probability theory. For some reason I haven&#8217;t seen much discussion of this! But people should have looked into this. After all, statistical mechanics explains thermodynamics in terms [&#8230;]]]></description>
										<content:encoded><![CDATA[<p><a href="https://johncarlosbaez.wordpress.com/2021/07/27/information-geometry-part-17/">Last time</a> I sketched how two related forms of geometry, <a href="https://en.wikipedia.org/wiki/Symplectic_geometry">symplectic</a> and <a href="https://en.wikipedia.org/wiki/Contact_geometry">contact</a> geometry, show up in thermodynamics.  Today I want to explain how they show up in probability theory.</p>
<p>For some reason I haven&#8217;t seen much discussion of this!  But people should have looked into this.  After all, statistical mechanics explains thermodynamics in terms of probability theory, so if some mathematical structure shows up in thermodynamics it should appear in statistical mechanics&#8230; and thus ultimately in probability theory.</p>
<p>I just figured out how this works for symplectic and contact geometry.</p>
<p>Suppose a system has <img src="https://s0.wp.com/latex.php?latex=n&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="n" class="latex" /> possible states.  We&#8217;ll call these <b><a href="https://en.wikipedia.org/wiki/Microstate_(statistical_mechanics)">microstates</a></b>, following the tradition in statistical mechanics.   If you don&#8217;t know what &#8216;microstate&#8217; means, don&#8217;t worry about it!  But the rough idea is that if you have a macroscopic system like a rock, the precise details of what its atoms are doing are described by a microstate, and many different microstates could be indistinguishable unless you look very carefully.</p>
<p>We&#8217;ll call the microstates <img src="https://s0.wp.com/latex.php?latex=1%2C+2%2C+%5Cdots%2C+n.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="1, 2, &#92;dots, n." class="latex" />  So, if you don&#8217;t want to think about physics, when I say <b>microstate</b> I&#8217;ll just mean an integer from 1 to <em>n</em>.</p>
<p>Next, a <b>probability distribution</b> <img src="https://s0.wp.com/latex.php?latex=q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q" class="latex" /> assigns a real number <img src="https://s0.wp.com/latex.php?latex=q_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q_i" class="latex" /> to each microstate, and these numbers must sum to 1 and be nonnegative.  So, we have <img src="https://s0.wp.com/latex.php?latex=q+%5Cin+%5Cmathbb%7BR%7D%5En%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q &#92;in &#92;mathbb{R}^n," class="latex" /> though not every vector in <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5En&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^n" class="latex" /> is a probability distribution.</p>
<p>I&#8217;m sure you&#8217;re wondering why I&#8217;m using <img src="https://s0.wp.com/latex.php?latex=q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q" class="latex" /> rather than <img src="https://s0.wp.com/latex.php?latex=p&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p" class="latex" /> to stand for an observable instead of a probability distribution.   Am I just trying to confuse you?</p>
<p>No: I&#8217;m trying to set up an analogy to physics!</p>
<p><a href="https://johncarlosbaez.wordpress.com/2021/07/27/information-geometry-part-17/">Last time</a> I introduced symplectic geometry using classical mechanics.  The most important example of a symplectic manifold is the cotangent bundle <img src="https://s0.wp.com/latex.php?latex=T%5E%5Cast+Q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T^&#92;ast Q" class="latex" /> of a manifold <img src="https://s0.wp.com/latex.php?latex=Q.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Q." class="latex" />   A point of <img src="https://s0.wp.com/latex.php?latex=T%5E%5Cast+Q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T^&#92;ast Q" class="latex" /> is a pair <img src="https://s0.wp.com/latex.php?latex=%28q%2Cp%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(q,p)" class="latex" /> consisting of a point <img src="https://s0.wp.com/latex.php?latex=q+%5Cin+Q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q &#92;in Q" class="latex" /> and a cotangent vector <img src="https://s0.wp.com/latex.php?latex=p+%5Cin+T%5E%5Cast_q+Q.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p &#92;in T^&#92;ast_q Q." class="latex" />  In classical mechanics the point <img src="https://s0.wp.com/latex.php?latex=q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q" class="latex" /> describes the position of some physical system, while <img src="https://s0.wp.com/latex.php?latex=p&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p" class="latex" /> describes its momentum.</p>
<p>So, I&#8217;m going to set up an analogy like this:</p>
<div align="center">
<table border="1">
<tr>
<td> </td>
<td style="text-align:center;">&nbsp;<b>Classical Mechanics</b>&nbsp;</td>
<td style="text-align:center;"><b>Probability Theory</b></td>
</tr>
<tr>
<td>&nbsp; <img src="https://s0.wp.com/latex.php?latex=q+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q " class="latex" /> &nbsp; </td>
<td style="text-align:center;">position</td>
<td style="text-align:center;">&nbsp; probability distribution &nbsp; </td>
</tr>
<tr>
<td>&nbsp; <img src="https://s0.wp.com/latex.php?latex=p&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p" class="latex" /> &nbsp;</td>
<td style="text-align:center;">momentum</td>
<td style="text-align:center;">???</td>
</tr>
</table>
</div>
<p>But <i>what is to momentum as probability is to position?</i></p>
<p>A big clue is the appearance of symplectic geometry in thermodynamics, which I also outlined <a href="https://johncarlosbaez.wordpress.com/2021/07/27/information-geometry-part-17/">last time</a>.    We can use this to get some intuition about the analogue of momentum in probability theory.</p>
<p>In thermodynamics, a system has a manifold <img src="https://s0.wp.com/latex.php?latex=Q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Q" class="latex" /> of states.  (These are not the &#8216;microstates&#8217; I mentioned before: we&#8217;ll see the relation later.)  There is a function</p>
<p><img src="https://s0.wp.com/latex.php?latex=f+%5Ccolon+Q+%5Cto+%5Cmathbb%7BR%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="f &#92;colon Q &#92;to &#92;mathbb{R} " class="latex" /></p>
<p>describing the <a href="https://en.wikipedia.org/wiki/Entropy">entropy</a> of the system as a function of its state.   There is a law of thermodynamics saying that</p>
<p><img src="https://s0.wp.com/latex.php?latex=p+%3D+%28df%29_q+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p = (df)_q " class="latex" /></p>
<p>This equation picks out a submanifold of <img src="https://s0.wp.com/latex.php?latex=T%5E%5Cast+Q%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T^&#92;ast Q," class="latex" /> namely</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5CLambda+%3D+%5C%7B%28q%2Cp%29+%5Cin+T%5E%5Cast+Q+%3A+%5C%3B+p+%3D+%28df%29_q+%5C%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Lambda = &#92;{(q,p) &#92;in T^&#92;ast Q : &#92;; p = (df)_q &#92;} " class="latex" /></p>
<p>Moreover this submanifold is Lagrangian: the symplectic structure <img src="https://s0.wp.com/latex.php?latex=%5Comega&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;omega" class="latex" /> vanishes when restricted to it:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Comega+%7C_%5CLambda+%3D+0+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;omega |_&#92;Lambda = 0 } " class="latex" /></p>
<p>This is very beautiful, but it goes by so fast you might almost miss it!   So let&#8217;s clutter it up a bit with coordinates.  We often use local coordinates on <img src="https://s0.wp.com/latex.php?latex=Q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Q" class="latex" /> and describe a point <img src="https://s0.wp.com/latex.php?latex=q+%5Cin+Q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q &#92;in Q" class="latex" /> using these coordinates, getting a point</p>
<p><img src="https://s0.wp.com/latex.php?latex=%28q_1%2C+%5Cdots%2C+q_n%29+%5Cin+%5Cmathbb%7BR%7D%5En+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(q_1, &#92;dots, q_n) &#92;in &#92;mathbb{R}^n " class="latex" /></p>
<p>They give rise to local coordinates <img src="https://s0.wp.com/latex.php?latex=q_1%2C+%5Cdots%2C+q_n%2C+p_1%2C+%5Cdots%2C+p_n&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q_1, &#92;dots, q_n, p_1, &#92;dots, p_n" class="latex" /> on the cotangent bundle <img src="https://s0.wp.com/latex.php?latex=T%5E%5Cast+Q.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T^&#92;ast Q." class="latex" />   The <img src="https://s0.wp.com/latex.php?latex=q_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q_i" class="latex" /> are called <b>extensive variables</b>, because they are typically things that you can measure only by totalling up something over the whole system, like the energy or volume of a cylinder of gas.   The <img src="https://s0.wp.com/latex.php?latex=p_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p_i" class="latex" /> are called <b>intensive variables</b>, because they are typically things that you can measure locally at any point, like temperature or pressure.</p>
<p>In these local coordinates, the symplectic structure on <img src="https://s0.wp.com/latex.php?latex=T%5E%5Cast+Q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T^&#92;ast Q" class="latex" /> is the 2-form given by</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Comega+%3D+dp_1+%5Cwedge+dq_1+%2B+%5Ccdots+%2B+dp_n+%5Cwedge+dq_n+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;omega = dp_1 &#92;wedge dq_1 + &#92;cdots + dp_n &#92;wedge dq_n " class="latex" /></p>
<p>The equation</p>
<p><img src="https://s0.wp.com/latex.php?latex=p+%3D+%28df%29_q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p = (df)_q" class="latex" /></p>
<p>serves as a law of physics that determines the intensive variables given the extensive ones when our system is in thermodynamic equilibrium.   Written out using coordinates, this law says</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+p_i+%3D+%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+q_i%7D+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ p_i = &#92;frac{&#92;partial f}{&#92;partial q_i} } " class="latex" /></p>
<p>It looks pretty bland here, but in fact it gives formulas for the temperature and pressure of a gas, and many other useful formulas in thermodynamics.</p>
<p>Now we are ready to see how all this plays out in probability theory!  We&#8217;ll get an analogy like this, which goes hand-in-hand with our earlier one:</p>
<div align="center">
<table border="1">
<tr>
<td> </td>
<td style="text-align:center;">&nbsp;<b>Thermodynamics</b>&nbsp;</td>
<td style="text-align:center;">&nbsp;<b>Probability Theory</b>&nbsp;</td>
</tr>
<tr>
<td>&nbsp; <img src="https://s0.wp.com/latex.php?latex=q+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q " class="latex" /> &nbsp; </td>
<td style="text-align:center;">extensive variables</td>
<td style="text-align:center;">&nbsp; probability distribution &nbsp; </td>
</tr>
<tr>
<td>&nbsp; <img src="https://s0.wp.com/latex.php?latex=p&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p" class="latex" /> &nbsp;</td>
<td style="text-align:center;">intensive variables</td>
<td style="text-align:center;">???</td>
</tr>
</table>
</div>
<p>This analogy is clearer than the last, because statistical mechanics reveals that the extensive variables in thermodynamics are really just summaries of probability distributions on microstates.  Furthermore, both thermodynamics and probability theory have a concept of <i>entropy</i>.</p>
<p>So, let&#8217;s take our manifold <img src="https://s0.wp.com/latex.php?latex=Q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Q" class="latex" /> to consist of probability distributions on the set of microstates I was talking about before: the set <img src="https://s0.wp.com/latex.php?latex=%5C%7B1%2C+%5Cdots%2C+n%5C%7D.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;{1, &#92;dots, n&#92;}." class="latex" />   Actually, let&#8217;s use <i>nowhere vanishing</i> probability distributions:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+Q+%3D+%5C%7B+q+%5Cin+%5Cmathbb%7BR%7D%5En+%3A+%5C%3B+q_i+%3E+0%2C+%5C%3B+%5Csum_%7Bi%3D1%7D%5En+q_i+%3D+1+%5C%7D+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ Q = &#92;{ q &#92;in &#92;mathbb{R}^n : &#92;; q_i &gt; 0, &#92;; &#92;sum_{i=1}^n q_i = 1 &#92;} } " class="latex" /></p>
<p>I&#8217;m requiring <img src="https://s0.wp.com/latex.php?latex=q_i+%3E+0&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q_i &gt; 0" class="latex" /> to ensure <img src="https://s0.wp.com/latex.php?latex=Q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Q" class="latex" /> is a manifold, and also to make sure <img src="https://s0.wp.com/latex.php?latex=f&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="f" class="latex" /> is differentiable: it ceases to be differentiable when one of the probabilities <img src="https://s0.wp.com/latex.php?latex=q_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q_i" class="latex" /> hits zero.</p>
<p>Since <img src="https://s0.wp.com/latex.php?latex=Q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Q" class="latex" /> is a manifold, its cotangent bundle is a symplectic manifold <img src="https://s0.wp.com/latex.php?latex=T%5E%5Cast+Q.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T^&#92;ast Q." class="latex" />   And here&#8217;s the good news: we have a god-given entropy function</p>
<p><img src="https://s0.wp.com/latex.php?latex=f+%5Ccolon+Q+%5Cto+%5Cmathbb%7BR%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="f &#92;colon Q &#92;to &#92;mathbb{R} " class="latex" /></p>
<p>namely the <b><a href="https://en.wikipedia.org/wiki/Entropy_(information_theory)">Shannon entropy</a></b></p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+f%28q%29+%3D+-+%5Csum_%7Bi+%3D+1%7D%5En+q_i+%5Cln+q_i+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ f(q) = - &#92;sum_{i = 1}^n q_i &#92;ln q_i } " class="latex" /></p>
<p>So, everything I just described about thermodynamics works in the setting of plain old probability theory!  Starting from our manifold <img src="https://s0.wp.com/latex.php?latex=Q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Q" class="latex" /> and the entropy function, we get all the rest, leading up to the Lagrangian submanifold</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5CLambda+%3D+%5C%7B%28q%2Cp%29+%5Cin+T%5E%5Cast+Q+%3A+%5C%3B+p+%3D+%28df%29_q+%5C%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Lambda = &#92;{(q,p) &#92;in T^&#92;ast Q : &#92;; p = (df)_q &#92;} " class="latex" /></p>
<p>that describes the relation between extensive and intensive variables.</p>
<p>For computations it helps to pick coordinates on <img src="https://s0.wp.com/latex.php?latex=Q.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Q." class="latex" />   Since the probabilities <img src="https://s0.wp.com/latex.php?latex=q_1%2C+%5Cdots%2C+q_n&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q_1, &#92;dots, q_n" class="latex" /> sum to 1, they aren&#8217;t independent coordinates on <img src="https://s0.wp.com/latex.php?latex=Q.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Q." class="latex" />   So, we can either pick all but one of them as coordinates, or learn how to deal with non-independent coordinates, which are already completely standard in <a href="https://en.wikipedia.org/wiki/Homogeneous_coordinates">projective geometry</a>.  Let&#8217;s do the former, just to keep things simple.</p>
<p>These coordinates on <img src="https://s0.wp.com/latex.php?latex=Q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Q" class="latex" /> give rise in the usual way to coordinates <img src="https://s0.wp.com/latex.php?latex=q_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q_i" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=p_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p_i" class="latex" /> on the cotangent bundle <img src="https://s0.wp.com/latex.php?latex=T%5E%5Cast+Q.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T^&#92;ast Q." class="latex" />   These play the role of extensive and intensive variables, respectively, and it should be very interesting to impose the equation</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+p_i+%3D+%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+q_i%7D+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ p_i = &#92;frac{&#92;partial f}{&#92;partial q_i} } " class="latex" /></p>
<p>where <img src="https://s0.wp.com/latex.php?latex=f&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="f" class="latex" /> is the Shannon entropy.   This picks out a Lagrangian submanifold <img src="https://s0.wp.com/latex.php?latex=%5CLambda+%5Csubseteq+T%5E%5Cast+Q.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Lambda &#92;subseteq T^&#92;ast Q." class="latex" /></p>
<p>So, the question becomes: what does this mean?  If this formula gives the analogue of momentum for probability theory, what does this analogue of momentum <i>mean?</i></p>
<p>Here&#8217;s a preliminary answer: <img src="https://s0.wp.com/latex.php?latex=p_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p_i" class="latex" /> says how fast entropy increases as we increase the probability <img src="https://s0.wp.com/latex.php?latex=q_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q_i" class="latex" /> that our system is in the <i>i</i>th microstate.  So if we think of nature as &#8216;wanting&#8217; to maximize entropy, the quantity <img src="https://s0.wp.com/latex.php?latex=p_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p_i" class="latex" /> says how eager it is to increase the probability <img src="https://s0.wp.com/latex.php?latex=q_i.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q_i." class="latex" /></p>
<p>Indeed, you can think of <img src="https://s0.wp.com/latex.php?latex=p_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p_i" class="latex" /> as a bit like <i>pressure</i>&#8212;one of the most famous intensive quantities in thermodynamics.   A gas &#8216;wants&#8217; to expand, and its pressure says precisely how eager it is to expand.   Similarly, a probability distribution &#8216;wants&#8217; to flatten out, to maximize entropy, and <img src="https://s0.wp.com/latex.php?latex=p_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p_i" class="latex" /> says how eager it is to increase the probability <img src="https://s0.wp.com/latex.php?latex=q_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q_i" class="latex" /> in order to do this.</p>
<p>But what can we <i>do</i> with this concept?  And what does symplectic geometry <i>do</i> for probability theory?</p>
<p>I will start tackling these questions next time.</p>
<p>One thing I&#8217;ll show is that when we reduce thermodynamics to probability theory using the ideas of statistical mechanics, the appearance of symplectic geometry in thermodynamics <i>follows</i> from its appearance in probability theory.</p>
<p>Another thing I want to investigate is how other geometrical structures on the space of probability distributions, like the <a href="https://math.ucr.edu/home/baez/information/information_geometry_1.html">Fisher information metric</a>, interact with the symplectic structure on its cotangent bundle.   This will integrate symplectic geometry and information geometry.</p>
<p>I also want to bring contact geometry into the picture.  It&#8217;s already easy to see from our work last time how this should go.  We treat the entropy <img src="https://s0.wp.com/latex.php?latex=S&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S" class="latex" /> as an independent variable, and replace <img src="https://s0.wp.com/latex.php?latex=T%5E%5Cast+Q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T^&#92;ast Q" class="latex" /> with a larger manifold <img src="https://s0.wp.com/latex.php?latex=T%5E%5Cast+Q+%5Ctimes+%5Cmathbb%7BR%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T^&#92;ast Q &#92;times &#92;mathbb{R}" class="latex" /> having <img src="https://s0.wp.com/latex.php?latex=S&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S" class="latex" /> as an extra coordinate.  This is a contact manifold with contact form</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Calpha+%3D+-dS+%2B+p_1+dq_i+%2B+%5Ccdots+%2B+p_n+dq_n+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;alpha = -dS + p_1 dq_i + &#92;cdots + p_n dq_n " class="latex" /></p>
<p>This contact manifold has a submanifold <img src="https://s0.wp.com/latex.php?latex=%5CSigma&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Sigma" class="latex" /> where we remember that entropy is a function of the probability distribution <img src="https://s0.wp.com/latex.php?latex=q%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q," class="latex" /> and define <img src="https://s0.wp.com/latex.php?latex=p&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p" class="latex" /> in terms of <img src="https://s0.wp.com/latex.php?latex=q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q" class="latex" /> as usual:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5CSigma+%3D+%5C%7B%28q%2Cp%2CS%29+%5Cin+T%5E%5Cast+Q+%5Ctimes+%5Cmathbb%7BR%7D+%3A+%5C%3B+S+%3D+f%28q%29%2C+%5C%3B+p+%3D+%28df%29_q+%5C%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Sigma = &#92;{(q,p,S) &#92;in T^&#92;ast Q &#92;times &#92;mathbb{R} : &#92;; S = f(q), &#92;; p = (df)_q &#92;} " class="latex" /></p>
<p>And as we saw last time, <img src="https://s0.wp.com/latex.php?latex=%5CSigma&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Sigma" class="latex" /> is a Legendrian submanifold, meaning</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Calpha%7C_%7B%5CSigma%7D+%3D+0+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;alpha|_{&#92;Sigma} = 0 } " class="latex" /></p>
<p>But again, we want to understand what these ideas from contact geometry really <i>do</i> for probability theory!</p>
<hr />
<p>For all my old posts on information geometry, go here:</p>
<p>• <a href="https://math.ucr.edu/home/baez/information/">Information geometry</a>.</p>
]]></content:encoded>
					
					<wfw:commentRss>https://johncarlosbaez.wordpress.com/2021/08/05/information-geometry-part-18/feed/</wfw:commentRss>
			<slash:comments>2</slash:comments>
		
		
		
		<media:thumbnail url="https://johncarlosbaez.files.wordpress.com/2021/08/simplex.png" />
		<media:content url="https://johncarlosbaez.files.wordpress.com/2021/08/simplex.png" medium="image">
			<media:title type="html">simplex</media:title>
		</media:content>

		<media:content url="https://0.gravatar.com/avatar/34784534843022b3541c8ddd693718cb?s=96&#38;d=identicon&#38;r=G" medium="image">
			<media:title type="html">John Baez</media:title>
		</media:content>
	</item>
		<item>
		<title>Information Geometry (Part 17)</title>
		<link>https://johncarlosbaez.wordpress.com/2021/07/27/information-geometry-part-17/</link>
					<comments>https://johncarlosbaez.wordpress.com/2021/07/27/information-geometry-part-17/#comments</comments>
		
		<dc:creator><![CDATA[John Baez]]></dc:creator>
		<pubDate>Tue, 27 Jul 2021 00:52:57 +0000</pubDate>
				<category><![CDATA[information and entropy]]></category>
		<category><![CDATA[physics]]></category>
		<category><![CDATA[probability]]></category>
		<guid isPermaLink="false">http://johncarlosbaez.wordpress.com/?p=31330</guid>

					<description><![CDATA[I&#8217;m getting back into information geometry, which is the geometry of the space of probability distributions, studied using tools from information theory. I&#8217;ve written a bunch about it already, which you can see here: • Information geometry. Now I&#8217;m fascinated by something new: how symplectic geometry and contact geometry show up in information geometry. But [&#8230;]]]></description>
										<content:encoded><![CDATA[<p>I&#8217;m getting back into information geometry, which is the geometry of the space of probability distributions, studied using tools from information theory.  I&#8217;ve written a bunch about it already, which you can see here:</p>
<p>• <a href="https://math.ucr.edu/home/baez/information/">Information geometry</a>.</p>
<p>Now I&#8217;m fascinated by something new: how <a href="https://en.wikipedia.org/wiki/Symplectic_geometry">symplectic geometry</a> and <a href="https://en.wikipedia.org/wiki/Contact_geometry">contact geometry</a> show up in information geometry.   But before I say anything about this, let me say a bit about how they show up in thermodynamics.  This is more widely discussed, and it&#8217;s a good starting point.</p>
<p>Symplectic geometry was born as the geometry of <a href="https://en.wikipedia.org/wiki/Phase_space">phase space</a> in classical mechanics: that is, the space of possible positions and momenta of a classical system.  The simplest example of a symplectic manifold is the vector space <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5E%7B2n%7D%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^{2n}," class="latex" /> with <i>n</i> position coordinates <img src="https://s0.wp.com/latex.php?latex=q_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q_i" class="latex" /> and <i>n</i> momentum coordinates <img src="https://s0.wp.com/latex.php?latex=p_i.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p_i." class="latex" /></p>
<p>It turns out that symplectic manifolds are always even-dimensional, because we can always cover them with coordinate charts that look like <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5E%7B2n%7D.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^{2n}." class="latex" />  When we change coordinates, it turns out that the splitting of coordinates into positions and momenta is somewhat arbitrary.  For example, the position of a rock on a spring now may determine its momentum a while later, and vice versa.   What&#8217;s not arbitrary?  It&#8217;s the so-called &#8216;<a href="https://en.wikipedia.org/wiki/Symplectic_manifold#Definition">symplectic structure</a>’:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Comega+%3D+dp_1+%5Cwedge+dq_1+%2B+%5Ccdots+%2B+dp_n+%5Cwedge+dq_n+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;omega = dp_1 &#92;wedge dq_1 + &#92;cdots + dp_n &#92;wedge dq_n " class="latex" /></p>
<p>While far from obvious at first, we know by now that the symplectic structure is exactly what needs to be preserved under valid changes of coordinates in classical mechanics!  In fact, we can develop the whole formalism of classical mechanics starting from a manifold with a symplectic structure.</p>
<p>Symplectic geometry also shows up in thermodynamics.  In thermodynamics we can start with a system in equilibrium whose state is described by some variables <img src="https://s0.wp.com/latex.php?latex=q_1%2C+%5Cdots%2C+q_n.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q_1, &#92;dots, q_n." class="latex" />  Its entropy will be a function of these variables, say</p>
<p><img src="https://s0.wp.com/latex.php?latex=S+%3D+f%28q_1%2C+%5Cdots%2C+q_n%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S = f(q_1, &#92;dots, q_n)" class="latex" /></p>
<p>We can then take the partial derivatives of entropy and call them something:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+p_i+%3D+%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+q_i%7D+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ p_i = &#92;frac{&#92;partial f}{&#92;partial q_i} } " class="latex" /></p>
<p>These new variables <img src="https://s0.wp.com/latex.php?latex=p_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p_i" class="latex" /> are said to be &#8216;<a href="https://en.wikipedia.org/wiki/Conjugate_variables_(thermodynamics)">conjugate</a>’ to the <img src="https://s0.wp.com/latex.php?latex=q_i%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q_i," class="latex" /> and they turn out to be very interesting.  For example, if <img src="https://s0.wp.com/latex.php?latex=q_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q_i" class="latex" /> is energy then <img src="https://s0.wp.com/latex.php?latex=p_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p_i" class="latex" /> is &#8216;coolness&#8217;: the reciprocal of temperature.  The coolness of a system is its change in entropy per change in energy.</p>
<p>Often the variables <img src="https://s0.wp.com/latex.php?latex=q_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q_i" class="latex" /> are &#8216;<a href="https://en.wikipedia.org/wiki/Intensive_and_extensive_properties#Extensive_properties">extensive</a>’: that is, you can measure them only by looking at your whole system and totaling up some quantity.  Examples are energy and volume.  Then the new variables <img src="https://s0.wp.com/latex.php?latex=p_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p_i" class="latex" /> are &#8216;<a href="https://en.wikipedia.org/wiki/Intensive_and_extensive_properties#Intensive_properties">intensive</a>’: that is, you can measure them at any one location in your system.   Examples are coolness and pressure.</p>
<p>Now for a twist: sometimes we do not know the function <img src="https://s0.wp.com/latex.php?latex=f&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="f" class="latex" /> ahead of time.   Then we cannot define the <img src="https://s0.wp.com/latex.php?latex=p_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p_i" class="latex" /> as above.  We&#8217;re forced into a different approach where we treat them as independent quantities, at least until someone tells us what <img src="https://s0.wp.com/latex.php?latex=f&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="f" class="latex" /> is.</p>
<p>In this approach, we start with a space <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5E%7B2n%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^{2n}" class="latex" /> having <i>n</i> coordinates called <img src="https://s0.wp.com/latex.php?latex=q_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q_i" class="latex" /> and <i>n</i> coordinates called <img src="https://s0.wp.com/latex.php?latex=p_i.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p_i." class="latex" />   This is a symplectic manifold, with the symplectic struture <img src="https://s0.wp.com/latex.php?latex=%5Comega&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;omega" class="latex" /> described earlier!</p>
<p>But what about the entropy?   We don&#8217;t yet know what it is as a function of the <img src="https://s0.wp.com/latex.php?latex=q_i%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q_i," class="latex" /> but we may still want to talk about it.  So, we build a space <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5E%7B2n%2B1%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^{2n+1}" class="latex" /> having one extra coordinate <img src="https://s0.wp.com/latex.php?latex=S&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S" class="latex" /> in addition to the <img src="https://s0.wp.com/latex.php?latex=q_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q_i" class="latex" /> and <img src="https://s0.wp.com/latex.php?latex=p_i.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p_i." class="latex" />  This new coordinate stands for entropy.  And this new space has an important 1-form on it:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Calpha+%3D+-dS+%2B+p_1+dq_i+%2B+%5Ccdots+%2B+p_n+dq_n+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;alpha = -dS + p_1 dq_i + &#92;cdots + p_n dq_n " class="latex" /></p>
<p>This is called the &#8216;contact 1-form&#8217;.</p>
<p>This makes <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5E%7B2n%2B1%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^{2n+1}" class="latex" /> into an example of a &#8216;contact manifold&#8217;.  Contact geometry is the odd-dimensional partner of symplectic geometry.  Just as symplectic manifolds are always even-dimensional, contact manifolds are always odd-dimensional.</p>
<p>What is the point of the contact 1-form?  Well, suppose someone tells us the function <img src="https://s0.wp.com/latex.php?latex=f&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="f" class="latex" /> relating entropy to the coordinates <img src="https://s0.wp.com/latex.php?latex=q_i.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q_i." class="latex" />   Now we know that we want</p>
<p><img src="https://s0.wp.com/latex.php?latex=S+%3D+f&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S = f" class="latex" /></p>
<p>and also</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+p_i+%3D+%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+q_i%7D+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ p_i = &#92;frac{&#92;partial f}{&#92;partial q_i} }" class="latex" /></p>
<p>So, we can impose these equations, which pick out a subset of <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5E%7B2n%2B1%7D.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^{2n+1}." class="latex" />   You can check that this subset, say <img src="https://s0.wp.com/latex.php?latex=%5CSigma%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Sigma," class="latex" /> is an <i>n</i>-dimensional submanifold.  But even better, the contact 1-form vanishes when restricted to this submanifold:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cleft.%5Calpha%5Cright%7C_%5CSigma+%3D+0+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;left.&#92;alpha&#92;right|_&#92;Sigma = 0 " class="latex" /></p>
<p>Let&#8217;s see why!   Suppose <img src="https://s0.wp.com/latex.php?latex=x+%5Cin+%5CSigma&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x &#92;in &#92;Sigma" class="latex" /> and suppose <img src="https://s0.wp.com/latex.php?latex=v+%5Cin+T_x+%5CSigma&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="v &#92;in T_x &#92;Sigma" class="latex" /> is a vector tangent to <img src="https://s0.wp.com/latex.php?latex=%5CSigma&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Sigma" class="latex" /> at this point <img src="https://s0.wp.com/latex.php?latex=x&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x" class="latex" />.  It suffices to show</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Calpha%28v%29+%3D+0&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;alpha(v) = 0" class="latex" /></p>
<p>Using the definition of <img src="https://s0.wp.com/latex.php?latex=%5Calpha&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;alpha" class="latex" /> this equation says</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+-dS%28v%29+%2B+%5Csum_i+p_i+dq_i%28v%29+%3D+0+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ -dS(v) + &#92;sum_i p_i dq_i(v) = 0 } " class="latex" /></p>
<p>But on the surface <img src="https://s0.wp.com/latex.php?latex=%5CSigma&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Sigma" class="latex" /> we have</p>
<p><img src="https://s0.wp.com/latex.php?latex=S+%3D+f%2C+%5Cqquad++%5Cdisplaystyle%7B+p_i+%3D+%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+q_i%7D+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S = f, &#92;qquad  &#92;displaystyle{ p_i = &#92;frac{&#92;partial f}{&#92;partial q_i} }" class="latex" /></p>
<p>So, the equation we&#8217;re trying to show can be written as</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+-df%28v%29+%2B+%5Csum_i+%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+q_i%7D+dq_i%28v%29+%3D+0+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ -df(v) + &#92;sum_i &#92;frac{&#92;partial f}{&#92;partial q_i} dq_i(v) = 0 }" class="latex" /></p>
<p>But this follows from</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+df+%3D+%5Csum_i+%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+q_i%7D+dq_i+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ df = &#92;sum_i &#92;frac{&#92;partial f}{&#92;partial q_i} dq_i } " class="latex" /></p>
<p>which holds because <img src="https://s0.wp.com/latex.php?latex=f&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="f" class="latex" /> is a function only of the coordinates <img src="https://s0.wp.com/latex.php?latex=q_i.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q_i." class="latex" /></p>
<p>So, any formula for entropy <img src="https://s0.wp.com/latex.php?latex=S+%3D+f%28q_1%2C+%5Cdots%2C+q_n%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S = f(q_1, &#92;dots, q_n)" class="latex" /> picks out a so-called &#8216;Legendrian submanifold&#8217; of <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5E%7B2n%2B1%7D%3A&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^{2n+1}:" class="latex" /> that is, an <i>n</i>-dimensional submanifold such that the contact 1-form vanishes when restricted to this submanifold.  And the idea is that this submanifold tells you everything you need to know about a thermodynamic system.</p>
<p>Indeed, V. I. Arnol&#8217;d says this was implicitly known to the great founder of statistical mechanics, Josiah Willard Gibbs.  Arnol&#8217;d calls <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5E5&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^5" class="latex" /> with coordinates energy, entropy, temperature, pressure and volume the &#8216;Gibbs manifold&#8217;, and he proclaims:</p>
<blockquote><p>
<b>Gibbs&#8217; thesis</b>: substances are Legendrian submanifolds of the Gibbs manifold.</p></blockquote>
<p>This is from here:</p>
<p>• V. I. Arnol&#8217;d, Contact geometry: the geometrical method of Gibbs&#8217; thermodynamics, <i>Proceedings of the Gibbs Symposium (New Haven, CT, 1989)</i>, AMS, Providence, Rhode Island, 1990.</p>
<h3> A bit more detail</h3>
<p>Now I want to say everything again, with a bit of extra detail, assuming more familiarity with manifolds.  Above I was using <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5En&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^n" class="latex" /> with coordinates <img src="https://s0.wp.com/latex.php?latex=q_1%2C+%5Cdots%2C+q_n&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q_1, &#92;dots, q_n" class="latex" /> to describe the &#8216;extensive&#8217; variables of a thermodynamic system.  But let&#8217;s be a bit more general and use any smooth <i>n</i>-dimensional manifold <img src="https://s0.wp.com/latex.php?latex=Q.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Q." class="latex" />  Even if <img src="https://s0.wp.com/latex.php?latex=Q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Q" class="latex" /> is a vector space, this viewpoint is nice because it&#8217;s manifestly coordinate-independent!</p>
<p>So: starting from <img src="https://s0.wp.com/latex.php?latex=Q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Q" class="latex" /> we build the cotangent bundle <img src="https://s0.wp.com/latex.php?latex=T%5E%5Cast+Q.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T^&#92;ast Q." class="latex" />   A point in cotangent describes both extensive variables, namely <img src="https://s0.wp.com/latex.php?latex=q+%5Cin+Q%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q &#92;in Q," class="latex" /> and &#8216;intensive&#8217; variables, namely a cotangent vector <img src="https://s0.wp.com/latex.php?latex=p+%5Cin+T%5E%5Cast_q+Q.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p &#92;in T^&#92;ast_q Q." class="latex" /></p>
<p>The manifold <img src="https://s0.wp.com/latex.php?latex=T%5E%5Cast+Q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T^&#92;ast Q" class="latex" /> has a 1-form <img src="https://s0.wp.com/latex.php?latex=%5Ctheta&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;theta" class="latex" /> on it called the <a href="https://en.wikipedia.org/wiki/Tautological_one-form">tautological 1-form</a>.  We can describe it as follows.  Given a tangent vector <img src="https://s0.wp.com/latex.php?latex=v+%5Cin+T_%7B%28q%2Cp%29%7D+T%5E%5Cast+Q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="v &#92;in T_{(q,p)} T^&#92;ast Q" class="latex" /> we have to say what <img src="https://s0.wp.com/latex.php?latex=%5Ctheta%28v%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;theta(v)" class="latex" /> is.   Using the projection</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cpi+%5Ccolon+T%5E%5Cast+Q+%5Cto+Q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;pi &#92;colon T^&#92;ast Q &#92;to Q" class="latex" /></p>
<p>we can project <img src="https://s0.wp.com/latex.php?latex=v&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="v" class="latex" /> down to a tangent vector <img src="https://s0.wp.com/latex.php?latex=d%5Cpi%28v%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="d&#92;pi(v)" class="latex" /> at the point <img src="https://s0.wp.com/latex.php?latex=q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q" class="latex" />.  But the 1-form <img src="https://s0.wp.com/latex.php?latex=p&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p" class="latex" /> eats tangent vectors at <img src="https://s0.wp.com/latex.php?latex=q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q" class="latex" /> and spits out numbers!  So, we set</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Ctheta%28v%29+%3D+p%28d%5Cpi%28v%29%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;theta(v) = p(d&#92;pi(v))" class="latex" /></p>
<p>This is sort of mind-boggling at first, but it&#8217;s worth pondering until it makes sense.  It helps to work out what <img src="https://s0.wp.com/latex.php?latex=%5Ctheta&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;theta" class="latex" /> looks like in local coordinates.  Starting with any local coordinates <img src="https://s0.wp.com/latex.php?latex=q_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q_i" class="latex" /> on an open set of <img src="https://s0.wp.com/latex.php?latex=Q%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="Q," class="latex" /> we get local coordinates <img src="https://s0.wp.com/latex.php?latex=q_i%2C+p_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q_i, p_i" class="latex" /> on the cotangent bundle of this open set in the usual way.  On this open set you then get</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Ctheta+%3D+p_1+dq_1+%2B+%5Ccdots+%2B+p_n+dq_n+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;theta = p_1 dq_1 + &#92;cdots + p_n dq_n " class="latex" /></p>
<p>This is a standard calculation, which is really worth doing!</p>
<p>It follows that we can define a symplectic structure <img src="https://s0.wp.com/latex.php?latex=%5Comega&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;omega" class="latex" /> by</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Comega+%3D+d+%5Ctheta+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;omega = d &#92;theta " class="latex" /></p>
<p>and get this formula in local coordinates:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Comega+%3D+dp_1+%5Cwedge+dq_1+%2B+%5Ccdots+%2B+dp_n+%5Cwedge+dq_n+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;omega = dp_1 &#92;wedge dq_1 + &#92;cdots + dp_n &#92;wedge dq_n " class="latex" /></p>
<p>Now, suppose we choose a smooth function</p>
<p><img src="https://s0.wp.com/latex.php?latex=f+%5Ccolon+Q+%5Cto+%5Cmathbb%7BR%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="f &#92;colon Q &#92;to &#92;mathbb{R} " class="latex" /></p>
<p>which describes the entropy.   We get a 1-form <img src="https://s0.wp.com/latex.php?latex=df&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="df" class="latex" />, which we can think of as a map</p>
<p><img src="https://s0.wp.com/latex.php?latex=df+%5Ccolon+Q+%5Cto+T%5E%5Cast+Q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="df &#92;colon Q &#92;to T^&#92;ast Q" class="latex" /></p>
<p>assigning to each choice <img src="https://s0.wp.com/latex.php?latex=q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q" class="latex" /> of extensive variables the pair <img src="https://s0.wp.com/latex.php?latex=%28q%2Cp%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(q,p)" class="latex" /> of extensive and intensive variables where</p>
<p><img src="https://s0.wp.com/latex.php?latex=p+%3D+df_q+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p = df_q " class="latex" /></p>
<p>The image of the map <img src="https://s0.wp.com/latex.php?latex=df&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="df" class="latex" /> is a &#8216;<a href="https://en.wikipedia.org/wiki/Symplectic_manifold#Lagrangian_and_other_submanifolds">Lagrangian submanifold</a>&#8216; of <img src="https://s0.wp.com/latex.php?latex=T%5E%5Cast+Q%3A&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T^&#92;ast Q:" class="latex" /> that is, an <i>n</i>-dimensional submanifold <img src="https://s0.wp.com/latex.php?latex=%5CLambda&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Lambda" class="latex" /> such that</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cleft.%5Comega%5Cright%7C_%7B%5CLambda%7D+%3D+0&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;left.&#92;omega&#92;right|_{&#92;Lambda} = 0" class="latex" /></p>
<p>Lagrangian submanifolds are to symplectic geometry as Legendrian submanifolds are to contact geometry!  What we&#8217;re seeing here is that if Gibbs had preferred symplectic geometry, he could have described substances as Lagrangian submanifolds rather than Legendrian submanifolds.  But this approach would only keep track of the derivatives of entropy, <img src="https://s0.wp.com/latex.php?latex=df%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="df," class="latex" /> not the actual value of the entropy function <img src="https://s0.wp.com/latex.php?latex=f.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="f." class="latex" /></p>
<p>If we prefer to keep track of the actual value of <img src="https://s0.wp.com/latex.php?latex=f&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="f" class="latex" /> using contact geometry, we can do that.   For this we add an extra dimension to <img src="https://s0.wp.com/latex.php?latex=T%5E%5Cast+Q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T^&#92;ast Q" class="latex" /> and form the manifold <img src="https://s0.wp.com/latex.php?latex=T%5E%5Cast+Q+%5Ctimes+%5Cmathbb%7BR%7D.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T^&#92;ast Q &#92;times &#92;mathbb{R}." class="latex" />  The extra dimension represents entropy, so we&#8217;ll use <img src="https://s0.wp.com/latex.php?latex=S&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="S" class="latex" /> as our name for the coordinate on <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}." class="latex" /></p>
<p>We can make <img src="https://s0.wp.com/latex.php?latex=T%5E%5Cast+Q+%5Ctimes+%5Cmathbb%7BR%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T^&#92;ast Q &#92;times &#92;mathbb{R}" class="latex" /> into a contact manifold with contact 1-form</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Calpha+%3D+-d+S+%2B+%5Ctheta+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;alpha = -d S + &#92;theta " class="latex" /></p>
<p>In local coordinates we get</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Calpha+%3D+-dS+%2B+p_1+dq_i+%2B+%5Ccdots+%2B+p_n+dq_n+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;alpha = -dS + p_1 dq_i + &#92;cdots + p_n dq_n " class="latex" /></p>
<p>just as we had earlier.   And just as before, if we choose a smooth function <img src="https://s0.wp.com/latex.php?latex=f+%5Ccolon+Q+%5Cto+%5Cmathbb%7BR%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="f &#92;colon Q &#92;to &#92;mathbb{R}" class="latex" /> describing entropy, the subset</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5CSigma+%3D+%5C%7B%28q%2Cp%2CS%29+%5Cin+T%5E%5Cast+Q+%5Ctimes+%5Cmathbb%7BR%7D+%3A+%5C%3B+S+%3D+f%28q%29%2C+%5C%3B+p+%3D+df_q+%5C%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Sigma = &#92;{(q,p,S) &#92;in T^&#92;ast Q &#92;times &#92;mathbb{R} : &#92;; S = f(q), &#92;; p = df_q &#92;} " class="latex" /></p>
<p>is a Legendrian submanifold of <img src="https://s0.wp.com/latex.php?latex=T%5E%5Cast+Q+%5Ctimes+%5Cmathbb%7BR%7D.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="T^&#92;ast Q &#92;times &#92;mathbb{R}." class="latex" /></p>
<p>Okay, this concludes my lightning review of symplectic and contact geometry in thermodynamics!  Next time I&#8217;ll talk about something a bit less well understood: how they show up in statistical mechanics.</p>
]]></content:encoded>
					
					<wfw:commentRss>https://johncarlosbaez.wordpress.com/2021/07/27/information-geometry-part-17/feed/</wfw:commentRss>
			<slash:comments>10</slash:comments>
		
		
		
		<media:thumbnail url="https://johncarlosbaez.files.wordpress.com/2021/07/9116227_orig.jpg" />
		<media:content url="https://johncarlosbaez.files.wordpress.com/2021/07/9116227_orig.jpg" medium="image">
			<media:title type="html">9116227_orig</media:title>
		</media:content>

		<media:content url="https://0.gravatar.com/avatar/34784534843022b3541c8ddd693718cb?s=96&#38;d=identicon&#38;r=G" medium="image">
			<media:title type="html">John Baez</media:title>
		</media:content>
	</item>
		<item>
		<title>Fisher&#8217;s Fundamental Theorem (Part 4)</title>
		<link>https://johncarlosbaez.wordpress.com/2021/07/13/fishers-fundamental-theorem-part-4/</link>
					<comments>https://johncarlosbaez.wordpress.com/2021/07/13/fishers-fundamental-theorem-part-4/#comments</comments>
		
		<dc:creator><![CDATA[John Baez]]></dc:creator>
		<pubDate>Tue, 13 Jul 2021 15:40:16 +0000</pubDate>
				<category><![CDATA[biology]]></category>
		<category><![CDATA[information and entropy]]></category>
		<category><![CDATA[probability]]></category>
		<guid isPermaLink="false">http://johncarlosbaez.wordpress.com/?p=31205</guid>

					<description><![CDATA[I wrote a paper that summarizes my work connecting natural selection to information theory: • John Baez, The fundamental theorem of natural selection. Check it out! If you have any questions or see any mistakes, please let me know. Just for fun, here&#8217;s the abstract and introduction. Abstract. Suppose we have n different types of [&#8230;]]]></description>
										<content:encoded><![CDATA[<p>I wrote a paper that summarizes my work connecting natural selection to information theory:</p>
<p>• John Baez, <a href="https://arxiv.org/abs/2107.05610">The fundamental theorem of natural selection</a>.</p>
<p>Check it out! If you have any questions or see any mistakes, please let me know.</p>
<p>Just for fun, here&#8217;s the abstract and introduction.</p>
<p><strong>Abstract.</strong> Suppose we have <i>n</i> different types of self-replicating entity, with the population <img src="https://s0.wp.com/latex.php?latex=P_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="P_i" class="latex" /> of the <i>i</i>th type changing at a rate equal to <img src="https://s0.wp.com/latex.php?latex=P_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="P_i" class="latex" /> times the fitness <img src="https://s0.wp.com/latex.php?latex=f_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="f_i" class="latex" /> of that type. Suppose the fitness <img src="https://s0.wp.com/latex.php?latex=f_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="f_i" class="latex" /> is any continuous function of all the populations <img src="https://s0.wp.com/latex.php?latex=P_1%2C+%5Cdots%2C+P_n&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="P_1, &#92;dots, P_n" class="latex" />. Let <img src="https://s0.wp.com/latex.php?latex=p_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p_i" class="latex" /> be the fraction of replicators that are of the <i>i</i>th type. Then <img src="https://s0.wp.com/latex.php?latex=p+%3D+%28p_1%2C+%5Cdots%2C+p_n%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p = (p_1, &#92;dots, p_n)" class="latex" /> is a time-dependent probability distribution, and we prove that its speed as measured by the Fisher information metric equals the variance in fitness. In rough terms, this says that the speed at which information is updated through natural selection equals the variance in fitness. This result can be seen as a modified version of Fisher&#8217;s fundamental theorem of natural selection. We compare it to Fisher&#8217;s original result as interpreted by Price, Ewens and Edwards.</p>
<h4>Introduction</h4>
<p>In 1930, Fisher stated his &#8220;fundamental theorem of natural selection&#8221; as follows:</p>
<blockquote><p>The rate of increase in fitness of any organism at any time is equal to its genetic variance in fitness at that time</p></blockquote>
<p>Some tried to make this statement precise as follows:</p>
<blockquote><p>The time derivative of the mean fitness of a population equals the variance of its fitness.</p></blockquote>
<p>But this is only true under very restrictive conditions, so a controversy was ignited.</p>
<p>An interesting resolution was proposed by Price, and later amplified by Ewens and Edwards. We can formalize their idea as follows. Suppose we have <i>n</i> types of self-replicating entity, and idealize the population of the <i>i</i>th type as a real-valued function <img src="https://s0.wp.com/latex.php?latex=P_i%28t%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="P_i(t)" class="latex" />. Suppose</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bd%7D%7Bdt%7D+P_i%28t%29+%3D+f_i%28P_1%28t%29%2C+%5Cdots%2C+P_n%28t%29%29+%5C%2C+P_i%28t%29+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{d}{dt} P_i(t) = f_i(P_1(t), &#92;dots, P_n(t)) &#92;, P_i(t) } " class="latex" /></p>
<p>where the fitness <img src="https://s0.wp.com/latex.php?latex=f_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="f_i" class="latex" /> is a differentiable function of the populations of every type of replicator. The mean fitness at time <img src="https://s0.wp.com/latex.php?latex=t&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="t" class="latex" /> is</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Coverline%7Bf%7D%28t%29+%3D+%5Csum_%7Bi%3D1%7D%5En+p_i%28t%29+%5C%2C+f_i%28P_1%28t%29%2C+%5Cdots%2C+P_n%28t%29%29+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;overline{f}(t) = &#92;sum_{i=1}^n p_i(t) &#92;, f_i(P_1(t), &#92;dots, P_n(t)) } " class="latex" /></p>
<p>where <img src="https://s0.wp.com/latex.php?latex=p_i%28t%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p_i(t)" class="latex" /> is the fraction of replicators of the <i>i</i>th type:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+p_i%28t%29+%3D+%5Cfrac%7BP_i%28t%29%7D%7B%5Cphantom%7B%5CBig%7C%7D+%5Csum_%7Bj+%3D+1%7D%5En+P_j%28t%29+%7D+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ p_i(t) = &#92;frac{P_i(t)}{&#92;phantom{&#92;Big|} &#92;sum_{j = 1}^n P_j(t) } } " class="latex" /></p>
<p>By the product rule, the rate of change of the mean fitness is the sum of two terms:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bd%7D%7Bdt%7D+%5Coverline%7Bf%7D%28t%29+%3D+%5Csum_%7Bi%3D1%7D%5En+%5Cdot%7Bp%7D_i%28t%29+%5C%2C+f_i%28P_1%28t%29%2C+%5Cdots%2C+P_n%28t%29%29+%5C%3B+%2B+%5C%3B+%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{d}{dt} &#92;overline{f}(t) = &#92;sum_{i=1}^n &#92;dot{p}_i(t) &#92;, f_i(P_1(t), &#92;dots, P_n(t)) &#92;; + &#92;; }" class="latex" /></p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Csum_%7Bi%3D1%7D%5En+p_i%28t%29+%5C%2C%5Cfrac%7Bd%7D%7Bdt%7D+f_i%28P_1%28t%29%2C+%5Cdots%2C+P_n%28t%29%29+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;sum_{i=1}^n p_i(t) &#92;,&#92;frac{d}{dt} f_i(P_1(t), &#92;dots, P_n(t)) } " class="latex" /></p>
<p>The <i>first</i> of these two terms equals the variance of the fitness at time <i>t</i>. We give the easy proof in Theorem 1. Unfortunately, the conceptual significance of this first term is much less clear than that of the total rate of change of mean fitness. Ewens concluded that &#8220;the theorem does not provide the substantial biological statement that Fisher claimed&#8221;.</p>
<p>But there is another way out, based on an idea Fisher himself introduced in 1922: Fisher information. Fisher information gives rise to a Riemannian metric on the space of probability distributions on a finite set, called the &#8216;Fisher information metric&#8217;&#8212;or in the context of evolutionary game theory, the &#8216;Shahshahani metric&#8217;. Using this metric we can define the speed at which a time-dependent probability distribution changes with time. We call this its &#8216;Fisher speed&#8217;. Under just the assumptions already stated, we prove in Theorem 2 that the Fisher speed of the probability distribution</p>
<p><img src="https://s0.wp.com/latex.php?latex=p%28t%29+%3D+%28p_1%28t%29%2C+%5Cdots%2C+p_n%28t%29%29+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p(t) = (p_1(t), &#92;dots, p_n(t)) " class="latex" /></p>
<p>is the variance of the fitness at time <i>t</i>.</p>
<p>As explained by Harper, natural selection can be thought of as a learning process, and studied using ideas from information geometry&#8212;that is, the geometry of the space of probability distributions. As <img src="https://s0.wp.com/latex.php?latex=p%28t%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p(t)" class="latex" /> changes with time, the rate at which information is updated is closely connected to its Fisher speed. Thus, our revised version of the fundamental theorem of natural selection can be loosely stated as follows:</p>
<blockquote><p>As a population changes with time, the rate at which information is updated equals the variance of fitness.</p></blockquote>
<p>The precise statement, with all the hypotheses, is in Theorem 2. But one lesson is this: variance in fitness may not cause &#8216;progress&#8217; in the sense of increased mean fitness, but it does cause change!</p>
<p>For more details in a user-friendly blog format, read the whole series:</p>
<p>• <a href="https://johncarlosbaez.wordpress.com/2020/09/29/fishers-fundamental-theorem-part-1/">Part 1</a>: the obscurity of Fisher&#8217;s original paper.</p>
<p>• <a href="https://johncarlosbaez.wordpress.com/2020/09/29/fishers-fundamental-theorem-part-2/">Part 2</a>: a precise statement of Fisher&#8217;s fundamental theorem of natural selection, and conditions under which it holds.</p>
<p>• <a href="https://johncarlosbaez.wordpress.com/2020/10/08/fishers-fundamental-theorem-part-3/">Part 3</a>: a modified version of the fundamental theorem of natural selection, which holds much more generally.</p>
<p>• <a href="https://johncarlosbaez.wordpress.com/2021/07/13/fishers-fundamental-theorem-part-4/">Part 4</a>: my paper on the fundamental theorem of natural selection.</p>
]]></content:encoded>
					
					<wfw:commentRss>https://johncarlosbaez.wordpress.com/2021/07/13/fishers-fundamental-theorem-part-4/feed/</wfw:commentRss>
			<slash:comments>6</slash:comments>
		
		
		
		<media:thumbnail url="https://johncarlosbaez.files.wordpress.com/2021/07/replicators.png" />
		<media:content url="https://johncarlosbaez.files.wordpress.com/2021/07/replicators.png" medium="image">
			<media:title type="html">replicators</media:title>
		</media:content>

		<media:content url="https://0.gravatar.com/avatar/34784534843022b3541c8ddd693718cb?s=96&#38;d=identicon&#38;r=G" medium="image">
			<media:title type="html">John Baez</media:title>
		</media:content>
	</item>
		<item>
		<title>Fisher&#8217;s Fundamental Theorem (Part 3)</title>
		<link>https://johncarlosbaez.wordpress.com/2020/10/08/fishers-fundamental-theorem-part-3/</link>
					<comments>https://johncarlosbaez.wordpress.com/2020/10/08/fishers-fundamental-theorem-part-3/#comments</comments>
		
		<dc:creator><![CDATA[John Baez]]></dc:creator>
		<pubDate>Thu, 08 Oct 2020 00:10:26 +0000</pubDate>
				<category><![CDATA[biology]]></category>
		<category><![CDATA[information and entropy]]></category>
		<category><![CDATA[probability]]></category>
		<guid isPermaLink="false">http://johncarlosbaez.wordpress.com/?p=28874</guid>

					<description><![CDATA[Last time we stated and proved a simple version of Fisher&#8217;s fundamental theorem of natural selection, which says that under some conditions, the rate of increase of the mean fitness equals the variance of the fitness. But the conditions we gave were very restrictive: namely, that the fitness of each species of replicator is constant, [&#8230;]]]></description>
										<content:encoded><![CDATA[<p><a href="https://johncarlosbaez.wordpress.com/2020/09/29/fishers-fundamental-theorem-part-2/">Last time</a> we stated and proved a simple version of Fisher&#8217;s fundamental theorem of natural selection, which says that <i>under some conditions</i>, the rate of increase of the mean fitness equals the variance of the fitness.   But the conditions we gave were very restrictive: namely, that the fitness of each species of replicator is constant, not depending on how many of these replicators there are, or any other replicators.</p>
<p>To broaden the scope of Fisher&#8217;s fundamental theorem we need to do one of two things:</p>
<p>1) change the left side of the equation: talk about some other quantity other than rate of change of mean fitness.</p>
<p>2) change the right side of the question: talk about some other quantity than the variance in fitness.</p>
<p>Or we could do both!   <img src="https://i1.wp.com/math.ucr.edu/home/baez/emoticons/tongue2.gif" />  People have spent a lot of time generalizing Fisher&#8217;s fundamental theorem.   I don&#8217;t think there are, or should be, any hard rules on what counts as a generalization.</p>
<p>But today we&#8217;ll take alternative 1).  We&#8217;ll show the square of something called the &#8216;Fisher speed&#8217; <i>always</i> equals the variance in fitness.  One nice thing about this result is that we can drop the restrictive condition I mentioned.   Another nice thing is that the Fisher speed is a concept from information theory!  It&#8217;s defined using the <a href="https://en.wikipedia.org/wiki/Fisher_information_metric">Fisher metric</a> on the space of probability distributions.</p>
<p>And yes&#8212;that metric is named after the same guy who proved Fisher&#8217;s fundamental theorem!  So, arguably, <i>Fisher</i> should have proved this generalization of Fisher&#8217;s fundamental theorem.  But in fact it seems that I was the first to prove it, around <a href="https://math.ucr.edu/home/baez/information/information_geometry_16.html">February 1st, 2017</a>.   Some similar results were already known, and I will discuss those someday.  But they&#8217;re a bit different.</p>
<p>A good way to think about the Fisher speed is that it&#8217;s &#8216;the rate at which information is being updated&#8217;.   A population of replicators of different species gives a probability distribution.  Like any probability distribution, this has information in it.   As the populations of our replicators change, the Fisher speed says the rate at which this information is being updated.  So, in simple terms, we&#8217;ll show</p>
<blockquote><p>
  The square of the rate at which information is updated is equal to the variance in fitness.</p></blockquote>
<p>This is quite a change from Fisher&#8217;s original idea, namely:</p>
<blockquote><p>
  The rate of increase of mean fitness is equal to the variance in fitness.</p></blockquote>
<p>But it has the advantage of always being true&#8230; as long the population dynamics are described by the general framework we introduced last time.  So let me remind you of the general setup, and then prove the result!</p>
<h3> The setup</h3>
<p>We start out with population functions <img src="https://s0.wp.com/latex.php?latex=P_i+%5Ccolon+%5Cmathbb%7BR%7D+%5Cto+%280%2C%5Cinfty%29%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="P_i &#92;colon &#92;mathbb{R} &#92;to (0,&#92;infty)," class="latex" /> one for each species of replicator <img src="https://s0.wp.com/latex.php?latex=i+%3D+1%2C%5Cdots%2Cn%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="i = 1,&#92;dots,n," class="latex" /> obeying the <b>Lotka–Volterra equation</b></p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bd+P_i%7D%7Bd+t%7D+%3D+f_i%28P_1%2C+%5Cdots%2C+P_n%29+P_i+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{d P_i}{d t} = f_i(P_1, &#92;dots, P_n) P_i } " class="latex" /></p>
<p>for some differentiable functions <img src="https://s0.wp.com/latex.php?latex=f_i+%5Ccolon+%280%2C%5Cinfty%29+%5Cto+%5Cmathbb%7BR%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="f_i &#92;colon (0,&#92;infty) &#92;to &#92;mathbb{R}" class="latex" /> called <b>fitness functions</b>.   The probability of a replicator being in the <i>i</i>th species is</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B++p_i%28t%29+%3D+%5Cfrac%7BP_i%28t%29%7D%7B%5Csum_j+P_j%28t%29%7D+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{  p_i(t) = &#92;frac{P_i(t)}{&#92;sum_j P_j(t)} } " class="latex" /></p>
<p>Using the Lotka–Volterra equation we showed last time that these probabilities obey the <b>replicator equation</b></p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cdot%7Bp%7D_i+%3D+%5Cleft%28+f_i%28P%29+-+%5Coverline+f%28P%29+%5Cright%29++p_i+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;dot{p}_i = &#92;left( f_i(P) - &#92;overline f(P) &#92;right)  p_i } " class="latex" /></p>
<p>Here <img src="https://s0.wp.com/latex.php?latex=P&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="P" class="latex" /> is short for the whole list of populations <img src="https://s0.wp.com/latex.php?latex=%28P_1%28t%29%2C+%5Cdots%2C+P_n%28t%29%29%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="(P_1(t), &#92;dots, P_n(t))," class="latex" /> and</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Coverline+f%28P%29+%3D+%5Csum_j+f_j%28P%29+p_j++%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;overline f(P) = &#92;sum_j f_j(P) p_j  } " class="latex" /></p>
<p>is the <b>mean fitness</b>.</p>
<h3>The Fisher metric</h3>
<p>The space of probability distributions on the set <img src="https://s0.wp.com/latex.php?latex=%5C%7B1%2C+%5Cdots%2C+n%5C%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;{1, &#92;dots, n&#92;}" class="latex" /> is called the <b>(n-1)-simplex</b></p>
<p><img src="https://s0.wp.com/latex.php?latex=%5CDelta%5E%7Bn-1%7D+%3D+%5C%7B+%28x_1%2C+%5Cdots%2C+x_n%29+%3A+%5C%3B+x_i+%5Cge+0%2C+%5C%3B+%5Cdisplaystyle%7B+%5Csum_%7Bi%3D1%7D%5En+x_i+%3D+1+%7D+%5C%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Delta^{n-1} = &#92;{ (x_1, &#92;dots, x_n) : &#92;; x_i &#92;ge 0, &#92;; &#92;displaystyle{ &#92;sum_{i=1}^n x_i = 1 } &#92;} " class="latex" /></p>
<p>It&#8217;s called <img src="https://s0.wp.com/latex.php?latex=%5CDelta%5E%7Bn-1%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Delta^{n-1}" class="latex" /> because it&#8217;s (n-1)-dimensional.  When <img src="https://s0.wp.com/latex.php?latex=n+%3D+3&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="n = 3" class="latex" /> it looks like the letter <img src="https://s0.wp.com/latex.php?latex=%5CDelta%3A&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Delta:" class="latex" /></p>
<div align="center">
<a href="https://johncarlosbaez.files.wordpress.com/2020/10/800px-2d-simplex.svg_.png"><img src="https://johncarlosbaez.files.wordpress.com/2020/10/800px-2d-simplex.svg_.png?w=150" alt="" width="150" /></a></div>
<p>The <b>Fisher metric</b> is a Riemannian metric on the interior of the (n-1)-simplex.  That is, given a point <img src="https://s0.wp.com/latex.php?latex=p&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p" class="latex" /> in the interior of <img src="https://s0.wp.com/latex.php?latex=%5CDelta%5E%7Bn-1%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;Delta^{n-1}" class="latex" /> and two tangent vectors <img src="https://s0.wp.com/latex.php?latex=v%2Cw&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="v,w" class="latex" /> at this point the Fisher metric gives a number</p>
<p><img src="https://s0.wp.com/latex.php?latex=g%28v%2Cw%29+%3D+%5Cdisplaystyle%7B+%5Csum_%7Bi%3D1%7D%5En+%5Cfrac%7Bv_i+w_i%7D%7Bp_i%7D++%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="g(v,w) = &#92;displaystyle{ &#92;sum_{i=1}^n &#92;frac{v_i w_i}{p_i}  } " class="latex" /></p>
<p>Here we are describing the tangent vectors <img src="https://s0.wp.com/latex.php?latex=v%2Cw&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="v,w" class="latex" /> as vectors in <img src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BR%7D%5En&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;mathbb{R}^n" class="latex" /> with the property that the sum of their components is zero: that&#8217;s what makes them tangent to the (n-1)-simplex.  And we&#8217;re demanding that <img src="https://s0.wp.com/latex.php?latex=x&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="x" class="latex" /> be in the interior of the simplex to avoid dividing by zero, since on the boundary of the simplex we have <img src="https://s0.wp.com/latex.php?latex=p_i+%3D+0&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p_i = 0" class="latex" /> for at least one choice of $i.$</p>
<p>If we have a probability distribution <img src="https://s0.wp.com/latex.php?latex=p%28t%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p(t)" class="latex" /> moving around in the interior of the (n-1)-simplex as a function of time, its <b>Fisher speed</b> is</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Csqrt%7Bg%28%5Cdot%7Bp%7D%28t%29%2C+%5Cdot%7Bp%7D%28t%29%29%7D+%3D+%5Csqrt%7B%5Csum_%7Bi%3D1%7D%5En+%5Cfrac%7B%5Cdot%7Bp%7D_i%28t%29%5E2%7D%7Bp_i%28t%29%7D%7D+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;sqrt{g(&#92;dot{p}(t), &#92;dot{p}(t))} = &#92;sqrt{&#92;sum_{i=1}^n &#92;frac{&#92;dot{p}_i(t)^2}{p_i(t)}} } " class="latex" /></p>
<p>if the derivative <img src="https://s0.wp.com/latex.php?latex=%5Cdot%7Bp%7D%28t%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;dot{p}(t)" class="latex" /> exists.   This is the usual formula for the speed of a curve moving in a Riemannian manifold, specialized to the case at hand.</p>
<p>Now we&#8217;ve got all the formulas we&#8217;ll need to prove the result we want.  But for those who don&#8217;t already know and love it, it&#8217;s worthwhile saying a bit more about the Fisher metric.</p>
<p>The factor of <img src="https://s0.wp.com/latex.php?latex=1%2Fx_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="1/x_i" class="latex" /> in the Fisher metric changes the geometry of the simplex so that it becomes <i>round</i>, like a portion of a sphere:</p>
<div align="center">
<a href="https://johncarlosbaez.files.wordpress.com/2020/10/fisher_metric.jpg"><img src="https://johncarlosbaez.files.wordpress.com/2020/10/fisher_metric.jpg?w=250" alt="" width="250" /></a></div>
<p>But the reason the Fisher metric is important, I think, is its connection to relative information.  Given two probability distributions <img src="https://s0.wp.com/latex.php?latex=p%2C+q+%5Cin+%5CDelta%5E%7Bn-1%7D%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p, q &#92;in &#92;Delta^{n-1}," class="latex" /> the <b>information of <img src="https://s0.wp.com/latex.php?latex=q&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q" class="latex" /> relative to <img src="https://s0.wp.com/latex.php?latex=p&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p" class="latex" /></b> is</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+I%28q%2Cp%29+%3D+%5Csum_%7Bi+%3D+1%7D%5En+q_i+%5Cln%5Cleft%28%5Cfrac%7Bq_i%7D%7Bp_i%7D%5Cright%29+++%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ I(q,p) = &#92;sum_{i = 1}^n q_i &#92;ln&#92;left(&#92;frac{q_i}{p_i}&#92;right)   } " class="latex" /></p>
<p>You can show this is the expected amount of information gained if <img src="https://s0.wp.com/latex.php?latex=p&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p" class="latex" /> was your prior distribution and you receive information that causes you to update your prior to <img src="https://s0.wp.com/latex.php?latex=q.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="q." class="latex" />   So, sometimes it&#8217;s called the <b>information gain</b>.  It&#8217;s also called <b>relative entropy</b> or&#8212;my least favorite, since it sounds so mysterious&#8212;the <b><a href="https://en.wikipedia.org/wiki/Kullback%E2%80%93Leibler_divergence">Kullback–Leibler divergence</a></b>.</p>
<p>Suppose <img src="https://s0.wp.com/latex.php?latex=p%28t%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p(t)" class="latex" /> is a smooth curve in the interior of the (n-1)-simplex.  We can ask the rate at which information is gained as time passes.  Perhaps surprisingly, a calculation gives</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cfrac%7Bd%7D%7Bdt%7D+I%28p%28t%29%2C+p%28t_0%29%29%5CBig%7C_%7Bt+%3D+t_0%7D+%3D+0+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;frac{d}{dt} I(p(t), p(t_0))&#92;Big|_{t = t_0} = 0 } " class="latex" /></p>
<p>That is, in some sense &#8216;to first order&#8217; no information is being gained at any moment <img src="https://s0.wp.com/latex.php?latex=t_0+%5Cin+%5Cmathbb%7BR%7D.&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="t_0 &#92;in &#92;mathbb{R}." class="latex" />   However, we have</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B++%5Cfrac%7Bd%5E2%7D%7Bdt%5E2%7D+I%28p%28t%29%2C+p%28t_0%29%29%5CBig%7C_%7Bt+%3D+t_0%7D+%3D++g%28%5Cdot%7Bp%7D%28t_0%29%2C+%5Cdot%7Bp%7D%28t_0%29%29%7D++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{  &#92;frac{d^2}{dt^2} I(p(t), p(t_0))&#92;Big|_{t = t_0} =  g(&#92;dot{p}(t_0), &#92;dot{p}(t_0))}  " class="latex" /></p>
<p>So, the square of the Fisher speed has a nice interpretation in terms of relative entropy!</p>
<p>For a derivation of these last two equations, see <a href="https://johncarlosbaez.wordpress.com/2011/03/02/information-geometry-part-7/">Part 7</a> of my posts on information geometry.  For more on the meaning of relative entropy, see <a href="https://johncarlosbaez.wordpress.com/2011/01/21/information-geometry-part-6/">Part 6</a>.</p>
<h3> The result</h3>
<p>It&#8217;s now extremely easy to show what we want, but let me state it formally so all the assumptions are crystal clear.</p>
<p><b>Theorem.</b>  Suppose the functions <img src="https://s0.wp.com/latex.php?latex=P_i+%5Ccolon+%5Cmathbb%7BR%7D+%5Cto+%280%2C%5Cinfty%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="P_i &#92;colon &#92;mathbb{R} &#92;to (0,&#92;infty)" class="latex" /> obey the Lotka&#8211;Volterra equations:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cdot+P_i+%3D+f_i%28P%29+P_i%7D++&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;dot P_i = f_i(P) P_i}  " class="latex" /></p>
<p>for some differentiable functions <img src="https://s0.wp.com/latex.php?latex=f_i+%5Ccolon+%280%2C%5Cinfty%29%5En+%5Cto+%5Cmathbb%7BR%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="f_i &#92;colon (0,&#92;infty)^n &#92;to &#92;mathbb{R}" class="latex" /> called fitness functions.   Define probabilities and the mean fitness as above, and define the <b>variance of the fitness</b> by</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cmathrm%7BVar%7D%28f%28P%29%29+%3D++%5Csum_j+%28+f_j%28P%29+-+%5Coverline+f%28P%29%29%5E2+%5C%2C+p_j+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;mathrm{Var}(f(P)) =  &#92;sum_j ( f_j(P) - &#92;overline f(P))^2 &#92;, p_j } " class="latex" /></p>
<p>Then if none of the populations <img src="https://s0.wp.com/latex.php?latex=P_i&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="P_i" class="latex" /> are zero, the square of the Fisher speed of the probability distribution <img src="https://s0.wp.com/latex.php?latex=p%28t%29+%3D+%28p_1%28t%29%2C+%5Cdots+%2C+p_n%28t%29%29&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="p(t) = (p_1(t), &#92;dots , p_n(t))" class="latex" /> is the variance of the fitness:</p>
<p><img src="https://s0.wp.com/latex.php?latex=g%28%5Cdot%7Bp%7D%2C+%5Cdot%7Bp%7D%29++%3D+%5Cmathrm%7BVar%7D%28f%28P%29%29+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="g(&#92;dot{p}, &#92;dot{p})  = &#92;mathrm{Var}(f(P)) " class="latex" /></p>
<p><b>Proof.</b> The proof is near-instantaneous.  We take the square of the Fisher speed:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+g%28%5Cdot%7Bp%7D%2C+%5Cdot%7Bp%7D%29+%3D+%5Csum_%7Bi%3D1%7D%5En+%5Cfrac%7B%5Cdot%7Bp%7D_i%28t%29%5E2%7D%7Bp_i%28t%29%7D+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ g(&#92;dot{p}, &#92;dot{p}) = &#92;sum_{i=1}^n &#92;frac{&#92;dot{p}_i(t)^2}{p_i(t)} } " class="latex" /></p>
<p>and plug in the replicator equation:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cdisplaystyle%7B+%5Cdot%7Bp%7D_i+%3D+%28f_i%28P%29+-+%5Coverline+f%28P%29%29+p_i+%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;displaystyle{ &#92;dot{p}_i = (f_i(P) - &#92;overline f(P)) p_i } " class="latex" /></p>
<p>We obtain:</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Barray%7D%7Bccl%7D+%5Cdisplaystyle%7B+g%28%5Cdot%7Bp%7D%2C+%5Cdot%7Bp%7D%29%7D+%26%3D%26++%5Cdisplaystyle%7B+%5Csum_%7Bi%3D1%7D%5En+%5Cleft%28+f_i%28P%29+-+%5Coverline+f%28P%29+%5Cright%29%5E2+p_i+%7D+%5C%5C+%5C%5C++%26%3D%26+%5Cmathrm%7BVar%7D%28f%28P%29%29++%5Cend%7Barray%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;begin{array}{ccl} &#92;displaystyle{ g(&#92;dot{p}, &#92;dot{p})} &amp;=&amp;  &#92;displaystyle{ &#92;sum_{i=1}^n &#92;left( f_i(P) - &#92;overline f(P) &#92;right)^2 p_i } &#92;&#92; &#92;&#92;  &amp;=&amp; &#92;mathrm{Var}(f(P))  &#92;end{array} " class="latex" /></p>
<p>as desired.   &nbsp; █</p>
<p>It&#8217;s hard to imagine anything simpler than this.  We see that given the Lotka–Volterra equation, what causes information to be updated is nothing more and nothing less than variance in fitness!</p>
<hr />
<p>The whole series:</p>
<p>&bull; <a href="https://johncarlosbaez.wordpress.com/2020/09/29/fishers-fundamental-theorem-part-1/">Part 1</a>: the obscurity of Fisher&#8217;s original paper.</p>
<p>&bull; <a href="https://johncarlosbaez.wordpress.com/2020/09/29/fishers-fundamental-theorem-part-2/">Part 2</a>: a precise statement of Fisher&#8217;s fundamental theorem of natural selection, and conditions under which it holds.</p>
<p>&bull; <a href="https://johncarlosbaez.wordpress.com/2020/10/08/fishers-fundamental-theorem-part-3/">Part 3</a>: a modified version of the fundamental theorem of natural selection, which holds much more generally.</p>
<p>&bull; <a href="https://johncarlosbaez.wordpress.com/2021/07/13/fishers-fundamental-theorem-part-4/">Part 4</a>: my paper on the fundamental theorem of natural selection.</p>
]]></content:encoded>
					
					<wfw:commentRss>https://johncarlosbaez.wordpress.com/2020/10/08/fishers-fundamental-theorem-part-3/feed/</wfw:commentRss>
			<slash:comments>10</slash:comments>
		
		
		
		<media:content url="https://0.gravatar.com/avatar/34784534843022b3541c8ddd693718cb?s=96&#38;d=identicon&#38;r=G" medium="image">
			<media:title type="html">John Baez</media:title>
		</media:content>

		<media:content url="http://math.ucr.edu/home/baez/emoticons/tongue2.gif" medium="image" />

		<media:content url="https://johncarlosbaez.files.wordpress.com/2020/10/800px-2d-simplex.svg_.png" medium="image" />

		<media:content url="https://johncarlosbaez.files.wordpress.com/2020/10/fisher_metric.jpg" medium="image" />
	</item>
		<item>
		<title>Markov Decision Processes</title>
		<link>https://johncarlosbaez.wordpress.com/2020/10/06/markov-decision-processes/</link>
					<comments>https://johncarlosbaez.wordpress.com/2020/10/06/markov-decision-processes/#comments</comments>
		
		<dc:creator><![CDATA[John Baez]]></dc:creator>
		<pubDate>Tue, 06 Oct 2020 21:00:57 +0000</pubDate>
				<category><![CDATA[biology]]></category>
		<category><![CDATA[probability]]></category>
		<category><![CDATA[sustainability]]></category>
		<guid isPermaLink="false">http://johncarlosbaez.wordpress.com/?p=28922</guid>

					<description><![CDATA[The National Institute of Mathematical and Biological Sciences is having an online seminar on &#8216;adaptive management&#8217;. It should be fun for people who want to understand Markov decision processes&#8212;like me! • NIMBioS Adaptive Management Webinar Series, 2020 October 26-29 (Monday-Thursday). Adaptive management seeks to determine sound management strategies in the face of uncertainty concerning the [&#8230;]]]></description>
										<content:encoded><![CDATA[<p>The National Institute of Mathematical and Biological Sciences is having an online seminar on &#8216;adaptive management&#8217;.  It should be fun for people who want to understand <a href="https://en.wikipedia.org/wiki/Markov_decision_process">Markov decision processes</a>&#8212;like me!</p>
<p>• <a href="http://www.nimbios.org/tutorials/TT_adapt_webinars">NIMBioS Adaptive Management Webinar Series</a>, 2020 October 26-29 (Monday-Thursday).</p>
<blockquote><p> Adaptive management seeks to determine sound management strategies in the face of uncertainty concerning the behavior of the system being managed. Specifically, it attempts to find strategies for managing dynamic systems while learning the behavior of the system. These webinars review the key concept of a Markov Decision Process (MDP) and demonstrate how quantitative adaptive management strategies can be developed using MDPs. Additional conceptual, computational and application aspects will be discussed, including dynamic programming and Bayesian formalization of learning.</p></blockquote>
<p>Here are the topics:</p>
<p>Session 1: Introduction to decision problems<br />
Session 2: Introduction to Markov decision processes (MDPs)<br />
Session 3: Solving Markov decision processes (MDPs)<br />
Session 4: Modeling beliefs<br />
Session 5: Conjugacy and discrete model adaptive management (AM)<br />
Session 6: More on AM problems (Dirichlet/multinomial and Gaussian prior/likelihood)<br />
Session 7: Partially observable Markov decision processes (POMDPs)<br />
Session 8: Frontier topics (projection methods, approximate DP, communicating solutions)</p>
<p>&nbsp;</p>
<div align="center"><a href="http://www.nimbios.org/"><img src="https://i0.wp.com/www.utk.edu/tntoday/images/nimbios_logo_lg.jpg" width="450"/></a></div>
]]></content:encoded>
					
					<wfw:commentRss>https://johncarlosbaez.wordpress.com/2020/10/06/markov-decision-processes/feed/</wfw:commentRss>
			<slash:comments>2</slash:comments>
		
		
		
		<media:content url="https://0.gravatar.com/avatar/34784534843022b3541c8ddd693718cb?s=96&#38;d=identicon&#38;r=G" medium="image">
			<media:title type="html">John Baez</media:title>
		</media:content>

		<media:content url="http://www.utk.edu/tntoday/images/nimbios_logo_lg.jpg" medium="image" />
	</item>
		<item>
		<title>Fock Space Techniques for Stochastic Physics</title>
		<link>https://johncarlosbaez.wordpress.com/2020/10/02/fock-space-techniques-for-stochastic-physics/</link>
					<comments>https://johncarlosbaez.wordpress.com/2020/10/02/fock-space-techniques-for-stochastic-physics/#respond</comments>
		
		<dc:creator><![CDATA[John Baez]]></dc:creator>
		<pubDate>Fri, 02 Oct 2020 19:10:29 +0000</pubDate>
				<category><![CDATA[mathematics]]></category>
		<category><![CDATA[physics]]></category>
		<category><![CDATA[probability]]></category>
		<guid isPermaLink="false">http://johncarlosbaez.wordpress.com/?p=28805</guid>

					<description><![CDATA[I&#8217;ve been fascinated for a long time about the relation between classical probability theory and quantum mechanics. This story took a strange new turn when people discovered that stochastic Petri nets, good for describing classical probabilistic models of interacting entities, can also be described using ideas from the quantum field theory! I&#8217;ll be talking about [&#8230;]]]></description>
										<content:encoded><![CDATA[<p>I&#8217;ve been fascinated for a long time about the relation between classical probability theory and quantum mechanics.  This story took a strange new turn when people discovered that stochastic Petri nets, good for describing classical probabilistic models of interacting entities, can also be described using ideas from the quantum field theory!</p>
<p>I&#8217;ll be talking about this at the online category theory seminar at UNAM, the National Autonomous University of Mexico, on Wednesday October 7th at 18:00 UTC (11 am Pacific Time):</p>
<blockquote><p>
  <b>Fock space techniques for stochastic physics</b></p>
<p><b>Abstract.</b> Some ideas from quantum theory are beginning to percolate back to classical probability theory. For example, the master equation for a chemical reaction network&#8212;also known as a stochastic Petri net&#8212;describes particle interactions in a stochastic rather than quantum way. If we look at this equation from the perspective of quantum theory, this formalism turns out to involve creation and annihilation operators, coherent states and other well-known ideas&#8212;but with a few big differences.</p></blockquote>
<p>You can watch the talk here:</p>
<p><iframe class="youtube-player" width="450" height="254" src="https://www.youtube.com/embed/7_vw2RU5V08?version=3&#038;rel=1&#038;showsearch=0&#038;showinfo=1&#038;iv_load_policy=1&#038;fs=1&#038;hl=en&#038;autohide=2&#038;wmode=transparent" allowfullscreen="true" style="border:0;" sandbox="allow-scripts allow-same-origin allow-popups allow-presentation"></iframe></p>
<p>You can also <a href="Fock_space_web.pdf">see the slides of this talk</a>.  Click on any picture in the slides, or any text in blue, and get more information!</p>
<p>My students Joe Moeller and Jade Master will also be giving talks in this seminar&#8212;on Petri nets and structured cospans.</p>
<p>&nbsp;</p>
<div align="center">
<img src="https://i2.wp.com/math.ucr.edu/home/baez/networks/pictures/rabbit_wolf_feynman_diagram.png" width="350"/></div>
]]></content:encoded>
					
					<wfw:commentRss>https://johncarlosbaez.wordpress.com/2020/10/02/fock-space-techniques-for-stochastic-physics/feed/</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
		
		<media:thumbnail url="https://johncarlosbaez.files.wordpress.com/2020/10/rabbit_wolf_feynman_diagram.png" />
		<media:content url="https://johncarlosbaez.files.wordpress.com/2020/10/rabbit_wolf_feynman_diagram.png" medium="image">
			<media:title type="html">rabbit_wolf_feynman_diagram</media:title>
		</media:content>

		<media:content url="https://0.gravatar.com/avatar/34784534843022b3541c8ddd693718cb?s=96&#38;d=identicon&#38;r=G" medium="image">
			<media:title type="html">John Baez</media:title>
		</media:content>

		<media:content url="http://math.ucr.edu/home/baez/networks/pictures/rabbit_wolf_feynman_diagram.png" medium="image" />
	</item>
		<item>
		<title>The Brownian Map</title>
		<link>https://johncarlosbaez.wordpress.com/2020/09/19/the-brownian-map/</link>
					<comments>https://johncarlosbaez.wordpress.com/2020/09/19/the-brownian-map/#comments</comments>
		
		<dc:creator><![CDATA[John Baez]]></dc:creator>
		<pubDate>Sat, 19 Sep 2020 18:59:45 +0000</pubDate>
				<category><![CDATA[mathematics]]></category>
		<category><![CDATA[physics]]></category>
		<category><![CDATA[probability]]></category>
		<guid isPermaLink="false">http://johncarlosbaez.wordpress.com/?p=28563</guid>

					<description><![CDATA[Nina Holden won the 2021 Maryam Mirzakhani New Frontiers Prize for her work on random surfaces and the mathematics of quantum gravity. I&#8217;d like to tell you what she did&#8230; but I&#8217;m so far behind I&#8217;ll just explain a bit of the background. Suppose you randomly choose a triangulation of the sphere with n triangles. [&#8230;]]]></description>
										<content:encoded><![CDATA[<p><img src="https://s0.wp.com/latex.php?latex=%5Cphantom%7Bx%7D+&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="&#92;phantom{x} " class="latex" /></p>
<div align="center">
<img src="https://i1.wp.com/math.ucr.edu/home/baez//mathematical/nina_holden.jpg" width="200" border="2" /></div>
<p><a href="https://n.ethz.ch/~holdenn/">Nina Holden</a> won the <a href="https://breakthroughprize.org/News/60">2021 Maryam Mirzakhani New Frontiers Prize</a> for her work on random surfaces and the mathematics of quantum gravity.   I&#8217;d like to tell you what she did&#8230; but I&#8217;m so far behind I&#8217;ll just explain a bit of the background.</p>
<p>Suppose you randomly choose a triangulation of the sphere with <i>n</i> triangles.  This is a purely combinatorial thing, but you can think of it as a metric space if each of the triangles is equilateral with all sides of length 1.</p>
<p>This is a distorted picture of what you might get, drawn by Jérémie Bettinelli:</p>
<div align="center">
<a href="http://www.normalesup.org/~bettinel/simul_plane_maps.html"><br />
<img src="https://i1.wp.com/math.ucr.edu/home/baez/mathematical/brownian_map.jpg" width="400" /></a></div>
<p>The triangles are not drawn as equilateral, so we can fit this shape into 3d space.  Visit Bettinelli&#8217;s page for images that you can rotate:</p>
<p>• Jérémie Bettinelli, <a href="http://www.normalesup.org/~bettinel/simul.html">Computer simulations of random maps</a>.</p>
<p>I&#8217;ve described how to build a random space out of <img src="https://s0.wp.com/latex.php?latex=n&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="n" class="latex" /> triangles.  In the limit <img src="https://s0.wp.com/latex.php?latex=n+%5Cto+%5Cinfty%2C&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="n &#92;to &#92;infty," class="latex" /> if you rescale the resulting space by a factor of <img src="https://s0.wp.com/latex.php?latex=n%5E%7B-1%2F4%7D&#038;bg=ffffff&#038;fg=333333&#038;s=0&#038;c=20201002" alt="n^{-1/4}" class="latex" /> so it doesn&#8217;t get bigger and bigger, it converges to a &#8216;random metric space&#8217; with fascinating properties.   It&#8217;s called the <b>Brownian map</b>.</p>
<p>This random metric space is on average so wrinkly and crinkly that &#8216;almost surely&#8217;&#8212;that is, with probability 1&#8212;its Hausdorff dimension <a href="https://arxiv.org/abs/math/0607567">is not 2 but 4</a>.  And yet it is almost surely <a href="https://arxiv.org/abs/math/0612315">homeomorphic to a sphere</a>!</p>
<p>Rigorously proving this is hard: a mix of combinatorics, probability theory and geometry.</p>
<p>Ideas from physics are also important here.  There&#8217;s a theory called<br />
&#8216;<a href="https://arxiv.org/abs/1908.05573">Liouville quantum gravity</a>’ that describes these random 2-dimensional surfaces.  So, physicists have ways of&#8212;nonrigorously&#8212;figuring out answers to some questions faster than the mathematicians!</p>
<p>A key step in understanding the Brownian map was this paper from 2013:</p>
<p>• Jean-François Le Gall, <a href="https://projecteuclid.org/euclid.aop/1372859769">Uniqueness and universality of the Brownian map</a>, <i>Annals of Probability</i> <b>41</b> (2013), 2880–2960.</p>
<div align="center">
<a href="https://projecteuclid.org/euclid.aop/1372859769"><br />
<img src="https://i1.wp.com/math.ucr.edu/home/baez/mathematical/brownian_map_le_gall.jpg" width="440" border="5" /><br />
</a></div>
<p>The Brownian map is to surfaces what Brownian motion is to curves.  For example, the Hausdorff dimension of Brownian motion is almost surely 2: twice the dimension of a smooth curve.  For the Brownian map it&#8217;s almost surely 4, twice the dimension of a smooth surface.</p>
<p>Let me just say one more technical thing.  There&#8217;s a &#8216;space of all compact metric spaces&#8217;, and the Brownian map is actually a probability measure on this space!  It&#8217;s called the <a href="https://en.wikipedia.org/wiki/Gromov%E2%80%93Hausdorff_convergence">Gromov-Hausdorff space</a>, and it itself is a metric space&#8230; but not compact.  (So no, we don&#8217;t have a set containing itself as an element.)</p>
<div align="center">
<a href="https://en.wikipedia.org/wiki/Gromov%E2%80%93Hausdorff_convergence"><br />
<img src="https://i1.wp.com/math.ucr.edu/home/baez/mathematical/gromov-hausdorff.jpg" width="400" border="5" /></a></div>
<p>There&#8217;s a lot more to say about this&#8230; but I haven&#8217;t gotten very close to understanding Nina Holden&#8217;s work yet.  She wrote a 7-paper series leading up to this one:</p>
<p>• Nina Holden and Xin Sun, <a href="https://arxiv.org/abs/1905.13207">Convergence of uniform triangulations under the Cardy embedding</a>.</p>
<p>They show that random triangulations of a <i>disk</i> can be chosen to a random metric on the disk which can also be obtained from Liouville quantum gravity.</p>
<p>This is a much easier place to start learning this general subject:</p>
<p>• Ewain Gwynne, <a href="https://arxiv.org/abs/1908.05573">Random surfaces and Liouville quantum gravity</a>.</p>
<p>One reason I find all this interesting is that when I worked on &#8216;spin foam models&#8217; of quantum gravity, we were trying to develop combinatorial theories of spacetime that had nice limits as the number of discrete building blocks approached infinity.   We were studying theories much more complicated than random 2-dimensional triangulations, and it quickly became clear to me how much work it would be to carefully analyze these.  So it&#8217;s interesting to see how mathematicians have entered this subject&#8212;starting with a much more tractable class of theories, which are already quite hard.</p>
<p>While the theory I just described gives random metric spaces whose Hausdorff dimension is twice their topological dimension, Liouville quantum gravity actually contains an adjustable parameter that lets you force these metric spaces to become less wrinkled, with lower Hausdorff dimension.  Taming the behavior of random triangulations gets harder in higher dimensions.   Renate Loll, Jan Ambjørn and others have argued that we need to work with Lorentzian rather than Riemannian geometries to get physically reasonable behavior.  This approach to quantum gravity is called <a href="https://arxiv.org/abs/1905.08669">causal dynamical triangulations</a>.</p>
]]></content:encoded>
					
					<wfw:commentRss>https://johncarlosbaez.wordpress.com/2020/09/19/the-brownian-map/feed/</wfw:commentRss>
			<slash:comments>2</slash:comments>
		
		
		
		<media:thumbnail url="https://johncarlosbaez.files.wordpress.com/2020/09/brownian_map.jpg" />
		<media:content url="https://johncarlosbaez.files.wordpress.com/2020/09/brownian_map.jpg" medium="image">
			<media:title type="html">brownian_map</media:title>
		</media:content>

		<media:content url="https://0.gravatar.com/avatar/34784534843022b3541c8ddd693718cb?s=96&#38;d=identicon&#38;r=G" medium="image">
			<media:title type="html">John Baez</media:title>
		</media:content>

		<media:content url="http://math.ucr.edu/home/baez//mathematical/nina_holden.jpg" medium="image" />

		<media:content url="http://math.ucr.edu/home/baez/mathematical/brownian_map.jpg" medium="image" />

		<media:content url="http://math.ucr.edu/home/baez/mathematical/brownian_map_le_gall.jpg" medium="image" />

		<media:content url="http://math.ucr.edu/home/baez/mathematical/gromov-hausdorff.jpg" medium="image" />
	</item>
	</channel>
</rss>
