<html><head><title>ESXi health status</title>
<style>
* {
	font-family: "Verdana",sans-serif;
}
</style>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
html {
	font-family: "Verdana", sans-serif;
	font-size: 11pt;
}
body {
	max-width:600pt;
	margin: 10pt auto;
}
div#menu {
	float: right;
	font-size: 9pt;
	padding: 0.5em;
	margin: 0.5em;
	border: 1px solid black;
}
div#menu ul {
	list-style-type: none;
	padding: 0 0 1ex 0;
	margin: 0;
	font-weight: bold;
}
div#menu ul ul {
	list-style-type: none;
	padding-left: 1em;
	margin: 0;
	font-weight: normal;
}
div#content {
	max-width: 80em;
}
form {
	padding-bottom: 0;
	margin-bottom: 0;
}
@media (prefers-color-scheme: dark) {
	body {
		color: #ddd;
		background: #222;
	}
	a:link {
		color:#0af;
	}
	a:visited {
		color:#a6d;
	}
	div#menu {
		border: 1px solid #ccc;
	}
}
</style>
</head><body>
<div id="menu">
<ul><li>Windows ports
<ul>
<li><a href="/misc/gifsicle/">Gifsicle</a></li>
<li><a href="/misc/netcat/">NetCat</a></li>
<li><a href="/misc/pciutils/">PCI Utilities</a></li>
<li><a href="/misc/wget/">GNU Wget</a></li>
</ul></li>
<li>Scripts
<ul>
<li><a href="/misc/AHK/">AutoHotKey</a></li>
<li><a href="/misc/xchat/">for (he)xchat</a></li>
<li><a href="/misc/vmware/">for VMWare ESXi</a></li>
</ul></li>
<li>Other things
<ul>
<li><a href="/misc/gimp/">GIMP-related stuff</a></li>
</ul></li>
</ul>
<small>Provided by <a href="mailto:jernej&#x7c;s-website@eternallybored.org" title="This is a real, working e-mail address">Jernej Simon&#269;i&#269;</a></small>
<br><form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top" style="float:right">
<input type="hidden" name="cmd" value="_s-xclick">
<input type="hidden" name="encrypted" value="-----BEGIN PKCS7-----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-----END PKCS7-----">
<input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donate_SM.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
<img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
</form></div>

<h1>ESXi health status</h1>
This is a perl script which will generate health report for ESXi server. You need to have
<a href="http://www.vmware.com/support/developer/vcli/">vSphere CLI</a> installed. The script can generate
<a href="sample_report.txt">text</a> or <a href="sample_report.html">HTML</a> reports, and automatically mail them.
<br><br>
<a href="esxi_health_status.pl">esxi_health_status.pl</a> - ESXi health report script<br>
<a href="mail_health_report.cmd">mail_health_report.cmd</a> - simple wrapper for Windows<br>
<a href="mail_health_report.sh">mail_health_report.sh</a> - simple wrapper for Linux<br><br>
The easiest way to use the script is to download the perl script and the wrapper for your OS. Open the wrapper in a text editor
and change the values to match your setup, then put the wrapper in cron or Task Scheduler.<br>
<br><h4>Notes:</h4>
<ul>
<li>VSphere CLI 6.5 and newer do not include Perl any more on Windows, so you need to install
<a href="http://strawberryperl.com">Strawberry Perl</a> or <a href="http://www.activestate.com/activeperl">ActivePerl</a>
yoursef.</li>
<li>ESXi 6.7 seems to not work with older versions of VSphere CLI - install <a
href="https://code.vmware.com/web/dp/tool/vsphere-cli/6.7">VSphere CLI 6.7</a> if you have problems getting the script to work.</li>
</ul>
<h4>Creating a limited account for health check script</h4>
<h5>ESXi Web UI:</h5>
<ol>
<li>Log in to ESXi Web UI as root</li>
<li>Expand <i>Host</i>, click <i>Manage</i> and then click <i>Security & Users</i> tab</li>
<li>Click <i>Roles</i> and <i>Add role...</i></li>
<li>Select a name for the role (eg. Health), then click <i>Global</i> and check <i>Health</i>, then click <i>Add</i>.</li>
<li>Click <i>Users</i> and <i>Add user...</i></li>
<li>Set a login name and password for the user and click <i>Add</i></li>
<li>Right-click <i>Manage</i> (under <i>Host</i>) and click <i>Permissions</i></li>
<li>Click <i>Add user...</i>, select the user and role you created, then click <i>Add user</i></li>
<li>With this the user account creation is complete, and you can use this user with the health report script</li>
</ol>
<h5>VSphere Client:</h5>
<ol>
<li>Log in to vSphere Client as root</li>
<li>Click <i>Home</i> and then click <i>Roles</i></li>
<li>Right-click inside the Roles pane and choose <i>Add...</i></li>
<li>Select a name for the role (eg. Health), expand <i>All roles</i>, <i>Global</i> and check <i>Health</i>, then click <i>OK</i>.</li>
<li>Click <i>Home</i> again, then click <i>Inventory</i> and go to <i>Users</i> tab</li>
<li>Right-click inside the window and choose <i>Add...</i></li>
<li>Set a login name and password for the user and click <i>OK</i></li>
<li>Go to <i>Permissions</i> tab, right-click inside the window and choose <i>Add permision...</i></li>
<li>Click <i>Add...</i> under <i>Users and Groups</i>, double-click the user you created and click <i>OK</i></li>
<li>Under <i>Assigned Role</i> choose the role you created and click <i>OK</i></li>
<li>With this the user account creation is complete, and you can use this user with the health report script</li>
</ol>
</body></html>